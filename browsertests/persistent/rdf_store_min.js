(function(){typeof console=="undefined"&&(console={log:function(){}});var A={"extends":function(a,c){c.prototype=new a},stackCounterLimit:1E3,stackCounter:0};A.recur=function(a){A.stackCounter===A.stackCounterLimit?(A.stackCounter=0,setTimeout(a,0)):(A.stackCounter++,a())};A.clone=function(a){return JSON.parse(JSON.stringify(a))};A.shuffle=function(a){for(var c,d,e=a.length;e;c=parseInt(Math.random()*e),d=a[--e],a[e]=a[c],a[c]=d);return a};A.include=function(a,c,d){for(var e=a.length-1;e>=0;e--){var k=
!1,k=d==null?a[e]===c:d(a[e],c)===0;if(k===!0)return!0}return!1};A.remove=function(a,c){for(var d=[],e=0;e<a.length;e++)a[e]!==c&&d.push(a[e]);return d};A.repeat=function(a,c,d,e,k){arguments.length===4&&(k={});a<c?(k._i=a,d(function(d,k){A.recur(function(){A.repeat(a+1,c,d,e,k)})},k)):e(k)};A.meanwhile=function(a,c,d,e){arguments.length===3&&(e={});e._stack_counter==null&&(e._stack_counter=0);a===!0?c(function(a,c,e){e._stack_counter%40==39?(e._stack_counter+=1,setTimeout(function(){A.neanwhile(a,
c,d,e)},0)):(e._stack_counter+=1,A.meanwhile(a,c,d,e))},e):d(e)};A.seq=function(){var a=arguments;return function(c){A.repeat(0,a.length,function(c,e){var k=arguments.callee;a[e._i](function(){c(k,e)})},function(){c()})}};A.partition=function(a,c){for(var d=a.length%c,e=[],k=0;k<d;k++)e.push(null);d=[];for(k=0;k<a.length;k++)e.push(a[k]),e.length%c==0&&(d.push(e),e=[]);return d};A.keys=function(a){var c=[],d;for(d in a)c.push(d);return c};A.iso8601=function(a){function c(a){return a<10?"0"+a:a}return a.getUTCFullYear()+
"-"+c(a.getUTCMonth()+1)+"-"+c(a.getUTCDate())+"T"+c(a.getUTCHours())+":"+c(a.getUTCMinutes())+":"+c(a.getUTCSeconds())+"Z"};A.parseStrictISO8601=function(a){var c=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=0,d=new Date(c[1],0,1);if(c[3])d.setMonth(c[3]-1);else throw"missing ISO8061 component";if(c[5])d.setDate(c[5]);else throw"missing ISO8061 component";if(c[7])d.setHours(c[7]);else throw"missing ISO8061 component";
if(c[8])d.setMinutes(c[8]);else throw"missing ISO8061 component";if(c[10])d.setSeconds(c[10]);else throw"missing ISO8061 component";c[12]&&d.setMilliseconds(Number("0."+c[12])*1E3);c[14]&&(a=Number(c[16])*60+Number(c[17]),a*=c[15]=="-"?1:-1);a-=d.getTimezoneOffset();c=new Date;c.setTime(Number(Number(d)+a*6E4));return c};A.parseISO8601=function(a){var c=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=
0,d=new Date(c[1],0,1);c[3]&&d.setMonth(c[3]-1);c[5]&&d.setDate(c[5]);c[7]&&d.setHours(c[7]);c[8]&&d.setMinutes(c[8]);c[10]&&d.setSeconds(c[10]);c[12]&&d.setMilliseconds(Number("0."+c[12])*1E3);c[14]&&(a=Number(c[16])*60+Number(c[17]),a*=c[15]=="-"?1:-1);a-=d.getTimezoneOffset();c=new Date;c.setTime(Number(Number(d)+a*6E4));return c};A.parseISO8601Components=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2}))(-([0-9]{2}))(T([0-9]{2}):([0-9]{2})(:([0-9]{2}))?(.([0-9]+))?)?(Z|([-+])([0-9]{2})(:([0-9]{2}))?)?")),
c,d,e,k,j,i,l,f;c=Number(a[1]);d=a[3]-1;e=Number(a[5]);k=Number(a[7]);j=Number(a[8]);i=Number(a[10]);a[12]&&(l=Number("0."+a[12])*1E3);a[13]==="Z"?f=0:a[14]?(f=0,a[17]&&(f=Number(a[17])),f+=Number(a[15])*60,f*=a[14]=="-"?-1:1):a[14]==null&&a[11]&&(f=Number(a[12])*60);return{year:isNaN(c)?null:c,month:isNaN(d)?null:d,date:isNaN(e)?null:e,hours:isNaN(k)?null:k,minutes:isNaN(j)?null:j,seconds:isNaN(i)?null:i,millisecs:isNaN(l)?null:l,timezone:isNaN(f)?null:f}};A.compareDateComponents=function(a,c){var d=
A.parseISO8601Components(a),e=A.parseISO8601Components(c);if(d.timezone==null&&e.timezone==null||d.timezone!=null&&e.timezone!=null)return d=A.parseISO8601(a),e=A.parseISO8601(c),d.getTime()==e.getTime()?0:d.getTime()<e.getTime()?-1:1;else if(d.timezone!=null&&e.timezone==null){var d=A.parseISO8601(a),e=A.parseISO8601(c),d=d.getTime(),e=e.getTime(),k=50400;return d<e&&d<e+k?-1:d>e&&d>e-k?1:null}else return d=A.parseISO8601(a),e=A.parseISO8601(c),d=d.getTime(),e=e.getTime(),k=50400,d<e&&d+k<e?-1:d>
e&&d+k>e?1:null};A.lexicalFormLiteral=function(a,c){var d=a.value,e=a.lang,k=a.type,j=null;if(d!=null&&k!=null&&typeof k!="string"){d=k.value;if(d==null)d=k.suffix,k=c.namespaces[k.prefix],a.type=k+d,d=k+d;j=d.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+d+">":'"'+a.value+'"^^<'+d+">"}else j=e==null&&k==null?'"'+d+'"':k==null?'"'+d+'"@'+e:k.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+k+">":'"'+a.value+'"^^<'+k+">";return j};A.lexicalFormBaseUri=function(a,c){var d=null;
if(a.value==null)var d=a.prefix,e=a.suffix,k=c.namespaces[d],d=k!=null?k+e:d+":"+e;else d=a.value;if(d===null)return null;else d.indexOf(":")==-1&&(d=(c.base||"")+d);return d};A.lexicalFormTerm=function(a,c){if(a.token==="uri")return{uri:A.lexicalFormBaseUri(a,c)};else if(a.token==="literal")return{literal:A.lexicalFormLiteral(a,c)};else if(a.token==="blank")return{blank:"_:"+a.value};else throw"Error, cannot get lexical form of unknown token: "+a.token;};A.normalizeUnicodeLiterals=function(a){for(var c=
a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],d={},e=0;e<c.length;e++)d[c[e]]==null&&(d[c[e]]=!0,a=a.replace(RegExp("\\"+c[e],"g"),eval("'"+c[e]+"'")));return a};A.hashTerm=function(a){try{if(a==null)return"";if(a.token==="uri")return"u"+a.value;else if(a.token==="blank")return"b"+a.value;else if(a.token==="literal"){var c="l"+a.value;c+=a.type||"";c+=a.lang||"";return c}}catch(d){if(typeof a==="object"){c="";for(p in a)c=c+p+a[p];return c}return a}};var ra={PriorityQueue:function(a){var c=[],d={},e=
!1,k,j=a.maxSize||10;k=function(a,c){return d[c].priority-d[a].priority};var i=function(){c.sort(k);e=!0};return{debugContents:c,debugStore:d,debugSort:i,push:function(a,k){if(c.length===j){e||i();if(d[a]==null){delete d[c[0]];c[0]=a;var f=d[c[c.length-1]].priority-1;d[a]={object:k,priority:f}}else f=d[c[c.length-1]].priority-1,d[a].priority=f;e=!1}else c.length===0?(c.push(a),d[a]={object:k,priority:1E3}):(f=d[c[c.length-1]].priority-1,d[a]==null?(d[a]={object:k,priority:f},c.push(a)):(d[a].priority=
f,e=!1))},remove:function(a){if(d[a]!=null){delete d[a];for(var j=null,e=0;e<c.length;e++)if(c[e]===a){j=e;break}j!=null&&c.splice(j,1)}},fetch:function(a){var j=d[a];return d[a]!=null?(e||i(),d[a].priority=d[c[c.length-1]].priority-1,e=!1,j.object):null}}}},G={};G.Tree=function(a,c,d,e){if(arguments.length!=0){var k=null;if(d===!0)try{if(k=window.localStorage,k==null)throw"not found";}catch(j){throw"Local storage is not present, cannot create persistent storage";}k==null&&(k=function(){var a={};
return{setItem:function(c,d){a[c]=d},getItem:function(c){return a[c]||null},removeItem:function(c){delete a[c]},get:function(c){var d=0,j;for(j in a){if(c===d)return j;d++}return""},length:a.length}}());this.storage=k;this.order=a;this.name=c;this.diskManager=new G.LocalStorageManager(c,k,e);this.root=this.diskManager._readRootNode();this.root==null?(this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0,this._diskWrite(this.root),this._updateRootNode(this.root),this.root=this.root.pointer):
this.root=this.diskManager._diskRead(this.root).pointer;this.comparator=function(a,c){return a<c?-1:a>c?1:0};this.merger=null}};G.Tree.prototype._allocateNode=function(){return new G.Node};G.Tree.prototype._diskWrite=function(a){this.diskManager._diskWrite(a)};G.Tree.prototype._diskRead=function(a){return this.diskManager._diskRead(a)};G.Tree.prototype._diskDelete=function(a){this.diskManager._diskDelete(a)};G.Tree.prototype._updateRootNode=function(a){this.diskManager._updateRootNode(a);return a};
G.Tree.prototype.search=function(a,c){for(var d=!0,e=this._diskRead(this.root);d;){for(var k=0;k<e.numberActives&&this.comparator(a,e.keys[k].key)===1;)k++;if(k<e.numberActives&&this.comparator(e.keys[k].key,a)===0)return c!=null&&c==!0?!0:e.keys[k].data;else e.isLeaf===!0?d=!1:e=this._diskRead(e.children[k])}return null};G.Tree.prototype.walk=function(a){this._walk(a,this._diskRead(this.root))};G.Tree.prototype._walk=function(a,c){if(c.isLeaf)for(var d=0;d<c.numberActives;d++)a(c.keys[d]);else{for(d=
0;d<c.numberActives;d++)this._walk(a,this._diskRead(c.children[d])),a(c.keys[d]);this._walk(a,this._diskRead(c.children[c.numberActives]))}};G.Tree.prototype.walkNodes=function(a){this._walkNodes(a,this._diskRead(this.root))};G.Tree.prototype._walkNodes=function(a,c){if(c.isLeaf)a(c);else{a(c);for(var d=0;d<c.numberActives;d++)this._walkNodes(a,this._diskRead(c.children[d]));this._walkNodes(a,this._diskRead(c.children[c.numberActives]))}};G.Tree.prototype._splitChild=function(a,c,d){var e=this._allocateNode();
e.isLeaf=d.isLeaf;e.level=d.level;e.numberActives=this.order-1;var k=d.keys[this.order-1];d.keys[this.order-1]=null;for(var j=0;j<this.order-1;j++)e.keys[j]=d.keys[j+this.order],d.keys[j+this.order]=null,d.isLeaf||(e.children[j]=d.children[j+this.order],d.children[j+this.order]=null);d.isLeaf||(e.children[j]=d.children[j+this.order],d.children[j+this.order]=null);d.numberActives=this.order-1;for(j=a.numberActives+1;j>c+1;j--)a.children[j]=a.children[j-1];this._diskWrite(e);a.children[c+1]=e.pointer;
for(j=a.numberActives;j>c;j--)a.keys[j]=a.keys[j-1];a.keys[c]=k;a.numberActives++;this._diskWrite(a);this._diskWrite(d)};G.Tree.prototype.insert=function(a,c){var d=this._diskRead(this.root);if(d.numberActives===2*this.order-1){var e=this._allocateNode();e.isLeaf=!1;e.level=d.level+1;e.numberActives=0;e.children[0]=d.pointer;this._diskWrite(e);this._splitChild(e,0,d);this.root=e.pointer;this._updateRootNode(e);this._insertNonFull(e,a,c)}else this._insertNonFull(d,a,c)};G.Tree.prototype._insertNonFull=
function(a,c,d){for(var e=a.numberActives-1;!a.isLeaf;){for(;e>=0&&this.comparator(c,a.keys[e].key)===-1;)e--;e++;var k=this._diskRead(a.children[e]);k.numberActives===2*this.order-1&&(this._splitChild(a,e,k),this.comparator(c,a.keys[e].key)===1&&e++);a=this._diskRead(a.children[e]);e=a.numberActives-1}for(;e>=0&&this.comparator(c,a.keys[e].key)===-1;)a.keys[e+1]=a.keys[e],e--;a.keys[e+1]={key:c,data:d};a.numberActives++;this._diskWrite(a)};G.Tree.prototype["delete"]=function(a){for(var c=this._diskRead(this.root),
d=null,e=!0,k=null,j=null,i=null,f=!0;f===!0;){for(f=!1;e===!0;){r=0;if(c.numberActives===0)return!1;for(;r<c.numberActives&&this.comparator(a,c.keys[r].key)===1;)r++;k=r;r<c.numberActives&&this.comparator(a,c.keys[r].key)===0&&(e=!1);if(e===!0){if(c.isLeaf===!0)return!1;d=c;c=this._diskRead(c.children[r]);if(c===null)return!1;k===d.numberActives?(j=this._diskRead(d.children[k-1]),i=null):k===0?(j=null,i=this._diskRead(d.children[1])):(j=this._diskRead(d.children[k-1]),i=this._diskRead(d.children[k+
1]));c.numberActives===this.order-1&&d!=null&&(i!=null&&i.numberActives>this.order-1?(this._moveKey(d,r,-1),c=this._diskRead(c.pointer)):j!=null&&j.numberActives>this.order-1?(this._moveKey(d,r,1),c=this._diskRead(c.pointer)):j!=null&&j.numberActives===this.order-1?c=this._mergeSiblings(d,r,-1):i!=null&&i.numberActives===this.order-1&&(c=this._mergeSiblings(d,r,1)))}}if(c.isLeaf&&c.numberActives>this.order-1)return this._deleteKeyFromNode(c,k),!0;if(c.isLeaf&&c.pointer===this.root)return this._deleteKeyFromNode(c,
k),!0;try{if(c.isLeaf===!1)if(j=d=null,(d=this._diskRead(c.children[k])).numberActives>this.order-1){var u=this._getMaxKeyPos(d),a=u.node.keys[u.index];c.keys[k]=a;this._diskWrite(c);c=d;a=a.key;e=f=!0}else if((d=this._diskRead(c.children[k+1])).numberActives>this.order-1)u=this._getMinKeyPos(d),a=u.node.keys[u.index],c.keys[k]=a,this._diskWrite(c),c=d,a=a.key,e=f=!0;else if((d=this._diskRead(c.children[k])).numberActives===this.order-1&&(j=this._diskRead(c.children[k+1])).numberActives===this.order-
1){var w=this._mergeNodes(d,c.keys[k],j);c.children[k]=w.pointer;k++;for(var r=k;r<c.numberActives;r++)c.children[r]=c.children[r+1],c.keys[r-1]=c.keys[r];c.children[r]=null;c.keys[r-1]=null;c.numberActives--;if(c.numberActives===0&&this.root===c.pointer)this.root=w.pointer,this._updateRootNode(w);this._diskWrite(c);c=w;e=f=!0}}catch(x){console.log("!!!"),console.log(x)}c.isLeaf&&c.numberActives>this.order-1&&e===!1&&this._deleteKeyFromNode(c,k);if(f===!1)return!0}};G.Tree.prototype._moveKey=function(a,
c,d){d===1&&c--;var e=this._diskRead(a.children[c]),k=this._diskRead(a.children[c+1]);if(d==-1){e.keys[e.numberActives]=a.keys[c];e.children[e.numberActives+1]=k.children[0];k.children[0]=null;e.numberActives++;a.keys[c]=k.keys[0];for(d=1;d<k.numberActives;d++)k.keys[d-1]=k.keys[d],k.children[d-1]=k.children[d];k.children[k.numberActives-1]=k.children[k.numberActives];k.numberActives--}else{k.children[k.numberActives+1]=k.children[k.numberActives];for(d=k.numberActives;d>0;d--)k.children[d]=k.children[d-
1],k.keys[d]=k.keys[d-1];k.keys[0]=null;k.children[0]=null;k.children[0]=e.children[e.numberActives];k.keys[0]=a.keys[c];k.numberActives++;e.children[e.numberActives]=null;a.keys[c]=e.keys[e.numberActives-1];e.keys[e.numberActives-1]=null;e.numberActives--}this._diskWrite(e);this._diskWrite(k);this._diskWrite(a)};G.Tree.prototype._mergeSiblings=function(a,c){var d,e,k;c===a.numberActives?(c--,e=this._diskRead(a.children[a.numberActives-1]),k=this._diskRead(a.children[a.numberActives])):(e=this._diskRead(a.children[c]),
k=this._diskRead(a.children[c+1]));var j=this._allocateNode();j.isLeaf=e.isLeaf;j.level=e.level;for(d=0;d<this.order-1;d++)j.keys[d]=e.keys[d],j.children[d]=e.children[d];j.keys[this.order-1]=a.keys[c];j.children[this.order-1]=e.children[this.order-1];for(d=0;d<this.order-1;d++)j.keys[d+this.order]=k.keys[d],j.children[d+this.order]=k.children[d];j.children[2*this.order-1]=k.children[this.order-1];this._diskWrite(j);a.children[c]=j.pointer;for(d=c;d<a.numberActives;d++)a.keys[d]=a.keys[d+1],a.children[d+
1]=a.children[d+2];j.numberActives=e.numberActives+k.numberActives+1;a.numberActives--;for(d=a.numberActives;d<2*this.order-1;d++)a.keys[d]=null;if(a.numberActives===0&&this.root===a.pointer)this.root=j.pointer,j.isLeaf=j.level?!1:!0;this._diskWrite(j);this.root===j.pointer&&this._updateRootNode(j);this._diskWrite(a);this._diskDelete(e);this._diskDelete(k);return j};G.Tree.prototype._deleteKeyFromNode=function(a,c){var d=2*this.order-1;if(a.numberActives<d)d=a.numberActives;var e;if(a.isLeaf===!1)return!1;
for(e=c;e<d-1;e++)a.keys[e]=a.keys[e+1];a.keys.splice(d-1,a.keys.length-(d-1));a.numberActives--;this._diskWrite(a);return!0};G.Tree.prototype._mergeNodes=function(a,c,d){var e,k;e=this._allocateNode();e.isLeaf=!0;for(k=0;k<a.numberActives;k++)e.keys[k]=a.keys[k],e.children[k]=a.children[k];e.children[a.numberActives]=a.children[a.numberActives];e.keys[a.numberActives]=c;for(k=0;k<d.numberActives;k++)e.keys[k+a.numberActives+1]=d.keys[k],e.children[k+a.numberActives+1]=d.children[k];e.children[2*
this.order-1]=d.children[d.numberActives];e.numberActives=a.numberActives+d.numberActives+1;e.isLeaf=a.isLeaf;e.level=a.level;this._diskWrite(e);this._diskDelete(a);this._diskDelete(d);return e};G.Tree.prototype.audit=function(a){var c=[],d=[],e=this,k=function(j){for(var k=0;k<d.length;k++)if(e.comparator(d[k],j)===0){var f=" !!! duplicated key "+j;a===!0&&console.log(f);c.push(f)}},j=null,e=this;this.walkNodes(function(i){a===!0&&(console.log("--- Node at "+i.level+" level"),console.log(" - pointer: "+
i.pointer),console.log(" - leaf? "+i.isLeaf),console.log(" - num actives? "+i.numberActives),console.log(" - keys: "));for(var f=i.numberActives;f<i.keys.length;f++)i.keys[f]!=null&&a===!0&&(console.log(" * warning : redundant key data"),c.push(" * warning : redundant key data"));for(f=i.numberActives+1;f<i.children.length;f++)i.children[f]!=null&&a===!0&&(console.log(" * warning : redundant children data"),c.push(" * warning : redundant key data"));if(i.isLeaf===!1)for(f=0;f<i.numberActives;f++){var u=
e._diskRead(i.children[f]).keys[e._diskRead(i.children[f]).numberActives-1].key,w=e._diskRead(i.children[f+1]).keys[0].key;a===!0&&console.log("   "+i.keys[f].key+"("+u+","+w+")");if(e.comparator(i.keys[f].key,u)===-1){var r=" !!! value max left "+u+" > key "+i.keys[f].key;a===!0&&console.log(r);c.push(r)}e.comparator(i.keys[f].key,w)===1&&(r=" !!! value min right "+w+" < key "+i.keys[f].key,a===!0&&console.log(r),c.push(r));k(i.keys[f].key);d.push(i.keys[f].key)}else{j===null?j=i.level:j!=i.level&&
(r=" !!! Leaf node with wrong level value",a===!0&&console.log(r),c.push(r));for(f=0;f<i.numberActives;f++)a===!0&&console.log(" "+i.keys[f].key),k(i.keys[f].key),d.push(i.keys[f].key)}i.pointer!=e.root&&(i.numberActives>2*e.order-1&&(a===!0&&(r=" !!!! MAX num keys restriction violated "),console.log(r),c.push(r)),i.numberActives<e.order-1&&(a===!0&&(r=" !!!! MIN num keys restriction violated "),console.log(r),c.push(r)))});return c};G.Tree.prototype.clear=function(){this.diskManager.clear();this.root=
this._allocateNode();this.root.isLeaf=!0;this.root.level=0;this._diskWrite(this.root);this._updateRootNode(this.root);this.root=this.root.pointer};G.Tree.prototype._getMaxKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=a.numberActives-1;break}else c.node=a,c.index=a.numberActives-1,a=this._diskRead(a.children[a.numberActives])}return c};G.Tree.prototype._getMinKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=0;break}else c.node=
a,c.index=0,a=this._diskRead(a.children[0])}return c};G.Node=function(){this.numberActives=0;this.isLeaf=null;this.keys=[];this.children=[];this.level=0};G.LocalStorageManager=function(a,c,d){this.name=a;this.storage=c;this.maxSize=d;this.bufferCache=new ra.PriorityQueue({maxSize:d});this.counter=this.storage.getItem("__"+this.name+"__ID_COUNTER__")||0};G.LocalStorageManager.prototype.clear=function(){for(var a=this.storage.length,c=[],d=0;d<a;d++){var e=this.storage.key(d);(e.indexOf(this.name)==
0||e.indexOf("__"+this.name)==0)&&c.push(e)}for(d=0;d<c.length;d++)this.storage.removeItem(c[d]);this.bufferCache=new ra.PriorityQueue({maxSize:this.maxSize})};G.LocalStorageManager.prototype._genIndex=function(){var a=this.name+this.counter;this.counter++;this.storage.setItem("__"+this.name+"__ID_COUNTER__",this.counter);return a};G.LocalStorageManager.prototype._diskRead=function(a){if(typeof a==="object")a=a.pointer;var c=this.bufferCache.fetch(a);if(c==null&&(c=this.storage.getItem(a),c!=null))c=
this._decode(c),c.pointer=a,this.bufferCache.push(a,c);return c};G.LocalStorageManager.prototype._diskWrite=function(a){if(a.pointer==null)a.pointer=this._genIndex();var c=a.children,d=[];if(a.isLeaf===!1)for(var e=0;e<c.length;e++)c[e]==null?d.push(null):typeof c[e]==="object"?d.push(c[e].pointer):d.push(c[e]);a.children=d;this.storage.setItem(a.pointer,this._encode(a));a.children=c;this.bufferCache.push(a.pointer,a)};G.LocalStorageManager.prototype._diskDelete=function(a){this.storage.removeItem(a.pointer);
this.bufferCache.remove(a.pointer)};G.LocalStorageManager.prototype._updateRootNode=function(a){if(a.pointer)this.storage.setItem("__"+this.name+"__ROOT_NODE__",a.pointer);else throw"Cannot set as root of the b-tree a node without pointer";};G.LocalStorageManager.prototype._readRootNode=function(){var a=this.storage.getItem("__"+this.name+"__ROOT_NODE__");return a==null?null:this._diskRead(a)};G.LocalStorageManager.prototype._encode=function(a){for(var c=""+a.numberActives,c=c+":"+a.pointer,c=c+":"+
a.level,c=c+":"+(a.isLeaf?1:0),d=0,e="",k=0;k<a.keys.length;k++)a.keys[k]!=null&&(e=typeof a.keys[k].key==="number"?e+":"+a.keys[k].key:e+":"+("_"+(a.keys[k].key.subject||"")+"_"+(a.keys[k].key.predicate||"")+"_"+(a.keys[k].key.object||"")+"_"+(a.keys[k].key.graph||"")),a.keys[k].data==null?e+=":n:":e=typeof a.keys[k].data=="string"?e+":s:"+a.keys[k].data:typeof a.keys[k].data=="number"?a.keys[k]%1==0?e+":i:"+a.keys[k].data:e+":f:"+a.keys[k].data:e+":o:"+JSON.stringify(a.keys[k].data).replace(":",
"&colon;"),d++);c=c+":"+d+e;if(a.isLeaf===!1){d="";for(k=e=0;k<a.children.length;k++)a.children[k]!=null&&(d=d+":"+a.children[k],e++);c=c+":"+e+d}return c};G.LocalStorageManager.prototype._decode=function(a){var c=new G.Node,a=a.split(":");c.numberActives=parseInt(a[0]);c.pointer=a[1];c.level=parseInt(a[2]);c.isLeaf=a[3]==="1"?!0:!1;for(var d=parseInt(a[4]),e=5,k,j,i,f=0;f<d;f++)k=a[e],k[0]=="_"?(k=k.split("_"),k={subject:parseInt(k[1])||null,predicate:parseInt(k[2])||null,object:parseInt(k[3])||
null,graph:parseInt(k[4]||null)}):k=parseInt(a[e]),j=a[e+1],i=a[e+2],j==="n"?i=void 0:j==="i"?i=parseInt(i):j==="f"?i=parseFloat(i):j==="o"&&(i=JSON.parse(i.replace("&colon;",":"))),c.keys.push({key:k,data:i}),e+=3;if(c.isLeaf===!1){d=parseInt(a[e]);e++;for(f=0;f<d;f++)c.children[f]=a[e],e++}return c};var T={NodeKey:function(a,c){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.order=c}};T.NodeKey.prototype.comparator=function(a){for(var c=0;c<this.order.length;c++){var d=
this.order[c];if(a[d]==null)break;else if(this[d]<a[d])return-1;else if(this[d]>a[d])return 1}return 0};T.Pattern=function(a){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.indexKey=[];this.keyComponents={};for(var c=[],d=[],a=["subject","predicate","object","graph"],e=0;e<a.length;e++)typeof this[a[e]]==="string"?(d.push(a[e]),this.keyComponents[a[e]]=null):(c.push(a[e]),this.keyComponents[a[e]]=this[a[e]],this.indexKey.push(a[e]));this.order=c.concat(d);
this.key=new T.NodeKey(this.keyComponents,this.order)};var ca={Tree:function(a,c){if(arguments!=0)this.componentOrder=a.componentOrder,G.Tree.call(this,a.order,a.name,a.persistent,a.cacheMaxSize),this.comparator=function(a,c){for(var k=0;k<this.componentOrder.length;k++){var j=this.componentOrder[k],i=a[j],j=c[j];if(i<j)return-1;else if(i>j)return 1}return 0},this.rangeComparator=function(a,c){for(var k=0;k<this.componentOrder.length;k++){var j=this.componentOrder[k];if(c[j]==null||a[j]==null)break;
else if(a[j]<c[j])return-1;else if(a[j]>c[j])return 1}return 0},c!=null&&c(this)}};A["extends"](G.Tree,ca.Tree);ca.Tree.prototype.insert=function(a,c){G.Tree.prototype.insert.call(this,a,null);c&&c(!0);return!0};ca.Tree.prototype.search=function(a,c){var d=G.Tree.prototype.search.call(this,a,!0);c&&c(d);return d};ca.Tree.prototype.range=function(a,c){var d=null,d=typeof this.root==="string"?this._rangeTraverse(this,this._diskRead(this.root),a):this._rangeTraverse(this,this.root,a);c&&c(d);return d};
ca.Tree.prototype._rangeTraverse=function(a,c,d){for(var d=d.key,e=[],k=[c],j;k.length>0;){c=k.shift();for(j=0;j<c.numberActives&&a.rangeComparator(c.keys[j].key,d)===-1;)j++;if(c.isLeaf===!0)for(;j<c.numberActives&&a.rangeComparator(c.keys[j].key,d)===0;)e.push(c.keys[j].key),j++;else{var i=a._diskRead(c.children[j]);for(k.push(i);;)if(j<c.numberActives&&a.rangeComparator(c.keys[j].key,d)===0)e.push(c.keys[j].key),j++,i=a._diskRead(c.children[j]),k.push(i);else break}}return e};var Y={QuadBackend:function(a,
c){if(arguments!=0){this.indexMap={};this.treeOrder=a.treeOrder;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};for(var d=0;d<this.indices.length;d++){var e=this.indices[d];this.indexMap[e]=new ca.Tree({order:this.treeOrder,
componentOrder:this.componentOrders[e],persistent:a.persistent,name:(a.name||"")+e,cacheMaxSize:a.cacheMaxSize})}c&&c(this)}}};Y.QuadBackend.prototype.clear=function(){for(var a=0;a<this.indices.length;a++)this.indexMap[this.indices[a]].clear()};Y.QuadBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,d=0;d<c.length;d++)for(var e=c[d],k=this.componentOrders[e],j=0;j<k.length;j++){if(A.include(a,k[j])===!1)break;if(j==a.length-1)return e}return"SPOG"};Y.QuadBackend.prototype.index=
function(a,c){for(var d=0;d<this.indices.length;d++)this.indexMap[this.indices[d]].insert(a);c&&c(!0);return!0};Y.QuadBackend.prototype.range=function(a,c){var d=this.indexMap[this._indexForPattern(a)].range(a);c&&c(d);return d};Y.QuadBackend.prototype.search=function(a,c){var d=this.indexMap[this.indices[0]].search(a);c&&c(d!=null);return d!=null};Y.QuadBackend.prototype["delete"]=function(a,c){for(var d,e=0;e<this.indices.length;e++)d=this.indices[e],d=this.indexMap[d],d["delete"](a);c&&c(!0);return!0};
var P={Lexicon:function(a,c){this.name=c||"";this.storage=null;try{this.storage=window.localStorage}catch(d){}if(this.storage==null)this.storage={setItem:function(){},getItem:function(){return null},removeItem:function(){},key:function(){return""},length:0};this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};this.defaultGraphOid=0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm=
{token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri,oid:this.defaultGraphOid};this.oidCounter=parseInt(this.storage.getItem(this.pointer("oidCounter")))||1;this.storage.getItem(this.pointer("knownGraphs"))==null?(this.knownGraphs={},this.storage.setItem(this.pointer("knownGraphs"),JSON.stringify(this.knownGraphs))):this.knownGraphs=JSON.parse(this.storage.getItem(this.pointer("knownGraphs")));a!=null&&a(this)}};P.Lexicon.prototype.updateAfterWrite=function(){this.storage.setItem(this.pointer("oidCounter"),
""+this.oidCounter)};P.Lexicon.prototype.pointer=function(a,c){a=="uriToOID"?a="uo":a=="OIDToUri"?a="ou":a=="literalToOID"?a="lo":a=="OIDToLiteral"?a="ok":a=="blankToOID"?a="bo":a=="OIDToBlank"&&(a="ob");return c==null?this.name+"_l_"+a:this.name+"_l_"+a+"_"+c};P.Lexicon.prototype.clear=function(){this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};for(var a=this.storage.length,c=this.name+"_l_",d=[],e=0;e<a;e++){var k=this.storage.key(e);
k.indexOf(c)==0&&d.push(k)}for(e=0;e<d.length;e++)this.storage.removeItem(d[e])};P.Lexicon.prototype.registerGraph=function(a){a!=this.defaultGraphOid&&(this.knownGraphs[a]=!0,this.storage.setItem(this.pointer("knownGraphs"),JSON.stringify(this.knownGraphs)));return!0};P.Lexicon.prototype.registeredGraphs=function(a){var c=[],d;for(d in this.knownGraphs)a===!0?c.push(this.retrieve(d)):c.push(d);return c};P.Lexicon.prototype.registerUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;
else{if(this.uriToOID[a]==null){var c=this.storage.getItem(this.pointer("uriToOID",a));if(c==null){var c=this.oidCounter,d="u"+c;this.oidCounter++;this.uriToOID[a]=[c,0];this.OIDToUri[d]=a;this.storage.setItem(this.pointer("uriToOID",a),c+":0");this.storage.setItem(this.pointer("OIDToUri",d),a)}else{var e=c.split(":"),c=parseInt(e[0]),d="u"+c,e=parseInt(e[1])+1;this.uriToOID[a]=[c,e];this.OIDToUri[d]=a;this.storage.setItem(this.pointer("uriToOID",a),c+":0")}}else d=this.uriToOID[a],c=d[0],e=d[1]+
1,this.uriToOID[a]=[c,e],this.storage.setItem(this.pointer("uriToOID",a),c+":"+e);return c}};P.Lexicon.prototype.resolveUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;else{var c=this.uriToOID[a];if(c!=null)return c[0];else if(c=this.storage.getItem(this.pointer("uriToOID",a)),c==null)return-1;else{var d=c.split(":"),c=parseInt(d[0]),e="u"+c,d=parseInt(d[1]);this.uriToOID[a]=[c,d];this.OIDToUri[e]=a;return c}}};P.Lexicon.prototype.resolveUriCost=function(a){return a===this.defaultGraphUri?
this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[1]:-1)};P.Lexicon.prototype.registerBlank=function(){var a=this.oidCounter;this.oidCounter++;a=""+a;this.storage.setItem(this.pointer("OIDToBlank",a),!0);this.OIDToBlank[a]=!0;return a};P.Lexicon.prototype.resolveBlank=function(){var a=this.oidCounter;this.oidCounter++;return""+a};P.Lexicon.prototype.resolveBlankCost=function(){return 0};P.Lexicon.prototype.registerLiteral=function(a){if(this.literalToOID[a]==null){var c=this.storage.getItem(this.pointer("literalToOID",
a));if(c==null){var c=this.oidCounter,d="l"+c;this.oidCounter++;this.literalToOID[a]=[c,0];this.OIDToLiteral[d]=a;this.storage.setItem(this.pointer("literalToOID",a),c+":0");this.storage.setItem(this.pointer("OIDToLiteral",d),a)}else d=c.split(":"),c=parseInt(d[0]),d=parseInt(d[1])+1,this.literalToOID[a]=[c,d],this.storage.setItem(this.pointer("literalToOID",a),c+":"+d)}else d=this.literalToOID[a],c=d[0],d=d[1]+1,this.storage.setItem(this.pointer("literalToOID",a),c+":"+d),this.literalToOID[a]=[c,
d];return c};P.Lexicon.prototype.resolveLiteral=function(a){var c=this.literalToOID[a];if(c!=null)return c[0];else{var d=this.storage.getItem(this.pointer("literalToOID",a));return d!=null?(c=d.split(":"),d=parseInt(c[0]),c=parseInt(c[1]),this.literalToOID[a]=[d,c],this.OIDToLiteral["l"+d]=a,d):-1}};P.Lexicon.prototype.resolveLiteralCost=function(a){a=this.literalToOID[a];return a!=null?a[1]:0};P.Lexicon.prototype.parseLiteral=function(a){var c=a.lastIndexOf("@");if(c!=-1&&a[c-1]==='"'){var d=a.substring(1,
c-1),a=a.substring(c+1,a.length);return{token:"literal",value:d,lang:a}}c=a.lastIndexOf("^^");if(c!=-1&&a[c-1]==='"'&&a[c+2]==="<"&&a[a.length-1]===">")return d=a.substring(1,c-1),a=a.substring(c+3,a.length-1),{token:"literal",value:d,type:a};d=a.substring(1,a.length-1);return{token:"literal",value:d}};P.Lexicon.prototype.parseUri=function(a){return{token:"uri",value:a}};P.Lexicon.prototype.retrieve=function(a){var c;try{if(a===this.defaultGraphOid)return{token:"uri",value:this.defaultGraphUri,prefix:null,
suffix:null,defaultGraph:!0};else{var d=this.OIDToUri["u"+a];if(d!=null)return this.parseUri(d);else{var e=this.OIDToLiteral["l"+a];if(e!=null)return this.parseLiteral(e);else{var k=this.OIDToBlank[""+a];if(k!=null)return{token:"blank",value:"_:"+a};else if(d=this.storage.getItem(this.pointer("OIDToUri","u"+a)),d!=null){this.OIDToUri["u"+a]=d;c=this.storage.getItem(this.pointer("uriToOID",d));var j=c.split(":"),i=parseInt(j[1]);this.uriToOID[d]=[a,i];return this.parseUri(d)}else if(e=this.storage.getItem(this.pointer("OIDToLiteral",
"l"+a)),e!=null){this.OIDToLiteral["l"+a]=e;c=this.storage.getItem(this.pointer("literalToOID",e));var f=c.split(":"),a=parseInt(f[0]),i=parseInt(f[1]);this.literalToOID[e]=[a,i];return this.parseLiteral(e)}else if(k=this.storage.getItem(this.pointer("OIDToBlank",""+a)),k!=null)return this.OIDToBlank[""+a]=!0,{token:"blank",value:"_:"+a};else throw"Null value for OID";}}}}catch(u){throw console.log("error in lexicon retrieving OID:"),console.log(a),u.message&&console.log(u.message),u.stack&&console.log(u.stack),
Error("Unknown retrieving OID in lexicon:"+a);}};P.Lexicon.prototype.unregister=function(a,c){try{return this.unregisterTerm(a.subject.token,c.subject),this.unregisterTerm(a.predicate.token,c.predicate),this.unregisterTerm(a.object.token,c.object),a.graph!=null&&this.unregisterTerm(a.graph.token,c.graph),!0}catch(d){return console.log("Error unregistering quad"),console.log(d.message),!1}};P.Lexicon.prototype.unregisterTerm=function(a,c){if(a==="uri"){if(c!=this.defaultGraphOid){var d="u"+c,e=this.OIDToUri[d],
k=this.uriToOID[e],j=k[1];if(""+k[0]===""+c)j===0?(delete this.OIDToUri[d],delete this.uriToOID[e],delete this.knownGraphs[c]):this.uriToOID[e]=[c,j-1];else throw"Not matching OID : "+c+" vs "+k[0];}}else if(a==="literal")if(this.oidCounter++,d="l"+c,e=this.OIDToLiteral[d],k=this.literalToOID[e],j=k[1],""+k[0]===""+c)j===0?(delete this.OIDToLiteral[d],delete this.literalToOID[e]):this.literalToOID[e]=[c,j-1];else throw"Not matching OID : "+c+" vs "+k[0];else a==="blank"&&delete this.OIDToBlank[""+
c]};var W={};W.load=function(a,c,d){jQuery.ajax({url:a,headers:{Accept:c},success:function(a,c,j){if((""+j.status)[0]=="2"){for(var c=j.getAllResponseHeaders().split("\n"),j={},i=0;i<c.length;i++){var f=c[i].split(":");j[f[0]]=f[1]}d(!0,{headers:j,data:a})}},error:function(a){(""+a.status)[0]=="3"?redirection==0?d(!1,500):(a=a.getAllResponseHeaders().Location||a.getAllResponseHeaders().location,a!=null?W.load(a,c,d,redirection-1):d(!1,500)):d(!1,a.statusCode())}})};var sa=null;(function(){var a=function(a,
c){a.stack="";for(var d in c)a[d]=c[d]};if(typeof window!=="undefined"){var c=window.jsonld=window.jsonld||{};Exception=function(c){a(this,c)};if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var c=[],d;for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.push(d);return c};if(!Array.prototype.filter)Array.prototype.filter=function(a,c){if(this==null)throw new TypeError;var d=Object(this),j=d.length>>>0;if(typeof a!="function")throw new TypeError;
for(var e=[],k=0;k<j;k++)if(k in d){var i=d[k];a.call(c,i,k,d)&&e.push(i)}return e}}else typeof module!=="undefined"&&module.exports&&(c={},Exception=function(c){a(this,c);this.stack=Error().stack});sa=c;var d={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",
geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},e={xsd:"http://www.w3.org/2001/XMLSchema#"},k={"boolean":e.xsd+"boolean","double":e.xsd+"double",integer:e.xsd+"integer"},j=function(a,c,d){c in a?a[c].constructor===Array?
a[c].push(d):a[c]=[a[c],d]:a[c]=d},i=function(a){var c;if(a.constructor===Object){c={};var d=Object.keys(a).sort(),j;for(j in d){var e=d[j];c[e]=i(a[e])}}else if(a.constructor===Array)for(j in c=[],a)c[j]=i(a[j]);else c=a;return c},f=function(a){var c={"@id":"@id","@language":"@language","@literal":"@literal","@type":"@type"};if(a){var d={},j;for(j in a)a[j].constructor===String&&a[j]in c&&(d[a[j]]=j);for(j in d)c[j]=d[j]}return c},u=function(a,c){var d=null;c in a&&(a[c].constructor===String?d=a[c]:
a[c].constructor===Object&&"@id"in a[c]&&(d=a[c]["@id"]));return d},w=function(a,c,d){var j=null,e;for(e in a)if(e.length>0&&e[0]!=="@"&&c===u(a,e)){j=e;d!==null&&(d[e]=i(a[e]));break}j===null&&c==="@type"&&(j=f(a)["@type"]);if(j===null)for(e in a)if(e.length>0&&e[0]!=="@"){var k=u(a,e);if(k!==null&&c.indexOf(k)===0&&c.length>k.length){j=e+":"+c.substr(k.length);d!==null&&(d[e]=i(a[e]));break}}j===null&&(j=c);return j},r=function(a,c,d){var j=c,e=f(a),k=c.indexOf(":");if(k!==-1)e=c.substr(0,k),e in
a&&(j=u(a,e)+c.substr(k+1),d!==null&&(d[e]=i(a[e])));else if(c in a)j=u(a,c),d!==null&&(d[c]=i(a[c]));else for(var n in e)if(c===e[n]){j=n;break}return j},x=function(a){var c=!1;a!==null&&a.constructor===Object&&!("@literal"in a)&&(c=Object.keys(a).length>1||!("@id"in a));return c};c.normalize=function(a){return(new I).normalize(a)};c.expand=function(a){return(new I).expand({},null,a)};c.compact=function(a,d){var j=null;if(d!==null){var d=c.expand(d),e;d.constructor===Array?(j=[],e=d):e=[d];a.constructor===
Array&&(a=c.mergeContexts({},a));for(var k in e){var f={},l=(new I).compact(i(a),null,e[k],f);if(Object.keys(f).length>0){var n=f,f={},s=Object.keys(n).sort(),z=void 0;for(z in s){var r=s[z];f[r]=n[r]}n=Object.keys(l);n.sort();n.unshift("@context");l["@context"]=f;var f={},u;for(u in n)s=n[u],f[s]=l[s];l=f}j===null?j=l:j.push(l)}}return j};c.mergeContexts=function(a,d){a.constructor===Array&&(a=c.mergeContexts({},a));var j=i(a);if(d.constructor===Array)for(var e in d)j=c.mergeContexts(j,d[e]);else{for(var k in d)if(k.indexOf("@")!==
0)for(var f in j)if(j[f]===d[k]){delete j[f];break}for(k in d)j[k]=i(d[k])}return j};c.expandTerm=r;c.compactIri=function(a,c){return w(a,c,null)};c.frame=function(a,c,d){return(new I).frame(a,c,d)};c.toTriples=function(a,d,j){var e=null,a=c.normalize(a),j=j||null;j===null&&(e=[],j=function(a,c,j){e.push({subject:A.lexicalFormTerm(a),predicate:A.lexicalFormTerm(c),object:A.lexicalFormTerm(j),graph:d})});var k=!1,i;for(i in a){var f=a[i],l=f["@id"],l=l[0]=="_"?{token:"blank",value:l.split(":")[1]}:
{token:"uri",value:l},n;for(n in f)if(n!=="@id"){var s=f[n];s.constructor!==Array&&(s=[s]);for(var z in s)if(k=s[z],n==="@type"||n==="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"?(n="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",k={token:"uri",value:k}):typeof k==="string"?k={token:"literal",value:k}:k["@id"]!=null?k=k["@id"][0]=="_"?{token:"blank",value:k["@id"].split(":")[1]}:{token:"uri",value:k["@id"]}:k["@type"]!=null?k={token:"literal",value:k["@literal"],type:k["@type"]}:k["@language"]!=
null&&(k={token:"literal",value:k["@literal"],lang:k["@language"]}),k=j(l,{token:"uri",value:n},k)===!1)break;if(k)break}if(k)break}return e};c.resolve=function(a,c,d){var j={},e=function(a,c){if(a.constructor===Array)for(var d in a)e(a[d]);else if(a.constructor===Object)for(var k in a)if(k==="@context")if(a[k].constructor===Array){var i=a[k];for(d in i)i[d].constructor===String&&(c?i[d]=j[i[d]]:j[i[d]]={})}else a[k].constructor===String&&(c?a[k]=j[a[k]]:j[a[k]]={})};e(a,!1);var k=Object.keys(j).length,
i=null;if(k===0)d(a,i);else for(var f in j)c(f,function(c,l){--k;if(c===null)i=i||[],i.push({url:f,error:l});else try{j[f]=c.constructor===String?JSON.parse(c)["@context"]:c["@context"]}catch(n){i=i||[],i.push({url:f,error:n})}k===0&&(i===null&&e(a,!0),d(a,i))})};var I=function(){};I.prototype.compact=function(a,c,d,j){var e,n=f(a);if(d===null)e=null,this.getCoerceType(a,c,j);else if(d.constructor===Array){e=[];for(var s in d)e.push(this.compact(a,c,d[s],j))}else if(d.constructor===Object&&"@id"in
d&&d["@id"].constructor===Array)e={},e[n["@id"]]=this.compact(a,c,d["@id"],j);else if(x(d)){e={};for(var z in d)if(d[z]!=="@context"&&(n=w(a,z,j),n!==z||!(n in e)))e[n]=this.compact(a,z,d[z],j)}else{c=this.getCoerceType(a,c,j);s=null;d.constructor===Object?"@language"in d||(s="@type"in d?d["@type"]:"@id"in d?"@id":c):d.constructor===String&&(s=c);if(c===null&&(s===k["boolean"]||s===k.integer||s===k["double"]))c=s;if(c!==null)if(s===null)throw{message:"Cannot coerce type when a language is specified. The language information would be lost."};
else if(s!==c)throw new Exception({message:"Cannot coerce type because the type does not match.",type:s,expected:c});else d.constructor===Object?"@id"in d?e=d["@id"]:"@literal"in d&&(e=d["@literal"]):e=d,c===k["boolean"]?e=e==="true"||e!=0:c===k["double"]?e=parseFloat(e):c===k.integer&&(e=parseInt(e));else if(d.constructor===Object)for(z in e={},d)e[n[z]]=d[z];else e=i(d);s==="@id"&&(e.constructor===Object?e[n["@id"]]=w(a,e[n["@id"]],j):e=w(a,e,j))}return e};I.prototype.expand=function(a,d,e){var n;
if(e===null)n=null;else if(d===null&&e.constructor===String)n=r(a,e,null);else if(e.constructor===Array){n=[];for(var s in e)n.push(this.expand(a,d,e[s]))}else if(e.constructor===Object){"@context"in e&&(a=c.mergeContexts(a,e["@context"]));n={};for(var z in e)z==="@embed"||z==="@explicit"||z==="@default"||z==="@omitDefault"?j(n,z,i(e[z])):z!=="@context"&&j(n,r(a,z,null),this.expand(a,z,e[z]))}else{s=this.getCoerceType(a,d,null);n=f(a);if(s===null&&(e.constructor===Number||e.constructor===Boolean))s=
e.constructor===Boolean?k["boolean"]:(""+e).indexOf(".")==-1?k.integer:k["double"];d===n["@id"]||d===n["@type"]?n=r(a,e,null):s!==null?(n={},s==="@id"?n["@id"]=r(a,e,null):(n["@type"]=s,s===k["double"]&&(e=e.toExponential(6).replace(/(e(?:\+|-))([0-9])$/,"$10$2")),n["@literal"]=""+e)):n=""+e}return n};I.prototype.normalize=function(a){var c=[];if(a!==null){this.ng={tmp:null,c14n:null};var j=this.expand(d,null,a);this.nameBlankNodes(j);a={};Q(null,null,j,a);for(var e in a){var j=a[e],k={},i=Object.keys(j).sort(),
f;for(f in i){var n=i[f];k[n]=j[n]}c.push(k)}this.canonicalizeBlankNodes(c);c.sort(function(a,c){return s(a["@id"],c["@id"])})}return c};I.prototype.getCoerceType=function(a,c,d){var j=null,c=r(a,c,null);c==="@id"||c==="@type"?j="@id":(c=w(a,c,null),c in a&&a[c].constructor===Object&&"@type"in a[c]&&(j=r(a,a[c]["@type"],d),d!==null&&(d[c]=i(a[c]))));return j};var B=function(a){return a.indexOf("_:")===0},Wa=function(a){return a.constructor===Object&&"@id"in a&&B(a["@id"])},s=function(a,c){var d=0;
if(a.constructor===Array&&c.constructor===Array)for(var j=0;j<a.length&&d===0;++j)d=s(a[j],c[j]);else d=a<c?-1:a>c?1:0;return d},n=function(a,c,d){var j=0;d in a?j=d in c?s(a[d],c[d]):-1:d in c&&(j=1);return j},D=function(a,c){var d=0;a.constructor===String?d=c.constructor!==String?-1:s(a,c):c.constructor===String?d=1:(d=n(a,c,"@literal"),d===0&&("@literal"in a?(d=n(a,c,"@type"),d===0&&(d=n(a,c,"@language"))):d=s(a["@id"],c["@id"])));return d},z=function(a,c){var d=0,j;for(j in a)if(j!=="@id"){d=
s(a[j].constructor===Array?a[j].length:1,c[j].constructor===Array?c[j].length:1);if(d===0){var e=a[j],k=c[j];e.constructor!==Array&&(e=[e],k=[k]);e=e.filter(function(a){return!Wa(a)});k=k.filter(function(a){return!Wa(a)});d=s(e.length,k.length)}if(d===0){e.sort(D);k.sort(D);for(var i=0;i<e.length&&d===0;++i)d=D(e[i],k[i])}if(d!==0)break}return d},H=function(a){var c=-1,d={next:function(){++c;return d.current()},current:function(){return"_:"+a+c},inNamespace:function(c){return c.indexOf("_:"+a)===
0}};return d},U=function(a,c,d){if(a!==null)if(a.constructor===Array)for(var j in a)U(a[j],c,d);else if(a.constructor===Object){"@id"in a?a["@id"].constructor==Array?U(a["@id"],c,d):x(a)&&(c[a["@id"]]=a):x(a)&&(!("@id"in a)||Wa(a))&&d.push(a);for(var e in a)U(a[e],c,d)}},Q=function(a,c,d,j){var e=null;if(d!==null)if(d.constructor===Array)for(var k in d)Q(a,c,d[k],j);else if(d.constructor===Object)if("@literal"in d||c==="@type")e=i(d);else if(d["@id"].constructor===Array){if(a!==null)throw{message:"Embedded graph literals cannot be flattened."};
for(var f in d["@id"])Q(a,c,d["@id"][f],j)}else{d["@id"]in j?k=j[d["@id"]]:(k={"@id":d["@id"]},j[d["@id"]]=k);var e={"@id":k["@id"]},n;for(n in d)f=d[n],f!==null&&n!=="@id"&&(n in k?k[n].constructor!==Array&&(k[n]=[k[n]]):k[n]=[],Q(k[n],n,f,j),k[n].length===1&&(k[n]=k[n][0]))}else e=d;e!==null&&a!==null&&(a.constructor===Array?(c=!1,e.constructor===Object&&"@id"in e&&(c=a.filter(function(a){return a.constructor===Object&&"@id"in a&&a["@id"]===e["@id"]}).length>0),c||a.push(e)):a[c]=e)};I.prototype.nameBlankNodes=
function(a){var c=this.ng.tmp=H("tmp"),d={},j=[];U(a,d,j);for(var e in j)if(a=j[e],!("@id"in a)){for(;c.next()in d;);a["@id"]=c.current();d[c.current()]=a}};I.prototype.renameBlankNode=function(a,c){var d=a["@id"];a["@id"]=c;var j=this.subjects;j[c]=j[d];delete j[d];this.edges.refs[c]=this.edges.refs[d];this.edges.props[c]=this.edges.props[d];delete this.edges.refs[d];delete this.edges.props[d];var e=this.edges.refs[c].all,k;for(k in e){var i=e[k].s;i===d&&(i=c);var f=j[i],n=this.edges.props[i].all,
l;for(l in n)if(n[l].s===d){n[l].s=c;var i=n[l].p,i=f[i].constructor===Object?[f[i]]:f[i].constructor===Array?f[i]:[],s;for(s in i)i[s].constructor===Object&&"@id"in i[s]&&i[s]["@id"]===d&&(i[s]["@id"]=c)}}n=this.edges.props[c].all;for(k in n){var i=n[k].s,e=this.edges.refs[i].all,z;for(z in e)if(e[z].s===d)e[z].s=c}};I.prototype.canonicalizeBlankNodes=function(a){this.renamed={};this.mappings={};this.serializations={};var c=this.edges={refs:{},props:{}},d=this.subjects={},j=[],e;for(e in a){var k=
a[e]["@id"];d[k]=a[e];c.refs[k]={all:[],bnodes:[]};c.props[k]={all:[],bnodes:[]};B(k)&&j.push(a[e])}this.collectEdges();var a=this.ng.c14n=H("c14n"),i=this.ng.tmp;for(e in j){var f=j[e],k=f["@id"];if(a.inNamespace(k)){for(;i.next()in d;);this.renameBlankNode(f,i.current());k=f["@id"]}this.serializations[k]={props:null,refs:null}}for(var i=!0,n=this;j.length>0;){i&&(i=!1,j.sort(function(a,c){return n.deepCompareBlankNodes(a,c)}));var f=j.shift(),k=f["@id"],f=["props","refs"],l;for(l in f){var z=f[l];
if(this.serializations[k][z]===null){var r={};r[k]="s1"}else r=this.serializations[k][z].m;var u=Object.keys(r);u.sort(function(a,c){return s(r[a],r[c])});var w=[];for(e in u){var x=u[e];!a.inNamespace(k)&&x in d&&(this.renameBlankNode(d[x],a.next()),w.push(x))}u=j;j=[];for(e in u){var x=u[e],A=x["@id"];if(!a.inNamespace(A)){for(var I in w)this.markSerializationDirty(A,w[I],z)&&(i=!0);j.push(x)}}}}for(var Q in c.props)if(c.props[Q].bnodes.length>0){var f=d[Q],$;for($ in f)$.indexOf("@")!==0&&f[$].constructor===
Array&&f[$].sort(D)}};MappingBuilder=function(){this.count=1;this.processed={};this.mapping={};this.adj={};this.keyStack=[{keys:["s1"],idx:0}];this.done={};this.s=""};MappingBuilder.prototype.copy=function(){var a=new MappingBuilder;a.count=this.count;a.processed=i(this.processed);a.mapping=i(this.mapping);a.adj=i(this.adj);a.keyStack=i(this.keyStack);a.done=i(this.done);a.s=this.s;return a};MappingBuilder.prototype.mapNode=function(a){a in this.mapping||(this.mapping[a]=a.indexOf("_:c14n")===0?"c"+
a.substr(6):"s"+this.count++);return this.mapping[a]};MappingBuilder.prototype.serialize=function(a,c){if(this.keyStack.length>0)for(var d=this.keyStack.pop();d.idx<d.keys.length;++d.idx){var j=d.keys[d.idx];if(!(j in this.adj)){this.keyStack.push(d);break}if(j in this.done)this.s+="_"+j;else{this.done[j]=!0;var e=j,j=this.adj[j],k=j.i;if(k in a){var i=a[k],f="",n=!0,l=void 0;for(l in i)if(l!=="@id"){n?n=!1:f+="|";f+="<"+l+">";var s=i[l].constructor===Array?i[l]:[i[l]],z;for(z in s){var r=s[z];r.constructor===
Object?"@id"in r?f+=B(r["@id"])?"_:":"<"+r["@id"]+">":(f+='"'+r["@literal"]+'"',"@type"in r?f+="^^<"+r["@type"]+">":"@language"in r&&(f+="@"+r["@language"])):f+='"'+r+'"'}}e+="["+f+"]";i=!0;e+="[";var k=c.refs[k].all,u;for(u in k)i?i=!1:e+="|",e+="<"+k[u].p+">",e+=B(k[u].s)?"_:":"<"+k[u].s+">";e+="]"}e+=j.k.join("");this.s+=e;this.keyStack.push({keys:j.k,idx:0});this.serialize(a,c)}}};I.prototype.markSerializationDirty=function(a,c,d){var j=!1,a=this.serializations[a];a[d]!==null&&c in a[d].m&&(a[d]=
null,j=!0);return j};var C=function(a,c){var d=0;return d=a.length==c.length?s(a,c):a.length>c.length?s(a.substr(0,c.length),c):s(a,c.substr(0,a.length))};I.prototype.serializeCombos=function(a,c,d,j,e,k,f){if(f.length>0){k=i(k);k[j.mapNode(f[0].s)]=f[0].s;for(var n=j.copy(),f=f.slice(1),l=Math.max(1,f.length),s=0;s<l;++s){var z=s===0?j:n.copy();this.serializeCombos(a,c,d,z,e,k,f);f.unshift.apply(f,f.splice(1,f.length))}}else if(f=Object.keys(k).sort(),j.adj[d]={i:c,k:f,m:k},j.serialize(this.subjects,
this.edges),a[e]===null||C(j.s,a[e].s)<=0){for(n in f)this.serializeBlankNode(a,k[f[n]],j,e);j.serialize(this.subjects,this.edges);if(a[e]===null||C(j.s,a[e].s)<=0&&j.s.length>=a[e].s.length)a[e]={s:j.s,m:j.mapping}}};I.prototype.serializeBlankNode=function(a,c,d,j){if(!(c in d.processed)){d.processed[c]=!0;var e=d.mapNode(c),k=d.copy(),i=this.edges[j][c].bnodes,f={},n=[],l;for(l in i)i[l].s in d.mapping?f[d.mapping[i[l].s]]=i[l].s:n.push(i[l]);i=Math.max(1,n.length);for(l=0;l<i;++l){var s=l===0?
d:k.copy();this.serializeCombos(a,c,e,s,j,f,n)}}};I.prototype.deepCompareBlankNodes=function(a,c){var d=0,j=a["@id"],e=c["@id"];if(j===e)d=0;else if(d=this.shallowCompareBlankNodes(a,c),d===0)for(var k=["props","refs"],f=0;d===0&&f<k.length;++f){var d=k[f],n=this.serializations[j],l=this.serializations[e];if(n[d]===null){var z=new MappingBuilder;if(d==="refs")z.mapping=i(n.props.m),z.count=Object.keys(z.mapping).length+1;this.serializeBlankNode(n,j,z,d)}if(l[d]===null){z=new MappingBuilder;if(d===
"refs")z.mapping=i(l.props.m),z.count=Object.keys(z.mapping).length+1;this.serializeBlankNode(l,e,z,d)}d=s(n[d].s,l[d].s)}return d};I.prototype.shallowCompareBlankNodes=function(a,c){var d=0,j=Object.keys(a),e=Object.keys(c),d=s(j.length,e.length);d===0&&(d=s(j.sort(),e.sort()));d===0&&(d=z(a,c));if(d===0)var k=this.edges.refs[a["@id"]].all,i=this.edges.refs[c["@id"]].all,d=s(k.length,i.length);if(d===0)for(j=0;j<k.length&&d===0;++j)d=this.compareEdges(k[j],i[j]);return d};I.prototype.compareEdges=
function(a,c){var d=0,j=B(a.s),e=B(c.s),k=this.ng.c14n;j!=e?d=j?1:-1:(j||(d=s(a.s,c.s)),d===0&&(d=s(a.p,c.p)),d===0&&k!==null&&(j=k.inNamespace(a.s),k=k.inNamespace(c.s),j!=k?d=j?1:-1:j&&(d=s(a.s,c.s))));return d};I.prototype.collectEdges=function(){var a=this.edges.refs,c=this.edges.props,d;for(d in this.subjects){var j=this.subjects[d],e;for(e in j)if(e!=="@id"){var k=j[e],k=k.constructor!==Array?[k]:k,i;for(i in k){var f=k[i];f.constructor===Object&&"@id"in f&&f["@id"]in this.subjects&&(f=f["@id"],
a[f].all.push({s:d,p:e}),c[d].all.push({s:f,p:e}))}}}var n=this;for(d in a)a[d].all.sort(function(a,c){return n.compareEdges(a,c)}),a[d].bnodes=a[d].all.filter(function(a){return B(a.s)});for(d in c)c[d].all.sort(function(a,c){return n.compareEdges(a,c)}),c[d].bnodes=c[d].all.filter(function(a){return B(a.s)})};var G=function(a,c){var d=!1;if(!("@type"in c)){var j=Object.keys(c).filter(function(a){return a.indexOf("@")!==0});if(j.length===0)d=!0;else if(a.constructor===Object&&"@id"in a){var d=!0,
e;for(e in j)if(!(j[e]in a)){d=!1;break}}}return d},E=function(a,c,d,j,e,k,i,f){var n=c["@id"],l=n in j?j[n]:null;if(("@embed"in d&&d["@embed"]||!("@embed"in d)&&f.defaults.embedOn)&&(l===null||l.autoembed&&!e)){if(l===null)l={},j[n]=l;else if(l.parent!==null){if(l.parent[l.key].constructor===Array){var s=l.parent[l.key],z;for(z in s)if(s[z].constructor===Object&&"@id"in s[z]&&s[z]["@id"]===n){s[z]={"@id":c["@id"]};break}}else l.parent[l.key]={"@id":c["@id"]};var r=function(a){var c=Object.keys(j),
d;for(d in c)d=c[d],d in j&&j[d].parent!==null&&j[d].parent["@id"]===a&&(delete j[d],r(d))};r(n)}l.autoembed=e;l.parent=k;l.key=i;if(d["@explicit"]===!0||f.defaults.explicitOn)for(u in c)u!=="@id"&&!(u in d)&&delete c[u];e=Object.keys(c);for(z in e){var u=e[z];if(u.indexOf("@")!==0){u in d?(k=d[u],i=!1):(k=c[u].constructor===Array?[]:{},i=!0);var n=c[u],n=n.constructor===Array?n:[n],w;for(w in n)n[w].constructor===Object&&"@id"in n[w]&&n[w]["@id"]in a&&(n[w]=a[n[w]["@id"]]);c[u]=F(a,n,k,j,i,c,u,f)}}for(u in d)if(u.indexOf("@")!==
0&&(!(u in c)||c[u]===null))k=d[u],k.constructor===Array?c[u]=[]:(k.constructor===Array&&(k=k.length>0?k[0]:{}),k["@omitDefault"]===!0||f.defaults.omitDefaultOn||(c[u]="@default"in k?k["@default"]:null))}else c={"@id":c["@id"]};return c},F=function(a,c,d,j,e,k,i,f){var n=null,l=-1,s;d.constructor===Array?(n=[],s=d,s.length===0&&s.push({})):(s=[d],l=1);for(var z=[],r=0;r<s.length&&l!==0;++r){d=s[r];if(d.constructor!==Object)throw{message:"Invalid JSON-LD frame. Frame must be an object or an array.",
frame:d};z[r]=[];for(var u=0;u<c.length&&l!==0;++u){var w=c[u],D=!1,H="@type";if("@type"in d&&w.constructor===Object&&H in w)for(var A=w[H].constructor===Array?w[H]:[w[H]],I=d[H].constructor===Array?d[H]:[d[H]],Q=0;Q<I.length&&!D;++Q){var H=I[Q],B;for(B in A)if(A[B]===H){D=!0;break}}if(D||G(w,d))z[r].push(w),--l}}for(var U in z)for(var C in z[U])d=s[U],c=z[U][C],x(c)&&(c=E(a,c,d,j,e,k,i,f)),n===null?n=c:(d=c!==null&&c.constructor===Object&&"@id"in c&&Object.keys(c).length===1&&c["@id"]in j,k===null&&
d||n.push(c));return n};I.prototype.frame=function(a,d,j){var a=c.normalize(a),e=null;if("@context"in d)e=i(d["@context"]),d=c.expand(d);else if(d.constructor===Array){d.length>0&&"@context"in d[0]&&(e=i(d[0]["@context"]));var j=[],k;for(k in d)j.push(c.expand(d[k]));d=j}var j={defaults:{embedOn:!0,explicitOn:!1,omitDefaultOn:!1}},f={};for(k in a)f[a[k]["@id"]]=a[k];a=F(f,a,d,{},!1,null,null,j);e!==null&&a!==null&&(a=c.compact(e,a));return a}})();var ta={parser:{}};ta.parser.parse=function(a,c){typeof a===
"string"&&(a=JSON.parse(a));return sa.toTriples(a,c)};var aa={RDFLoader:function(a){this.precedences=["text/turtle","text/n3","application/json"];this.parsers={"text/turtle":la.parser,"text/n3":la.parser,"application/json":ta.parser};if(a!=null)for(var c in a.parsers)this.parsers[c]=a.parsers[c];if(a&&a.precedences!=null)for(c in this.precedences=a.precedences,a.parsers)A.include(this.precedences,c)||this.precedences.push(c);this.acceptHeaderValue="";for(a=0;a<this.precedences.length;a++)a!=0?this.acceptHeaderValue=
this.acceptHeaderValue+","+this.precedences[a]:this.acceptHeaderValue+=this.precedences[a]}};aa.RDFLoader.prototype.registerParser=function(a,c){this.parsers[a]=c;this.precedences.push(a)};aa.RDFLoader.prototype.unregisterParser=function(a){delete this.parsers[a];for(var c=[],d=0;d<this.precedences.length;d++)this.precedences[d]!=a&&c.push(this.precedences[d]);this.precedences=c};aa.RDFLoader.prototype.setAcceptHeaderPrecedence=function(a){this.precedences=a};aa.RDFLoader.prototype.load=function(a,
c,d){var e=this;W.load(a,this.acceptHeaderValue,function(k,j){if(k==!0){var i=j.headers["Content-Type"]||j.headers["content-type"],f=j.data;if(i!=null){var i=i.split(";")[0],u;for(u in e.parsers)if(u.indexOf("/")!=-1){var w=u.split("/");if(w[1]==="*"){if(i.indexOf(w[0])!=-1)return e.tryToParse(e.parsers[u],c,f,d)}else if(i.indexOf(u)!=-1)return e.tryToParse(e.parsers[u],c,f,d);else if(i.indexOf(w[1])!=-1)return e.tryToParse(e.parsers[u],c,f,d)}else if(i.indexOf(u)!=-1)return e.tryToParse(e.parsers[u],
a,c,d);d(!1,"Unknown media type : "+i)}else console.log("Unknown media type"),console.log(j.headers),d(!1,"Uknown media type")}else d(!1,"Network error: "+j)})};aa.RDFLoader.prototype.loadFromFile=function(a,c,d,e){try{var k=this;require("fs").readFile(d.split("file:/")[1],function(d,j){if(d)throw d;j=j.toString("utf8");k.tryToParse(a,c,j,e)})}catch(j){e(!1,j)}};aa.RDFLoader.prototype.tryToParse=function(a,c,d,e){try{typeof d==="string"&&(d=A.normalizeUnicodeLiterals(d));var k=a.parse(d,c);k!=null?
e(!0,k):e(!1,"parsing error")}catch(j){console.log(j.message),console.log(j.stack),e(!1,"parsing error with mime type : "+j)}};var N={AbstractQueryTree:function(){}};N.AbstractQueryTree.prototype.parseQueryString=function(a){return ua.parser.parse(a)};N.AbstractQueryTree.prototype.parseExecutableUnit=function(a){if(a.kind==="select")return this.parseSelect(a);else if(a.kind==="ask")return this.parseSelect(a);else if(a.kind==="modify")return this.parseSelect(a);else if(a.kind==="construct")return this.parseSelect(a);
else if(a.kind==="insertdata")return this.parseInsertData(a);else if(a.kind==="deletedata")return this.parseInsertData(a);else if(a.kind==="load")return a;else if(a.kind==="clear")return a;else if(a.kind==="drop")return a;else if(a.kind==="create")return a;else throw Error("unknown executable unit: "+a.kind);};N.AbstractQueryTree.prototype.parseSelect=function(a){return a==null?(console.log("error parsing query"),null):(a.pattern=this.build(a.pattern,{freshCounter:0}),a)};N.AbstractQueryTree.prototype.parseInsertData=
function(a){return a==null?(console.log("error parsing query"),null):a};N.AbstractQueryTree.prototype.build=function(a,c){if(a.token==="groupgraphpattern")return this._buildGroupGraphPattern(a,c);else if(a.token==="basicgraphpattern"){var d={kind:"BGP",value:a.triplesContext};return d=N.translatePathExpressionsInBGP(d,c)}else if(a.token==="graphunionpattern"){var d=this.build(a.value[0],c),e=this.build(a.value[1],c);return{kind:"UNION",value:[d,e]}}else if(a.token==="graphgraphpattern")return{kind:"GRAPH",
value:this.build(a.value,c),graph:a.graph};else throw Error("not supported token in query:"+a.token);};N.translatePathExpressionsInBGP=function(a,c){var d,e=[],k,j;for(j=0;j<a.value.length;j++)if(a.value[j].predicate&&a.value[j].predicate.token==="path"){d=a.value[j];k=a.value.slice(j+1);var i=N.translatePathExpression(d,c);d=null;if(i.kind==="BGP")e=e.concat(i.value);else if(i.kind==="ZERO_OR_MORE_PATH"||i.kind==="ONE_OR_MORE_PATH"){j=e.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:e},rvalue:i}:
i;if(i.kind==="ZERO_OR_MORE_PATH")if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0&&i.x.token==="var"&&i.x.value.indexOf("fresh:")===0)for(var f=0;f<a.value.length;f++){if(a.value[f].object&&a.value[f].object.token==="var"&&a.value[f].object.value===i.x.value)d=A.clone(a.value[f]),d.object=i.y}else if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0)for(f=0;f<a.value.length;f++)if(a.value[f].subject&&a.value[f].subject.token==="var"&&a.value[f].subject.value===i.y.value)d=A.clone(a.value[f]),
d.subject=i.x;return k.length>0?(i=N.translatePathExpressionsInBGP({kind:"BGP",value:k},c),d!=null?(e=e.concat([d]).concat(k),{kind:"UNION",value:[{kind:"JOIN",lvalue:j,rvalue:i},{kind:"BGP",value:e}]}):{kind:"JOIN",lvalue:j,rvalue:i}):j}else return i}else e.push(a.value[j]);a.value=e;return a};N.translatePathExpression=function(a,c){if(a.predicate.kind==="element")if(a.predicate.modifier==="+"){a.predicate.modifier=null;var d=N.translatePathExpression(a,c);return{kind:"ONE_OR_MORE_PATH",path:d,x:a.subject,
y:a.object}}else return a.predicate.modifier==="*"?(a.predicate.modifier=null,d=N.translatePathExpression(a,c),{kind:"ZERO_OR_MORE_PATH",path:d,x:a.subject,y:a.object}):(a.predicate=a.predicate.value,{kind:"BGP",value:[a]});else if(a.predicate.kind==="sequence"){for(var d=a.subject,e=a.object,k=a.graph,j,i,f=[],u=0;u<a.predicate.value.length;u++){u!=a.predicate.value.length-1?(j={token:"var",value:"fresh:"+c.freshCounter},c.freshCounter++):j=e;i={subject:d,predicate:a.predicate.value[u],object:j};
if(k!=null)i.graph=A.clone(k);f.push(i);u!=a.predicate.value.length-1&&(d=A.clone(j))}return N.translatePathExpressionsInBGP({kind:"BGP",value:f},c)}};N.AbstractQueryTree.prototype._buildGroupGraphPattern=function(a,c){for(var d=a.filters||[],e={kind:"EMPTY_PATTERN"},k=0;k<a.patterns.length;k++){var j=a.patterns[k];j.token==="optionalgraphpattern"?(j=this.build(j.value,c),e=j.kind==="FILTER"?{kind:"LEFT_JOIN",lvalue:e,rvalue:j.value,filter:j.filter}:{kind:"LEFT_JOIN",lvalue:e,rvalue:j,filter:!0}):
(j=this.build(j,c),e=e.kind=="EMPTY_PATTERN"?j:{kind:"JOIN",lvalue:e,rvalue:j})}if(d.length!=0)if(e.kind==="EMPTY_PATTERN")return{kind:"FILTER",filter:d,value:e};else if(e.kind==="LEFT_JOIN"&&e.filter===!0)return{kind:"FILTER",filter:d,value:e};else if(e.kind==="LEFT_JOIN")return{kind:"FILTER",filter:d,value:e};else if(e.kind==="JOIN")return{kind:"FILTER",filter:d,value:e};else if(e.kind==="UNION")return{kind:"FILTER",filter:d,value:e};else if(e.kind==="GRAPH")return{kind:"FILTER",filter:d,value:e};
else if(e.kind==="BGP")return{kind:"FILTER",filter:d,value:e};else throw Error("Unknow kind of algebra expression: "+e.kind);else return e};N.AbstractQueryTree.prototype.collectBasicTriples=function(a,c){c==null&&(c=[]);if(a.kind==="select")c=this.collectBasicTriples(a.pattern,c);else if(a.kind==="BGP")c=c.concat(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")c=this.collectBasicTriples(a.path);else if(a.kind==="UNION")c=this.collectBasicTriples(a.value[0],c),c=this.collectBasicTriples(a.value[1],c);
else if(a.kind==="GRAPH")c=this.collectBasicTriples(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")c=this.collectBasicTriples(a.lvalue,c),c=this.collectBasicTriples(a.rvalue,c);else if(a.kind==="FILTER")c=this.collectBasicTriples(a.value,c);else if(a.kind==="construct")c=this.collectBasicTriples(a.pattern,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return c};N.AbstractQueryTree.prototype.bind=function(a,c){if(a.graph!=null&&a.graph.token&&a.graph.token==="var"&&c[a.graph.value]!=
null)a.graph=c[a.graph.value];if(a.filter!=null){for(var d=[],e=0;e<a.filter.length;e++)a.filter[e].value=this._bindFilter(a.filter[e].value,c),d.push(a.filter[e]);a.filter=d}if(a.kind==="select")a.pattern=this.bind(a.pattern,c);else if(a.kind==="BGP")a.value=this._bindTripleContext(a.value,c);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._bindTripleContext(a.path,c);if(a.x&&a.x.token==="var"&&c[a.x.value]!=null)a.x=c[a.x.value];if(a.y&&a.y.token==="var"&&c[a.y.value]!=null)a.y=c[a.y.value]}else if(a.kind===
"UNION")a.value[0]=this.bind(a.value[0],c),a.value[1]=this.bind(a.value[1],c);else if(a.kind==="GRAPH")a.value=this.bind(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.bind(a.lvalue,c),a.rvalue=this.bind(a.rvalue,c);else if(a.kind==="FILTER")a.filter=this._bindFilter(a.filter[e].value,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};N.AbstractQueryTree.prototype._bindTripleContext=function(a,c){for(var d=0;d<a.length;d++){delete a[d].graph;delete a[d].variables;
for(var e in a[d]){var k=a[d][e];k.token==="var"&&c[k.value]!=null&&(a[d][e]=c[k.value])}}return a};N.AbstractQueryTree.prototype._bindFilter=function(a,c){if(a.expressionType!=null){var d=a.expressionType;if(d=="relationalexpression")a.op1=this._bindFilter(a.op1,c),a.op2=this._bindFilter(a.op2,c);else if(d=="conditionalor"||d=="conditionaland")for(d=0;d<a.operands.length;d++)a.operands[d]=this._bindFilter(a.operands[d],c);else if(d=="additiveexpression"){a.summand=this._bindFilter(a.summand,c);for(d=
0;d<a.summands.length;d++)a.summands[d].expression=this._bindFilter(a.summands[d].expression,c)}else if(d=="builtincall")for(d=0;d<a.args.length;d++)a.args[d]=this._bindFilter(a.args[d],c);else if(d=="multiplicativeexpression"){a.factor=this._bindFilter(a.factor,c);for(d=0;d<a.factors.length;d++)a.factors[d].expression=this._bindFilter(a.factors[d].expression,c)}else if(d=="unaryexpression")a.expression=this._bindFilter(a.expression,c);else if(d=="irireforfunction")for(d=0;d<a.factors.args;d++)a.args[d]=
this._bindFilter(a.args[d],c);else if(d=="atomic"&&a.primaryexpression=="var"&&c[a.value.value]!=null)d=c[a.value.value],a.primaryexpression=d.token==="uri"?"iri":"literal",a.value=d}return a};N.AbstractQueryTree.prototype.replace=function(a,c,d,e){if(a.graph!=null&&a.graph.token&&a.graph.token===c.token&&a.graph.value==c.value)a.graph=A.clone(d);if(a.filter!=null){for(var k=[],j=0;j<a.filter.length;j++)a.filter[j].value=this._replaceFilter(a.filter[j].value,c,d,e),k.push(a.filter[j]);a.filter=k}if(a.kind===
"select")a.pattern=this.replace(a.pattern,c,d,e);else if(a.kind==="BGP")a.value=this._replaceTripleContext(a.value,c,d,e);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._replaceTripleContext(a.path,c,d,e);if(a.x&&a.x.token===c.token&&a.value===c.value)a.x=A.clone(d);if(a.y&&a.y.token===c.token&&a.value===c.value)a.y=A.clone(d)}else if(a.kind==="UNION")a.value[0]=this.replace(a.value[0],c,d,e),a.value[1]=this.replace(a.value[1],c,d,e);else if(a.kind==="GRAPH")a.value=this.replace(a.value,c,d);else if(a.kind===
"LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.replace(a.lvalue,c,d,e),a.rvalue=this.replace(a.rvalue,c,d,e);else if(a.kind==="FILTER")a.value=this._replaceFilter(a.value,c,d,e);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};N.AbstractQueryTree.prototype._replaceTripleContext=function(a,c,d,e){for(var k=0;k<a.length;k++)for(var j in a[k]){var i=a[k][j];if(i.token==="var"&&c.token==="var"&&i.value===c.value)a[k][j]=d;else if(i.token==="blank"&&c.token==="blank"&&i.value===c.value)a[k][j]=
d;else if((i.token==="literal"||i.token==="uri")&&(c.token==="literal"||c.token==="uri")&&i.token===c.token&&A.lexicalFormTerm(i,e)[i.token]===A.lexicalFormTerm(c,e)[i.token])a[k][j]=d}return a};N.AbstractQueryTree.prototype._replaceFilter=function(a,c,d,e){if(a.expressionType!=null){var k=a.expressionType;if(k=="relationalexpression")a.op1=this._replaceFilter(a.op1,c,d,e),a.op2=this._replaceFilter(a.op2,c,d,e);else if(k=="conditionalor"||k=="conditionaland")for(k=0;k<a.operands.length;k++)a.operands[k]=
this._replaceFilter(a.operands[k],c,d,e);else if(k=="additiveexpression"){a.summand=this._replaceFilter(a.summand,c,d,e);for(k=0;k<a.summands.length;k++)a.summands[k].expression=this._replaceFilter(a.summands[k].expression,c,d,e)}else if(k=="builtincall")for(k=0;k<a.args.length;k++)a.args[k]=this._replaceFilter(a.args[k],c,d,e);else if(k=="multiplicativeexpression"){a.factor=this._replaceFilter(a.factor,c,d,e);for(k=0;k<a.factors.length;k++)a.factors[k].expression=this._replaceFilter(a.factors[k].expression,
c,d,e)}else if(k=="unaryexpression")a.expression=this._replaceFilter(a.expression,c,d,e);else if(k=="irireforfunction")for(k=0;k<a.factors.args;k++)a.args[k]=this._replaceFilter(a.args[k],c,d,e);else if(k=="atomic"){e=null;if(a.primaryexpression==c.token&&a.value==c.value)e=d.value;else if(a.primaryexpression=="iri"&&c.token=="uri"&&a.value==c.value)e=d.value;if(e!=null)a.primaryexpression=d.token==="uri"?"iri":d.token,a.value=e}}return a};N.AbstractQueryTree.prototype.treeWithUnion=function(a){if(a==
null)return!1;if(a.kind==null)return!1;if(a.kind==="select")return this.treeWithUnion(a.pattern);else if(a.kind==="BGP")return this.treeWithUnion(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")return!1;else if(a.kind==="UNION")if(console.log("UNION!!"),a.value[0].value!=null&&a.value[0].value.variables!=null&&a.value[1].value!=null&&a.value[1].value.variables!=null){if(console.log("COMPARING:"+a.value[0].variables.join("/")),console.log("VS "+a.values[1].variables.join("/")),a.value[0].variables.join("/")===
a.values[1].variables.join("/"))return this.treeWithUnion(a.value[0])?!0:this.treeWithUnion(a.value[1])}else return!0;else if(a.kind==="GRAPH")return!1;else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")if(this.treeWithUnion(a.lvalue))return!0;else this.treeWithUnion(a.rvalue);else return!1};var ua={};ua.parser=function(){var a={parse:function(a,d){function e(a){var b=a.charCodeAt(0);if(b<=255)var a="x",c=2;else a="u",c=4;var a="\\"+a,h=b.toString(16).toUpperCase(),b=h;c-=h.length;for(h=0;h<c;h++)b="0"+
b;return a+b}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,e)+'"'}function j(a){b<va||(b>va&&(va=b,cb=[]),cb.push(a))}function i(){var a="Query@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=f();if(g!==null){var e=r();e===null&&(e=B(),e===null&&(e=C(),e===null&&(e=s(),e=e!==null?e:null)));e!==null?g=[g,e]:(g=null,b=h)}else g=null,b=h;h=g!==null?{token:"query",kind:"query",prologue:g[0],units:[g[1]]}:
null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[2] Query");v[a]={nextPos:b,result:h};return h}function f(){var a="Prologue@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=u(),g=g!==null?g:"";if(g!==null){for(var e=[],t=q();t!==null;)e.push(t),t=q();if(e!==null){for(var t=[],k=w();k!==null;)t.push(k),k=w();t!==null?g=[g,e,t]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?{token:"prologue",base:g[0],prefixes:g[2]}:null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[3] Prologue");
v[a]={nextPos:b,result:h};return h}function u(){var d="BaseDecl@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],K=q();K!==null;)g.push(K),K=q();if(g!==null)if(a.substr(b,4)==="BASE"?(K="BASE",b+=4):(K=null,m&&j('"BASE"')),K===null&&(a.substr(b,4)==="base"?(K="base",b+=4):(K=null,m&&j('"base"')),K=K!==null?K:null),K!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();t!==null?(y=Ea(),y!==null?g=[g,K,t,y]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?
function(a){var b={token:"base"};b.value=a;return b}(g[3]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[4] BaseDecl");v[d]={nextPos:b,result:h};return h}function w(){var d="PrefixDecl@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],K=q();K!==null;)g.push(K),K=q();if(g!==null)if(a.substr(b,6)==="PREFIX"?(K="PREFIX",b+=6):(K=null,m&&j('"PREFIX"')),K===null&&(a.substr(b,6)==="prefix"?(K="prefix",b+=6):(K=null,m&&j('"prefix"')),K=K!==null?K:null),K!==null){for(var t=[],y=
q();y!==null;)t.push(y),y=q();if(t!==null)if(y=Fa(),y!==null){for(var o=[],i=q();i!==null;)o.push(i),i=q();o!==null?(i=Ea(),i!==null?g=[g,K,t,y,o,i]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){var c={token:"prefix"};c.prefix=a;c.local=b;return c}(g[3],g[5]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[5] PrefixDecl");v[d]={nextPos:b,result:h};return h}function r(){var a="SelectQuery@"+b,c=v[a];if(c)return b=c.nextPos,c.result;
c=m;m=!1;var d=b,h=b,g=A();if(g!==null){for(var e=[],t=q();t!==null;)e.push(t),t=q();if(e!==null){for(var t=[],k=n();k!==null;)t.push(k),k=n();if(t!==null){for(var k=[],o=q();o!==null;)k.push(o),o=q();if(k!==null)if(o=H(),o!==null){for(var i=[],f=q();f!==null;)i.push(f),f=q();if(i!==null)if(f=U(),f!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=W(),s!==null?g=[g,e,t,k,o,i,f,l,s]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,
b=h}else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c,g){for(var h={named:[],implicit:[]},d=0;d<b.length;d++){var j=b[d];j.kind==="default"?h.implicit.push(j.graph):h.named.push(j.graph)}h.named.length===0&&h.implicit.length===0&&h.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});b={kind:"select",token:"executableunit"};b.dataset=h;b.projection=a.vars;b.modifier=a.modifier;b.pattern=c;if(g!=null&&g.limit!=null)b.limit=
g.limit;if(g!=null&&g.offset!=null)b.offset=g.offset;if(g!=null&&g.order!=null&&g.order!="")b.order=g.order;if(g!=null&&g.group!=null)b.group=g.group;return b}(g[0],g[2],g[4],g[6]):null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[6] SelectQuery");v[a]={nextPos:b,result:h};return h}function x(){var a="SubSelect@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=A();if(h!==null){var g=H();if(g!==null){var e=U();e!==null?h=[h,g,e]:(h=null,b=d)}else h=null,b=d}else h=null,b=d;(m=c)&&h===null&&
j("[7] SubSelect");v[a]={nextPos:b,result:h};return h}function A(){var d="SelectClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],K=q();K!==null;)g.push(K),K=q();if(g!==null)if(a.substr(b,6)==="SELECT"?(K="SELECT",b+=6):(K=null,m&&j('"SELECT"')),K===null&&(a.substr(b,6)==="select"?(K="select",b+=6):(K=null,m&&j('"select"')),K=K!==null?K:null),K!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null)if(a.substr(b,8)==="DISTINCT"?(y="DISTINCT",b+=8):(y=null,
m&&j('"DISTINCT"')),y===null&&(a.substr(b,8)==="distinct"?(y="distinct",b+=8):(y=null,m&&j('"distinct"')),y=y!==null?y:null),y===null&&(a.substr(b,7)==="REDUCED"?(y="REDUCED",b+=7):(y=null,m&&j('"REDUCED"')),y===null&&(a.substr(b,7)==="reduced"?(y="reduced",b+=7):(y=null,m&&j('"reduced"')),y=y!==null?y:null),y=y!==null?y:null),y=y!==null?y:"",y!==null){for(var o=[],i=q();i!==null;)o.push(i),i=q();if(o!==null){for(var f=b,n=[],l=q();l!==null;)n.push(l),l=q();if(n!==null)if(l=R(),l!==null){for(var s=
[],z=q();z!==null;)s.push(z),z=q();s!==null?n=[n,l,s]:(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("')),l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();if(s!==null)if(z=M(),z!==null){for(var r=[],u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,2)==="AS"?(u="AS",b+=2):(u=null,m&&j('"AS"')),u===null&&(a.substr(b,2)==="as"?(u="as",b+=2):(u=null,m&&j('"as"')),
u=u!==null?u:null),u!==null){for(var w=[],D=q();D!==null;)w.push(D),D=q();if(w!==null)if(D=R(),D!==null){for(var H=[],x=q();x!==null;)H.push(x),x=q();if(H!==null)if(a.substr(b,1)===")"?(x=")",b+=1):(x=null,m&&j('")"')),x!==null){for(var I=[],Q=q();Q!==null;)I.push(Q),Q=q();I!==null?n=[n,l,s,z,r,u,w,D,H,x,I]:(n=null,b=f)}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=null,b=f;f=n!==null?n:null}if(f!==
null)for(i=[];f!==null;){i.push(f);f=b;n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(l=R(),l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();s!==null?n=[n,l,s]:(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("')),l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();if(s!==null)if(z=M(),z!==null){r=[];for(u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,2)===
"AS"?(u="AS",b+=2):(u=null,m&&j('"AS"')),u===null&&(a.substr(b,2)==="as"?(u="as",b+=2):(u=null,m&&j('"as"')),u=u!==null?u:null),u!==null){w=[];for(D=q();D!==null;)w.push(D),D=q();if(w!==null)if(D=R(),D!==null){H=[];for(x=q();x!==null;)H.push(x),x=q();if(H!==null)if(a.substr(b,1)===")"?(x=")",b+=1):(x=null,m&&j('")"')),x!==null){I=[];for(Q=q();Q!==null;)I.push(Q),Q=q();I!==null?n=[n,l,s,z,r,u,w,D,H,x,I]:(n=null,b=f)}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=
null,b=f}else n=null,b=f;else n=null,b=f}else n=null,b=f;else n=null,b=f;f=n!==null?n:null}}else i=null;if(i===null){i=b;f=[];for(n=q();n!==null;)f.push(n),n=q();if(f!==null)if(a.substr(b,1)==="*"?(n="*",b+=1):(n=null,m&&j('"*"')),n!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?f=[f,n,l]:(f=null,b=i)}else f=null,b=i;else f=null,b=i;i=f!==null?f:null}i!==null?g=[g,K,t,y,o,i]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,
b){var c=[];if(b.length===3&&b[1]==="*")return{vars:[{token:"variable",kind:"*"}],modifier:qb(a)};for(var g=0;g<b.length;g++){var h=b[g];h.length===3?c.push({token:"variable",kind:"var",value:h[1]}):c.push({token:"variable",kind:"aliased",expression:h[3],alias:h[7]})}return{vars:c,modifier:qb(a)}}(g[3],g[5]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[8] SelectClause");v[d]={nextPos:b,result:h};return h}function B(){var d="ConstructQuery@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=
b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,9)==="CONSTRUCT"?(i="CONSTRUCT",b+=9):(i=null,m&&j('"CONSTRUCT"')),i===null&&(a.substr(b,9)==="construct"?(i="construct",b+=9):(i=null,m&&j('"construct"')),i=i!==null?i:null),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null)if(y=rb(),y!==null){for(var o=[],f=q();f!==null;)o.push(f),f=q();if(o!==null){for(var f=[],L=n();L!==null;)f.push(L),L=n();if(f!==null){for(var L=[],l=q();l!==null;)L.push(l),l=q();if(L!==null)if(l=
H(),l!==null){for(var s=[],z=q();z!==null;)s.push(z),z=q();s!==null?(z=U(),z!==null?g=[g,i,t,y,o,f,L,l,s,z]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b,c,g){for(var h={named:[],implicit:[]},d=0;d<b.length;d++){var j=b[d];j.kind==="default"?h.implicit.push(j.graph):h.named.push(j.graph)}h.named.length===0&&h.implicit.length===0&&h.implicit.push({token:"uri",prefix:null,
suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});b={kind:"construct",token:"executableunit"};b.dataset=h;b.template=a;b.pattern=c;if(g!=null&&g.limit!=null)b.limit=g.limit;if(g!=null&&g.offset!=null)b.offset=g.offset;if(g!=null&&g.order!=null&&g.order!="")b.order=g.order;return b}(g[3],g[5],g[7],g[9]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[9] ConstructQuery");v[d]={nextPos:b,result:h};return h}function C(){var d="DescribeQuery@"+b,e=v[d];if(e)return b=e.nextPos,
e.result;e=m;m=!1;var k=b;if(a.substr(b,8)==="DESCRIBE"){var h="DESCRIBE";b+=8}else h=null,m&&j('"DESCRIBE"');if(h!==null){var g=ia();if(g!==null)for(var i=[];g!==null;)i.push(g),g=ia();else i=null;i!==null?g=i:(a.substr(b,1)==="*"?(g="*",b+=1):(g=null,m&&j('"*"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=n();t!==null;)i.push(t),t=n();if(i!==null)if(t=H(),t=t!==null?t:"",t!==null){var y=U();y!==null?h=[h,g,i,t,y]:(h=null,b=k)}else h=null,b=k;else h=null,b=k}else h=null,b=k}else h=null,b=k;(m=
e)&&h===null&&j("[10] DescribeQuery");v[d]={nextPos:b,result:h};return h}function s(){var d="AskQuery@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,3)==="ASK"?(i="ASK",b+=3):(i=null,m&&j('"ASK"')),i===null&&(a.substr(b,3)==="ask"?(i="ask",b+=3):(i=null,m&&j('"ask"')),i=i!==null?i:null),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null){for(var y=[],o=n();o!==null;)y.push(o),o=n();if(y!==null){for(var o=
[],f=q();f!==null;)o.push(f),f=q();o!==null?(f=H(),f!==null?g=[g,i,t,y,o,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h}else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){for(var c={named:[],implicit:[]},g=0;g<a.length;g++){var h=a[g];h.kind==="implicit"?c.implicit.push(h.graph):c.named.push(h.graph)}c.named.length===0&&c.implicit.length===0&&c.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});g={kind:"ask",
token:"executableunit"};g.dataset=c;g.pattern=b;return g}(g[3],g[5]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[11] AskQuery");v[d]={nextPos:b,result:h};return h}function n(){var d="DatasetClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,4)==="FROM"){var g="FROM";b+=4}else g=null,m&&j('"FROM"');g===null&&(a.substr(b,4)==="from"?(g="from",b+=4):(g=null,m&&j('"from"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=
D(),t===null&&(t=z(),t=t!==null?t:null),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[2]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[12] DatasetClause");v[d]={nextPos:b,result:h};return h}function D(){var a="DefaultGraphClause@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var d=b,h=b,g=[],e=q();e!==null;)g.push(e),e=q();g!==null?(e=S(),e!==null?g=[g,e]:(g=null,b=h)):(g=null,b=h);
h=g!==null?{graph:g[1],kind:"default",token:"graphClause"}:null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[13] DefaultGraphClause");v[a]={nextPos:b,result:h};return h}function z(){var d="NamedGraphClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="NAMED"){var g="NAMED";b+=5}else g=null,m&&j('"NAMED"');g===null&&(a.substr(b,5)==="named"?(g="named",b+=5):(g=null,m&&j('"named"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();i!==
null?(t=S(),t!==null?g=[g,i,t]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?{graph:g[2],kind:"named",token:"graphCluase"}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[14] NamedGraphClause");v[d]={nextPos:b,result:h};return h}function H(){var d="WhereClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="WHERE"){var g="WHERE";b+=5}else g=null,m&&j('"WHERE"');g===null&&(a.substr(b,5)==="where"?(g="where",b+=5):(g=null,m&&j('"where"')),g=g!==null?g:null);
g=g!==null?g:"";if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=X(),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[2]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[16] WhereClause");v[d]={nextPos:b,result:h};return h}function U(){var a="SolutionModifier@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=Q(),g=g!==null?g:"";if(g!==null){var e=F(),e=e!==
null?e:"";if(e!==null){var t=E(),t=t!==null?t:"";if(t!==null){var k=O(),k=k!==null?k:"";k!==null?g=[g,e,t,k]:(g=null,b=h)}else g=null,b=h}else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c){var g={};if(c!=null){if(c.limit!=null)g.limit=c.limit;if(c.offset!=null)g.offset=c.offset}if(a!=null)g.group=a;g.order=b;return g}(g[0],g[2],g[3]):null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[17] SolutionModifier");v[a]={nextPos:b,result:h};return h}function Q(){var d="GroupClause@"+b,e=v[d];if(e)return b=
e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="GROUP"){var g="GROUP";b+=5}else g=null,m&&j('"GROUP"');g===null&&(a.substr(b,5)==="group"?(g="group",b+=5):(g=null,m&&j('"group"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,2)==="BY"?(t="BY",b+=2):(t=null,m&&j('"BY"')),t===null&&(a.substr(b,2)==="by"?(t="by",b+=2):(t=null,m&&j('"by"')),t=t!==null?t:null),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();if(y!==null){o=G();
if(o!==null)for(var f=[];o!==null;)f.push(o),o=G();else f=null;f!==null?g=[g,i,t,y,f]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[4]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[18] GroupClause");v[d]={nextPos:b,result:h};return h}function G(){var d="GroupCondition@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(i=Ga(),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();t!==
null?g=[g,i,t]:(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;g=[];for(i=q();i!==null;)g.push(i),i=q();if(g!==null)if(i=db(),i!==null){t=[];for(y=q();y!==null;)t.push(y),y=q();t!==null?g=[g,i,t]:(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;g=[];for(i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){t=
[];for(y=q();y!==null;)t.push(y),y=q();if(t!==null)if(y=M(),y!==null){for(var o=[],f=q();f!==null;)o.push(f),f=q();if(o!==null){f=b;if(a.substr(b,2)==="AS"){var L="AS";b+=2}else L=null,m&&j('"AS"');L===null&&(a.substr(b,2)==="as"?(L="as",b+=2):(L=null,m&&j('"as"')),L=L!==null?L:null);if(L!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();n!==null?(l=R(),l!==null?L=[L,n,l]:(L=null,b=f)):(L=null,b=f)}else L=null,b=f;f=L!==null?L:"";if(f!==null){L=[];for(n=q();n!==null;)L.push(n),n=q();if(L!==null)if(a.substr(b,
1)===")"?(n=")",b+=1):(n=null,m&&j('")"')),n!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?g=[g,i,t,y,o,f,L,n,l]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?g[5].length!=0?{token:"aliased_expression",expression:g[3],alias:g[5][2]}:g[3]:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;g=[];for(i=q();i!==null;)g.push(i),i=q();if(g!==null)if(i=R(),i!==null){t=[];for(y=q();y!==
null;)t.push(y),y=q();t!==null?g=[g,i,t]:(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=k);k=h!==null?h:null}}}(m=e)&&k===null&&j("[19] GroupCondition");v[d]={nextPos:b,result:k};return k}function F(){var d="HavingClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b;if(a.substr(b,6)==="HAVING"){var h="HAVING";b+=6}else h=null,m&&j('"HAVING"');if(h!==null){var g=wa();if(g!==null)for(var i=[];g!==null;)i.push(g),g=wa();else i=null;i!==null?h=[h,
i]:(h=null,b=k)}else h=null,b=k;(m=e)&&h===null&&j("[20] HavingClause");v[d]={nextPos:b,result:h};return h}function E(){var d="OrderClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="ORDER"){var g="ORDER";b+=5}else g=null,m&&j('"ORDER"');g===null&&(a.substr(b,5)==="order"?(g="order",b+=5):(g=null,m&&j('"order"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,2)==="BY"?(t="BY",b+=2):(t=null,m&&j('"BY"')),
t===null&&(a.substr(b,2)==="by"?(t="by",b+=2):(t=null,m&&j('"by"')),t=t!==null?t:null),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();if(y!==null){var f=J();if(f!==null)for(o=[];f!==null;)o.push(f),f=J();else o=null;if(o!==null){for(var f=[],L=q();L!==null;)f.push(L),L=q();f!==null?g=[g,i,t,y,o,f]:(g=null,b=h)}else g=null,b=h}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[4]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[22] OrderClause");v[d]={nextPos:b,result:h};
return h}function J(){var d="OrderCondition@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,3)==="ASC"){var g="ASC";b+=3}else g=null,m&&j('"ASC"');g===null&&(a.substr(b,3)==="asc"?(g="asc",b+=3):(g=null,m&&j('"asc"')),g===null&&(a.substr(b,4)==="DESC"?(g="DESC",b+=4):(g=null,m&&j('"DESC"')),g===null&&(a.substr(b,4)==="desc"?(g="desc",b+=4):(g=null,m&&j('"desc"')),g=g!==null?g:null)));if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=Ha(),t!==
null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?{direction:g[0].toUpperCase(),expression:g[2]}:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;g=wa();g===null&&(g=R(),g=g!==null?g:null);if(g!==null){i=[];for(t=q();t!==null;)i.push(t),t=q();i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.token==="var"&&(a={token:"expression",expressionType:"atomic",primaryexpression:"var",value:a});
return{direction:"ASC",expression:a}}(g[0]):null;h===null&&(h=null,b=k);k=h!==null?h:null}(m=e)&&k===null&&j("[23] OrderCondition");v[d]={nextPos:b,result:k};return k}function O(){var a="LimitOffsetClauses@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=N();if(g!==null){var e=P(),e=e!==null?e:"";e!==null?g=[g,e]:(g=null,b=h)}else g=null,b=h;g!==null?h=g:(h=b,g=P(),g!==null?(e=N(),e=e!==null?e:"",e!==null?g=[g,e]:(g=null,b=h)):(g=null,b=h),h=g!==null?g:null);h=h!==null?function(a){for(var b=
{},c=0;c<a.length;c++){var g=a[c];if(g.limit!=null)b.limit=g.limit;else if(g.offset!=null)b.offset=g.offset}return b}(h):null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[24] LimitOffsetClauses");v[a]={nextPos:b,result:h};return h}function N(){var d="LimitClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="LIMIT"){var g="LIMIT";b+=5}else g=null,m&&j('"LIMIT"');g===null&&(a.substr(b,5)==="limit"?(g="limit",b+=5):(g=null,m&&j('"limit"')),g=g!==null?g:null);if(g!==
null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=da(),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?{limit:parseInt(g[2].value)}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[25] LimitClause");v[d]={nextPos:b,result:h};return h}function P(){var d="OffsetClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="OFFSET"){var g="OFFSET";b+=6}else g=
null,m&&j('"OFFSET"');g===null&&(a.substr(b,6)==="offset"?(g="offset",b+=6):(g=null,m&&j('"offset"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=da(),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?{offset:parseInt(g[2].value)}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[26] OffsetClause");v[d]={nextPos:b,result:h};return h}function W(){var d=
"BindingsClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b;if(a.substr(b,8)==="BINDINGS"){var h="BINDINGS";b+=8}else h=null,m&&j('"BINDINGS"');if(h!==null){for(var g=[],i=R();i!==null;)g.push(i),i=R();if(g!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){var t=[],y=b;if(a.substr(b,1)==="("){var o="(";b+=1}else o=null,m&&j('"("');if(o!==null){var f=T();if(f!==null)for(var q=[];f!==null;)q.push(f),f=T();else q=null;q!==null?(a.substr(b,1)===")"?(f=")",b+=1):
(f=null,m&&j('")"')),f!==null?o=[o,q,f]:(o=null,b=y)):(o=null,b=y)}else o=null,b=y;o!==null?y=o:(y=ja(),y=y!==null?y:null);for(;y!==null;){t.push(y);y=b;a.substr(b,1)==="("?(o="(",b+=1):(o=null,m&&j('"("'));if(o!==null){f=T();if(f!==null)for(q=[];f!==null;)q.push(f),f=T();else q=null;q!==null?(a.substr(b,1)===")"?(f=")",b+=1):(f=null,m&&j('")"')),f!==null?o=[o,q,f]:(o=null,b=y)):(o=null,b=y)}else o=null,b=y;o!==null?y=o:(y=ja(),y=y!==null?y:null)}t!==null?(a.substr(b,1)==="}"?(y="}",b+=1):(y=null,
m&&j('"}"')),y!==null?h=[h,g,i,t,y]:(h=null,b=k)):(h=null,b=k)}else h=null,b=k;else h=null,b=k}else h=null,b=k;k=h!==null?h:"";(m=e)&&k===null&&j("[27] BindingsClause");v[d]={nextPos:b,result:k};return k}function T(){var d="BindingValue@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=S();k===null&&(k=Ia(),k===null&&(k=Ja(),k===null&&(k=Ka(),k===null&&(a.substr(b,5)==="UNDEF"?(k="UNDEF",b+=5):(k=null,m&&j('"UNDEF"')),k=k!==null?k:null))));(m=e)&&k===null&&j("[28] BindingValue");v[d]={nextPos:b,
result:k};return k}function Y(){var d="Update@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=f();if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=aa(),t!==null){for(var y=b,o=[],n=q();n!==null;)o.push(n),n=q();if(o!==null)if(a.substr(b,1)===";"?(n=";",b+=1):(n=null,m&&j('";"')),n!==null){for(var L=[],s=q();s!==null;)L.push(s),s=q();L!==null?(s=Y(),s=s!==null?s:"",s!==null?o=[o,n,L,s]:(o=null,b=y)):(o=null,b=y)}else o=null,b=y;else o=null,b=y;y=o!==null?
o:"";y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c){var g={token:"query",kind:"update"};g.prologue=a;a=[b];c.length!=null&&c[3]!=null&&c[3].units!=null&&(a=a.concat(c[3].units));g.units=a;return g}(g[0],g[2],g[3]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[30] Update");v[d]={nextPos:b,result:h};return h}function aa(){var a="Update1@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=ca();d===null&&(d=ga(),d===null&&(d=la(),
d===null&&(d=ra(),d===null&&(d=sa(),d===null&&(d=ta(),d===null&&(d=ua(),d===null&&(d=Ca(),d=d!==null?d:null)))))));(m=c)&&d===null&&j("[31] Update1");v[a]={nextPos:b,result:d};return d}function ca(){var d="Load@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,4)==="LOAD"){var g="LOAD";b+=4}else g=null,m&&j('"LOAD"');g===null&&(a.substr(b,4)==="load"?(g="load",b+=4):(g=null,m&&j('"load"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==
null)if(t=S(),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();if(y!==null){o=b;if(a.substr(b,4)==="INTO"){var f="INTO";b+=4}else f=null,m&&j('"INTO"');f===null&&(a.substr(b,4)==="into"?(f="into",b+=4):(f=null,m&&j('"into"')),f=f!==null?f:null);if(f!==null){for(var L=[],n=q();n!==null;)L.push(n),n=q();L!==null?(n=Da(),n!==null?f=[f,L,n]:(f=null,b=o)):(f=null,b=o)}else f=null,b=o;o=f!==null?f:"";o!==null?g=[g,i,t,y,o]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=
h;h=g!==null?function(a,b){var c={kind:"load",token:"executableunit"};c.sourceGraph=a;c.destinyGraph=b[2];return c}(g[2],g[4]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[32] Load");v[d]={nextPos:b,result:h};return h}function ga(){var d="Clear@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="CLEAR"){var g="CLEAR";b+=5}else g=null,m&&j('"CLEAR"');g===null&&(a.substr(b,5)==="clear"?(g="clear",b+=5):(g=null,m&&j('"clear"')),g=g!==null?g:null);if(g!==null){for(var i=
[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,6)==="SILENT"?(t="SILENT",b+=6):(t=null,m&&j('"SILENT"')),t===null&&(a.substr(b,6)==="silent"?(t="silent",b+=6):(t=null,m&&j('"silent"')),t=t!==null?t:null),t=t!==null?t:"",t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?(o=Xa(),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={kind:"clear",token:"executableunit"};b.destinyGraph=a;return b}(g[4]):
null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[33] Clear");v[d]={nextPos:b,result:h};return h}function la(){var d="Drop@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,4)==="DROP"){var g="DROP";b+=4}else g=null,m&&j('"DROP"');g===null&&(a.substr(b,4)==="drop"?(g="drop",b+=4):(g=null,m&&j('"drop"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,6)==="SILENT"?(t="SILENT",b+=6):(t=null,m&&j('"SILENT"')),t===null&&
(a.substr(b,6)==="silent"?(t="silent",b+=6):(t=null,m&&j('"silent"')),t=t!==null?t:null),t=t!==null?t:"",t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?(o=Xa(),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={kind:"drop",token:"executableunit"};b.destinyGraph=a;return b}(g[4]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[34] Drop");v[d]={nextPos:b,result:h};return h}function ra(){var d="Create@"+b,
e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="CREATE"){var g="CREATE";b+=6}else g=null,m&&j('"CREATE"');g===null&&(a.substr(b,6)==="create"?(g="create",b+=6):(g=null,m&&j('"create"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,6)==="SILENT"?(t="SILENT",b+=6):(t=null,m&&j('"SILENT"')),t===null&&(a.substr(b,6)==="silent"?(t="silent",b+=6):(t=null,m&&j('"silent"')),t=t!==null?t:null),t=t!==null?t:"",t!==null){for(var y=
[],o=q();o!==null;)y.push(o),o=q();y!==null?(o=Da(),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={kind:"create",token:"executableunit"};b.destinyGraph=a;return b}(g[4]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[35] Create");v[d]={nextPos:b,result:h};return h}function sa(){var d="InsertData@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="INSERT"){var g="INSERT";b+=6}else g=
null,m&&j('"INSERT"');g===null&&(a.substr(b,6)==="insert"?(g="insert",b+=6):(g=null,m&&j('"insert"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,4)==="DATA"?(t="DATA",b+=4):(t=null,m&&j('"DATA"')),t===null&&(a.substr(b,4)==="data"?(t="data",b+=4):(t=null,m&&j('"data"')),t=t!==null?t:null),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?(o=ab(),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=
h}else g=null,b=h;h=g!==null?function(a){var b={kind:"insertdata",token:"executableunit"};b.quads=a;return b}(g[4]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[36] InsertData");v[d]={nextPos:b,result:h};return h}function ta(){var d="DeleteData@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="DELETE"){var g="DELETE";b+=6}else g=null,m&&j('"DELETE"');g===null&&(a.substr(b,6)==="delete"?(g="delete",b+=6):(g=null,m&&j('"delete"')),g=g!==null?g:null);if(g!==null){for(var i=
[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,4)==="DATA"?(t="DATA",b+=4):(t=null,m&&j('"DATA"')),t===null&&(a.substr(b,4)==="data"?(t="data",b+=4):(t=null,m&&j('"data"')),t=t!==null?t:null),t!==null){var y=ab();y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={kind:"deletedata",token:"executableunit"};b.quads=a;return b}(g[3]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[37] DeleteData");v[d]={nextPos:b,result:h};return h}
function ua(){var d="DeleteWhere@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="DELETE"){var g="DELETE";b+=6}else g=null,m&&j('"DELETE"');g===null&&(a.substr(b,6)==="delete"?(g="delete",b+=6):(g=null,m&&j('"delete"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(a.substr(b,5)==="WHERE"?(t="WHERE",b+=5):(t=null,m&&j('"WHERE"')),t===null&&(a.substr(b,5)==="where"?(t="where",b+=5):(t=null,m&&j('"where"')),t=t!==null?
t:null),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?(o=X(),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={kind:"modify"};b.pattern=a;b["with"]=null;b.using=null;for(var c=[],a=a.patterns[0],a=a.triplesContext==null&&a.patterns!=null?a.patterns[0].triplesContext:a.triplesContext,g=0;g<a.length;g++){var h={},d=a[g];h.subject=d.subject;h.predicate=d.predicate;h.object=d.object;h.graph=d.graph;c.push(h)}b["delete"]=
c;return b}(g[4]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[38] DeleteWhere");v[d]={nextPos:b,result:h};return h}function Ca(){var d="Modify@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=b;if(a.substr(b,4)==="WITH"){var i="WITH";b+=4}else i=null,m&&j('"WITH"');i===null&&(a.substr(b,4)==="with"?(i="with",b+=4):(i=null,m&&j('"with"')),i=i!==null?i:null);if(i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();t!==null?(y=S(),y!==null?i=[i,t,y]:(i=null,b=g)):(i=null,b=g)}else i=
null,b=g;g=i!==null?i:"";if(g!==null){i=[];for(t=q();t!==null;)i.push(t),t=q();if(i!==null){t=b;y=pb();if(y!==null){for(var o=[],f=q();f!==null;)o.push(f),f=q();o!==null?(f=Za(),f=f!==null?f:"",f!==null?y=[y,o,f]:(y=null,b=t)):(y=null,b=t)}else y=null,b=t;y!==null?t=y:(t=Za(),t=t!==null?t:null);if(t!==null){y=[];for(o=q();o!==null;)y.push(o),o=q();if(y!==null){o=[];for(f=$a();f!==null;)o.push(f),f=$a();if(o!==null){for(var f=[],n=q();n!==null;)f.push(n),n=q();if(f!==null)if(a.substr(b,5)==="WHERE"?
(n="WHERE",b+=5):(n=null,m&&j('"WHERE"')),n===null&&(a.substr(b,5)==="where"?(n="where",b+=5):(n=null,m&&j('"where"')),n=n!==null?n:null),n!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();if(l!==null)if(s=X(),s!==null){for(var z=[],r=q();r!==null;)z.push(r),r=q();z!==null?g=[g,i,t,y,o,f,n,l,s,z]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h}else g=null,b=h}else g=null,b=h}else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c,g){var h={kind:"modify"};
h["with"]=a!=""?a[2]:null;b.length===3&&b[2]===""?(h["delete"]=b[0],h.insert=null):b.length===3&&b[0].length!=null&&b[1].length!=null&&b[2].length!=null?(h["delete"]=b[0],h.insert=b[2]):(h.insert=b,h["delete"]=null);c!=""&&(h.using=c);h.pattern=g;return h}(g[0],g[2],g[4],g[8]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[39] Modify");v[d]={nextPos:b,result:h};return h}function pb(){var d="DeleteClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="DELETE"){var g=
"DELETE";b+=6}else g=null,m&&j('"DELETE"');g===null&&(a.substr(b,6)==="delete"?(g="delete",b+=6):(g=null,m&&j('"delete"')),g=g!==null?g:null);if(g!==null){var i=Ya();i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[40] DeleteClause");v[d]={nextPos:b,result:h};return h}function Za(){var d="InsertClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,6)==="INSERT"){var g="INSERT";b+=6}else g=null,m&&j('"INSERT"');
g===null&&(a.substr(b,6)==="insert"?(g="insert",b+=6):(g=null,m&&j('"insert"')),g=g!==null?g:null);if(g!==null){var i=Ya();i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[41] InsertClause");v[d]={nextPos:b,result:h};return h}function $a(){var d="UsingClause@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,5)==="USING"?(i="USING",b+=5):(i=null,m&&j('"USING"')),
i===null&&(a.substr(b,5)==="using"?(i="using",b+=5):(i=null,m&&j('"using"')),i=i!==null?i:null),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null){y=S();if(y===null){y=b;if(a.substr(b,5)==="NAMED"){var o="NAMED";b+=5}else o=null,m&&j('"NAMED"');o===null&&(a.substr(b,5)==="named"?(o="named",b+=5):(o=null,m&&j('"named"')),o=o!==null?o:null);if(o!==null){for(var f=[],n=q();n!==null;)f.push(n),n=q();f!==null?(n=S(),n!==null?o=[o,f,n]:(o=null,b=y)):(o=null,b=y)}else o=null,b=y;y=o!==null?
o:null}y!==null?g=[g,i,t,y]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?g[3].length!=null?{kind:"named",uri:g[3][2]}:{kind:"default",uri:g[3]}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[42] UsingClause");v[d]={nextPos:b,result:h};return h}function Da(){var d="GraphRef@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="GRAPH"){var g="GRAPH";b+=5}else g=null,m&&j('"GRAPH"');g===null&&(a.substr(b,5)==="graph"?(g="graph",b+=5):(g=null,
m&&j('"graph"')),g=g!==null?g:null);if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();i!==null?(t=S(),t!==null?g=[g,i,t]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?g[2]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[43] GraphRef");v[d]={nextPos:b,result:h};return h}function Xa(){var d="GraphRefAll@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=Da(),h=h!==null?h:null;h===null&&(h=null,b=k);h!==null?k=h:(k=b,a.substr(b,7)==="DEFAULT"?(h="DEFAULT",b+=7):(h=null,m&&
j('"DEFAULT"')),h===null&&(a.substr(b,7)==="default"?(h="default",b+=7):(h=null,m&&j('"default"')),h=h!==null?h:null),h=h!==null?"default":null,h===null&&(h=null,b=k),h!==null?k=h:(k=b,a.substr(b,5)==="NAMED"?(h="NAMED",b+=5):(h=null,m&&j('"NAMED"')),h===null&&(a.substr(b,5)==="named"?(h="named",b+=5):(h=null,m&&j('"named"')),h=h!==null?h:null),h=h!==null?"named":null,h===null&&(h=null,b=k),h!==null?k=h:(k=b,a.substr(b,3)==="ALL"?(h="ALL",b+=3):(h=null,m&&j('"ALL"')),h===null&&(a.substr(b,3)==="all"?
(h="all",b+=3):(h=null,m&&j('"all"')),h=h!==null?h:null),h=h!==null?"all":null,h===null&&(h=null,b=k),k=h!==null?h:null)));(m=e)&&k===null&&j("[44] GraphRefAll");v[d]={nextPos:b,result:k};return k}function Ya(){var d="QuadPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null)if(y=bb(),y!==null){for(var o=
[],f=q();f!==null;)o.push(f),f=q();if(o!==null)if(a.substr(b,1)==="}"?(f="}",b+=1):(f=null,m&&j('"}"')),f!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();n!==null?g=[g,i,t,y,o,f,n]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?g[3].quadsContext:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[45] QuadPattern");v[d]={nextPos:b,result:h};return h}function ab(){var d="QuadData@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=
m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null)if(y=bb(),y!==null){for(var o=[],f=q();f!==null;)o.push(f),f=q();if(o!==null)if(a.substr(b,1)==="}"?(f="}",b+=1):(f=null,m&&j('"}"')),f!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();n!==null?g=[g,i,t,y,o,f,n]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,
b=h;else g=null,b=h;h=g!==null?g[3].quadsContext:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[46] QuadData");v[d]={nextPos:b,result:h};return h}function bb(){var d="Quads@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=ma(),g=g!==null?g:"";if(g!==null){var i=[],t=b,y=eb();if(y!==null){if(a.substr(b,1)==="."){var o=".";b+=1}else o=null,m&&j('"."');o=o!==null?o:"";if(o!==null){var f=ma(),f=f!==null?f:"";f!==null?y=[y,o,f]:(y=null,b=t)}else y=null,b=t}else y=null,b=t;for(;y!==
null;)i.push(y),t=b,y=eb(),y!==null?(a.substr(b,1)==="."?(o=".",b+=1):(o=null,m&&j('"."')),o=o!==null?o:"",o!==null?(f=ma(),f=f!==null?f:"",f!==null?y=[y,o,f]:(y=null,b=t)):(y=null,b=t)):(y=null,b=t);i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){var c=[];if(a.triplesContext!=null&&a.triplesContext!=null)for(var g=0;g<a.triplesContext.length;g++){var h=a.triplesContext[g];h.graph=null;c.push(h)}if(b&&b.length>0&&b[0].length>0&&(c=c.concat(b[0][0].quadsContext),b[0][2]!=null&&
b[0][2].triplesContext!=null))for(g=0;g<b[0][2].triplesContext.length;g++)h=b[0][2].triplesContext[g],h.graph=null,c.push(h);return{token:"quads",quadsContext:c}}(g[0],g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[47] Quads");v[d]={nextPos:b,result:h};return h}function eb(){var d="QuadsNotTriples@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,5)==="GRAPH"?(i="GRAPH",b+=5):(i=null,m&&j('"GRAPH"')),i===null&&
(a.substr(b,5)==="graph"?(i="graph",b+=5):(i=null,m&&j('"graph"')),i=i!==null?i:null),i!==null){for(var t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null)if(y=ia(),y!==null){for(var o=[],f=q();f!==null;)o.push(f),f=q();if(o!==null)if(a.substr(b,1)==="{"?(f="{",b+=1):(f=null,m&&j('"{"')),f!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();if(n!==null)if(l=ma(),l=l!==null?l:"",l!==null){for(var s=[],z=q();z!==null;)s.push(z),z=q();if(s!==null)if(a.substr(b,1)==="}"?(z="}",b+=1):(z=null,m&&j('"}"')),
z!==null){for(var r=[],u=q();u!==null;)r.push(u),u=q();r!==null?g=[g,i,t,y,o,f,n,l,s,z,r]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){for(var c=[],g=0;g<b.triplesContext.length;g++){var h=b.triplesContext[g];h.graph=a;c.push(h)}return{token:"quadsnottriples",quadsContext:c}}(g[3],g[7]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[48] QuadsNotTriples");
v[d]={nextPos:b,result:h};return h}function ma(){var d="TriplesTemplate@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=fb();if(g!==null){for(var i=b,t=[],y=q();y!==null;)t.push(y),y=q();if(t!==null)if(a.substr(b,1)==="."?(y=".",b+=1):(y=null,m&&j('"."')),y!==null){for(var o=[],f=q();f!==null;)o.push(f),f=q();o!==null?(f=ma(),f=f!==null?f:"",f!==null?t=[t,y,o,f]:(t=null,b=i)):(t=null,b=i)}else t=null,b=i;else t=null,b=i;i=t!==null?t:"";i!==null?g=[g,i]:(g=null,b=h)}else g=null,
b=h;h=g!==null?function(a,b){var c=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(c=c.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:c}}(g[0],g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[49] TriplesTemplate");v[d]={nextPos:b,result:h};return h}function X(){var d="GroupGraphPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="{"){var g="{";b+=1}else g=null,m&&j('"{"');if(g!==null){for(var i=
[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=x(),t!==null){for(var y=[],o=q();o!==null;)y.push(o),o=q();y!==null?(a.substr(b,1)==="}"?(o="}",b+=1):(o=null,m&&j('"}"')),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[2]:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;a.substr(b,1)==="{"?(g="{",b+=1):(g=null,m&&j('"{"'));if(g!==null){i=[];for(t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=sb(),t!==null){y=[];for(o=q();o!==
null;)y.push(o),o=q();y!==null?(a.substr(b,1)==="}"?(o="}",b+=1):(o=null,m&&j('"}"')),o!==null?g=[g,i,t,y,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[2]:null;h===null&&(h=null,b=k);k=h!==null?h:null}(m=e)&&k===null&&j("[50] GroupGraphPattern");v[d]={nextPos:b,result:k};return k}function sb(){var d="GroupGraphPatternSub@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=xa(),g=g!==null?g:"";if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),
t=q();if(i!==null){var t=[],y=b,o=gb();if(o!==null){for(var f=[],n=q();n!==null;)f.push(n),n=q();if(f!==null)if(a.substr(b,1)==="."?(n=".",b+=1):(n=null,m&&j('"."')),n=n!==null?n:"",n!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=xa(),s=s!==null?s:"",s!==null?o=[o,f,n,l,s]:(o=null,b=y)):(o=null,b=y)}else o=null,b=y;else o=null,b=y}else o=null,b=y;for(;o!==null;)if(t.push(o),y=b,o=gb(),o!==null){f=[];for(n=q();n!==null;)f.push(n),n=q();if(f!==null)if(a.substr(b,1)==="."?(n=".",b+=
1):(n=null,m&&j('"."')),n=n!==null?n:"",n!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=xa(),s=s!==null?s:"",s!==null?o=[o,f,n,l,s]:(o=null,b=y)):(o=null,b=y)}else o=null,b=y;else o=null,b=y}else o=null,b=y;t!==null?g=[g,i,t]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c=[];a!=null&&a!=[]&&c.push(a);for(var g=0;g<b.length;g++)for(var h=0;h<b[g].length;h++)b[g][h].token!=null&&c.push(b[g][h]);for(var d=[],e=[],j=[],g=0;g<c.length;g++)if(c[g].token!="triplespattern"&&
c[g].token!="filter"){if(e.length!=0||j.length!=0){for(var k=[],h=0;h<e.length;h++)k=k.concat(e[h].triplesContext);k.length>0&&d.push({token:"basicgraphpattern",triplesContext:k});e=[]}d.push(c[g])}else c[g].token==="triplespattern"?e.push(c[g]):j.push(c[g]);if(e.length!=0||j.length!=0){k=[];for(h=0;h<e.length;h++)k=k.concat(e[h].triplesContext);k.length>0&&d.push({token:"basicgraphpattern",triplesContext:k})}return{token:"groupgraphpattern",patterns:d,filters:j}}(g[0],g[2]):null;h===null&&(h=null,
b=k);(m=e)&&h===null&&j("[51] GroupGraphPatternSub");v[d]={nextPos:b,result:h};return h}function xa(){var d="TriplesBlock@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=tb();if(g!==null){for(var i=b,t=[],f=q();f!==null;)t.push(f),f=q();if(t!==null)if(a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."')),f!==null){var o=xa(),o=o!==null?o:"";o!==null?t=[t,f,o]:(t=null,b=i)}else t=null,b=i;else t=null,b=i;i=t!==null?t:"";i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,
b){var c=a.triplesContext;typeof b==="object"&&b.length!=null&&b[2].triplesContext!=null&&(c=c.concat(b[2].triplesContext));return{token:"triplespattern",triplesContext:c}}(g[0],g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[54] TriplesBlock");v[d]={nextPos:b,result:h};return h}function gb(){var a="GraphPatternNotTriples@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=ub();d===null&&(d=vb(),d===null&&(d=wb(),d===null&&(d=xb(),d===null&&(d=yb(),d===null&&(d=zb(),d=d!==null?d:null)))));
(m=c)&&d===null&&j("[53] GraphPatternNotTriples");v[a]={nextPos:b,result:d};return d}function vb(){var d="OptionalGraphPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,8)==="OPTIONAL"?(i="OPTIONAL",b+=8):(i=null,m&&j('"OPTIONAL"')),i===null&&(a.substr(b,8)==="optional"?(i="optional",b+=8):(i=null,m&&j('"optional"')),i=i!==null?i:null),i!==null){for(var t=[],f=q();f!==null;)t.push(f),f=q();t!==null?(f=X(),f!==
null?g=[g,i,t,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?{token:"optionalgraphpattern",value:g[3]}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[54] OptionalGraphPattern");v[d]={nextPos:b,result:h};return h}function xb(){var d="GraphGraphPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,5)==="GRAPH"?(i="GRAPH",b+=5):(i=null,m&&j('"GRAPH"')),i===null&&(a.substr(b,5)==="graph"?
(i="graph",b+=5):(i=null,m&&j('"graph"')),i=i!==null?i:null),i!==null){for(var t=[],f=q();f!==null;)t.push(f),f=q();if(t!==null)if(f=ia(),f!==null){for(var o=[],n=q();n!==null;)o.push(n),n=q();o!==null?(n=X(),n!==null?g=[g,i,t,f,o,n]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){for(var c=0;c<b.patterns.length;c++)for(var g=b.patterns[c],h=0;h<g.triplesContext.length;h++)g.triplesContext[h].graph=a;b.token="groupgraphpattern";return b}(g[3],
g[5]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[55] GraphGraphPattern");v[d]={nextPos:b,result:h};return h}function yb(){var d="ServiceGraphPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,7)==="SERVICE"){var g="SERVICE";b+=7}else g=null,m&&j('"SERVICE"');if(g!==null){var i=ia();if(i!==null){var t=X();t!==null?g=[g,i,t]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?{token:"servicegraphpattern",status:"todo",value:[g[1],g[2]]}:null;h===null&&(h=
null,b=k);(m=e)&&h===null&&j("[56] ServiceGraphPattern");v[d]={nextPos:b,result:h};return h}function wb(){var d="MinusGraphPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="MINUS"){var g="MINUS";b+=5}else g=null,m&&j('"MINUS"');if(g!==null){var i=X();i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?{token:"minusgraphpattern",status:"todo",value:g[1]}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[57] MinusGraphPattern");v[d]={nextPos:b,result:h};
return h}function ub(){var d="GroupOrUnionGraphPattern@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=X();if(g!==null){for(var i=[],t=b,f=[],o=q();o!==null;)f.push(o),o=q();if(f!==null)if(a.substr(b,5)==="UNION"?(o="UNION",b+=5):(o=null,m&&j('"UNION"')),o===null&&(a.substr(b,5)==="union"?(o="union",b+=5):(o=null,m&&j('"union"')),o=o!==null?o:null),o!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();n!==null?(l=X(),l!==null?f=[f,o,n,l]:(f=null,b=t)):(f=null,b=t)}else f=null,
b=t;else f=null,b=t;for(;f!==null;){i.push(f);t=b;f=[];for(o=q();o!==null;)f.push(o),o=q();if(f!==null)if(a.substr(b,5)==="UNION"?(o="UNION",b+=5):(o=null,m&&j('"UNION"')),o===null&&(a.substr(b,5)==="union"?(o="union",b+=5):(o=null,m&&j('"union"')),o=o!==null?o:null),o!==null){n=[];for(l=q();l!==null;)n.push(l),l=q();n!==null?(l=X(),l!==null?f=[f,o,n,l]:(f=null,b=t)):(f=null,b=t)}else f=null,b=t;else f=null,b=t}i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b.length===0)return a;
else{for(var c={token:"graphunionpattern",value:[a]},g=0;g<b.length;g++)g==b.length-1?c.value.push(b[g][3]):(c.value.push(b[g][3]),c={token:"graphunionpattern",value:[c]});return c}}(g[0],g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[58] GroupOrUnionGraphPattern");v[d]={nextPos:b,result:h};return h}function zb(){var d="Filter@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var k=b,h=b,g=[],i=q();i!==null;)g.push(i),i=q();if(g!==null)if(a.substr(b,6)==="FILTER"?(i="FILTER",b+=6):
(i=null,m&&j('"FILTER"')),i===null&&(a.substr(b,6)==="filter"?(i="filter",b+=6):(i=null,m&&j('"filter"')),i=i!==null?i:null),i!==null){for(var t=[],f=q();f!==null;)t.push(f),f=q();t!==null?(f=wa(),f!==null?g=[g,i,t,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?{token:"filter",value:g[3]}:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[59] Filter");v[d]={nextPos:b,result:h};return h}function wa(){var a="Constraint@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=
Ha();d===null&&(d=Ga(),d===null&&(d=db(),d=d!==null?d:null));(m=c)&&d===null&&j("[60] Constraint");v[a]={nextPos:b,result:d};return d}function db(){var a="FunctionCall@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=S();if(g!==null){var e=hb();e!==null?g=[g,e]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"irireforfunction"};c.iriref=a;c.args=b.value;return c}(g[0],g[1]):null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[61] FunctionCall");
v[a]={nextPos:b,result:h};return h}function hb(){var d="ArgList@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=ja()!==null?{token:"args",value:[]}:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;if(a.substr(b,1)==="("){var g="(";b+=1}else g=null,m&&j('"("');if(g!==null){if(a.substr(b,8)==="DISTINCT"){var i="DISTINCT";b+=8}else i=null,m&&j('"DISTINCT"');i===null&&(a.substr(b,8)==="distinct"?(i="distinct",b+=8):(i=null,m&&j('"distinct"')),i=i!==null?i:null);i=i!==null?i:"";if(i!==
null){var t=M();if(t!==null){var f=[],o=b;if(a.substr(b,1)===","){var n=",";b+=1}else n=null,m&&j('","');if(n!==null){var q=M();q!==null?n=[n,q]:(n=null,b=o)}else n=null,b=o;for(;n!==null;)f.push(n),o=b,a.substr(b,1)===","?(n=",",b+=1):(n=null,m&&j('","')),n!==null?(q=M(),q!==null?n=[n,q]:(n=null,b=o)):(n=null,b=o);f!==null?(a.substr(b,1)===")"?(o=")",b+=1):(o=null,m&&j('")"')),o!==null?g=[g,i,t,f,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h}else g=null,b=h}else g=null,b=h;h=g!==null?function(a,
b,c){for(var g=[],h=0;h<c.length;h++)g.push(c[h][1]);c={token:"args"};c.value=[b].concat(g);c.distinct=a!=null&&a.toUpperCase()==="DISTINCT"?!0:!1;return c}(g[1],g[2],g[3]):null;h===null&&(h=null,b=k);k=h!==null?h:null}(m=e)&&k===null&&j("[62] ArgList");v[d]={nextPos:b,result:k};return k}function Ab(){var d="ExpressionList@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=ja()!==null?{token:"args",value:[]}:null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;if(a.substr(b,1)==="("){var g=
"(";b+=1}else g=null,m&&j('"("');if(g!==null){var i=M();if(i!==null){var t=[],f=b;if(a.substr(b,1)===","){var o=",";b+=1}else o=null,m&&j('","');if(o!==null){var n=M();n!==null?o=[o,n]:(o=null,b=f)}else o=null,b=f;for(;o!==null;)t.push(o),f=b,a.substr(b,1)===","?(o=",",b+=1):(o=null,m&&j('","')),o!==null?(n=M(),n!==null?o=[o,n]:(o=null,b=f)):(o=null,b=f);t!==null?(a.substr(b,1)===")"?(f=")",b+=1):(f=null,m&&j('")"')),f!==null?g=[g,i,t,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h}else g=null,b=h;
h=g!==null?function(a,b){for(var c=[],g=0;g<b.length;g++)c.push(b[g][1]);g={token:"args"};g.value=[a].concat(c);return g}(g[1],g[2]):null;h===null&&(h=null,b=k);k=h!==null?h:null}(m=e)&&k===null&&j("[63] ExpressionList");v[d]={nextPos:b,result:k};return k}function rb(){var d="ConstructTemplate@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="{"){var g="{";b+=1}else g=null,m&&j('"{"');if(g!==null){for(var i=[],t=q();t!==null;)i.push(t),t=q();if(i!==null)if(t=ib(),
t=t!==null?t:"",t!==null){for(var f=[],o=q();o!==null;)f.push(o),o=q();f!==null?(a.substr(b,1)==="}"?(o="}",b+=1):(o=null,m&&j('"}"')),o!==null?g=[g,i,t,f,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[2]:null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[64] ConstructTemplate");v[d]={nextPos:b,result:h};return h}function ib(){var d="ConstructTriples@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b,g=fb();if(g!==null){for(var i=b,t=[],f=q();f!==
null;)t.push(f),f=q();if(t!==null)if(a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."')),f!==null){for(var o=[],n=q();n!==null;)o.push(n),n=q();o!==null?(n=ib(),n=n!==null?n:"",n!==null?t=[t,f,o,n]:(t=null,b=i)):(t=null,b=i)}else t=null,b=i;else t=null,b=i;i=t!==null?t:"";i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){var c=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(c=c.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:c}}(g[0],
g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[65] ConstructTriples");v[d]={nextPos:b,result:h};return h}function fb(){var a="TriplesSameSubject@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var d=b,h=b,g=[],e=q();e!==null;)g.push(e),e=q();if(g!==null)if(e=La(),e!==null){for(var k=[],i=q();i!==null;)k.push(i),i=q();k!==null?(i=ya(),i!==null?g=[g,e,k,i]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){var c=b.triplesContext;if(b.pairs)for(var g=
0;g<b.pairs.length;g++){var h=b.pairs[g],d=null;h[1].length!=null&&(h[1]=h[1][0]);a.token&&a.token==="triplesnodecollection"?(d={subject:a.chainSubject[0],predicate:h[0],object:h[1]},c.push(d),c=c.concat(a.triplesContext)):(d={subject:a,predicate:h[0],object:h[1]},c.push(d))}g={token:"triplessamesubject"};g.triplesContext=c;g.chainSubject=a;return g}(g[1],g[3]):null;h===null&&(h=null,b=d);if(h!==null)d=h;else{h=d=b;g=[];for(e=q();e!==null;)g.push(e),e=q();if(g!==null)if(e=Ma(),e!==null){k=[];for(i=
q();i!==null;)k.push(i),i=q();k!==null?(i=Bb(),i!==null?g=[g,e,k,i]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){var c=a.triplesContext,g=a.chainSubject;if(b.pairs)for(var h=0;h<b.pairs.length;h++){var d=b.pairs[h];d[1].length!=null&&(d[1]=d[1][0]);if(a.token==="triplesnodecollection")for(var e=0;e<g.length;e++){var j=g[e];if(j.triplesContext!=null){var i={subject:j.chainSubject,predicate:d[0],object:d[1]};c.concat(j.triplesContext)}else i={subject:g[e],predicate:d[0],
object:d[1]},c.push(i)}else i={subject:g,predicate:d[0],object:d[1]},c.push(i)}h={token:"triplessamesubject"};h.triplesContext=c;h.chainSubject=g;return h}(g[1],g[3]):null;h===null&&(h=null,b=d);d=h!==null?h:null}(m=c)&&d===null&&j("[66] TriplesSameSubject");v[a]={nextPos:b,result:d};return d}function ya(){var d="PropertyListNotEmpty@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=Na();if(g!==null){for(var k=[],t=q();t!==null;)k.push(t),t=q();if(k!==null)if(t=ka(),t!==null){for(var f=
[],o=b,n=[],l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,1)===";"?(l=";",b+=1):(l=null,m&&j('";"')),l!==null){for(var s=[],z=q();z!==null;)s.push(z),z=q();if(s!==null){var z=b,r=Na();if(r!==null){for(var u=[],w=q();w!==null;)u.push(w),w=q();u!==null?(w=ka(),w!==null?r=[r,u,w]:(r=null,b=z)):(r=null,b=z)}else r=null,b=z;z=r!==null?r:"";z!==null?n=[n,l,s,z]:(n=null,b=o)}else n=null,b=o}else n=null,b=o;else n=null,b=o;for(;n!==null;){f.push(n);o=b;n=[];for(l=q();l!==null;)n.push(l),l=q();
if(n!==null)if(a.substr(b,1)===";"?(l=";",b+=1):(l=null,m&&j('";"')),l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();if(s!==null){z=b;r=Na();if(r!==null){u=[];for(w=q();w!==null;)u.push(w),w=q();u!==null?(w=ka(),w!==null?r=[r,u,w]:(r=null,b=z)):(r=null,b=z)}else r=null,b=z;z=r!==null?r:"";z!==null?n=[n,l,s,z]:(n=null,b=o)}else n=null,b=o}else n=null,b=o;else n=null,b=o}f!==null?g=[g,k,t,f]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c){for(var g={token:"propertylist"},
h=[],d=[],e=0;e<b.length;e++)b[e].triplesContext!=null?(h=h.concat(b[e].triplesContext),b[e].token==="triplesnodecollection"&&b[e].chainSubject.length!=null?d.push([a,b[e].chainSubject[0]]):d.push([a,b[e].chainSubject])):d.push([a,b[e]]);for(e=0;e<c.length;e++)for(var b=c[e][3],a=b[0],b=b[2]||[],j=0;j<b.length;j++)b[j].triplesContext!=null?(h=h.concat(b[j].triplesContext),d.push([a,b[j].chainSubject])):d.push([a,b[j]]);g.pairs=d;g.triplesContext=h;return g}(g[0],g[2],g[3]):null;h===null&&(h=null,
b=i);(m=e)&&h===null&&j("[67] PropertyListNotEmpty");v[d]={nextPos:b,result:h};return h}function Bb(){var a="PropertyList@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=ya(),d=d!==null?d:"";(m=c)&&d===null&&j("[68] PropertyList");v[a]={nextPos:b,result:d};return d}function ka(){var d="ObjectList@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=na();if(g!==null){for(var k=[],t=q();t!==null;)k.push(t),t=q();if(k!==null){var t=[],f=b;if(a.substr(b,1)===","){var o=",";b+=
1}else o=null,m&&j('","');if(o!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();n!==null?(l=na(),l!==null?o=[o,n,l]:(o=null,b=f)):(o=null,b=f)}else o=null,b=f;for(;o!==null;)if(t.push(o),f=b,a.substr(b,1)===","?(o=",",b+=1):(o=null,m&&j('","')),o!==null){n=[];for(l=q();l!==null;)n.push(l),l=q();n!==null?(l=na(),l!==null?o=[o,n,l]:(o=null,b=f)):(o=null,b=f)}else o=null,b=f;t!==null?g=[g,k,t]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c=[];c.push(a);for(var g=0;g<
b.length;g++)for(var h=0;h<b[g].length;h++)typeof b[g][h]=="object"&&b[g][h].token!=null&&c.push(b[g][h]);return c}(g[0],g[2]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[69] ObjectList");v[d]={nextPos:b,result:h};return h}function Na(){var d="Verb@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=ia();if(i===null){i=b;if(a.substr(b,1)==="a"){var h="a";b+=1}else h=null,m&&j('"a"');h=h!==null?{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:
null;h===null&&(h=null,b=i);i=h!==null?h:null}(m=e)&&i===null&&j("[71] Verb");v[d]={nextPos:b,result:i};return i}function tb(){var a="TriplesSameSubjectPath@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var d=b,h=b,g=[],e=q();e!==null;)g.push(e),e=q();if(g!==null)if(e=La(),e!==null){for(var i=[],k=q();k!==null;)i.push(k),k=q();i!==null?(k=Cb(),k!==null?g=[g,e,i,k]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){var c=b.triplesContext;if(b.pairs)for(var g=
0;g<b.pairs.length;g++){var h=b.pairs[g],d=null;h[1].length!=null&&(h[1]=h[1][0]);a.token&&a.token==="triplesnodecollection"?(d={subject:a.chainSubject[0],predicate:h[0],object:h[1]},c.push(d),c=c.concat(a.triplesContext)):(d={subject:a,predicate:h[0],object:h[1]},c.push(d))}g={token:"triplessamesubject"};g.triplesContext=c;g.chainSubject=a;return g}(g[1],g[3]):null;h===null&&(h=null,b=d);if(h!==null)d=h;else{h=d=b;g=[];for(e=q();e!==null;)g.push(e),e=q();if(g!==null)if(e=Ma(),e!==null){i=[];for(k=
q();k!==null;)i.push(k),k=q();i!==null?(k=Db(),k!==null?g=[g,e,i,k]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?function(a,b){var c=a.triplesContext,g=a.chainSubject;if(b.pairs)for(var h=0;h<b.pairs.length;h++){var d=b.pairs[h];d[1].length!=null&&(d[1]=d[1][0]);if(a.token==="triplesnodecollection")for(var e=0;e<g.length;e++){var j=g[e];if(j.triplesContext!=null){var i={subject:j.chainSubject,predicate:d[0],object:d[1]};c.concat(j.triplesContext)}else i={subject:g[e],predicate:d[0],
object:d[1]},c.push(i)}else i={subject:g,predicate:d[0],object:d[1]},c.push(i)}h={token:"triplessamesubject"};h.triplesContext=c;h.chainSubject=g;return h}(g[1],g[3]):null;h===null&&(h=null,b=d);d=h!==null?h:null}(m=c)&&d===null&&j("[72] TriplesSameSubjectPath");v[a]={nextPos:b,result:d};return d}function Cb(){var d="PropertyListNotEmptyPath@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=Oa();g===null&&(g=R(),g=g!==null?g:null);if(g!==null){for(var k=[],t=q();t!==null;)k.push(t),
t=q();if(k!==null)if(t=ka(),t!==null){for(var f=[],o=b,n=[],l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,1)===";"?(l=";",b+=1):(l=null,m&&j('";"')),l!==null){for(var s=[],z=q();z!==null;)s.push(z),z=q();if(s!==null){var z=b,r=Oa();r===null&&(r=R(),r=r!==null?r:null);if(r!==null){var u=ka();u!==null?r=[r,u]:(r=null,b=z)}else r=null,b=z;z=r!==null?r:"";z!==null?n=[n,l,s,z]:(n=null,b=o)}else n=null,b=o}else n=null,b=o;else n=null,b=o;for(;n!==null;){f.push(n);o=b;n=[];for(l=q();l!==null;)n.push(l),
l=q();if(n!==null)if(a.substr(b,1)===";"?(l=";",b+=1):(l=null,m&&j('";"')),l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();s!==null?(z=b,r=Oa(),r===null&&(r=R(),r=r!==null?r:null),r!==null?(u=ka(),u!==null?r=[r,u]:(r=null,b=z)):(r=null,b=z),z=r!==null?r:"",z!==null?n=[n,l,s,z]:(n=null,b=o)):(n=null,b=o)}else n=null,b=o;else n=null,b=o}f!==null?g=[g,k,t,f]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c){token={token:"propertylist"};for(var g=[],h=[],d=0;d<
b.length;d++)b[d].triplesContext!=null?(g=g.concat(b[d].triplesContext),b[d].token==="triplesnodecollection"&&b[d].chainSubject.length!=null?h.push([a,b[d].chainSubject[0]]):h.push([a,b[d].chainSubject])):h.push([a,b[d]]);for(d=0;d<c.length;d++)for(var b=c[d][3],a=b[0],b=b[1]||[],e=0;e<b.length;e++)b[e].triplesContext!=null?(g=g.concat(b[e].triplesContext),h.push([a,b[e].chainSubject])):h.push([a,b[e]]);token.pairs=h;token.triplesContext=g;return token}(g[0],g[2],g[3]):null;h===null&&(h=null,b=i);
(m=e)&&h===null&&j("[73] PropertyListNotEmptyPath");v[d]={nextPos:b,result:h};return h}function Db(){var a="PropertyListPath@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=ya(),d=d!==null?d:"";(m=c)&&d===null&&j("[74] PropertyListPath");v[a]={nextPos:b,result:d};return d}function Oa(){var a="VerbPath@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=jb(),h=h!==null?h:null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[75]");v[a]={nextPos:b,result:h};return h}function jb(){var d=
"PathAlternative@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=Pa();if(g!==null){var k=[],t=b;if(a.substr(b,1)==="|"){var f="|";b+=1}else f=null,m&&j('"|"');if(f!==null){var o=Pa();o!==null?f=[f,o]:(f=null,b=t)}else f=null,b=t;for(;f!==null;)k.push(f),t=b,a.substr(b,1)==="|"?(f="|",b+=1):(f=null,m&&j('"|"')),f!==null?(o=Pa(),o!==null?f=[f,o]:(f=null,b=t)):(f=null,b=t);k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var c=
[],g=0;g<b.length;g++)c.push(b[1]);g={token:"path",kind:"alternative"};g.value=c;return g}}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[78] PathAlternative");v[d]={nextPos:b,result:h};return h}function Pa(){var d="PathSequence@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=Qa();if(g!==null){var k=[],t=b;if(a.substr(b,1)==="/"){var f="/";b+=1}else f=null,m&&j('"/"');if(f!==null){var o=Qa();o!==null?f=[f,o]:(f=null,b=t)}else f=null,b=t;for(;f!==null;)k.push(f),t=
b,a.substr(b,1)==="/"?(f="/",b+=1):(f=null,m&&j('"/"')),f!==null?(o=Qa(),o!==null?f=[f,o]:(f=null,b=t)):(f=null,b=t);k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var c=[a],g=0;g<b.length;g++)c.push(b[g][1]);g={token:"path",kind:"sequence"};g.value=c;return g}}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[79] PathSequence");v[d]={nextPos:b,result:h};return h}function kb(){var a="PathElt@"+b,c=v[a];if(c)return b=c.nextPos,
c.result;c=m;m=!1;var d=b,h=b,g=Eb();if(g!==null){var e=Fb(),e=e!==null?e:"";e!==null?g=[g,e]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(a.token&&a.token!="path"&&b=="")return a;else if(a.token&&a.token!=c&&b!=""){var c={token:"path",kind:"element"};c.value=a;c.modifier=b;return c}else return a.modifier=b,a}(g[0],g[1]):null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[88] PathElt");v[a]={nextPos:b,result:h};return h}function Qa(){var d="PathEltOrInverse@"+b,e=v[d];if(e)return b=e.nextPos,
e.result;e=m;m=!1;var i=kb();if(i===null){var h=i=b;if(a.substr(b,1)==="^"){var g="^";b+=1}else g=null,m&&j('"^"');if(g!==null){var k=kb();k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){var b={token:"path",kind:"inversePath"};b.value=a;return b}(g[1]):null;h===null&&(h=null,b=i);i=h!==null?h:null}(m=e)&&i===null&&j("[81] PathEltOrInverse");v[d]={nextPos:b,result:i};return i}function Fb(){var d="PathMod@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;if(a.substr(b,1)==="*"){var i=
"*";b+=1}else i=null,m&&j('"*"');if(i===null&&(a.substr(b,1)==="?"?(i="?",b+=1):(i=null,m&&j('"?"')),i===null&&(a.substr(b,1)==="+"?(i="+",b+=1):(i=null,m&&j('"+"')),i===null))){i=b;if(a.substr(b,1)==="{"){var h="{";b+=1}else h=null,m&&j('"{"');if(h!==null){var g=b,k=da();if(k!==null){var t=b;if(a.substr(b,1)===","){var f=",";b+=1}else f=null,m&&j('","');if(f!==null){if(a.substr(b,1)==="}"){var o="}";b+=1}else o=null,m&&j('"}"');if(o===null){var o=b,n=da();if(n!==null){if(a.substr(b,1)==="}"){var q=
"}";b+=1}else q=null,m&&j('"}"');q!==null?n=[n,q]:(n=null,b=o)}else n=null,b=o;o=n!==null?n:null}o!==null?f=[f,o]:(f=null,b=t)}else f=null,b=t;f!==null?t=f:(a.substr(b,1)==="}"?(t="}",b+=1):(t=null,m&&j('"}"')),t=t!==null?t:null);t!==null?k=[k,t]:(k=null,b=g)}else k=null,b=g;k!==null?g=k:(g=b,a.substr(b,1)===","?(k=",",b+=1):(k=null,m&&j('","')),k!==null?(t=da(),t!==null?(a.substr(b,1)==="}"?(f="}",b+=1):(f=null,m&&j('"}"')),f!==null?k=[k,t,f]:(k=null,b=g)):(k=null,b=g)):(k=null,b=g),g=k!==null?k:
null);g!==null?h=[h,g]:(h=null,b=i)}else h=null,b=i;i=h!==null?h:null}(m=e)&&i===null&&j("[82] PathMod");v[d]={nextPos:b,result:i};return i}function Eb(){var d="PathPrimary@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=S();if(i===null){i=b;if(a.substr(b,1)==="a"){var h="a";b+=1}else h=null,m&&j('"a"');h=h!==null?{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:null;h===null&&(h=null,b=i);if(h!==null)i=h;else{i=b;a.substr(b,1)==="!"?(h="!",
b+=1):(h=null,m&&j('"!"'));if(h!==null){var g=Gb();g!==null?h=[h,g]:(h=null,b=i)}else h=null,b=i;if(h!==null)i=h;else{h=i=b;a.substr(b,1)==="("?(g="(",b+=1):(g=null,m&&j('"("'));if(g!==null){var k=jb();if(k!==null){if(a.substr(b,1)===")"){var t=")";b+=1}else t=null,m&&j('")"');t!==null?g=[g,k,t]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=i);i=h!==null?h:null}}}(m=e)&&i===null&&j("[83] PathPrimary");v[d]={nextPos:b,result:i};return i}function Gb(){var d="PathNegatedPropertySet@"+
b,e=v[d];if(e)return b=e.nextPos,e.result;e=za();if(e===null){e=b;if(a.substr(b,1)==="("){var i="(";b+=1}else i=null,m&&j('"("');if(i!==null){var h=b,g=za();if(g!==null){var k=[],t=b;if(a.substr(b,1)==="|"){var f="|";b+=1}else f=null,m&&j('"|"');if(f!==null){var o=za();o!==null?f=[f,o]:(f=null,b=t)}else f=null,b=t;for(;f!==null;)k.push(f),t=b,a.substr(b,1)==="|"?(f="|",b+=1):(f=null,m&&j('"|"')),f!==null?(o=za(),o!==null?f=[f,o]:(f=null,b=t)):(f=null,b=t);k!==null?g=[g,k]:(g=null,b=h)}else g=null,
b=h;h=g!==null?g:"";h!==null?(a.substr(b,1)===")"?(g=")",b+=1):(g=null,m&&j('")"')),g!==null?i=[i,h,g]:(i=null,b=e)):(i=null,b=e)}else i=null,b=e;e=i!==null?i:null}v[d]={nextPos:b,result:e};return e}function za(){var d="PathOneInPropertySet@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=S();if(i===null&&(a.substr(b,1)==="a"?(i="a",b+=1):(i=null,m&&j('"a"')),i===null)){i=b;if(a.substr(b,1)==="^"){var h="^";b+=1}else h=null,m&&j('"^"');if(h!==null){var g=S();g===null&&(a.substr(b,1)==="a"?
(g="a",b+=1):(g=null,m&&j('"a"')),g=g!==null?g:null);g!==null?h=[h,g]:(h=null,b=i)}else h=null,b=i;i=h!==null?h:null}(m=e)&&i===null&&j("[85] PathOneInPropertySet");v[d]={nextPos:b,result:i};return i}function Ma(){var a="TriplesNode@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=Hb(),h=h!==null?function(a){for(var b=[],c=[],d=null,h=0;h<a.length;h++)ea++,d=null,a[h].chainSubject==null&&a[h].triplesContext==null?d=a[h]:(d=a[h].chainSubject,b=b.concat(nextSubject.triplesContext)),d=
{subject:{token:"blank",value:"_:"+ea},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:d},h==0&&c.push(d.subject),b.push(d),d=h===a.length-1?{subject:{token:"blank",value:"_:"+ea},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+ea},predicate:{token:"uri",
prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(ea+1)}},b.push(d);return{token:"triplesnodecollection",triplesContext:b,chainSubject:c}}(h):null;h===null&&(h=null,b=d);h!==null?d=h:(d=Ib(),d=d!==null?d:null);(m=c)&&d===null&&j("[87] TriplesNode");v[a]={nextPos:b,result:d};return d}function Ib(){var d="BlankNodePropertyList@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var i=b,h=b,g=[],k=q();k!==null;)g.push(k),k=q();if(g!==
null)if(a.substr(b,1)==="["?(k="[",b+=1):(k=null,m&&j('"["')),k!==null){for(var t=[],f=q();f!==null;)t.push(f),f=q();if(t!==null)if(f=ya(),f!==null){for(var o=[],n=q();n!==null;)o.push(n),n=q();if(o!==null)if(a.substr(b,1)==="]"?(n="]",b+=1):(n=null,m&&j('"]"')),n!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?g=[g,k,t,f,o,n,l]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?function(a){ea++;for(var b={token:"blank",
value:"_:"+ea},c=[],g=0;g<a.pairs.length;g++){var d=a.pairs[g],h={};h.subject=b;h.predicate=d[0];d[1].length!=null&&(d[1]=d[1][0]);h.object=d[1];c.push(h)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:a.triplesContext.concat(c),chainSubject:b}}(g[3]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[88] BlankNodePropertyList");v[d]={nextPos:b,result:h};return h}function Hb(){var d="Collection@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;for(var i=b,h=b,g=[],k=q();k!==
null;)g.push(k),k=q();if(g!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){for(var t=[],f=q();f!==null;)t.push(f),f=q();if(t!==null){var o=na();if(o!==null)for(f=[];o!==null;)f.push(o),o=na();else f=null;if(f!==null){for(var o=[],n=q();n!==null;)o.push(n),n=q();if(o!==null)if(a.substr(b,1)===")"?(n=")",b+=1):(n=null,m&&j('")"')),n!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?g=[g,k,t,f,o,n,l]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h}else g=
null,b=h}else g=null,b=h;else g=null,b=h;h=g!==null?g[3]:null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[89] Collection");v[d]={nextPos:b,result:h};return h}function na(){var a="GraphNode@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var d=b,h=b,g=[],e=q();e!==null;)g.push(e),e=q();if(g!==null)if(e=La(),e!==null){for(var i=[],k=q();k!==null;)i.push(k),k=q();i!==null?g=[g,e,i]:(g=null,b=h)}else g=null,b=h;else g=null,b=h;if(g!==null)h=g;else{h=b;g=[];for(e=q();e!==null;)g.push(e),e=q();
if(g!==null)if(e=Ma(),e!==null){i=[];for(k=q();k!==null;)i.push(k),k=q();i!==null?g=[g,e,i]:(g=null,b=h)}else g=null,b=h;else g=null,b=h;h=g!==null?g:null}h=h!==null?h[1]:null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[90] GraphNode");v[a]={nextPos:b,result:h};return h}function La(){var a="VarOrTerm@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=R();d===null&&(d=Jb(),d=d!==null?d:null);(m=c)&&d===null&&j("[91] VarOrTerm");v[a]={nextPos:b,result:d};return d}function ia(){var a="VarOrIRIref@"+
b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=R();d===null&&(d=S(),d=d!==null?d:null);(m=c)&&d===null&&j("[92] VarOrIRIref");v[a]={nextPos:b,result:d};return d}function R(){var a="Var@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=Kb();h===null&&(h=Lb(),h=h!==null?h:null);h=h!==null?function(a){var b={token:"var"};b.value=a;return b}(h):null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[93] Var");v[a]={nextPos:b,result:h};return h}function Jb(){var a="GraphTerm@"+b,c=v[a];
if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=S();d===null&&(d=Ia(),d===null&&(d=Ja(),d===null&&(d=Ka(),d===null&&(d=Mb(),d===null&&(d=ja(),d=d!==null?d:null)))));(m=c)&&d===null&&j("[94] GraphTerm");v[a]={nextPos:b,result:d};return d}function M(){var d="ConditionalOrExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=Ra();if(g!==null){for(var k=[],f=b,n=[],o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="||"?(o="||",b+=2):(o=null,m&&j('"||"')),o!==null){for(var l=
[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=Ra(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;for(;n!==null;){k.push(n);f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="||"?(o="||",b+=2):(o=null,m&&j('"||"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=Ra(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f}k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b.length===
0)return a;for(var c={token:"expression",expressionType:"conditionalor"},d=[a],g=0;g<b.length;g++)d.push(b[g][3]);c.operands=d;return c}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[96] ConditionalOrExpression");v[d]={nextPos:b,result:h};return h}function Ra(){var d="ConditionalAndExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=Sa();if(g!==null){for(var k=[],f=b,n=[],o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="&&"?(o="&&",b+=2):(o=null,
m&&j('"&&"')),o!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=Sa(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;for(;n!==null;){k.push(n);f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="&&"?(o="&&",b+=2):(o=null,m&&j('"&&"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=Sa(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f}k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=
h;h=g!==null?function(a,b){if(b.length===0)return a;for(var c={token:"expression",expressionType:"conditionaland"},d=[a],g=0;g<b.length;g++)d.push(b[g][3]);c.operands=d;return c}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[97] ConditionalAndExpression");v[d]={nextPos:b,result:h};return h}function Sa(){var d="RelationalExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=V();if(g!==null){for(var k=[],f=b,n=[],o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,
1)==="="?(o="=",b+=1):(o=null,m&&j('"="')),o!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="!="?(o="!=",b+=2):(o=null,m&&j('"!="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=
b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="<"?(o="<",b+=1):(o=null,m&&j('"<"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)===">"?(o=">",b+=1):(o=null,m&&j('">"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,
b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="<="?(o="<=",b+=2):(o=null,m&&j('"<="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)===">="?(o=">=",b+=2):(o=null,m&&j('">="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),
s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;f=n!==null?n:null}}}}}for(;f!==null;){k.push(f);f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="="?(o="=",b+=1):(o=null,m&&j('"="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,
2)==="!="?(o="!=",b+=2):(o=null,m&&j('"!="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="<"?(o="<",b+=1):(o=null,m&&j('"<"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=
[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)===">"?(o=">",b+=1):(o=null,m&&j('">"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)==="<="?(o="<=",b+=2):(o=null,m&&j('"<="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,
b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,2)===">="?(o=">=",b+=2):(o=null,m&&j('">="')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=V(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;f=n!==null?n:null}}}}}}k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b.length===0)return a;else{var c={expressionType:"relationalexpression"};c.operator=
b[0][1];c.op1=a;c.op2=b[0][3];c.token="expression";return c}}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[99] RelationalExpression");v[d]={nextPos:b,result:h};return h}function V(){var d="AdditiveExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=oa();if(g!==null){for(var k=[],f=b,n=[],o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="+"?(o="+",b+=1):(o=null,m&&j('"+"')),o!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=oa(),
s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="-"?(o="-",b+=1):(o=null,m&&j('"-"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=oa(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=pa();n===null&&(n=pa(),n=n!==null?n:null);if(n!==null){o=b;l=[];for(s=q();s!==null;)l.push(s),s=q();if(l!==null)if(a.substr(b,
1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s!==null){for(var z=[],r=q();r!==null;)z.push(r),r=q();z!==null?(r=ba(),r!==null?l=[l,s,z,r]:(l=null,b=o)):(l=null,b=o)}else l=null,b=o;else l=null,b=o;if(l!==null)o=l;else{o=b;l=[];for(s=q();s!==null;)l.push(s),s=q();if(l!==null)if(a.substr(b,1)==="/"?(s="/",b+=1):(s=null,m&&j('"/"')),s!==null){z=[];for(r=q();r!==null;)z.push(r),r=q();z!==null?(r=ba(),r!==null?l=[l,s,z,r]:(l=null,b=o)):(l=null,b=o)}else l=null,b=o;else l=null,b=o;o=l!==null?l:null}o=o!==
null?o:"";o!==null?n=[n,o]:(n=null,b=f)}else n=null,b=f;f=n!==null?n:null}}for(;f!==null;){k.push(f);f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="+"?(o="+",b+=1):(o=null,m&&j('"+"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=oa(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="-"?(o="-",b+=1):(o=null,m&&j('"-"')),o!==
null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=oa(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=pa();n===null&&(n=pa(),n=n!==null?n:null);if(n!==null){o=b;l=[];for(s=q();s!==null;)l.push(s),s=q();if(l!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s!==null){z=[];for(r=q();r!==null;)z.push(r),r=q();z!==null?(r=ba(),r!==null?l=[l,s,z,r]:(l=null,b=o)):(l=null,b=o)}else l=null,b=o;else l=null,b=o;if(l!==null)o=
l;else{o=b;l=[];for(s=q();s!==null;)l.push(s),s=q();if(l!==null)if(a.substr(b,1)==="/"?(s="/",b+=1):(s=null,m&&j('"/"')),s!==null){z=[];for(r=q();r!==null;)z.push(r),r=q();z!==null?(r=ba(),r!==null?l=[l,s,z,r]:(l=null,b=o)):(l=null,b=o)}else l=null,b=o;else l=null,b=o;o=l!==null?l:null}o=o!==null?o:"";o!==null?n=[n,o]:(n=null,b=f)}else n=null,b=f;f=n!==null?n:null}}}k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b.length===0)return a;var c={token:"expression",expressionType:"additiveexpression"};
c.summand=a;c.summands=[];for(var d=0;d<b.length;d++){var g=b[d],h={};if(g.length==4&&typeof g[1]==="string")h.operator=g[1],h.expression=g[3];else{var g={},e=h[0],j=h[1][1],i=h[1][3],j=null;e.value<0?(h.operator="-",e.value=-e.value):h.operator="+";g.token="expression";g.expressionType="multiplicativeexpression";g.operator=e;g.factors=[{operator:j,expression:i}];h.expression=g}c.summands.push(h)}return c}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[101] AdditiveExpression");v[d]=
{nextPos:b,result:h};return h}function oa(){var d="MultiplicativeExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b,g=ba();if(g!==null){for(var k=[],f=b,n=[],o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="*"?(o="*",b+=1):(o=null,m&&j('"*"')),o!==null){for(var l=[],s=q();s!==null;)l.push(s),s=q();l!==null?(s=ba(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();
if(n!==null)if(a.substr(b,1)==="/"?(o="/",b+=1):(o=null,m&&j('"/"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=ba(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;f=n!==null?n:null}for(;f!==null;){k.push(f);f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="*"?(o="*",b+=1):(o=null,m&&j('"*"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=ba(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,
b=f;else n=null,b=f;if(n!==null)f=n;else{f=b;n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(a.substr(b,1)==="/"?(o="/",b+=1):(o=null,m&&j('"/"')),o!==null){l=[];for(s=q();s!==null;)l.push(s),s=q();l!==null?(s=ba(),s!==null?n=[n,o,l,s]:(n=null,b=f)):(n=null,b=f)}else n=null,b=f;else n=null,b=f;f=n!==null?n:null}}k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b.length===0)return a;var c={token:"expression",expressionType:"multiplicativeexpression"};c.factor=a;c.factors=
[];for(var d=0;d<b.length;d++){var g=b[d],h={};h.operator=g[1];h.expression=g[3];c.factors.push(h)}return c}(g[0],g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[102] MultiplicativeExpression");v[d]={nextPos:b,result:h};return h}function ba(){var d="UnaryExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b;if(a.substr(b,1)==="!"){var g="!";b+=1}else g=null,m&&j('"!"');if(g!==null){for(var k=[],f=q();f!==null;)k.push(f),f=q();k!==null?(f=Aa(),f!==null?g=[g,k,f]:(g=null,
b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"};b.expression=a;return b}(g[2]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,1)==="+"?(g="+",b+=1):(g=null,m&&j('"+"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();k!==null?(f=Aa(),f!==null?g=[g,k,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};
b.expression=a;return b}(g[2]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,1)==="-"?(g="-",b+=1):(g=null,m&&j('"-"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();k!==null?(f=Aa(),f!==null?g=[g,k,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};b.expression=a;return b}(g[2]):null;h===null&&(h=null,b=i);h!==null?i=h:(i=Aa(),i=i!==null?i:null)}}(m=e)&&i===null&&j("[103] UnaryExpression");
v[d]={nextPos:b,result:i};return i}function Aa(){var a="PrimaryExpression@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=Ha();if(d===null&&(d=Ga(),d===null&&(d=Nb(),d===null))){var d=b,h=Ia(),h=h!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"};b.value=a;return b}(h):null;h===null&&(h=null,b=d);h!==null?d=h:(d=b,h=Ja(),h=h!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};b.value=
a;return b}(h):null,h===null&&(h=null,b=d),h!==null?d=h:(d=b,h=Ka(),h=h!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};b.value=a;return b}(h):null,h===null&&(h=null,b=d),h!==null?d=h:(d=Ob(),d===null&&(d=b,h=R(),h=h!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"var"};b.value=a;return b}(h):null,h===null&&(h=null,b=d),d=h!==null?h:null))))}(m=c)&&d===null&&j("[104] PrimaryExpression");v[a]={nextPos:b,
result:d};return d}function Ha(){var d="BrackettedExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b;if(a.substr(b,1)==="("){var g="(";b+=1}else g=null,m&&j('"("');if(g!==null){for(var k=[],f=q();f!==null;)k.push(f),f=q();if(k!==null)if(f=M(),f!==null){for(var n=[],o=q();o!==null;)n.push(o),o=q();n!==null?(a.substr(b,1)===")"?(o=")",b+=1):(o=null,m&&j('")"')),o!==null?g=[g,k,f,n,o]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?g[2]:
null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[105] BrackettedExpression");v[d]={nextPos:b,result:h};return h}function Ga(){var d="BuiltInCall@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b;if(a.substr(b,3)==="STR"){var g="STR";b+=3}else g=null,m&&j('"STR"');g===null&&(a.substr(b,3)==="str"?(g="str",b+=3):(g=null,m&&j('"str"')),g=g!==null?g:null);if(g!==null){for(var k=[],f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){for(var n=
[],o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){for(var s=[],l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"str"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,4)===
"LANG"?(g="LANG",b+=4):(g=null,m&&j('"LANG"'));g===null&&(a.substr(b,4)==="lang"?(g="lang",b+=4):(g=null,m&&j('"lang"')),g=g!==null?g:null);if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=
h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"lang"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,11)==="LANGMATCHES"?(g="LANGMATCHES",b+=11):(g=null,m&&j('"LANGMATCHES"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==
null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();if(s!==null)if(a.substr(b,1)===","?(l=",",b+=1):(l=null,m&&j('","')),l!==null){for(var z=[],r=q();r!==null;)z.push(r),r=q();if(z!==null)if(r=M(),r!==null){for(var u=[],w=q();w!==null;)u.push(w),w=q();u!==null?(a.substr(b,1)===")"?(w=")",b+=1):(w=null,m&&j('")"')),w!==null?g=[g,k,f,n,o,s,l,z,r,u,w]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=
null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};c.args=[a,b];return c}(g[4],g[8]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,8)==="DATATYPE"?(g="DATATYPE",b+=8):(g=null,m&&j('"DATATYPE"'));g===null&&(a.substr(b,8)==="datatype"?(g="datatype",b+=8):(g=null,m&&j('"datatype"')),g=g!==null?g:null);if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,
1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"datatype"};b.args=[a];return b}(g[4]):null;h===
null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,5)==="BOUND"?(g="BOUND",b+=5):(g=null,m&&j('"BOUND"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=R(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,
b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bound"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,3)==="IRI"?(g="IRI",b+=3):(g=null,m&&j('"IRI"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];
for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"iri"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,3)==="URI"?(g="URI",b+=3):(g=null,m&&j('"URI"'));if(g!==null){k=[];for(f=q();f!==
null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"uri"};
b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,5)==="BNODE"?(g="BNODE",b+=5):(g=null,m&&j('"BNODE"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null){f=b;a.substr(b,1)==="("?(n="(",b+=1):(n=null,m&&j('"("'));if(n!==null){o=[];for(s=q();s!==null;)o.push(s),s=q();if(o!==null)if(s=M(),s!==null){l=[];for(z=q();z!==null;)l.push(z),z=q();l!==null?(a.substr(b,1)===")"?(z=")",b+=1):(z=null,m&&j('")"')),z!==null?n=[n,o,s,l,z]:(n=null,b=f)):(n=
null,b=f)}else n=null,b=f;else n=null,b=f}else n=null,b=f;n!==null?f=n:(f=ja(),f=f!==null?f:null);f!==null?g=[g,k,f]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bnode"};b.args=a.length===5?[a[2]]:null;return b}(g[2]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,8)==="COALESCE"?(g="COALESCE",b+=8):(g=null,m&&j('"COALESCE"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();k!==null?
(f=Ab(),f!==null?g=[g,k,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};b.args=a;return b}(g[2]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,2)==="IF"?(g="IF",b+=2):(g=null,m&&j('"IF"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),
o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();if(s!==null)if(a.substr(b,1)===","?(l=",",b+=1):(l=null,m&&j('","')),l!==null){z=[];for(r=q();r!==null;)z.push(r),r=q();if(z!==null)if(r=M(),r!==null){u=[];for(w=q();w!==null;)u.push(w),w=q();if(u!==null)if(a.substr(b,1)===","?(w=",",b+=1):(w=null,m&&j('","')),w!==null){for(var D=[],H=q();H!==null;)D.push(H),H=q();if(D!==null)if(H=M(),H!==null){for(var x=[],A=q();A!==null;)x.push(A),A=q();x!==null?(a.substr(b,1)===")"?(A=")",b+=1):(A=null,m&&j('")"')),
A!==null?g=[g,k,f,n,o,s,l,z,r,u,w,D,H,x,A]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c){var d={token:"expression",expressionType:"builtincall",builtincall:"if"};d.args=[a,b,c];return d}(g[4],g[8],g[12]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,9)==="ISLITERAL"?
(g="ISLITERAL",b+=9):(g=null,m&&j('"ISLITERAL"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?
function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,7)==="ISBLANK"?(g="ISBLANK",b+=7):(g=null,m&&j('"ISBLANK"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?
(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isblank"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,8)==="SAMETERM"?(g="SAMETERM",b+=8):(g=null,m&&j('"SAMETERM"'));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();
if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();if(s!==null)if(a.substr(b,1)===","?(l=",",b+=1):(l=null,m&&j('","')),l!==null){z=[];for(r=q();r!==null;)z.push(r),r=q();if(z!==null)if(r=M(),r!==null){u=[];for(w=q();w!==null;)u.push(w),w=q();u!==null?(a.substr(b,1)===")"?(w=")",b+=1):(w=null,m&&j('")"')),w!==null?g=[g,k,f,n,o,s,l,z,r,u,w]:(g=null,b=h)):(g=null,
b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};c.args=[a,b];return c}(g[4],g[8]):null;h===null&&(h=null,b=i);if(h!==null)i=h;else{h=i=b;a.substr(b,5)==="ISURI"?(g="ISURI",b+=5):(g=null,m&&j('"ISURI"'));g===null&&(a.substr(b,5)==="isuri"?(g="isuri",b+=5):(g=null,m&&j('"isuri"')),g===null&&(a.substr(b,
5)==="ISIRI"?(g="ISIRI",b+=5):(g=null,m&&j('"ISIRI"')),g===null&&(a.substr(b,5)==="isiri"?(g="isiri",b+=5):(g=null,m&&j('"isiri"')),g=g!==null?g:null)));if(g!==null){k=[];for(f=q();f!==null;)k.push(f),f=q();if(k!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(o=q();o!==null;)n.push(o),o=q();if(n!==null)if(o=M(),o!==null){s=[];for(l=q();l!==null;)s.push(l),l=q();s!==null?(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null?g=[g,k,f,n,o,s,l]:(g=null,b=h)):
(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isuri"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);h!==null?i=h:(i=Pb(),i===null&&(i=Qb(),i===null&&(i=Rb(),i=i!==null?i:null)))}}}}}}}}}}}}}(m=e)&&i===null&&j("[106] BuiltInCall");v[d]={nextPos:b,result:i};return i}function Pb(){var d="RegexExpression@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;
var i=b,h=b;if(a.substr(b,5)==="REGEX"){var g="REGEX";b+=5}else g=null,m&&j('"REGEX"');g===null&&(a.substr(b,5)==="regex"?(g="regex",b+=5):(g=null,m&&j('"regex"')),g=g!==null?g:null);if(g!==null){for(var f=[],k=q();k!==null;)f.push(k),k=q();if(f!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();if(n!==null)if(l=M(),l!==null){for(var s=[],z=q();z!==null;)s.push(z),z=q();if(s!==null)if(a.substr(b,1)===","?(z=",",b+=1):(z=null,m&&j('","')),
z!==null){for(var r=[],u=q();u!==null;)r.push(u),u=q();if(r!==null)if(u=M(),u!==null){for(var w=[],D=q();D!==null;)w.push(D),D=q();if(w!==null){D=b;if(a.substr(b,1)===","){var H=",";b+=1}else H=null,m&&j('","');if(H!==null){for(var x=[],A=q();A!==null;)x.push(A),A=q();x!==null?(A=M(),A!==null?H=[H,x,A]:(H=null,b=D)):(H=null,b=D)}else H=null,b=D;D=H!==null?H:"";if(D!==null){H=[];for(x=q();x!==null;)H.push(x),x=q();H!==null?(a.substr(b,1)===")"?(x=")",b+=1):(x=null,m&&j('")"')),x!==null?g=[g,f,k,n,
l,s,z,r,u,w,D,H,x]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h}else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b,c){var d={token:"expression",expressionType:"regex"};d.text=a;d.pattern=b;d.flags=c[2];return d}(g[4],g[8],g[10]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[107] RegexExpression");v[d]={nextPos:b,result:h};return h}function Qb(){var d="ExistsFunc@"+
b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b;if(a.substr(b,6)==="EXISTS"){var g="EXISTS";b+=6}else g=null,m&&j('"EXISTS"');g===null&&(a.substr(b,6)==="exists"?(g="exists",b+=6):(g=null,m&&j('"exists"')),g=g!==null?g:null);if(g!==null){for(var f=[],k=q();k!==null;)f.push(k),k=q();f!==null?(k=X(),k!==null?g=[g,f,k]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"exists"};b.args=[a];return b}(g[2]):
null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[108] ExistsFunc");v[d]={nextPos:b,result:h};return h}function Rb(){var d="NotExistsFunc@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b;if(a.substr(b,3)==="NOT"){var g="NOT";b+=3}else g=null,m&&j('"NOT"');g===null&&(a.substr(b,3)==="not"?(g="not",b+=3):(g=null,m&&j('"not"')),g=g!==null?g:null);if(g!==null){for(var f=[],k=q();k!==null;)f.push(k),k=q();if(f!==null)if(a.substr(b,6)==="EXISTS"?(k="EXISTS",b+=6):(k=null,m&&j('"EXISTS"')),
k===null&&(a.substr(b,6)==="exists"?(k="exists",b+=6):(k=null,m&&j('"exists"')),k=k!==null?k:null),k!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();n!==null?(l=X(),l!==null?g=[g,f,k,n,l]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"notexists"};b.args=[a];return b}(g[4]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[109] NotExistsFunc");v[d]={nextPos:b,result:h};return h}
function Ob(){var d="Aggregate@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,5)==="COUNT"){var g="COUNT";b+=5}else g=null,m&&j('"COUNT"');g===null&&(a.substr(b,5)==="count"?(g="count",b+=5):(g=null,m&&j('"count"')),g=g!==null?g:null);if(g!==null){for(var i=[],f=q();f!==null;)i.push(f),f=q();if(i!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){for(var n=[],l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,8)==="DISTINCT"?(l="DISTINCT",
b+=8):(l=null,m&&j('"DISTINCT"')),l===null&&(a.substr(b,8)==="distinct"?(l="distinct",b+=8):(l=null,m&&j('"distinct"')),l=l!==null?l:null),l=l!==null?l:"",l!==null){for(var s=[],z=q();z!==null;)s.push(z),z=q();if(s!==null)if(a.substr(b,1)==="*"?(z="*",b+=1):(z=null,m&&j('"*"')),z===null&&(z=M(),z=z!==null?z:null),z!==null){for(var r=[],u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){for(var w=[],D=q();D!==null;)w.push(D),D=q();w!==null?
g=[g,i,f,n,l,s,z,r,u,w]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"aggregate",aggregateType:"count"};c.distinct=a!=""?"DISTINCT":a;c.expression=b;return c}(g[4],g[6]):null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;a.substr(b,3)==="SUM"?(g="SUM",b+=3):(g=null,m&&j('"SUM"'));g===null&&(a.substr(b,3)==="sum"?(g="sum",
b+=3):(g=null,m&&j('"sum"')),g=g!==null?g:null);if(g!==null){i=[];for(f=q();f!==null;)i.push(f),f=q();if(i!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,8)==="DISTINCT"?(l="DISTINCT",b+=8):(l=null,m&&j('"DISTINCT"')),l===null&&(a.substr(b,8)==="distinct"?(l="distinct",b+=8):(l=null,m&&j('"distinct"')),l=l!==null?l:null),l=l!==null?l:"",l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();if(s!==null)if(z=
M(),z!==null){r=[];for(u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(D=q();D!==null;)w.push(D),D=q();w!==null?g=[g,i,f,n,l,s,z,r,u,w]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"aggregate",aggregateType:"sum"};c.distinct=a!=""?"DISTINCT":a;c.expression=
b;return c}(g[4],g[6]):null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;a.substr(b,3)==="MIN"?(g="MIN",b+=3):(g=null,m&&j('"MIN"'));g===null&&(a.substr(b,3)==="min"?(g="min",b+=3):(g=null,m&&j('"min"')),g=g!==null?g:null);if(g!==null){i=[];for(f=q();f!==null;)i.push(f),f=q();if(i!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,8)==="DISTINCT"?(l="DISTINCT",b+=8):(l=null,m&&j('"DISTINCT"')),l===null&&
(a.substr(b,8)==="distinct"?(l="distinct",b+=8):(l=null,m&&j('"distinct"')),l=l!==null?l:null),l=l!==null?l:"",l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();if(s!==null)if(z=M(),z!==null){r=[];for(u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(D=q();D!==null;)w.push(D),D=q();w!==null?g=[g,i,f,n,l,s,z,r,u,w]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=
null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"aggregate",aggregateType:"min"};c.distinct=a!=""?"DISTINCT":a;c.expression=b;return c}(g[4],g[6]):null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;a.substr(b,3)==="MAX"?(g="MAX",b+=3):(g=null,m&&j('"MAX"'));g===null&&(a.substr(b,3)==="max"?(g="max",b+=3):(g=null,m&&j('"max"')),g=g!==null?g:null);if(g!==null){i=[];for(f=q();f!==null;)i.push(f),f=q();if(i!==null)if(a.substr(b,1)==="("?(f=
"(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,8)==="DISTINCT"?(l="DISTINCT",b+=8):(l=null,m&&j('"DISTINCT"')),l===null&&(a.substr(b,8)==="distinct"?(l="distinct",b+=8):(l=null,m&&j('"distinct"')),l=l!==null?l:null),l=l!==null?l:"",l!==null){s=[];for(z=q();z!==null;)s.push(z),z=q();if(s!==null)if(z=M(),z!==null){r=[];for(u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(D=
q();D!==null;)w.push(D),D=q();w!==null?g=[g,i,f,n,l,s,z,r,u,w]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"aggregate",aggregateType:"max"};c.distinct=a!=""?"DISTINCT":a;c.expression=b;return c}(g[4],g[6]):null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;a.substr(b,3)==="AVG"?(g="AVG",b+=3):(g=null,m&&j('"AVG"'));g===
null&&(a.substr(b,3)==="avg"?(g="avg",b+=3):(g=null,m&&j('"avg"')),g=g!==null?g:null);if(g!==null){i=[];for(f=q();f!==null;)i.push(f),f=q();if(i!==null)if(a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("')),f!==null){n=[];for(l=q();l!==null;)n.push(l),l=q();if(n!==null)if(a.substr(b,8)==="DISTINCT"?(l="DISTINCT",b+=8):(l=null,m&&j('"DISTINCT"')),l===null&&(a.substr(b,8)==="distinct"?(l="distinct",b+=8):(l=null,m&&j('"distinct"')),l=l!==null?l:null),l=l!==null?l:"",l!==null){s=[];for(z=q();z!==null;)s.push(z),
z=q();if(s!==null)if(z=M(),z!==null){r=[];for(u=q();u!==null;)r.push(u),u=q();if(r!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(D=q();D!==null;)w.push(D),D=q();w!==null?g=[g,i,f,n,l,s,z,r,u,w]:(g=null,b=h)}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;else g=null,b=h}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"aggregate",aggregateType:"avg"};c.distinct=a!=
""?"DISTINCT":a;c.expression=b;return c}(g[4],g[6]):null;h===null&&(h=null,b=k);k=h!==null?h:null}}}}(m=e)&&k===null&&j("[110] Aggregate");v[d]={nextPos:b,result:k};return k}function Nb(){var a="IRIrefOrFunction@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=S();if(g!==null){var e=hb(),e=e!==null?e:"";e!==null?g=[g,e]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){var c={token:"expression",expressionType:"irireforfunction"};c.iriref=a;c.args=b.value;return c}(g[0],g[1]):
null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[117] IRIrefOrFunction");v[a]={nextPos:b,result:h};return h}function Ia(){var d="RDFLiteral@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b,g=Sb();if(g!==null){var k=Tb();if(k===null){k=b;if(a.substr(b,2)==="^^"){var i="^^";b+=2}else i=null,m&&j('"^^"');if(i!==null){var n=S();n!==null?i=[i,n]:(i=null,b=k)}else i=null,b=k;k=i!==null?i:null}k=k!==null?k:"";k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){return typeof b===
"string"&&b.length>0?{token:"literal",value:a.value,lang:b.slice(1),type:null}:typeof b==="object"?(b.shift(),{token:"literal",value:a.value,lang:null,type:b[0]}):{token:"literal",value:a.value,lang:null,type:null}}(g[0],g[1]):null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[112] RDFLiteral");v[d]={nextPos:b,result:h};return h}function Ja(){var a="NumericLiteral@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=Ub();d===null&&(d=Vb(),d===null&&(d=pa(),d=d!==null?d:null));(m=c)&&d===null&&
j("[113] NumericLiteral");v[a]={nextPos:b,result:d};return d}function Ub(){var a="NumericLiteralUnsigned@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=Ta();d===null&&(d=Ua(),d===null&&(d=da(),d=d!==null?d:null));(m=c)&&d===null&&j("[114] NumericLiteralUnsigned");v[a]={nextPos:b,result:d};return d}function Vb(){var a="NumericLiteralPositive@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=Wb();d===null&&(d=Xb(),d===null&&(d=Yb(),d=d!==null?d:null));(m=c)&&d===null&&j("[115] NumericLiteralPositive");
v[a]={nextPos:b,result:d};return d}function pa(){var a="NumericLiteralNegative@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=Zb();d===null&&(d=$b(),d===null&&(d=ac(),d=d!==null?d:null));(m=c)&&d===null&&j("[116] NumericLiteralNegative");v[a]={nextPos:b,result:d};return d}function Ka(){var d="BooleanLiteral@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b;if(a.substr(b,4)==="TRUE"){var h="TRUE";b+=4}else h=null,m&&j('"TRUE"');h===null&&(a.substr(b,4)==="true"?(h="true",b+=
4):(h=null,m&&j('"true"')),h=h!==null?h:null);h=h!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}:null;h===null&&(h=null,b=f);h!==null?f=h:(f=b,a.substr(b,5)==="FALSE"?(h="FALSE",b+=5):(h=null,m&&j('"FALSE"')),h===null&&(a.substr(b,5)==="false"?(h="false",b+=5):(h=null,m&&j('"false"')),h=h!==null?h:null),h=h!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}:null,h===null&&(h=null,b=f),f=h!==null?h:null);(m=e)&&f===
null&&j("[117] BooleanLiteral");v[d]={nextPos:b,result:f};return f}function Sb(){var a="String@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=bc(),h=h!==null?{token:"string",value:h}:null;h===null&&(h=null,b=d);h!==null?d=h:(d=b,h=cc(),h=h!==null?{token:"string",value:h}:null,h===null&&(h=null,b=d),h!==null?d=h:(d=b,h=dc(),h=h!==null?{token:"string",value:h}:null,h===null&&(h=null,b=d),h!==null?d=h:(d=b,h=ec(),h=h!==null?{token:"string",value:h}:null,h===null&&(h=null,b=d),d=h!==null?
h:null)));(m=c)&&d===null&&j("[118] String");v[a]={nextPos:b,result:d};return d}function S(){var a="IRIref@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=Ea(),h=h!==null?{token:"uri",prefix:null,suffix:null,value:h}:null;h===null&&(h=null,b=d);h!==null?d=h:(d=b,h=fc(),h=h!==null?h:null,h===null&&(h=null,b=d),d=h!==null?h:null);(m=c)&&d===null&&j("[119] IRIref");v[a]={nextPos:b,result:d};return d}function fc(){var a="PrefixedName@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;
var d=b,h=gc(),h=h!==null?{token:"uri",prefix:h[0],suffix:h[1],value:null}:null;h===null&&(h=null,b=d);h!==null?d=h:(d=b,h=Fa(),h=h!==null?{token:"uri",prefix:h,suffix:"",value:null}:null,h===null&&(h=null,b=d),d=h!==null?h:null);(m=c)&&d===null&&j("[120] PrefixedName");v[a]={nextPos:b,result:d};return d}function Mb(){var a="BlankNode@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=hc(),h=h!==null?{token:"blank",value:h}:null;h===null&&(h=null,b=d);h!==null?d=h:(d=b,ic()!==null?(ea++,
h={token:"blank",value:"_:"+ea}):h=null,h===null&&(h=null,b=d),d=h!==null?h:null);(m=c)&&d===null&&j("[121] BlankNode");v[a]={nextPos:b,result:d};return d}function Ea(){var d="IRI_REF@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b,1)==="<"){var g="<";b+=1}else g=null,m&&j('"<"');if(g!==null){var k=[];if(a.substr(b).match(/^[^<>"{}|^`\\]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j('[^<>"{}|^`\\\\]');for(;i!==null;)k.push(i),a.substr(b).match(/^[^<>"{}|^`\\]/)!==
null?(i=a.charAt(b),b++):(i=null,m&&j('[^<>"{}|^`\\\\]'));k!==null?(a.substr(b,1)===">"?(i=">",b+=1):(i=null,m&&j('">"')),i!==null?g=[g,k,i]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?g[1].join(""):null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[122] IRI_REF");v[d]={nextPos:b,result:h};return h}function Fa(){var d="PNAME_NS@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b,g=jc(),g=g!==null?g:"";if(g!==null){if(a.substr(b,1)===":"){var k=":";b+=1}else k=null,m&&j('":"');
k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[0]:null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[123] PNAME_NS");v[d]={nextPos:b,result:h};return h}function gc(){var a="PNAME_LN@"+b,c=v[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var d=b,h=b,g=Fa();if(g!==null){var e=lb();e!==null?g=[g,e]:(g=null,b=h)}else g=null,b=h;h=g!==null?[g[0],g[1]]:null;h===null&&(h=null,b=d);(m=c)&&h===null&&j("[124] PNAME_LN");v[a]={nextPos:b,result:h};return h}function hc(){var d="BLANK_NODE_LABEL@"+b,e=
v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b,2)==="_:"){var g="_:";b+=2}else g=null,m&&j('"_:"');if(g!==null){var k=lb();k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[125] BLANK_NODE_LABEL");v[d]={nextPos:b,result:h};return h}function Kb(){var d="VAR1@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b,1)==="?"){var g="?";b+=1}else g=null,m&&j('"?"');if(g!==null){var k=mb();k!==
null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[126] VAR1");v[d]={nextPos:b,result:h};return h}function Lb(){var d="VAR2@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b,1)==="$"){var g="$";b+=1}else g=null,m&&j('"$"');if(g!==null){var k=mb();k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[1]:null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[127] VAR2");v[d]={nextPos:b,result:h};return h}function Tb(){var d=
"LANGTAG@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b,1)==="@"){var g="@";b+=1}else g=null,m&&j('"@"');if(g!==null){if(a.substr(b).match(/^[a-zA-Z]/)!==null){var k=a.charAt(b);b++}else k=null,m&&j("[a-zA-Z]");if(k!==null)for(var i=[];k!==null;)i.push(k),a.substr(b).match(/^[a-zA-Z]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[a-zA-Z]"));else i=null;if(i!==null){var k=[],n=b;if(a.substr(b,1)==="-"){var l="-";b+=1}else l=null,m&&j('"-"');if(l!==null){if(a.substr(b).match(/^[a-zA-Z0-9]/)!==
null){var s=a.charAt(b);b++}else s=null,m&&j("[a-zA-Z0-9]");if(s!==null)for(var q=[];s!==null;)q.push(s),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(s=a.charAt(b),b++):(s=null,m&&j("[a-zA-Z0-9]"));else q=null;q!==null?l=[l,q]:(l=null,b=n)}else l=null,b=n;for(;l!==null;)if(k.push(l),n=b,a.substr(b,1)==="-"?(l="-",b+=1):(l=null,m&&j('"-"')),l!==null){a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(s=a.charAt(b),b++):(s=null,m&&j("[a-zA-Z0-9]"));if(s!==null)for(q=[];s!==null;)q.push(s),a.substr(b).match(/^[a-zA-Z0-9]/)!==
null?(s=a.charAt(b),b++):(s=null,m&&j("[a-zA-Z0-9]"));else q=null;q!==null?l=[l,q]:(l=null,b=n)}else l=null,b=n;k!==null?g=[g,i,k]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?g[2].length===0?("@"+g[1].join("")).toLowerCase():("@"+g[1].join("")+"-"+g[2][0][1].join("")).toLowerCase():null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[128] LANGTAG");v[d]={nextPos:b,result:h};return h}function da(){var d="INTEGER@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b;if(a.substr(b).match(/^[0-9]/)!==
null){var h=a.charAt(b);b++}else h=null,m&&j("[0-9]");if(h!==null)for(var g=[];h!==null;)g.push(h),a.substr(b).match(/^[0-9]/)!==null?(h=a.charAt(b),b++):(h=null,m&&j("[0-9]"));else g=null;h=g!==null?function(a){var b={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"};b.value=Z(a);return b}(g):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[129] INTEGER");v[d]={nextPos:b,result:h};return h}function Ua(){var d="DECIMAL@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;
var k=b,h=b;if(a.substr(b).match(/^[0-9]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[0-9]");if(g!==null)for(var f=[];g!==null;)f.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else f=null;if(f!==null)if(a.substr(b,1)==="."?(g=".",b+=1):(g=null,m&&j('"."')),g!==null){var i=[];if(a.substr(b).match(/^[0-9]/)!==null){var n=a.charAt(b);b++}else n=null,m&&j("[0-9]");for(;n!==null;)i.push(n),a.substr(b).match(/^[0-9]/)!==null?(n=a.charAt(b),b++):(n=null,m&&j("[0-9]"));
i!==null?f=[f,g,i]:(f=null,b=h)}else f=null,b=h;else f=null,b=h;h=f!==null?function(a,b,c){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};d.value=Z([a,b,c]);return d}(f[0],f[1],f[2]):null;h===null&&(h=null,b=k);if(h!==null)k=h;else{h=k=b;a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."'));if(f!==null){a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));if(g!==null)for(i=[];g!==null;)i.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),
b++):(g=null,m&&j("[0-9]"));else i=null;i!==null?f=[f,i]:(f=null,b=h)}else f=null,b=h;h=f!==null?function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};c.value=Z([a,b]);return c}(f[0],f[1]):null;h===null&&(h=null,b=k);k=h!==null?h:null}(m=e)&&k===null&&j("[130] DECIMAL");v[d]={nextPos:b,result:k};return k}function Ta(){var d="DOUBLE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b).match(/^[0-9]/)!==null){var g=a.charAt(b);b++}else g=
null,m&&j("[0-9]");if(g!==null)for(var k=[];g!==null;)k.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else k=null;if(k!==null)if(a.substr(b,1)==="."?(g=".",b+=1):(g=null,m&&j('"."')),g!==null){var i=[];if(a.substr(b).match(/^[0-9]/)!==null){var n=a.charAt(b);b++}else n=null,m&&j("[0-9]");for(;n!==null;)i.push(n),a.substr(b).match(/^[0-9]/)!==null?(n=a.charAt(b),b++):(n=null,m&&j("[0-9]"));i!==null?(n=Va(),n!==null?k=[k,g,i,n]:(k=null,b=h)):(k=null,b=h)}else k=
null,b=h;else k=null,b=h;h=k!==null?function(a,b,c,d){var g={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};g.value=Z([a,b,c,d]);return g}(k[0],k[1],k[2],k[3]):null;h===null&&(h=null,b=f);if(h!==null)f=h;else{h=f=b;a.substr(b,1)==="."?(k=".",b+=1):(k=null,m&&j('"."'));if(k!==null){a.substr(b).match(/^[0-9]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[0-9]"));if(i!==null)for(g=[];i!==null;)g.push(i),a.substr(b).match(/^[0-9]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[0-9]"));
else g=null;g!==null?(i=Va(),i!==null?k=[k,g,i]:(k=null,b=h)):(k=null,b=h)}else k=null,b=h;h=k!==null?function(a,b,c){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};d.value=Z([a,b,c]);return d}(k[0],k[1],k[2]):null;h===null&&(h=null,b=f);if(h!==null)f=h;else{h=f=b;a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));if(g!==null)for(k=[];g!==null;)k.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else k=
null;k!==null?(g=Va(),g!==null?k=[k,g]:(k=null,b=h)):(k=null,b=h);h=k!==null?function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};c.value=Z([a,b]);return c}(k[0],k[1]):null;h===null&&(h=null,b=f);f=h!==null?h:null}}(m=e)&&f===null&&j("[131] DOUBLE");v[d]={nextPos:b,result:f};return f}function Yb(){var d="INTEGER_POSITIVE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="+"){var g="+";b+=1}else g=null,m&&j('"+"');if(g!==null){var f=
da();f!==null?g=[g,f]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.value="+"+a.value;return a}(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[132] INTEGER_POSITIVE");v[d]={nextPos:b,result:h};return h}function Xb(){var d="DECIMAL_POSITIVE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="+"){var g="+";b+=1}else g=null,m&&j('"+"');if(g!==null){var f=Ua();f!==null?g=[g,f]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.value="+"+a.value;return a}(g[1]):
null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[133] DECIMAL_POSITIVE");v[d]={nextPos:b,result:h};return h}function Wb(){var d="DOUBLE_POSITIVE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="+"){var g="+";b+=1}else g=null,m&&j('"+"');if(g!==null){var f=Ta();f!==null?g=[g,f]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.value="+"+a.value;return a}(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[134] DOUBLE_POSITIVE");v[d]={nextPos:b,result:h};return h}
function ac(){var d="INTEGER_NEGATIVE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="-"){var g="-";b+=1}else g=null,m&&j('"-"');if(g!==null){var f=da();f!==null?g=[g,f]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.value="-"+a.value;return a}(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[135] INTEGER_NEGATIVE");v[d]={nextPos:b,result:h};return h}function $b(){var d="DECIMAL_NEGATIVE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,
h=b;if(a.substr(b,1)==="-"){var g="-";b+=1}else g=null,m&&j('"-"');if(g!==null){var f=Ua();f!==null?g=[g,f]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.value="-"+a.value;return a}(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[136] DECIMAL_NEGATIVE");v[d]={nextPos:b,result:h};return h}function Zb(){var d="DOUBLE_NEGATIVE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="-"){var g="-";b+=1}else g=null,m&&j('"-"');if(g!==null){var f=Ta();f!==null?
g=[g,f]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a){a.value="-"+a.value;return a}(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[137] DOUBLE_NEGATIVE");v[d]={nextPos:b,result:h};return h}function Va(){var d="EXPONENT@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b).match(/^[eE]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[eE]");if(g!==null){if(a.substr(b).match(/^[+\-]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[+\\-]");f=f!==null?f:"";if(f!==
null){if(a.substr(b).match(/^[0-9]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[0-9]");if(i!==null)for(var n=[];i!==null;)n.push(i),a.substr(b).match(/^[0-9]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[0-9]"));else n=null;n!==null?g=[g,f,n]:(g=null,b=h)}else g=null,b=h}else g=null,b=h;h=g!==null?Z([g[0],g[1],g[2]]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[138] EXPONENT");v[d]={nextPos:b,result:h};return h}function dc(){var d="STRING_LITERAL1@"+b,e=v[d];if(e)return b=e.nextPos,e.result;
e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==="'"){var g="'";b+=1}else g=null,m&&j('"\'"');if(g!==null){var f=[];if(a.substr(b).match(/^[^'\\\n\r]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[^'\\\\\\n\\r]");i===null&&(i=fa(),i=i!==null?i:null);for(;i!==null;)f.push(i),a.substr(b).match(/^[^'\\\n\r]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[^'\\\\\\n\\r]")),i===null&&(i=fa(),i=i!==null?i:null);f!==null?(a.substr(b,1)==="'"?(i="'",b+=1):(i=null,m&&j('"\'"')),i!==null?g=[g,f,i]:(g=null,b=h)):(g=null,
b=h)}else g=null,b=h;h=g!==null?Z(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[139] STRING_LITERAL1");v[d]={nextPos:b,result:h};return h}function ec(){var d="STRING_LITERAL2@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,1)==='"'){var g='"';b+=1}else g=null,m&&j('"\\""');if(g!==null){var f=[];if(a.substr(b).match(/^[^"\\\n\r]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j('[^"\\\\\\n\\r]');i===null&&(i=fa(),i=i!==null?i:null);for(;i!==null;)f.push(i),a.substr(b).match(/^[^"\\\n\r]/)!==
null?(i=a.charAt(b),b++):(i=null,m&&j('[^"\\\\\\n\\r]')),i===null&&(i=fa(),i=i!==null?i:null);f!==null?(a.substr(b,1)==='"'?(i='"',b+=1):(i=null,m&&j('"\\""')),i!==null?g=[g,f,i]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?Z(g[1]):null;h===null&&(h=null,b=k);(m=e)&&h===null&&j("[140] STRING_LITERAL2");v[d]={nextPos:b,result:h};return h}function bc(){var d="STRING_LITERAL_LONG1@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var k=b,h=b;if(a.substr(b,3)==="'''"){var g="'''";b+=3}else g=
null,m&&j("\"'''\"");if(g!==null){var f=[];if(a.substr(b).match(/^[^'\\]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[^'\\\\]");i===null&&(i=fa(),i=i!==null?i:null);for(;i!==null;)f.push(i),a.substr(b).match(/^[^'\\]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[^'\\\\]")),i===null&&(i=fa(),i=i!==null?i:null);f!==null?(a.substr(b,3)==="'''"?(i="'''",b+=3):(i=null,m&&j("\"'''\"")),i!==null?g=[g,f,i]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?Z(g[1]):null;h===null&&(h=null,b=k);(m=e)&&
h===null&&j("[141] STRING_LITERAL_LONG1");v[d]={nextPos:b,result:h};return h}function cc(){var d="STRING_LITERAL_LONG2@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var i=b,h=b;if(a.substr(b,3)==='"""'){var g='"""';b+=3}else g=null,m&&j('"\\"\\"\\""');if(g!==null){var k=[];if(a.substr(b).match(/^[^"\\]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j('[^"\\\\]');f===null&&(f=fa(),f=f!==null?f:null);for(;f!==null;)k.push(f),a.substr(b).match(/^[^"\\]/)!==null?(f=a.charAt(b),b++):(f=null,m&&
j('[^"\\\\]')),f===null&&(f=fa(),f=f!==null?f:null);k!==null?(a.substr(b,3)==='"""'?(f='"""',b+=3):(f=null,m&&j('"\\"\\"\\""')),f!==null?g=[g,k,f]:(g=null,b=h)):(g=null,b=h)}else g=null,b=h;h=g!==null?Z(g[1]):null;h===null&&(h=null,b=i);(m=e)&&h===null&&j("[142] STRING_LITERAL_LONG2");v[d]={nextPos:b,result:h};return h}function fa(){var d="ECHAR@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b;if(a.substr(b,1)==="\\"){var h="\\";b+=1}else h=null,m&&j('"\\\\"');if(h!==null){if(a.substr(b).match(/^[tbnrf"']/)!==
null){var g=a.charAt(b);b++}else g=null,m&&j("[tbnrf\"']");g!==null?h=[h,g]:(h=null,b=f)}else h=null,b=f;(m=e)&&h===null&&j("[143] ECHAR");v[d]={nextPos:b,result:h};return h}function ja(){var d="NIL@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b;if(a.substr(b,1)==="("){var g="(";b+=1}else g=null,m&&j('"("');if(g!==null){for(var k=[],i=q();i!==null;)k.push(i),i=q();k!==null?(a.substr(b,1)===")"?(i=")",b+=1):(i=null,m&&j('")"')),i!==null?g=[g,k,i]:(g=null,b=h)):(g=null,b=h)}else g=
null,b=h;h=g!==null?{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}:null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[144] NIL");v[d]={nextPos:b,result:h};return h}function q(){var d="WS@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;if(a.substr(b).match(/^[ ]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[ ]");f===null&&(a.substr(b).match(/^[\t]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\t]")),f===null&&
(a.substr(b).match(/^[\r]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\r]")),f===null&&(a.substr(b).match(/^[\n]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\n]")),f===null&&(f=kc(),f=f!==null?f:null))));(m=e)&&f===null&&j("[145] WS");v[d]={nextPos:b,result:f};return f}function kc(){var d="COMMENT@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b;if(a.substr(b,1)==="#"){var h="#";b+=1}else h=null,m&&j('"#"');if(h!==null){var g=[];if(a.substr(b).match(/^[^\n\r]/)!==null){var i=a.charAt(b);
b++}else i=null,m&&j("[^\\n\\r]");for(;i!==null;)g.push(i),a.substr(b).match(/^[^\n\r]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[^\\n\\r]"));g!==null?h=[h,g]:(h=null,b=f)}else h=null,b=f;(m=e)&&h===null&&j(" COMMENT");v[d]={nextPos:b,result:h};return h}function ic(){var d="ANON@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b;if(a.substr(b,1)==="["){var h="[";b+=1}else h=null,m&&j('"["');if(h!==null){for(var g=[],i=q();i!==null;)g.push(i),i=q();g!==null?(a.substr(b,1)==="]"?(i="]",b+=
1):(i=null,m&&j('"]"')),i!==null?h=[h,g,i]:(h=null,b=f)):(h=null,b=f)}else h=null,b=f;(m=e)&&h===null&&j("[146] ANON");v[d]={nextPos:b,result:h};return h}function nb(){var d="PN_CHARS_BASE@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;if(a.substr(b).match(/^[A-Z]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[A-Z]");f===null&&(a.substr(b).match(/^[a-z]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[a-z]")),f===null&&(a.substr(b).match(/^[\xC0-\xD6]/)!==null?(f=a.charAt(b),b++):(f=null,m&&
j("[\\xC0-\\xD6]")),f===null&&(a.substr(b).match(/^[\xD8-\xF6]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\xD8-\\xF6]")),f===null&&(a.substr(b).match(/^[\xF8-\u02FF]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\xF8-\\u02FF]")),f===null&&(a.substr(b).match(/^[\u0370-\u037D]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u0370-\\u037D]")),f===null&&(a.substr(b).match(/^[\u037F-\u1FFF]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u037F-\\u1FFF]")),f===null&&(a.substr(b).match(/^[\u200C-\u200D]/)!==
null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u200C-\\u200D]")),f===null&&(a.substr(b).match(/^[\u2070-\u218F]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u2070-\\u218F]")),f===null&&(a.substr(b).match(/^[\u2C00-\u2FEF]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u2C00-\\u2FEF]")),f===null&&(a.substr(b).match(/^[\u3001-\uD7FF]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u3001-\\uD7FF]")),f===null&&(a.substr(b).match(/^[\uF900-\uFDCF]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\uF900-\\uFDCF]")),
f===null&&(a.substr(b).match(/^[\uFDF0-\uFFFD]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\uFDF0-\\uFFFD]")),f===null&&(a.substr(b).match(/^[\u1000-\uEFFF]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u1000-\\uEFFF]")),f=f!==null?f:null)))))))))))));(m=e)&&f===null&&j("[147] PN_CHARS_BASE");v[d]={nextPos:b,result:f};return f}function qa(){var d="PN_CHARS_U@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=nb();f===null&&(a.substr(b,1)==="_"?(f="_",b+=1):(f=null,m&&j('"_"')),f=f!==null?
f:null);(m=e)&&f===null&&j("[148] PN_CHARS_U");v[d]={nextPos:b,result:f};return f}function mb(){var d="VARNAME@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b,g=qa();g===null&&(a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]")),g=g!==null?g:null);if(g!==null){var i=[],k=qa();k===null&&(a.substr(b).match(/^[0-9]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[0-9]")),k===null&&(a.substr(b).match(/^[\xB7]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\xB7]")),
k===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u0300-\\u036F]")),k===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u203F-\\u2040]")),k=k!==null?k:null))));for(;k!==null;)i.push(k),k=qa(),k===null&&(a.substr(b).match(/^[0-9]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[0-9]")),k===null&&(a.substr(b).match(/^[\xB7]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\xB7]")),k===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==
null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u0300-\\u036F]")),k===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u203F-\\u2040]")),k=k!==null?k:null))));i!==null?g=[g,i]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[0]+g[1].join(""):null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[149] VARNAME");v[d]={nextPos:b,result:h};return h}function Ba(){var d="PN_CHARS@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=qa();f===null&&(a.substr(b,1)==="-"?(f="-",b+=
1):(f=null,m&&j('"-"')),f===null&&(a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]")),f===null&&(a.substr(b).match(/^[\xB7]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\xB7]")),f===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u0300-\\u036F]")),f===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[\\u203F-\\u2040]")),f=f!==null?f:null)))));(m=e)&&f===null&&j("[150] PN_CHARS");v[d]={nextPos:b,
result:f};return f}function jc(){var d="PN_PREFIX@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b,g=nb();if(g!==null){var k=[],i=Ba();i===null&&(a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."')),i=i!==null?i:null);for(;i!==null;)k.push(i),i=Ba(),i===null&&(a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."')),i=i!==null?i:null);k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?function(a,b){if(b[b.length-1]==".")throw Error("Wrong PN_PREFIX, cannot finish with '.'");else return a+
b.join("")}(g[0],g[1]):null;h===null&&(h=null,b=f);(m=e)&&h===null&&j("[151] PN_PREFIX");v[d]={nextPos:b,result:h};return h}function lb(){var d="PN_LOCAL@"+b,e=v[d];if(e)return b=e.nextPos,e.result;e=m;m=!1;var f=b,h=b,g=qa();g===null&&(a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]")),g=g!==null?g:null);if(g!==null){for(var k=[],i=Ba();i!==null;)k.push(i),i=Ba();k!==null?g=[g,k]:(g=null,b=h)}else g=null,b=h;h=g!==null?g[0]+g[1].join(""):null;h===null&&(h=null,b=f);(m=
e)&&h===null&&j("[152] PN_LOCAL");v[d]={nextPos:b,result:h};return h}function ob(){var d=function(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}(cb),e=Math.max(b,va),e=e<a.length?k(a.charAt(e)):"end of input";return"Expected "+d+" but "+e+" found."}function lc(){for(var b=1,d=1,e=!1,h=0;h<va;h++){var g=a.charAt(h);g==="\n"?(e||b++,
d=1,e=!1):g==="\r"|g==="\u2028"||g==="\u2029"?(b++,d=1,e=!0):(d++,e=!1)}return{line:b,column:d}}var ha={ANON:ic,AdditiveExpression:V,Aggregate:Ob,ArgList:hb,AskQuery:s,BLANK_NODE_LABEL:hc,BaseDecl:u,BindingValue:T,BindingsClause:W,BlankNode:Mb,BlankNodePropertyList:Ib,BooleanLiteral:Ka,BrackettedExpression:Ha,BuiltInCall:Ga,COMMENT:kc,Clear:ga,Collection:Hb,ConditionalAndExpression:Ra,ConditionalOrExpression:M,Constraint:wa,ConstructQuery:B,ConstructTemplate:rb,ConstructTriples:ib,Create:ra,DECIMAL:Ua,
DECIMAL_NEGATIVE:$b,DECIMAL_POSITIVE:Xb,DOUBLE:Ta,DOUBLE_NEGATIVE:Zb,DOUBLE_POSITIVE:Wb,DatasetClause:n,DefaultGraphClause:D,DeleteClause:pb,DeleteData:ta,DeleteWhere:ua,DescribeQuery:C,Drop:la,ECHAR:fa,EXPONENT:Va,ExistsFunc:Qb,ExpressionList:Ab,Filter:zb,FunctionCall:db,GraphGraphPattern:xb,GraphNode:na,GraphPatternNotTriples:gb,GraphRef:Da,GraphRefAll:Xa,GraphTerm:Jb,GroupClause:Q,GroupCondition:G,GroupGraphPattern:X,GroupGraphPatternSub:sb,GroupOrUnionGraphPattern:ub,HavingClause:F,INTEGER:da,
INTEGER_NEGATIVE:ac,INTEGER_POSITIVE:Yb,IRI_REF:Ea,IRIref:S,IRIrefOrFunction:Nb,InsertClause:Za,InsertData:sa,LANGTAG:Tb,LimitClause:N,LimitOffsetClauses:O,Load:ca,MinusGraphPattern:wb,Modify:Ca,MultiplicativeExpression:oa,NIL:ja,NamedGraphClause:z,NotExistsFunc:Rb,NumericLiteral:Ja,NumericLiteralNegative:pa,NumericLiteralPositive:Vb,NumericLiteralUnsigned:Ub,ObjectList:ka,OffsetClause:P,OptionalGraphPattern:vb,OrderClause:E,OrderCondition:J,PNAME_LN:gc,PNAME_NS:Fa,PN_CHARS:Ba,PN_CHARS_BASE:nb,PN_CHARS_U:qa,
PN_LOCAL:lb,PN_PREFIX:jc,PathAlternative:jb,PathElt:kb,PathEltOrInverse:Qa,PathMod:Fb,PathNegatedPropertySet:Gb,PathOneInPropertySet:za,PathPrimary:Eb,PathSequence:Pa,PrefixDecl:w,PrefixedName:fc,PrimaryExpression:Aa,Prologue:f,PropertyList:Bb,PropertyListNotEmpty:ya,PropertyListNotEmptyPath:Cb,PropertyListPath:Db,QuadData:ab,QuadPattern:Ya,Quads:bb,QuadsNotTriples:eb,Query:i,RDFLiteral:Ia,RegexExpression:Pb,RelationalExpression:Sa,SPARQL:function(){var a="SPARQL@"+b,c=v[a];if(c)return b=c.nextPos,
c.result;c=i();c===null&&(c=Y(),c=c!==null?c:null);v[a]={nextPos:b,result:c};return c},STRING_LITERAL1:dc,STRING_LITERAL2:ec,STRING_LITERAL_LONG1:bc,STRING_LITERAL_LONG2:cc,SelectClause:A,SelectQuery:r,ServiceGraphPattern:yb,SolutionModifier:U,String:Sb,SubSelect:x,TriplesBlock:xa,TriplesNode:Ma,TriplesSameSubject:fb,TriplesSameSubjectPath:tb,TriplesTemplate:ma,UnaryExpression:ba,Update:Y,Update1:aa,UsingClause:$a,VAR1:Kb,VAR2:Lb,VARNAME:mb,Var:R,VarOrIRIref:ia,VarOrTerm:La,Verb:Na,VerbPath:Oa,WS:q,
WhereClause:H};if(d!==void 0){if(ha[d]===void 0)throw Error("Invalid rule name: "+k(d)+".");}else d="SPARQL";var b=0,m=!0,va=0,cb=[],v={},Z=function(a){for(var b="",c=0;c<a.length;c++)b+=typeof a[c]==="string"?a[c]:a[c].join("");return b},ea=0,qb=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c];return b.toUpperCase()},ha=ha[d]();if(ha===null||b!==a.length)throw ha=lc(),new this.SyntaxError(ob(),ha.line,ha.column);return ha},toSource:function(){return this._source},SyntaxError:function(a,d,e){this.name=
"SyntaxError";this.message=a;this.line=d;this.column=e}};a.SyntaxError.prototype=Error.prototype;return a}();var Ca=function(){var a={RDFSink_uniqueURI:function(){return"https://github.com/antoniogarrote/rdfstore-js/vocabulary/unique#"},graph:null,Util:{ArrayIndexOf:function(a,d,e){e||(e=0);var f=a.length;for(e<0&&(e=f+e);e<f;e++)if(a[e]===d)return e;return-1}}};if(typeof a.Util.uri=="undefined")a.Util.uri={};a.Util.uri.join=function(a,d){var a=a||"",e=d.indexOf("#");e>0&&(d=d.slice(0,e));if(a.length==
0)return d;if(a.indexOf("#")==0)return d+a;if(a.indexOf(":")>=0)return a;var f=d.indexOf(":");if(d=="")return a;if(f<0)return alert("Invalid base: "+d+" in join with "+a),a;e=d.slice(0,f+1);if(a.indexOf("//")==0)return e+a;if(d.indexOf("//",f)==f+1){var j=d.indexOf("/",f+3);if(j<0)return d.length-f-3>0?d+"/"+a:e+a}else if(j=d.indexOf("/",f+1),j<0)return d.length-f-1>0?d+"/"+a:e+a;if(a.indexOf("/")==0)return d.slice(0,j)+a;var f=d.slice(j),i=f.lastIndexOf("/");if(i<0)return e+a;i>=0&&i<f.length-1&&
(f=f.slice(0,i+1));for(f+=a;f.match(/[^\/]*\/\.\.\//);)f=f.replace(/[^\/]*\/\.\.\//,"");f=f.replace(/\.\//g,"");f=f.replace(/\/\.$/,"/");return d.slice(0,j)+f};a.Empty=function(){return this};a.Empty.prototype.termType="empty";a.Empty.prototype.toString=function(){return"()"};a.Empty.prototype.toQuads=function(){return{uri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}};a.Symbol=function(a){this.value=this.uri=a;return this};a.Symbol.prototype.termType="symbol";a.Symbol.prototype.toString=function(){return"<"+
this.uri+">"};a.Symbol.prototype.toQuads=function(){return{token:"uri",prefix:null,suffix:null,value:this.uri}};a.Symbol.prototype.XSDboolean=new a.Symbol("http://www.w3.org/2001/XMLSchema#boolean");a.Symbol.prototype.XSDdecimal=new a.Symbol("http://www.w3.org/2001/XMLSchema#decimal");a.Symbol.prototype.XSDfloat=new a.Symbol("http://www.w3.org/2001/XMLSchema#float");a.Symbol.prototype.XSDinteger=new a.Symbol("http://www.w3.org/2001/XMLSchema#integer");a.Symbol.prototype.XSDdateTime=new a.Symbol("http://www.w3.org/2001/XMLSchema#dateTime");
a.Symbol.prototype.integer=new a.Symbol("http://www.w3.org/2001/XMLSchema#integer");typeof a.NextId!="undefined"?a.log.error("Attempt to re-zero existing blank node id counter at "+a.NextId):a.NextId=0;a.NTAnonymousNodePrefix="_:";a.BlankNode=function(c){this.id=a.NextId++;this.value=c?c:this.id.toString();return this};a.BlankNode.prototype.termType="bnode";a.BlankNode.prototype.toString=function(){return a.NTAnonymousNodePrefix+this.id};a.BlankNode.prototype.toString=a.BlankNode.prototype.toNT;a.BlankNode.prototype.toQuads=
function(){return{blank:a.NTAnonymousNodePrefix+this.id}};a.Literal=function(a,d,e){this.value=a;this.lang=d==""||d==null?void 0:d;this.datatype=e==null?void 0:e;return this};a.Literal.prototype.termType="literal";a.Literal.prototype.toNT=function(){var a=this.value;if(typeof a!="string"){if(typeof a=="number")return""+a;throw Error("Value of RDF literal is not string: "+a);}a=a.replace(/\\/g,"\\\\");a=a.replace(/\"/g,'\\"');a=a.replace(/\n/g,"\\n");a='"'+a+'"';this.datatype&&(a=a+"^^"+this.datatype.toNT());
this.lang&&(a=a+"@"+this.lang);return a};a.Literal.prototype.toQuads=function(){var a=this.value;if(typeof a!="string"){if(typeof a=="number")return""+a;throw Error("Value of RDF literal is not string: "+a);}a=a.replace(/\\/g,"\\\\");a=a.replace(/\"/g,'\\"');a=a.replace(/\n/g,"\\n");a='"'+a+'"';this.datatype&&(a=a+"^^<"+this.datatype.value+">");this.lang&&(a=a+"@"+this.lang);return{literal:a}};a.Collection=function(){this.id=a.NextId++;this.elements=[];this.closed=!1};a.Collection.idCounter=0;a.Collection.prototype.termType=
"collection";a.Collection.prototype.toNT=function(){return a.NTAnonymousNodePrefix+this.id};a.Collection.prototype.toQuads=function(){var c=[],d="_:list"+a.Collection.idCounter;a.Collection.idCounter++;for(var e={uri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},f={uri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},j={uri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"},i,l={blank:d+"p"+u},u=0;u<this.elements.length;u++)i=l,l=u<this.elements.length-1?{blank:d+"p"+(u+1)}:j,c.push({subject:i,
predicate:e,object:this.elements[u].toQuads(),graph:a.graph}),c.push({subject:i,predicate:f,object:l,graph:a.graph});return c};a.Collection.prototype.append=function(a){this.elements.push(a)};a.Collection.prototype.unshift=function(a){this.elements.unshift(a)};a.Collection.prototype.shift=function(){return this.elements.shift()};a.Collection.prototype.close=function(){this.closed=!0};a.term=function(c){if(typeof c=="object")if(c instanceof Date){var d=function(a){return(""+(100+a)).slice(1,3)};return new a.Literal(""+
c.getUTCFullYear()+"-"+d(c.getUTCMonth()+1)+"-"+d(c.getUTCDate())+"T"+d(c.getUTCHours())+":"+d(c.getUTCMinutes())+":"+d(c.getUTCSeconds())+"Z",void 0,a.Symbol.prototype.XSDdateTime)}else if(c instanceof Array){for(var d=new a.Collection,e=0;e<c.length;e++)d.append(a.term(c[e]));return d}else return c;if(typeof c=="string")return new a.Literal(c);if(typeof c=="number")return d=(""+c).indexOf("e")>=0?a.Symbol.prototype.XSDfloat:(""+c).indexOf(".")>=0?a.Symbol.prototype.XSDdecimal:a.Symbol.prototype.XSDinteger,
new a.Literal(c,void 0,d);if(typeof c=="boolean")return new a.Literal(c?"1":"0",void 0,a.Symbol.prototype.XSDboolean);if(typeof c!="undefined")throw"Can't make term from "+c+" of type "+typeof c;};a.Statement=function(c,d,e,f){this.subject=a.term(c);this.predicate=a.term(d);this.object=a.term(e);if(typeof f!="undefined")this.why=f;return this};a.st=function(c,d,e,f){return new a.Statement(c,d,e,f)};a.Statement.prototype.toNT=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+
" ."};a.Statement.prototype.toQuads=function(){var c=this.object.toQuads();if(c.constructor===Array){var d=c[0].subject;c.push({subject:this.subject.toQuads(),predicate:this.predicate.toQuads(),object:d,graph:a.graph});return c}else return{subject:this.subject.toQuads(),predicate:this.predicate.toQuads(),object:this.object.toQuads(),graph:a.graph}};a.Formula=function(){this.statements=[];return this};a.Formula.prototype.termType="formula";a.Formula.prototype.toNT=function(){return"{"+this.statements.join("\n")+
"}"};a.Formula.prototype.toQuads=function(){for(var a=[],d=0;d<this.statements.length;d++){var e=this.statements[d].toQuads();e.constructor===Array?a=a.concat(e):a.push(e)}return a};a.Formula.prototype.add=function(c,d,e,f){this.statements.push(new a.Statement(c,d,e,f))};a.Formula.prototype.sym=function(c){return new a.Symbol(c)};a.sym=function(c){return new a.Symbol(c)};a.Formula.prototype.literal=function(c,d,e){if(e!=null&&e.value!=null&&e.value.indexOf("http://")===-1)for(var f in this.namespaces)if(e.value.indexOf(f)===
0){e.value=this.namespaces[f]+e.value.split(f+":")[1];break}return new a.Literal(""+c,d,e)};a.lit=a.Formula.prototype.literal;a.Formula.prototype.bnode=function(c){return new a.BlankNode(c)};a.Formula.prototype.formula=function(){return new a.Formula};a.Formula.prototype.collection=function(){return new a.Collection};a.Formula.prototype.list=function(c){li=new a.Collection;if(c)for(var d=0;d<c.length;d++)li.append(c[d]);return li};a.Graph=function(){return new a.IndexedFormula};a.N3Parser=function(){function c(c,
d,e,f,k,l,u,w){typeof d=="undefined"&&(d=null);typeof e=="undefined"&&(e="");typeof f=="undefined"&&(f=null);typeof k=="undefined"&&(k="");typeof u=="undefined"&&(u="");typeof w=="undefined"&&(w=null);this._bindings=new i([]);this._flags=u;e&&e!=""&&(r(e.indexOf(":")>=0,"Document URI not absolute: "+e),this._bindings[""]=e+"#");this._store=c;k&&c.setGenPrefix(k);this._thisDoc=e;this.source=c.sym(e);this.previousLine=this.startOfLine=this.statementCount=this.lines=0;this._genPrefix=k;this.keywords=
new j(["a","this","bind","has","is","of","true","false"]);this.keywordsSet=0;this._anonymousNodes=new i([]);this._variables=new i([]);this._parentVariables=new i([]);this._reason=w;this._reason2=null;if(x)this._reason2=why_BecauseOfData(c.sym(e),this._reason);this._baseURI=f?f:e?e:null;r(!this._baseURI||this._baseURI.indexOf(":")>=0);if(!this._genPrefix)this._genPrefix=this._thisDoc?this._thisDoc+"#_g":a.RDFSink_uniqueURI();this._context=this._formula=d==null?this._thisDoc?c.formula(e+"#_formula"):
c.formula():d;this._parentContext=null}function d(a,c,d,e,f){return"Line "+(c+1)+" of <"+a+">: Bad syntax: "+f+'\nat: "'+l(d,e,e+30)+'"'}var e={encode:function(a){for(var a=a.replace(/\r\n/g,"\n"),c="",d=0;d<a.length;d++){var e=a.charCodeAt(d);e<128?c+=String.fromCharCode(e):(e>127&&e<2048?c+=String.fromCharCode(e>>6|192):(c+=String.fromCharCode(e>>12|224),c+=String.fromCharCode(e>>6&63|128)),c+=String.fromCharCode(e&63|128))}return c},decode:function(a){for(var c="",d=0;d<a.length;){var e=a.charCodeAt(d);
e<128?(c+=String.fromCharCode(e),d++):e>191&&e<224?(c+=String.fromCharCode((e&31)<<6|a.charCodeAt(d+1)&63),d+=2):(c+=String.fromCharCode((e&15)<<12|(a.charCodeAt(d+1)&63)<<6|a.charCodeAt(d+2)&63),d+=3)}return c}},f=function(a){return a},j=function(a){return a},i=function(a){if(a.length>0)throw"missing.js: oops nnonempty dict not imp";return[]},l=function(a,c,d){if(typeof a.slice=="undefined")throw"@@ mising.js: No .slice function for "+a+" of type "+typeof a;return typeof d=="undefined"||d==null?
a.slice(c):a.slice(c,d)},u=Error("dummy error stop iteration"),w=function(a){this.last=0;this.li=a;this.next=function(){if(this.last==this.li.length)throw u;return this.li[this.last++]};return this},r=function(a,c){if(!a){if(c)throw"python Assertion failed: "+c;throw"(python) Assertion failed.";}};String.prototype.encode=function(a){if(a!="utf-8")throw"UTF8_converter: can only do utf-8";return e.encode(this)};String.prototype.decode=function(a){if(a!="utf-8")throw"UTF8_converter: can only do utf-8";
return this};var x=0,A=RegExp("^([-+]?[0-9]+)(\\.[0-9]+)?(e[-+]?[0-9]+)?","g"),B=RegExp('[\\\\\\r\\n\\"]',"g"),C=RegExp("^[a-zA-Z0-9]+(-[a-zA-Z0-9]+)?","g");c.prototype.here=function(a){return this._genPrefix+"_L"+this.lines+"C"+(a-this.startOfLine+1)};c.prototype.formula=function(){return this._formula};c.prototype.loadStream=function(a){return this.loadBuf(a.read())};c.prototype.loadBuf=function(a){this.startDoc();this.feed(a);return this.endDoc()};c.prototype.feed=function(a){var c=a.decode("utf-8"),
a=[],d=c.length,e=0;numChunks=d/524288;for(var f=0;f<numChunks+1;f++)e+524288<d?a.push(c.substring(e,e+524288)):a.push(c.substring(e,d)),e+=524288;for(f=c=0;f>=0;)if(d=this.skipSpace(a[c],f),d<0)if(c==a.length-1)break;else c++,f=0;else{f=d;try{f=this.directiveOrStatement(a[c],d)}catch(i){if(c==a.length-1)throw i;d=f;f=-1}f<0&&(f=a[c].substring(d,a[c].length),c++,a[c]=f+a[c],f=0)}};c.prototype.directiveOrStatement=function(a,c){var d=this.skipSpace(a,c);if(d<0)return d;var e=this.directive(a,d);if(e>=
0)return this.checkDot(a,e);e=this.statement(a,d);return e>=0?this.checkDot(a,e):e};c.prototype.tok=function(c,d,e){if(l(d,e,e+1)=="@")e+=1;else if(a.Util.ArrayIndexOf(this.keywords,c)<0)return-1;var f=e+c.length;return l(d,e,f)==c&&"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~".indexOf(d.charAt(f))>=0?f:-1};c.prototype.directive=function(c,e){var f=this.skipSpace(c,e);if(f<0)return f;var i=new j([]),f=this.tok("bind",c,e);if(f>0)throw d(this._thisDoc,this.lines,c,e,"keyword bind is obsolete: use @prefix");
f=this.tok("keywords",c,e);if(f>0){e=this.commaSeparatedList(c,f,i,!1);if(e<0)throw d(this._thisDoc,this.lines,c,e,"'@keywords' needs comma separated list of words");this.setKeywords(l(i,null,null));return e}f=this.tok("forAll",c,e);if(f>0){e=this.commaSeparatedList(c,f,i,!0);if(e<0)throw d(this._thisDoc,this.lines,c,e,"Bad variable list after @forAll");f=new w(i);try{for(;;){var k=f.next();if(a.Util.ArrayIndexOf(this._variables,k)<0||a.Util.ArrayIndexOf(this._parentVariables,k)>=0)this._variables[k]=
this._context.newUniversal(k)}}catch(x){if(x!=u)throw x;}return e}f=this.tok("forSome",c,e);if(f>0){e=this.commaSeparatedList(c,f,i,this.uri_ref2);if(e<0)throw d(this._thisDoc,this.lines,c,e,"Bad variable list after @forSome");f=new w(i);try{for(;;)k=f.next(),this._context.declareExistential(k)}catch(A){if(A!=u)throw A;}return e}f=this.tok("prefix",c,e);if(f>=0){k=new j([]);e=this.qname(c,f,k);if(e<0)throw d(this._thisDoc,this.lines,c,f,"expected qname after @prefix");f=this.uri_ref2(c,e,k);if(f<
0)throw d(this._thisDoc,this.lines,c,e,"expected <uriref> after @prefix _qname_");i=k[1].uri;this._baseURI?i=a.Util.uri.join(i,this._baseURI):r(i.indexOf(":")>=0,"With no base URI, cannot handle relative URI for NS");r(i.indexOf(":")>=0);this._bindings[k[0][0]]=i;this.bind(k[0][0],encodeURI(i));return f}f=this.tok("base",c,e);if(f>=0){k=new j([]);e=this.uri_ref2(c,f,k);if(e<0)throw d(this._thisDoc,this.lines,c,f,"expected <uri> after @base ");i=k[0].uri;if(this._baseURI)i=a.Util.uri.join(i,this._baseURI);
else throw d(this._thisDoc,this.lines,c,f,"With no previous base URI, cannot use relative URI in @base  <"+i+">");r(i.indexOf(":")>=0);this._baseURI=i;return e}return-1};c.prototype.bind=function(a,c){this._store.setPrefixForURI(a,c);a!=""&&this._store.setPrefixForURI(a,c)};c.prototype.setKeywords=function(a){a==null?this.keywordsSet=0:(this.keywords=a,this.keywordsSet=1)};c.prototype.startDoc=function(){};c.prototype.endDoc=function(){return this._formula};c.prototype.makeStatement=function(a){a[0].add(a[2],
a[1],a[3],this.source);this.statementCount+=1};c.prototype.statement=function(a,c){var e=new j([]),c=this.object(a,c,e);if(c<0)return c;e=this.property_list(a,c,e[0]);if(e<0)throw d(this._thisDoc,this.lines,a,c,"expected propertylist");return e};c.prototype.subject=function(a,c,d){return this.item(a,c,d)};c.prototype.verb=function(a,c,e){var i=this.skipSpace(a,c);if(i<0)return i;var r=new j([]),i=this.tok("has",a,c);if(i>=0){c=this.prop(a,i,r);if(c<0)throw d(this._thisDoc,this.lines,a,i,"expected property after 'has'");
e.push(new f(["->",r[0]]));return c}i=this.tok("is",a,c);if(i>=0){c=this.prop(a,i,r);if(c<0)throw d(this._thisDoc,this.lines,a,i,"expected <property> after 'is'");i=this.skipSpace(a,c);if(i<0)throw d(this._thisDoc,this.lines,a,c,"End of file found, expected property after 'is'");c=i;i=this.tok("of",a,c);if(i<0)throw d(this._thisDoc,this.lines,a,c,"expected 'of' after 'is' <prop>");e.push(new f(["<-",r[0]]));return i}i=this.tok("a",a,c);if(i>=0)return e.push(new f(["->",this._store.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")])),
i;if(l(a,c,c+2)=="<=")return e.push(new f(["<-",this._store.sym("http://www.w3.org/2000/10/swap/log#implies")])),c+2;if(l(a,c,c+1)=="="){if(l(a,c+1,c+2)==">")return e.push(new f(["->",this._store.sym("http://www.w3.org/2000/10/swap/log#implies")])),c+2;e.push(new f(["->",this._store.sym("http://www.w3.org/2002/07/owl#sameAs")]));return c+1}if(l(a,c,c+2)==":=")return e.push(new f(["->","http://www.w3.org/2000/10/swap/log#becomes"])),c+2;i=this.prop(a,c,r);if(i>=0)return e.push(new f(["->",r[0]])),
i;if(l(a,c,c+2)==">-"||l(a,c,c+2)=="<-")throw d(this._thisDoc,this.lines,a,i,">- ... -> syntax is obsolete.");return-1};c.prototype.prop=function(a,c,d){return this.item(a,c,d)};c.prototype.item=function(a,c,d){return this.path(a,c,d)};c.prototype.blankNode=function(a){return this._context.bnode(a,this._reason2)};c.prototype.path=function(a,c,e){c=this.nodeOrLiteral(a,c,e);if(c<0)return c;for(;"!^.".indexOf(l(a,c,c+1))>=0;){var i=l(a,c,c+1);if(i=="."){var j=l(a,c+1,c+2);if(!j||"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(j)>=
0&&":?<[{(".indexOf(j)<0)break}var j=e.pop(),r=this.blankNode(this.here(c)),c=this.node(a,c+1,e);if(c<0)throw d(this._thisDoc,this.lines,a,c,"EOF found in middle of path syntax");var u=e.pop();i=="^"?this.makeStatement(new f([this._context,u,r,j])):this.makeStatement(new f([this._context,u,j,r]));e.push(r)}return c};c.prototype.anonymousNode=function(a){var c=this._anonymousNodes[a];if(c)return c;c=this._store.bnode(this._context,this._reason2);return this._anonymousNodes[a]=c};c.prototype.node=function(a,
c,e,r){typeof r=="undefined"&&(r=null);var x=r,r=this.skipSpace(a,c);if(r<0)return r;c=r;r=l(a,c,c+1);if(r=="["){var A=this.here(c),r=this.skipSpace(a,c+1);if(r<0)throw d(this._thisDoc,this.lines,a,c,"EOF after '['");if(l(a,r,r+1)=="="){var c=r+1,I=new j([]),r=this.objectList(a,c,I);if(r>=0){x=I[0];if(I.length>1){I=new w(I);try{for(;;){var B=I.next();this.makeStatement(new f([this._context,this._store.sym("http://www.w3.org/2002/07/owl#sameAs"),x,B]))}}catch($){if($!=u)throw $;}}r=this.skipSpace(a,
r);if(r<0)throw d(this._thisDoc,this.lines,a,c,"EOF when objectList expected after [ = ");l(a,r,r+1)==";"&&(r+=1)}else throw d(this._thisDoc,this.lines,a,c,"objectList expected after [= ");}x==null&&(x=this.blankNode(A));c=this.property_list(a,r,x);if(c<0)throw d(this._thisDoc,this.lines,a,r,"property_list expected");r=this.skipSpace(a,c);if(r<0)throw d(this._thisDoc,this.lines,a,c,"EOF when ']' expected after [ <propertyList>");if(l(a,r,r+1)!="]")throw d(this._thisDoc,this.lines,a,r,"']' expected");
e.push(x);return r+1}if(r=="{"){r=l(a,c+1,c+2);if(r=="$"){c+=1;r=c+1;x=new j([]);for(A=!0;;){c=this.skipSpace(a,r);if(c<0)throw d(this._thisDoc,this.lines,a,c,"needed '$}', found end.");if(l(a,c,c+2)=="$}"){r=c+2;break}if(A)A=!1;else if(l(a,c,c+1)==",")c+=1;else throw d(this._thisDoc,this.lines,a,c,"expected: ','");B=new j([]);r=this.item(a,c,B);if(r<0)throw d(this._thisDoc,this.lines,a,c,"expected item in set or '$}'");x.push(B[0])}e.push(this._store.newSet(x,this._context))}else{r=c+1;B=this._parentContext;
this._parentContext=this._context;A=this._anonymousNodes;I=this._parentVariables;this._parentVariables=this._variables;this._anonymousNodes=new i([]);this._variables=this._variables.slice();var C=this._reason2;this._reason2=null;x==null&&(x=this._store.formula());for(this._context=x;;){c=this.skipSpace(a,r);if(c<0)throw d(this._thisDoc,this.lines,a,c,"needed '}', found end.");if(l(a,c,c+1)=="}"){r=c+1;break}r=this.directiveOrStatement(a,c);if(r<0)throw d(this._thisDoc,this.lines,a,c,"expected statement or '}'");
}this._anonymousNodes=A;this._variables=this._parentVariables;this._parentVariables=I;this._context=this._parentContext;this._reason2=C;this._parentContext=B;e.push(x.close())}return r}if(r=="("){A=this._store.list;r=l(a,c+1,c+2);if(r=="$")A=this._store.newSet,c+=1;r=c+1;for(x=new j([]);;){c=this.skipSpace(a,r);if(c<0)throw d(this._thisDoc,this.lines,a,c,"needed ')', found end.");if(l(a,c,c+1)==")"){r=c+1;break}B=new j([]);r=this.item(a,c,B);if(r<0)throw d(this._thisDoc,this.lines,a,c,"expected item in list or ')'");
x.push(B[0])}e.push(A(x,this._context));return r}r=this.tok("this",a,c);if(r>=0)throw d(this._thisDoc,this.lines,a,c,"Keyword 'this' was ancient N3. Now use @forSome and @forAll keywords.");r=this.tok("true",a,c);if(r>=0)return e.push(!0),r;r=this.tok("false",a,c);return r>=0?(e.push(!1),r):x==null&&(r=this.uri_ref2(a,c,e),r>=0)?r:-1};c.prototype.property_list=function(a,c,e){for(;;){var i=this.skipSpace(a,c);if(i<0)throw d(this._thisDoc,this.lines,a,c,"EOF found when expected verb in property list");
if(l(a,i,i+2)==":-"){var c=i+2,r=new j([]),i=this.node(a,c,r,e);if(i<0)throw d(this._thisDoc,this.lines,a,c,"bad {} or () or [] node after :- ");c=i}else{c=i;r=new j([]);i=this.verb(a,c,r);if(i<=0)return c;var x=new j([]),c=this.objectList(a,i,x);if(c<0)throw d(this._thisDoc,this.lines,a,i,"objectList expected");i=new w(x);try{for(;;){var A=i.next(),I=r[0],B=I[1];I[0]=="->"?this.makeStatement(new f([this._context,B,e,A])):this.makeStatement(new f([this._context,B,A,e]))}}catch($){if($!=u)throw $;
}i=this.skipSpace(a,c);if(i<0)throw d(this._thisDoc,this.lines,a,i,"EOF found in list of objects");if(l(a,c,c+1)!=";")return c;c+=1}}};c.prototype.commaSeparatedList=function(a,c,e,f){var i=this.skipSpace(a,c);if(i<0)throw d(this._thisDoc,this.lines,a,i,"EOF found expecting comma sep list");if(a.charAt(i)==".")return c;i=f?this.uri_ref2(a,i,e):this.bareWord(a,i,e);if(i<0)return-1;for(;;){c=this.skipSpace(a,i);if(c<0)return c;i=l(a,c,c+1);if(i!=",")return i!="."?-1:c;i=f?this.uri_ref2(a,c+1,e):this.bareWord(a,
c+1,e);if(i<0)throw d(this._thisDoc,this.lines,a,i,"bad list content");}};c.prototype.objectList=function(a,c,e){c=this.object(a,c,e);if(c<0)return-1;for(;;){c=this.skipSpace(a,c);if(c<0)throw d(this._thisDoc,this.lines,a,c,"EOF found after object");if(l(a,c,c+1)!=",")return c;c=this.object(a,c+1,e);if(c<0)return c}};c.prototype.checkDot=function(a,c){var e=this.skipSpace(a,c);if(e<0)return e;if(l(a,e,e+1)==".")return e+1;if(l(a,e,e+1)=="}")return e;if(l(a,e,e+1)=="]")return e;throw d(this._thisDoc,
this.lines,a,e,"expected '.' or '}' or ']' at end of statement");};c.prototype.uri_ref2=function(c,e,f){var i=new j([]),k=this.qname(c,e,i);if(k>=0){var u=i[0],i=u[0],u=u[1];if(i==null){r(0,"not used?");var w=this._baseURI+"#"}else if(w=this._bindings[i],!w){if(i=="_")return f.push(this.anonymousNode(u)),k;throw d(this._thisDoc,this.lines,c,e,"Prefix "+i+" not bound.");}c=this._store.sym(w+u);a.Util.ArrayIndexOf(this._variables,c)>=0?f.push(this._variables[c]):f.push(c);return k}e=this.skipSpace(c,
e);if(e<0)return-1;if(c.charAt(e)=="?")return i=new j([]),k=this.variable(c,e,i),k>0?(f.push(i[0]),k):-1;else if(c.charAt(e)=="<"){e+=1;for(i=e;e<c.length;){if(c.charAt(e)==">")return k=l(c,i,e),this._baseURI?k=a.Util.uri.join(k,this._baseURI):r(k.indexOf(":")>=0,"With no base URI, cannot deal with relative URIs"),l(c,e-1,e)=="#"&&l(k,-1,null)!="#"&&(k+="#"),c=this._store.sym(k),a.Util.ArrayIndexOf(this._variables,c)>=0?f.push(this._variables[c]):f.push(c),e+1;e+=1}throw d(this._thisDoc,this.lines,
c,k,"unterminated URI reference");}else if(this.keywordsSet){i=new j([]);k=this.bareWord(c,e,i);if(k<0)return-1;if(a.Util.ArrayIndexOf(this.keywords,i[0])>=0)throw d(this._thisDoc,this.lines,c,e,'Keyword "'+i[0]+'" not allowed here.');f.push(this._store.sym(this._bindings[""]+i[0]));return k}else return-1};c.prototype.skipSpace=function(a,c){for(var d=a,e=c?c:0;e<a.length;e++)if(" \n\r\t\u000c\u000b\u00a0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000".indexOf(a.charAt(e))===
-1)if(a.charAt(e)==="#")a=a.slice(c).replace(/^[^\n]*\n/,""),c=0,e=-1;else break;val=d.length-a.length+e;return val===d.length?-1:val};c.prototype.variable=function(a,c,e){var f=this.skipSpace(a,c);if(f<0)return-1;if(l(a,f,f+1)!="?")return-1;f+=1;c=f;if("0123456789-".indexOf(a.charAt(f))>=0)throw d(this._thisDoc,this.lines,a,f,"Varible name can't start with '"+a.charAt(f)+"s'");for(;c<a.length&&"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(a.charAt(c))<0;)c+=1;if(this._parentContext==null)throw d(this._thisDoc,
this.lines,a,f,"Can't use ?xxx syntax for variable in outermost level: "+l(a,f-1,c));e.push(this._store.variable(l(a,f,c)));return c};c.prototype.bareWord=function(a,c,d){var e=this.skipSpace(a,c);if(e<0)return-1;c=a.charAt(e);if("0123456789-".indexOf(c)>=0)return-1;if("\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(c)>=0)return-1;for(c=e;c<a.length&&"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(a.charAt(c))<0;)c+=1;d.push(l(a,e,c));return c};c.prototype.qname=function(c,d,e){d=this.skipSpace(c,
d);if(d<0)return-1;var i=c.charAt(d);if("0123456789-+".indexOf(i)>=0)return-1;if("\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(i)<0){var j=i;for(d+=1;d<c.length;)if(i=c.charAt(d),"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(i)<0)j+=i,d+=1;else break}else j="";if(d<c.length&&c.charAt(d)==":"){var l=j;d+=1;for(j="";d<c.length;)if(i=c.charAt(d),"\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~:".indexOf(i)<0)j+=i,d+=1;else break;e.push(new f([l,j]));return d}else return j&&this.keywordsSet&&a.Util.ArrayIndexOf(this.keywords,
j)<0?(e.push(new f(["",j])),d):-1};c.prototype.object=function(a,c,d){var e=this.subject(a,c,d);if(e>=0)return e;else{e=this.skipSpace(a,c);if(e<0)return-1;else c=e;return a.charAt(c)=='"'?(e=l(a,c,c+3)=='"""'?'"""':'"',c+=e.length,a=this.strconst(a,c,e),e=a[0],d.push(this._store.literal(a[1])),e):-1}};c.prototype.nodeOrLiteral=function(a,c,e){var f=this.node(a,c,e);if(f>=0)return f;else{f=this.skipSpace(a,c);if(f<0)return-1;else c=f;if("-+0987654321".indexOf(a.charAt(c))>=0){A.lastIndex=0;var i=
A.exec(a.slice(c));if(i==null)throw d(this._thisDoc,this.lines,a,c,"Bad number syntax");var f=c+A.lastIndex,k=l(a,c,f);k.indexOf("e")>=0?e.push(this._store.literal(parseFloat(k),void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#double"))):l(a,c,f).indexOf(".")>=0?e.push(this._store.literal(parseFloat(k),void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#decimal"))):e.push(this._store.literal(parseInt(k),void 0,this._store.sym("http://www.w3.org/2001/XMLSchema#integer")));return f}if(a.charAt(c)==
'"'){f=l(a,c,c+3)=='"""'?'"""':'"';c+=f.length;var k=null,r=this.strconst(a,c,f),f=r[0],r=r[1],i=null;if(l(a,f,f+1)=="@"){C.lastIndex=0;i=C.exec(a.slice(f+1));if(i==null)throw d(this._thisDoc,startline,a,c,"Bad language code syntax on string literal, after @");c=C.lastIndex+f+1;i=l(a,f+1,c);f=c}l(a,f,f+2)=="^^"&&(c=new j([]),f=this.uri_ref2(a,f+2,c),k=c[0]);e.push(this._store.literal(r,i,k));return f}else return-1}};c.prototype.strconst=function(a,c,e){for(var i=c,j="",r=this.lines;i<a.length;){c=
i+e.length;if(l(a,i,c)==e)return new f([c,j]);if(a.charAt(i)=='"')j+='"',i+=1;else{B.lastIndex=0;if(!B.exec(a.slice(i)))throw d(this._thisDoc,r,a,i,"Closing quote missing in string at ^ in "+l(a,i-20,i)+"^"+l(a,i,i+20));c=i+B.lastIndex-1;j+=l(a,i,c);var u=a.charAt(c);if(u=='"')i=c;else if(u=="\r")i=c+1;else if(u=="\n"){if(e=='"')throw d(this._thisDoc,r,a,c,"newline found in string literal");this.lines+=1;j+=u;i=c+1;this.previousLine=this.startOfLine;this.startOfLine=i}else if(u=="\\"){i=c+1;u=l(a,
i,i+1);if(!u)throw d(this._thisDoc,r,a,c,"unterminated string literal (2)");var w='abfrtvn\\"'.indexOf(u);if(w>=0)u='a\u0008\u000c\r\t\u000b\n\\"'.charAt(w),j+=u,i+=1;else if(u=="u")u=this.uEscape(a,i+1,r),i=u[0],u=u[1],j+=u;else if(u=="U")u=this.UEscape(a,i+1,r),i=u[0],u=u[1],j+=u;else throw d(this._thisDoc,this.lines,a,c,"bad escape");}}}throw d(this._thisDoc,this.lines,a,c,"unterminated string literal");};c.prototype.uEscape=function(a,c,e){for(var i=c,j=0,r=0;j<4;){var u=l(a,i,i+1).toLowerCase();
i+=1;if(u=="")throw d(this._thisDoc,e,a,c,"unterminated string literal(3)");u="0123456789abcdef".indexOf(u);if(u<0)throw d(this._thisDoc,e,a,c,"bad string literal hex escape");r=r*16+u;j+=1}a=String.fromCharCode(r);return new f([i,a])};c.prototype.UEscape=function(a,c,e){for(var i=c,j=0,r="\\U";j<8;){var u=l(a,i,i+1).toLowerCase();i+=1;if(u=="")throw d(this._thisDoc,e,a,c,"unterminated string literal(3)");if("0123456789abcdef".indexOf(u)<0)throw d(this._thisDoc,e,a,c,"bad string literal hex escape");
r+=u;j+=1}a="0x"+l(r,2,10)-0;a=String.fromCharCode(a);return new f([i,a])};return function(a,d,e,f,i,k,j,l){return new c(a,d,e,f,i,k,j,l)}}();a.IndexedFormula=function(){function c(c,e){if(typeof e!="object"){if(typeof e=="string")return new a.Literal(e);if(typeof e=="number")return new a.Literal(e);if(typeof e=="boolean")return new a.Literal(e?"1":"0",void 0,a.Symbol.prototype.XSDboolean);else if(typeof e=="number")return new a.Literal(""+e);else if(typeof e=="undefined")return;else throw"Can't make Term from "+
e+" of type "+typeof e;}return e}a.IndexedFormula=function(){this.statements=[];this.propertyActions=[];this.classActions=[];this.redirections=[];this.aliases=[];this.HTTPRedirects=[];this.subjectIndex=[];this.predicateIndex=[];this.objectIndex=[];this.whyIndex=[];this.index=[this.subjectIndex,this.predicateIndex,this.objectIndex,this.whyIndex];this.namespaces={}};a.IndexedFormula.prototype=new a.Formula;a.IndexedFormula.prototype.constructor=a.IndexedFormula;a.IndexedFormula.SuperClass=a.Formula;
a.IndexedFormula.prototype.setPrefixForURI=function(a,c){a=="tab"&&this.namespaces.tab||(this.namespaces[a]=c)};a.IndexedFormula.prototype.register=function(a,c){this.namespaces[a]=c};a.IndexedFormula.prototype.canon=function(a){return a};a.IndexedFormula.prototype.add=function(d,e,f,j){j==void 0&&(j=this.fetcher?this.fetcher.appNode:this.sym("chrome:theSession"));d=c(this,d);e=c(this,e);f=c(this,f);j=c(this,j);d=new a.Statement(d,e,f,j);this.statements.push(d);return d};a.IndexedFormula.prototype.formula=
function(c){return new a.IndexedFormula(c)};return a.IndexedFormula}();a.parse=function(c,d,e,f){try{if(f=="text/n3"||f=="text/turtle"){a.graph=e;a.N3Parser(d,d,null,null,null,null,"",null).loadBuf(c);return}}catch(j){throw"Error trying to parse N3 data:"+j;}throw"Don't know how to parse "+f+" yet";};return a}(),la={parser:{}};la.parser.parse=function(a,c){var d=new Ca.Graph;try{Ca.parse(a,d,c,"text/n3")}catch(e){throw e;}return d.toQuads()};var x={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",
rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",
sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},UrisMap:function(){this.defaultNs="";this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]}};x.UrisMap.prototype.values=function(){var a={},c;for(c in this)!A.include(this.interfaceProperties,c)&&typeof this[c]!=="function"&&c!=="defaultNs"&&c!=="interfaceProperties"&&(a[c]=this[c]);return a};x.UrisMap.prototype.get=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";
return this[a]};x.UrisMap.prototype.remove=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";delete this[a];return null};x.UrisMap.prototype.set=function(a,c){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";this[a]=c};x.UrisMap.prototype.setDefault=function(a){this.defaultNs=a};x.UrisMap.prototype.addAll=function(a,c){for(var d in a)A.include(this.interfaceProperties,d)||(this[d]!=null?c===!0&&(this[d]=a[d]):this[d]=a[d]);return this};x.UrisMap.prototype.resolve=
function(a){var c=a.split(":"),a=c[0],c=c[1];return a===""?this.defaultNs==null?null:this.defaultNs+c:this[a]!=null?this[a]+c:null};x.UrisMap.prototype.shrink=function(a){for(var c in this){var d=this[c];if(a.indexOf(d)===0&&d!==""&&c!="defaultNs")return a=a.split(d)[1],c+":"+a}return a};x.Profile=function(){this.prefixes=new x.UrisMap;this.terms=new x.UrisMap};x.Profile.prototype.importProfile=function(a,c){this.prefixes.addAll(a.prefixes,c);this.terms.addAll(a.terms,c)};x.Profile.prototype.resolve=
function(a){return a.indexOf(":")!=-1?this.prefixes.resolve(a):this.terms[a]!=null?this.terms.resolve(a):null};x.Profile.prototype.setDefaultPrefix=function(a){this.prefixes.setDefault(a)};x.Profile.prototype.setDefaultVocabulary=function(a){this.terms.setDefault(a)};x.Profile.prototype.setPrefix=function(a,c){this.prefixes.set(a,c)};x.Profile.prototype.setTerm=function(a,c){this.terms.set(a,c)};x.RDFEnvironment=function(){this.blankNodeCounter=0;var a=this;this.filters={s:function(a){return function(c){return c.subject.equals(a)}},
p:function(a){return function(c){return c.predicate.equals(a)}},o:function(a){return function(c){return c.object.equals(a)}},sp:function(a,c){return function(f){return f.subject.equals(a)&&f.predicate.equals(c)}},so:function(a,c){return function(f){return f.subject.equals(a)&&f.object.equals(c)}},po:function(a,c){return function(f){return f.predicate.equals(a)&&f.object.equals(c)}},spo:function(a,c,f){return function(j){return j.subject.equals(a)&&j.predicate.equals(c)&&j.object.equals(f)}},describes:function(a){return function(c){return c.subject.equals(a)||
c.object.equals(a)}},type:function(c){var e=a.resolve("rdf:type");return function(a){return a.predicate.equals(e)&&a.object.equals(c)}}};for(var c in x.defaultContext)this.prefixes.set(c,x.defaultContext[c])};A["extends"](x.Profile,x.RDFEnvironment);x.RDFEnvironment.prototype.createBlankNode=function(){var a=new x.BlankNode(this.blankNodeCounter);this.blankNodeCounter++;return a};x.RDFEnvironment.prototype.createNamedNode=function(a){var c=this.resolve(a);return c!=null?new x.NamedNode(c):new x.NamedNode(a)};
x.RDFEnvironment.prototype.createLiteral=function(a,c,d){return d!=null?new x.Literal(a,c,d.toString()):new x.Literal(a,c,d)};x.RDFEnvironment.prototype.createTriple=function(a,c,d){return new x.Triple(a,c,d)};x.RDFEnvironment.prototype.createGraph=function(a){var c=new x.Graph;if(a!=null)for(var d=0;d<a.length;d++)c.add(a[d]);return c};x.RDFEnvironment.prototype.createAction=function(a,c){return function(d){return a(d)?c(d):d}};x.RDFEnvironment.prototype.createProfile=function(a){return a===!0?new x.RDFEnvironment.Profile:
(a=new x.RDFEnvironment.Profile,a.importProfile(this),a)};x.RDFEnvironment.prototype.createTermMap=function(a){if(a===!0)return new x.UrisMap;else{var a=this.terms.values(),c=new x.UrisMap,d;for(d in a)c[d]=a[d];return c}};x.RDFEnvironment.prototype.createPrefixMap=function(a){if(a===!0)return new x.UrisMap;else{var a=this.prefixes.values(),c=new x.UrisMap,d;for(d in a)c[d]=a[d];return c}};x.RDFNode=function(a){this.interfaceName=a;this.attributes=["interfaceName","nominalValue"]};x.RDFNode.prototype.equals=
function(a){if(a.interfaceName==null)return this.valueOf()==a;else{for(var c in this.attributes){var d=this.attributes[c];if(this[d]!=a[d])return!1}return!0}};x.BlankNode=function(a){x.RDFNode.call(this,"BlankNode");this.nominalValue="_:"+a;this.bnodeId=a};A["extends"](x.RDFNode,x.BlankNode);x.BlankNode.prototype.toString=function(){return this.nominalValue};x.BlankNode.prototype.toNT=function(){return this.nominalValue};x.BlankNode.prototype.valueOf=function(){return this.nominalValue};x.Literal=
function(a,c,d){x.RDFNode.call(this,"Literal");this.nominalValue=a;if(c!=null)this.language=c;else if(d!=null)this.datatype=d};A["extends"](x.RDFNode,x.Literal);x.Literal.prototype.toString=function(){var a='"'+this.nominalValue+'"';if(this.language!=null)a=a+"@"+this.language;else if(this.datatype!=null||this.type)a=a+"^^<"+(this.datatype||this.type)+">";return a};x.Literal.prototype.toNT=function(){return this.toString()};x.Literal.prototype.valueOf=function(){return f.effectiveTypeValue({token:"literal",
type:this.type||this.datatype,value:this.nominalValue,language:this.language})};x.NamedNode=function(a){x.RDFNode.call(this,"NamedNode");this.nominalValue=a.value!=null?a.value:a};A["extends"](x.RDFNode,x.NamedNode);x.NamedNode.prototype.toString=function(){return this.nominalValue};x.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"};x.NamedNode.prototype.valueOf=function(){return this.nominalValue};x.Triple=function(a,c,d){this.subject=a;this.predicate=c;this.object=d};x.Triple.prototype.equals=
function(a){return this.subject.equals(a.subject)&&this.predicate.equals(a.predicate)&&this.object.equals(a.object)};x.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"};x.Graph=function(){this.triples=[];this.duplicates={};this.actions=[]};x.Graph.prototype.add=function(a){for(var c=0;c<this.actions.length;c++)a=this.actions[c](a);c=a.subject.toString()+a.predicate.toString()+a.object.toString();this.duplicates[c]||(this.duplicates[c]=
!0,this.triples.push(a));return this};x.Graph.prototype.addAction=function(a,c){this.actions.push(a);if(c==!0)for(var d=0;d<this.triples.length;d++)this.triples[d]=a(this.triples[d]);return this};x.Graph.prototype.addAll=function(a){for(var a=a.toArray(),c=0;c<a.length;c++)this.add(a[c]);return this};x.Graph.prototype.remove=function(a){for(var c=null,d=0;d<this.triples.length;d++)if(this.triples[d].equals(a)){delete this.duplicates[a.subject.toString()+a.predicate.toString()+a.object.toString()];
c=d;break}c!=null&&this.triples.splice(c,1);return this};x.Graph.prototype.toArray=function(){return this.triples};x.Graph.prototype.some=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!0)return!0;return!1};x.Graph.prototype.every=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!1)return!1;return!0};x.Graph.prototype.filter=function(a){for(var c=new x.Graph,d=0;d<this.triples.length;d++)a(this.triples[d],this)===!0&&c.add(this.triples[d]);
return c};x.Graph.prototype.forEach=function(a){for(var c=0;c<this.triples.length;c++)a(this.triples[c],this)};x.Graph.prototype.merge=function(){for(var a=new x.Graph,c=0;c<this.triples;c++){var d=this.triples[c];a.add(d)}for(c=0;c<triples.length;c++)d=triples[c],this.add(d);return a};x.Graph.prototype.match=function(a,c,d,e){for(var f=new x.Graph,j=0,i=0;i<this.triples.length;i++){var l=this.triples[i];if(a==null||l.subject.equals(a))if(c==null||l.predicate.equals(c))if(d==null||l.object.equals(d))if(e==
null||j<e)j++,f.add(l);else break}return f};x.Graph.prototype.removeMatches=function(a,c,d){for(var e=[],f=0;f<this.triples.length;f++){var j=this.triples[f];if(a==null||j.subject.equals(a))if(c==null||j.predicate.equals(c))(d==null||j.object.equals(d))&&e.push(j)}for(f=0;f<e.length;f++)this.remove(e[f]);return this};x.Graph.prototype.toNT=function(){var a="";this.forEach(function(c){a+=c.toString()});return a};x.buildRDFResource=function(a,c,d,e){return a.token==="blank"?x.buildBlankNode(a,c,d,e):
a.token==="literal"?x.buildLiteral(a,c,d,e):a.token==="uri"?x.buildNamedNode(a,c,d,e):a.token==="var"?(a=c[a.value],a!=null?x.buildRDFResource(a,c,d,e):null):null};x.buildBlankNode=function(a){if(a.valuetmp!=null)a.value=a.valuetmp;if(a.value.indexOf("_:")===0)a.value=a.value.split("_:")[1];return new x.BlankNode(a.value)};x.buildLiteral=function(a){return new x.Literal(a.value,a.lang,a.type)};x.buildNamedNode=function(a,c,d,e){if(a.value==null&&a.prefix!=null)c=d.resolveNsInEnvironment(a.prefix,
e),a.value=c+a.suffix;return new x.NamedNode(a)};x.rdf=new x.RDFEnvironment;var f={checkFilters:function(a,c,d,e,k,j){var i=a.filter,l=[];if(i==null||a.length!=null)return c;for(a=0;a<i.length;a++){for(var c=f.run(i[a].value,c,d,e,k,j),u=[],w=0;w<c.length;w++)c[w].__nullify__!=null?l.push(c[w]):u.push(c[w]);c=u}return c.concat(l)}};f.boundVars=function(a){if(a.expressionType!=null){var c=a.expressionType;if(c=="relationalexpression")return c=a.op2,f.boundVars(a.op1)+f.boundVars(c);else if(c=="conditionalor"||
c=="conditionaland"){for(var d=[],c=0;c<a.operands;c++)d=d.concat(f.boundVars(a.operands[c]));return d}else if(c=="builtincall")if(a.args==null)return[];else{d=[];for(c=0;c<a.args.length;c++)d=d.concat(f.boundVars(a.args[c]));return d}else if(c=="multiplicativeexpression"){d=f.boundVars(a.factor);for(c=0;c<a.factors.length;c++)d=d.concat(f.boundVars(a.factors[c].expression));return d}else if(c=="additiveexpression"){d=f.boundVars(a.summand);for(c=0;c<a.summands.length;c++)d=d.concat(f.boundVars(a.summands[c].expression));
return d}else if(c=="regex")return d=f.boundVars(a.expression1),d.concat(f.boundVars(a.expression2));else if(c=="unaryexpression")return f.boundVars(a.expression);else if(c=="atomic")return a.primaryexpression=="var"?[a.value]:[]}else throw console.log("ERROR"),console.log(a),"Cannot find bound expressions in a no expression token";};f.run=function(a,c,d,e,k,j){for(var i=j.copyDenormalizedBindings(c,k.outCache),l=[],u=0;u<c.length;u++){var w=f.runFilter(a,i[u],j,e,k),w=f.ebv(w);f.isEbvError(w)?d&&
(w={__nullify__:!0,bindings:c[u]},l.push(w)):w===!0?l.push(c[u]):d&&(w={__nullify__:!0,bindings:c[u]},l.push(w))}return l};f.collect=function(a,c,d,e,k){for(var j=k.copyDenormalizedBindings(c,e.outCache),i=[],l=0;l<j.length;l++){var u=f.runFilter(a,j[l],k,d,e);i.push({binding:c[l],value:u})}return i};f.runDistinct=function(){};f.runAggregator=function(a,c,d,e,k){if(c==null||c.length===0)return f.ebvError();else if(a.token==="variable"&&a.kind=="var")return c[0][a.value.value];else if(a.token==="variable"&&
a.kind==="aliased")if(a.expression.expressionType==="atomic"&&a.expression.primaryexpression==="var")return c[0][a.expression.value.value];else if(a.expression.expressionType==="aggregate")if(a.expression.aggregateType==="max"){for(var j=null,i=0;i<c.length;i++){var l=c[i],l=f.runFilter(a.expression.expression,l,d,e,k);f.isEbvError(l)||(j===null?j=l:f.runLtFunction(j,l).value===!0&&(j=l))}return j===null?f.ebvError():j}else if(a.expression.aggregateType==="min"){j=null;for(i=0;i<c.length;i++)l=c[i],
l=f.runFilter(a.expression.expression,l,d,e,k),f.isEbvError(l)||(j===null?j=l:f.runGtFunction(j,l).value===!0&&(j=l));return j===null?f.ebvError():j}else if(a.expression.aggregateType==="count"){var j={},u=0;if(a.expression.expression==="*")if(a.expression.distinct!=null&&a.expression.distinct!="")for(i=0;i<c.length;i++){var l=c[i],w=A.hashTerm(l);j[w]==null&&(j[w]=!0,u++)}else u=c.length;else for(i=0;i<c.length;i++)l=c[i],l=f.runFilter(a.expression.expression,l,d,e,k),f.isEbvError(l)||(a.expression.distinct!=
null&&a.expression.distinct!=""?(w=A.hashTerm(l),j[w]==null&&(j[w]=!0,u++)):u++);return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+u}}else if(a.expression.aggregateType==="avg"){for(var j={},r={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},i=u=0;i<c.length;i++)l=c[i],l=f.runFilter(a.expression.expression,l,d,e,k),f.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(w=A.hashTerm(l),j[w]==null&&(j[w]=!0,f.isNumeric(l)&&
(r=f.runSumFunction(r,l),u++))):f.isNumeric(l)&&(r=f.runSumFunction(r,l),u++));a=f.runDivFunction(r,{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+u});a.value=""+a.value;return a}else if(a.expression.aggregateType==="sum"){j={};r={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(i=0;i<c.length;i++)l=c[i],l=f.runFilter(a.expression.expression,l,d,e,k),f.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(w=A.hashTerm(l),j[w]==
null&&(j[w]=!0,f.isNumeric(l)&&(r=f.runSumFunction(r,l)))):f.isNumeric(l)&&(r=f.runSumFunction(r,l)));r.value=""+r.value;return r}else return l=f.runFilter(aggregate.expression,c[0],e,{blanks:{},outCache:{}})};f.runFilter=function(a,c,d,e,k){if(a.expressionType!=null){var j=a.expressionType;if(j=="relationalexpression"){var j=f.runFilter(a.op1,c,d,e,k),i=f.runFilter(a.op2,c,d,e,k);return f.runRelationalFilter(a,j,i,c,d,e,k)}else if(j=="conditionalor")return f.runOrFunction(a,c,d,e,k);else if(j=="conditionaland")return f.runAndFunction(a,
c,d,e,k);else if(j=="additiveexpression")return f.runAddition(a.summand,a.summands,c,d,e,k);else if(j=="builtincall")return f.runBuiltInCall(a.builtincall,a.args,c,d,e,k);else if(j=="multiplicativeexpression")return f.runMultiplication(a.factor,a.factors,c,d,e,k);else if(j=="unaryexpression")return f.runUnaryExpression(a.unaryexpression,a.expression,c,d,e,k);else if(j=="irireforfunction")return f.runIriRefOrFunction(a.iriref,a.args,c,d,e,k);else if(j=="regex")return f.runRegex(a.text,a.pattern,a.flags,
c,d,e,k);else if(j=="atomic")if(a.primaryexpression=="var")return c[a.value.value];else{if(typeof a.value=="object"&&!(a.value.type==null||typeof a.value.type!="object"))a.value.type=A.lexicalFormBaseUri(a.value.type,k);return a.value}else throw"Unknown filter expression type";}else throw"Cannot find bound expressions in a no expression token";};f.isRDFTerm=function(a){return a==null?!1:a.token&&a.token=="literal"||a.token&&a.token=="uri"||a.token&&a.token=="blank"?!0:!1};f.RDFTermEquality=function(a,
c,d,e){return a.token==="literal"&&c.token==="literal"?a.lang==c.lang&&a.type==c.type&&a.value==c.value?!0:a.type!=null&&c.type!=null?f.ebvError():f.isSimpleLiteral(a)&&c.type!=null?f.ebvError():f.isSimpleLiteral(c)&&a.type!=null?f.ebvError():!1:a.token==="uri"&&c.token==="uri"?A.lexicalFormBaseUri(a,e)==A.lexicalFormBaseUri(c,e):a.token==="blank"&&c.token==="blank"?a.value==c.value:!1};f.isInteger=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||
a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||
a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};f.isFloat=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#float"?!0:!1:!1};f.isDecimal=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#decimal"?!0:!1:!1};f.isDouble=function(a){return a==
null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#double"?!0:!1:!1};f.isNumeric=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#float"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||
a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:
!1};f.isSimpleLiteral=function(a){return a&&a.token=="literal"?a.type==null&&a.lang==null?!0:!1:!1};f.isXsdType=function(a,c){return c&&c.token=="literal"?c.type=="http://www.w3.org/2001/XMLSchema#"+a:!1};f.ebv=function(a){if(a==null||f.isEbvError(a))return f.ebvError();else if(a.token&&a.token==="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||
a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||
a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"){var c=parseFloat(a.value);return isNaN(c)?!1:parseFloat(a.value)!=0}else return a.type==="http://www.w3.org/2001/XMLSchema#boolean"?a.value==="true"||a.value===!0||a.value==="True":a.type==="http://www.w3.org/2001/XMLSchema#string"?a.value!="":a.type==="http://www.w3.org/2001/XMLSchema#dateTime"?new Date(a.value)!=null:f.isEbvError(a)?a:a.type==null?a.value!=""?!0:!1:f.ebvError();else return a.value===!0};f.ebvTrue=function(){return{token:"literal",
type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}};f.ebvFalse=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}};f.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}};f.isEbvError=function(a){return typeof a=="object"&&a!=null?a.type==="https://github.com/antoniogarrote/js-tools/types#error":!1};f.ebvBoolean=function(a){return f.isEbvError(a)?a:a===!0?f.ebvTrue():f.ebvFalse()};f.runRelationalFilter=
function(a,c,d,e,k,j,i){a=a.operator;if(a==="=")return f.runEqualityFunction(c,d,e,k,j,i);else if(a==="!="){c=f.runEqualityFunction(c,d,e,k,j,i);if(!f.isEbvError(c))c.value=!c.value;return c}else if(a==="<")return f.runLtFunction(c,d,e);else if(a===">")return f.runGtFunction(c,d,e);else if(a==="<=")return f.runLtEqFunction(c,d,e);else if(a===">=")return f.runGtEqFunction(c,d,e);else throw"Error applying relational filter, unknown operator";};f.effectiveTypeValue=function(a){if(a.token=="literal")if(a.type==
"http://www.w3.org/2001/XMLSchema#integer")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#decimal")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#float")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#double")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#long")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#int")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#short")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#byte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#date"||a.type=="http://www.w3.org/2001/XMLSchema#dateTime")try{return A.parseISO8601(a.value)}catch(c){return null}else return a.type==
"http://www.w3.org/2001/XMLSchema#boolean"?a.value===!0||a.value==="true"||a.value==="1"||a.value===1||a.value===!0?!0:a.value===!1||a.value==="false"||a.value==="0"||a.value===0||a.value===!1?!1:void 0:a.type=="http://www.w3.org/2001/XMLSchema#string"?a.value===null||a.value===void 0?void 0:""+a.value:a.value;else throw console.log("not implemented yet"),"value not supported in operations yet";};f.runOrFunction=function(a,c,d,e,k){for(var j=null,i=0;i<a.operands.length;i++){var l=f.runFilter(a.operands[i],
c,d,e,k);f.isEbvError(l)==!1&&(l=f.ebv(l));j==null?j=l:f.isEbvError(l)?j=f.isEbvError(j)?f.ebvError():j===!0?!0:f.ebvError():l===!0?j=!0:f.isEbvError(j)&&(j=f.ebvError())}return f.ebvBoolean(j)};f.runAndFunction=function(a,c,d,e,k){for(var j=null,i=0;i<a.operands.length;i++){var l=f.runFilter(a.operands[i],c,d,e,k);f.isEbvError(l)==!1&&(l=f.ebv(l));j==null?j=l:f.isEbvError(l)?j=f.isEbvError(j)?f.ebvError():j===!0?f.ebvError():!1:l===!0?f.isEbvError(j)&&(j=f.ebvError()):j=!1}return f.ebvBoolean(j)};
f.runEqualityFunction=function(a,c,d,e,k,j){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();if(f.isNumeric(a)&&f.isNumeric(c))return d=f.effectiveTypeValue(a),k=f.effectiveTypeValue(c),isNaN(d)||isNaN(k)?f.ebvBoolean(f.RDFTermEquality(a,c,e,j)):f.ebvBoolean(d==k);else if((f.isSimpleLiteral(a)||f.isXsdType("string",a))&&(f.isSimpleLiteral(c)||f.isXsdType("string",c)))return f.ebvBoolean(f.effectiveTypeValue(a)==f.effectiveTypeValue(c));else if(f.isXsdType("boolean",a)&&f.isXsdType("boolean",
c))return f.ebvBoolean(f.effectiveTypeValue(a)==f.effectiveTypeValue(c));else if((f.isXsdType("dateTime",a)||f.isXsdType("date",a))&&(f.isXsdType("dateTime",c)||f.isXsdType("date",c))){if(f.isXsdType("dateTime",a)&&f.isXsdType("date",c))return f.ebvFalse();if(f.isXsdType("date",a)&&f.isXsdType("dateTime",c))return f.ebvFalse();a=A.compareDateComponents(a.value,c.value);return a!=null?a==0?f.ebvTrue():f.ebvFalse():f.ebvError()}else return f.isRDFTerm(a)&&f.isRDFTerm(c)?f.ebvBoolean(f.RDFTermEquality(a,
c,e,j)):f.ebvFalse()};f.runGtFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();if(f.isNumeric(a)&&f.isNumeric(c))return f.ebvBoolean(f.effectiveTypeValue(a)>f.effectiveTypeValue(c));else if(f.isSimpleLiteral(a)&&f.isSimpleLiteral(c))return f.ebvBoolean(f.effectiveTypeValue(a)>f.effectiveTypeValue(c));else if(f.isXsdType("string",a)&&f.isXsdType("string",c))return f.ebvBoolean(f.effectiveTypeValue(a)>f.effectiveTypeValue(c));else if(f.isXsdType("boolean",a)&&f.isXsdType("boolean",
c))return f.ebvBoolean(f.effectiveTypeValue(a)>f.effectiveTypeValue(c));else if((f.isXsdType("dateTime",a)||f.isXsdType("date",a))&&(f.isXsdType("dateTime",c)||f.isXsdType("date",c))){if(f.isXsdType("dateTime",a)&&f.isXsdType("date",c))return f.ebvFalse();if(f.isXsdType("date",a)&&f.isXsdType("dateTime",c))return f.ebvFalse();var d=A.compareDateComponents(a.value,c.value);return d!=null?d==1?f.ebvTrue():f.ebvFalse():f.ebvError()}else return f.ebvFalse()};f.runTotalGtFunction=function(a,c){return f.isEbvError(a)||
f.isEbvError(c)?f.ebvError():f.isNumeric(a)&&f.isNumeric(c)||f.isSimpleLiteral(a)&&f.isSimpleLiteral(c)||f.isXsdType("string",a)&&f.isSimpleLiteral("string",c)||f.isXsdType("boolean",a)&&f.isSimpleLiteral("boolean",c)||f.isXsdType("dateTime",a)&&f.isSimpleLiteral("dateTime",c)?f.runGtFunction(a,c,[]):a.token&&a.token==="uri"&&c.token&&c.token==="uri"?f.ebvBoolean(a.value>c.value):a.token&&a.token==="literal"&&c.token&&c.token==="literal"?f.ebvBoolean(""+a.value+a.type+a.lang>""+c.value+c.type+c.lang):
a.token&&a.token==="blank"&&c.token&&c.token==="blank"?f.ebvBoolean(a.value>c.value):a.value&&c.value?f.ebvBoolean(a.value>c.value):f.ebvTrue()};f.runLtFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();if(f.isNumeric(a)&&f.isNumeric(c))return f.ebvBoolean(f.effectiveTypeValue(a)<f.effectiveTypeValue(c));else if(f.isSimpleLiteral(a)&&f.isSimpleLiteral(c))return f.ebvBoolean(f.effectiveTypeValue(a)<f.effectiveTypeValue(c));else if(f.isXsdType("string",a)&&f.isXsdType("string",
c))return f.ebvBoolean(f.effectiveTypeValue(a)<f.effectiveTypeValue(c));else if(f.isXsdType("boolean",a)&&f.isXsdType("boolean",c))return f.ebvBoolean(f.effectiveTypeValue(a)<f.effectiveTypeValue(c));else if((f.isXsdType("dateTime",a)||f.isXsdType("date",a))&&(f.isXsdType("dateTime",c)||f.isXsdType("date",c))){if(f.isXsdType("dateTime",a)&&f.isXsdType("date",c))return f.ebvFalse();if(f.isXsdType("date",a)&&f.isXsdType("dateTime",c))return f.ebvFalse();var d=A.compareDateComponents(a.value,c.value);
return d!=null?d==-1?f.ebvTrue():f.ebvFalse():f.ebvError()}else return f.ebvFalse()};f.runGtEqFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();if(f.isNumeric(a)&&f.isNumeric(c))return f.ebvBoolean(f.effectiveTypeValue(a)>=f.effectiveTypeValue(c));else if(f.isSimpleLiteral(a)&&f.isSimpleLiteral(c))return f.ebvBoolean(f.effectiveTypeValue(a)>=f.effectiveTypeValue(c));else if(f.isXsdType("string",a)&&f.isXsdType("string",c))return f.ebvBoolean(f.effectiveTypeValue(a)>=f.effectiveTypeValue(c));
else if(f.isXsdType("boolean",a)&&f.isXsdType("boolean",c))return f.ebvBoolean(f.effectiveTypeValue(a)>=f.effectiveTypeValue(c));else if((f.isXsdType("dateTime",a)||f.isXsdType("date",a))&&(f.isXsdType("dateTime",c)||f.isXsdType("date",c))){if(f.isXsdType("dateTime",a)&&f.isXsdType("date",c))return f.ebvFalse();if(f.isXsdType("date",a)&&f.isXsdType("dateTime",c))return f.ebvFalse();var d=A.compareDateComponents(a.value,c.value);return d!=null?d!=-1?f.ebvTrue():f.ebvFalse():f.ebvError()}else return f.ebvFalse()};
f.runLtEqFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();if(f.isNumeric(a)&&f.isNumeric(c))return f.ebvBoolean(f.effectiveTypeValue(a)<=f.effectiveTypeValue(c));else if(f.isSimpleLiteral(a)&&f.isSimpleLiteral(c))return f.ebvBoolean(f.effectiveTypeValue(a)<=f.effectiveTypeValue(c));else if(f.isXsdType("string",a)&&f.isXsdType("string",c))return f.ebvBoolean(f.effectiveTypeValue(a)<=f.effectiveTypeValue(c));else if(f.isXsdType("boolean",a)&&f.isXsdType("boolean",c))return f.ebvBoolean(f.effectiveTypeValue(a)<=
f.effectiveTypeValue(c));else if((f.isXsdType("dateTime",a)||f.isXsdType("date",a))&&(f.isXsdType("dateTime",c)||f.isXsdType("date",c))){if(f.isXsdType("dateTime",a)&&f.isXsdType("date",c))return f.ebvFalse();if(f.isXsdType("date",a)&&f.isXsdType("dateTime",c))return f.ebvFalse();var d=A.compareDateComponents(a.value,c.value);return d!=null?d!=1?f.ebvTrue():f.ebvFalse():f.ebvError()}else return f.ebvFalse()};f.runAddition=function(a,c,d,e,k,j){var i=f.runFilter(a,d,e,k,j);if(f.isEbvError(i))return f.ebvError();
a=i;if(f.isNumeric(i)){for(i=0;i<c.length;i++){var l=f.runFilter(c[i].expression,d,e,k,j);if(f.isNumeric(l))c[i].operator==="+"?a=f.runSumFunction(a,l):c[i].operator==="-"&&(a=f.runSubFunction(a,l));else return f.ebvFalse()}return a}else return f.ebvFalse()};f.runSumFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();var d=f.effectiveTypeValue(a)+f.effectiveTypeValue(c);return f.isDouble(a)||f.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:d}:
f.isFloat(a)||f.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:d}:f.isDecimal(a)||f.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:d}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:d}};f.runSubFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();var d=f.effectiveTypeValue(a)-f.effectiveTypeValue(c);return f.isDouble(a)||f.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",
value:d}:f.isFloat(a)||f.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:d}:f.isDecimal(a)||f.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:d}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:d}};f.runMultiplication=function(a,c,d,e,k,j){a=f.runFilter(a,d,e,k,j);if(f.isEbvError(a))return a;var i=a;if(f.isNumeric(a)){for(var l=0;l<c.length;l++){var u=f.runFilter(c[l].expression,d,e,k,j);if(f.isEbvError(u))return a;
if(f.isNumeric(u))c[l].operator==="*"?i=f.runMulFunction(i,u):c[l].operator==="/"&&(i=f.runDivFunction(i,u));else return f.ebvFalse()}return i}else return f.ebvFalse()};f.runMulFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();var d=f.effectiveTypeValue(a)*f.effectiveTypeValue(c);return f.isDouble(a)||f.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:d}:f.isFloat(a)||f.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:d}:f.isDecimal(a)||f.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:d}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:d}};f.runDivFunction=function(a,c){if(f.isEbvError(a)||f.isEbvError(c))return f.ebvError();var d=f.effectiveTypeValue(a)/f.effectiveTypeValue(c);return f.isDouble(a)||f.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:d}:f.isFloat(a)||f.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:d}:f.isDecimal(a)||f.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:d}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:d}};f.runBuiltInCall=function(a,c,d,e,k,j){if(a==="notexists"||a==="exists"){var i=JSON.parse(JSON.stringify(c[0])),i=e.abstractQueryTree.parseSelect({pattern:i},d),i=e.abstractQueryTree.bind(i.pattern,d),d=e.executeSelectUnit([{kind:"*"}],k,i,j);return a==="exists"?f.ebvBoolean(d.length!==0):f.ebvBoolean(d.length===
0)}else{for(var i=[],l=0;l<c.length;l++)if(c[l].token==="var")i.push(c[l]);else{var u=f.runFilter(c[l],d,e,k,j);if(f.isEbvError(u))return u;i.push(u)}if(a==="str")return i[0].token==="literal"?{token:"literal",type:null,value:""+i[0].value}:i[0].token==="uri"?{token:"literal",type:null,value:i[0].value}:f.ebvFalse();else if(a==="lang")return i[0].token==="literal"?i[0].lang!=null?{token:"literal",value:""+i[0].lang}:{token:"literal",value:""}:f.ebvError();else if(a==="datatype")return i[0].token===
"literal"?(a=i[0],a.type!=null?typeof a.type==="string"?{token:"uri",value:a.type,prefix:null,suffix:null}:a.type:a.lang==null?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:f.ebvError()):f.ebvError();else if(a==="isliteral")return i[0].token==="literal"?f.ebvTrue():f.ebvFalse();else if(a==="isblank")return i[0].token==="blank"?f.ebvTrue():f.ebvFalse();else if(a==="isuri"||a==="isiri")return i[0].token==="uri"?f.ebvTrue():f.ebvFalse();else if(a==="sameterm")return a=
f.RDFTermEquality(i[0],i[1],e,j),f.isEbvError(a)&&(a=!1),f.ebvBoolean(a);else if(a==="langmatches")return a=i[0],d=i[1],a.token==="literal"&&d.token==="literal"?d.value==="*"&&a.value!=""?f.ebvTrue():f.ebvBoolean(a.value.toLowerCase().indexOf(d.value.toLowerCase())===0):f.ebvError();else if(a==="bound")return a=i[0].value,a==null?f.ebvError():d[a]!=null?f.ebvTrue():f.ebvFalse();else throw"Builtin call "+a+" not implemented yet";}};f.runUnaryExpression=function(a,c,d,e,k,j){c=f.runFilter(c,d,e,k,j);
if(f.isEbvError(c))return c;if(a==="!"){var i=f.ebv(c);return f.isEbvError(i)?f.ebvFalse():f.ebvBoolean(!i)}else if(a==="+")return f.isNumeric(c)?c:f.ebvError();else if(a==="-")if(f.isNumeric(c)){a={};for(i in c)a[i]=c[i];a.value=-a.value;return a}else return f.ebvError()};f.runRegex=function(a,c,d,e,k,j,i){if(a!=null)a=f.runFilter(a,e,k,j,i);else return f.ebvError();if(c!=null)c=f.runFilter(c,e,k,j,i);else return f.ebvError();d!=null&&(d=f.runFilter(d,e,k,j,i));if(c!=null&&c.token==="literal"&&(d==
null||d.token==="literal"))c=c.value,d=d==null?null:d.value;else return f.ebvError();if(a!=null&&a.token=="var")if(e[a.value]!=null)a=e[a.value];else return f.ebvError();else if(a!=null&&a.token==="literal")if(a.type==null||f.isXsdType("string",a))a=a.value;else return f.ebvError();else return f.ebvError();return(d==null?RegExp(c):RegExp(c,d.toLowerCase())).exec(a)?f.ebvTrue():f.ebvFalse()};f.normalizeLiteralDatatype=function(a,c,d){if(!(a.value.type==null||typeof a.value.type!="object"))a.value.type=
A.lexicalFormBaseUri(a.value.type,d);return a};f.runIriRefOrFunction=function(a,c,d,e,k,j){if(c==null)return a;else{for(var i=[],l=0;l<c.length;l++)i.push(f.runFilter(c[l],d,e,k,j));a=A.lexicalFormBaseUri(a,j);if(a=="http://www.w3.org/2001/XMLSchema#integer"||a=="http://www.w3.org/2001/XMLSchema#decimal"||a=="http://www.w3.org/2001/XMLSchema#double"||a=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a=="http://www.w3.org/2001/XMLSchema#long"||
a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#short"||a=="http://www.w3.org/2001/XMLSchema#byte"||a=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a=="http://www.w3.org/2001/XMLSchema#positiveInteger")if(i=i[0],i.token==="literal")if(i=f.normalizeLiteralDatatype(i,
e,j),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||
i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return i.type=a,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return f.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=
a,i.value=parseInt(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null){if(i.value.split(".").length>2)return f.ebvError();else if(i.value.split("-").length>2)return f.ebvError();else if(i.value.split("/").length>2)return f.ebvError();else if(i.value.split("+").length>2)return f.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#decimal"&&(i.value.indexOf("e")!=-1||i.value.indexOf("E")!=-1))return f.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#integer")if(i.value.indexOf("e")!=
-1||i.value.indexOf("E")!=-1||i.value.indexOf(".")!=-1)return f.ebvError();try{return i.value=parseInt(parseFloat(i.value)),isNaN(i.value)?f.ebvError():(i.type=a,i)}catch(u){return f.ebvError()}}else return f.ebvError();else return f.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#boolean")return i=i[0],i.token==="literal"&&i.type==null?i.value==="true"||i.value==="1"?f.ebvTrue():i.value==="false"||i.value==="0"?f.ebvFalse():f.ebvError():i.token==="literal"?f.isEbvError(i)?i:f.ebvBoolean(i):
f.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#string")if(i=i[0],i.token==="literal")if(i=f.normalizeLiteralDatatype(i,e,j),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||
i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#float")return i.type=
a,i.value=""+i.value,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return f.ebv(i)?(i.type=a,i.value="true"):(i.type=a,i.value="false"),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date"){i.type=a;if(typeof i.value!="string")i.value=A.iso8601(i.value);return i}else return i.type==null?(i.value=""+i.value,i.type=a,i):f.ebvError();else return i.token==="uri"?
{token:"literal",value:A.lexicalFormBaseUri(i,j),type:a,lang:null}:f.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#dateTime"||a=="http://www.w3.org/2001/XMLSchema#date")if(i=i[0],i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null)try{return i.value=A.iso8601(A.parseStrictISO8601(i.value)),i.type=a,i}catch(w){return f.ebvError()}else return f.ebvError();else if(a==
"http://www.w3.org/2001/XMLSchema#float")if(i=i[0],i.token==="literal")if(i=f.normalizeLiteralDatatype(i,e,j),i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#int")return i.type=a,i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return f.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=a,
i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")try{return i.value=parseFloat(i.value),isNaN(i.value)?f.ebvError():(i.type=a,i)}catch(r){return f.ebvError()}else if(i.type==null){if(i.value.split(".").length>2)return f.ebvError();else if(i.value.split("-").length>2)return f.ebvError();else if(i.value.split("/").length>2)return f.ebvError();else if(i.value.split("+").length>2)return f.ebvError();try{return i.value=parseFloat(i.value),isNaN(i.value)?f.ebvError():
(i.type=a,i)}catch(x){return f.ebvError()}}else return f.ebvError();else return f.ebvError();else return f.ebvError()}};var C={variablesInBGP:function(a){var c=a.variables;if(c)return c;var d=a.value||a,c=[],e;for(e in d)d[e]&&d[e].token==="var"?c.push(d[e].value):d[e]&&d[e].token==="blank"&&c.push("blank:"+d[e].value);return a.variables=c},connected:function(a,c){for(var d="/"+a.vars.join("/")+"/",e=0;e<c.vars.length;e++)if(d.indexOf("/"+c.vars[e]+"/")!=-1)return!0;return!1},variablesIntersectionBGP:function(a,
c){for(var d=C.variablesInBGP(a).sort(),e=C.variablesInBGP(c).sort(),f=0,j=0,i=[];f<d.length&&j<e.length;)d[f]===e[j]?(i.push(d[f]),f++,j++):d[f]<e[j]?f++:j++;return i},executeAndBGPsGroups:function(a){for(var c={},d={},e=0,f=0;f<a.length;f++){var j=a[f],i={},l={},u=[],w;for(w in j)w!="_cost"&&(j[w].token==="var"?u.push(j[w].value):j[w].token==="blank"&&u.push(j[w].value));var r=!1,x={},A;for(A in d){for(var B=d[A],r=!1,C=0;C<u.length;C++)if(B.indexOf("/"+u[C]+"/")!=-1){r=!0;break}r?x[A]=!0:(i[A]=
c[A],l[A]=d[A])}if(r){var r=[],C=B="",s;for(s in x)B+=s,r=r.concat(c[s]),C=d[s];C=C+u.join("/")+"/";r.push(j);i[B]=r;l[B]=C}else i[e]=[j],l[e]="/"+u.join("/")+"/",e++;c=i;d=l}a=[];for(e in c)a.push(c[e]);return a},intersectionSize:function(a,c){for(var d=c.i.split("_"),e=0;e<d.length;e++)if(d[e]!=""&&a.i.indexOf("_"+d[e]+"_")!=-1)return 1;return 0},createJoinTree:function(a,c){for(var d="/"+a.vars.join("/")+"/",e=a.vars.concat([]),f=[],j=0;j<c.vars.length;j++)d.indexOf("/"+c.vars[j]+"/")!=-1?c.vars[j].indexOf("_:")==
0?f.push("blank:"+c.vars[j]):f.push(c.vars[j]):e.push(c.vars[j]);for(var i=c.i.split("_"),l=a.i.split("_"),d={},j=0;j<i.length;j++)i[j]!=""&&(d[i[j]]=!0);for(j=0;j<l.length;j++)l[j]!=""&&(d[l[j]]=!0);var j=[],u;for(u in d)j.push(u);return{left:a,right:c,cost:a.cost+c.cost,i:"_"+j.sort().join("_")+"_",vars:e,join:f}}};C.executeBushyTree=function(a,c,d,e){if(a.left==null)return C.executeEmptyJoinBGP(a.right,c,d,e);else if(a.right==null)return C.executeEmptyJoinBGP(a.left,c,d,e);else{var f=C.executeBushyTree(a.left,
c,d,e);if(f!=null)return c=C.executeBushyTree(a.right,c,d,e),c!=null?C.joinBindings2(a.join,f,c):null}};C.executeAndBGPsDPSize=function(a,c,d,e){for(var f=C.executeAndBGPsGroups(a),a=[],j=0;j<f.length;j++){var i=f[j];d.computeCosts(i,e);var l={},u={},w={},r=1,x=null,A={};w["1"]=[];for(var B=0;B<i.length;B++){var r=[],G;for(G in i[B])G!="_cost"&&(i[B][G].token==="var"?r.push(i[B][G].value):i[B][G].token==="blank"&&r.push(i[B][G].value));u["_"+B+"_"]={left:i[B],right:null,cost:i[B]._cost,i:"_"+B+"_",
vars:r};r={left:i[B],right:null,cost:i[B]._cost,i:"_"+B+"_",vars:r};l["_"+B+"_"]=r;delete i[B]._cost;A["_"+B+"_"]=!0;w["1"].push("_"+B+"_");if(x==null||x.cost>r.cost)x=r}for(var s=2;s<=i.length;s++)for(var n=1;n<s;n++)for(var D=w[""+n]||[],z=w[""+(s-n)]||[],B=0;B<D.length;B++)for(var H=0;H<z.length;H++)if(D[B]!==z[H]){var F=u[D[B]],E=u[z[H]];if(C.intersectionSize(F,E)==0&&C.connected(F,E)&&(r=s,E=C.createJoinTree(l[F.i],l[E.i]),!A[E.i])){A[E.i]=!0;var J=E.cost+1;if(l[E.i]!=null)J=l[E.i].cost;F=w[s]||
[];F.push(E.i);u[E.i]=E;w[s]=F;J>E.cost&&(r===s&&(x=E),l[E.i]=E)}}a.push(x)}F=null;for(j=0;j<a.length;j++)G=C.executeBushyTree(a[j],c,d,e),F=F==null?G:C.crossProductBindings(F,G);return F};C.executeEmptyJoinBGP=function(a,c,d,e){return C.executeBGPDatasets(a,c,d,e)};C.executeBGPDatasets=function(a,c,d,e){var f={};if(a.graph==null){for(var j=[],i=0;i<c.implicit.length;i++)if(f[c.implicit[i].oid]==null){f[c.implicit[i].oid]=!0;a.graph=c.implicit[i];var l=d.rangeQuery(a,e),l=C.buildBindingsFromRange(l,
a);j.push(l)}return a=C.unionManyBindings(j)}else if(a.graph.token==="var"){for(var u=a.graph.value,j=[],i=0;i<c.named.length;i++)if(f[c.named[i].oid]==null)if(f[c.named[i].oid]=!0,a.graph=c.named[i],l=d.rangeQuery(a,e),l!=null){for(var l=C.buildBindingsFromRange(l,a),w=0;w<l.length;w++)l[w][u]=c.named[i].oid;j.push(l)}else return null;return a=C.unionManyBindings(j||[])}else return l=d.rangeQuery(a,e),l!=null?l=C.buildBindingsFromRange(l,a):null};C.buildBindingsFromRange=function(a,c){C.variablesInBGP(c);
var d={},e=c.value||c,d={};for(l in e)e[l]&&e[l].token==="var"?d[l]=e[l].value:e[l]&&e[l].token==="blank"&&(d[l]="blank:"+e[l].value);e=[];if(a!=null)for(var f=0;f<a.length;f++){var j={},i=a[f],l;for(l in d)j[d[l]]=i[l];e.push(j)}return e};C.areCompatibleBindings=function(a,c){for(var d in a)if(c[d]!=null&&c[d]!=a[d])return!1;return!0};C.mergeBindings=function(a,c){var d={},e;for(e in a)d[e]=a[e];for(e in c)d[e]=c[e];return d};C.joinBindings2=function(a,c,d){for(var e={},f,j,i,l,u=[],w=0;w<c.length;w++){f=
c[w];l=e;for(var r=0;r<a.length;r++)j=a[r],j=f[j],r==a.length-1?(i=l[j]||[],i.push(f),l[j]=i):(i=l[j]||{},l=l[j]=i)}for(w=0;w<d.length;w++){f=d[w];l=e;for(r=0;r<a.length;r++)if(j=a[r],j=f[j],l[j]!=null)if(r==a.length-1)for(c=0;c<l[j].length;c++)u.push(C.mergeBindings(l[j][c],f));else l=l[j]}return u};C.joinBindings=function(a,c){for(var d=[],e=0;e<a.length;e++)for(var f=a[e],j=0;j<c.length;j++){var i=c[j];C.areCompatibleBindings(f,i)&&d.push(C.mergeBindings(f,i))}return d};C.augmentMissingBindings=
function(a,c){for(var d in c)a[d]==null&&(a[d]=null);return a};C.leftOuterJoinBindings=function(a,c){for(var d=[],e=0;e<a.length;e++){for(var f=a[e],j=!1,i=0;i<c.length;i++){var l=c[i];C.areCompatibleBindings(f,l)&&(j=!0,d.push(C.mergeBindings(f,l)))}j===!1&&(C.augmentMissingBindings(f,l),d.push(f))}return d};C.crossProductBindings=function(a,c){for(var d=[],e=0;e<a.length;e++)for(var f=a[e],j=0;j<c.length;j++)d.push(C.mergeBindings(f,c[j]));return d};C.unionBindings=function(a,c){return a.concat(c)};
C.unionManyBindings=function(a){for(var c=[],d=0;d<a.length;d++)c=C.unionBindings(c,a[d]);return c};var E={},ga=C;E.QueryEngine=function(a){if(arguments.length!=0)this.backend=a.backend,this.lexicon=a.lexicon,this.eventsOnBatchLoad=a.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new N.AbstractQueryTree,this.rdfLoader=new aa.RDFLoader(a.communication),this.callbacksBackend=new F.CallbacksBackend(this)};E.QueryEngine.prototype.registerNsInEnvironment=function(a,c){var d=[];if(a!=
null&&a.prefixes!=null)d=a.prefixes;var e={},f;for(f in this.defaultPrefixes)e[f]=this.defaultPrefixes[f];for(f=0;f<d.length;f++){var j=d[f];if(j.token==="prefix")e[j.prefix]=j.local}c.namespaces=e;c.base=a!=null&&a.base&&typeof a.base==="object"?a.base.value:null};E.QueryEngine.prototype.applyModifier=function(a,c){if(a=="DISTINCT"){for(var d={},e=[],f=0;f<c.length;f++){var j=c[f],i="",l;for(l in j){var u=j[l];u==null?i=i+l+"null":u.token=="literal"?(u.value!=null&&(i+=u.value),u.lang!=null&&(i+=
u.lang),u.type!=null&&(i+=u.type)):i=u.value?i+l+u.value:i+l+u}d[i]==null&&(e.push(j),d[i]=!0)}return e}else return c};E.QueryEngine.prototype.applyLimitOffset=function(a,c,d){if(c==null&&a==null)return d;a==null&&(a=0);c=c==null?d.length:a+c;return d.slice(a,c)};E.QueryEngine.prototype.applySingleOrderBy=function(a,c,d,e){for(var k=[],j=0;j<a.length;j++){var i=f.collect(a[j].expression,[c],d,e,this);k.push(i[0].value)}return{binding:c,value:k}};E.QueryEngine.prototype.applyOrderBy=function(a,c,d,
e){var f=this,j=[];if(a!=null&&a.length>0){for(var i=0;i<c.length;i++){var l=f.applySingleOrderBy(a,c[i],d,e);j.push(l)}j.sort(function(c,d){return f.compareFilteredBindings(c,d,a,e)});c=[];for(i=0;i<j.length;i++)c.push(j[i].binding)}return c};E.QueryEngine.prototype.compareFilteredBindings=function(a,c,d,e){for(var k=0;;){if(k==a.value.length)return 0;var j=d[k].direction;if(a.value[k]==null&&c.value[k]==null)k++;else{if(a.value[k]==null)a={value:!1};else if(c.value[k]==null)a={value:!0};else if(a.value[k].token===
"blank"&&c.value[k].token==="blank"){k++;continue}else if(a.value[k].token==="blank")a={value:!1};else if(c.value[k].token==="blank")a={value:!0};else if(a.value[k].token==="uri"&&c.value[k].token==="uri")if(f.runEqualityFunction(a.value[k],c.value[k],[],this,e).value==!0){k++;continue}else a=f.runTotalGtFunction(a.value[k],c.value[k],[]);else if(a.value[k].token==="uri")a={value:!1};else if(c.value[k].token==="uri")a={value:!0};else if(a.value[k].token==="literal"&&c.value[k].token==="literal"&&
a.value[k].type==null&&c.value[k].type==null)if(f.runEqualityFunction(a.value[k],c.value[k],[],this,e).value==!0){k++;continue}else a=f.runTotalGtFunction(a.value[k],c.value[k],[]);else if(a.value[k].token==="literal"&&a.value[k].type==null)a={value:!1};else if(c.value[k].token==="literal"&&c.value[k].type==null)a={value:!0};else if(f.runEqualityFunction(a.value[k],c.value[k],[],this,e).value==!0){k++;continue}else a=f.runTotalGtFunction(a.value[k],c.value[k],[]);return a.value==!0?j==="ASC"?1:-1:
j==="ASC"?-1:1}}};E.QueryEngine.prototype.removeDefaultGraphBindings=function(a,c){for(var d=[],e={},f=0;f<c.named.length;f++)e[c.named[f].oid]=!0;for(f=0;f<c.implicit.length;f++)e[c.implicit[f].oid]==null&&d.push(c.implicit[f].oid);d=[];for(f=0;f<a.length;f++){var j=a[f],i=!1,l;for(l in j){for(var u=0;u<e.length;u++)if(j[l]===e[u]){i=!0;break}if(i)break}i||d.push(j)}return d};E.QueryEngine.prototype.aggregateBindings=function(a,c,d,e){for(var c=this.copyDenormalizedBindings(c,e.outCache),k={},j=
0;j<a.length;j++){var i=f.runAggregator(a[j],c,this,d,e);a[j].alias?k[a[j].alias.value]=i:k[a[j].value.value]=i}return k};E.QueryEngine.prototype.projectBindings=function(a,c,d){if(a[0].kind==="*")return c;else{for(var e=[],k=0;k<c.length;k++){for(var j=c[k],i={},l=!0,u=0;u<a.length;u++)if(a[u].token=="variable"&&a[u].kind!="aliased")i[a[u].value.value]=j[a[u].value.value];else if(a[u].token=="variable"&&a[u].kind=="aliased"){var w=f.runFilter(a[u].expression,j,this,d,{blanks:{},outCache:{}});if(f.isEbvError(w)){l=
!1;break}else i[a[u].alias.value]=w}l===!0&&e.push(i)}return e}};E.QueryEngine.prototype.resolveNsInEnvironment=function(a,c){return c.namespaces[a]};E.QueryEngine.prototype.termCost=function(a,c){if(a.token==="uri"){var d=A.lexicalFormBaseUri(a,c);return d==null?0:this.lexicon.resolveUriCost(d)}else return a.token==="literal"?this.lexicon.resolveLiteralCost(A.lexicalFormLiteral(a,c)):a.token==="blank"?this.lexicon.resolveBlankCost(a.value):a.token==="var"?this.lexicon.oidCounter/3:null};E.QueryEngine.prototype.normalizeTerm=
function(a,c,d){if(a.token==="uri")return c=A.lexicalFormBaseUri(a,c),c==null?null:d?this.lexicon.registerUri(c):this.lexicon.resolveUri(c);else if(a.token==="literal")return c=A.lexicalFormLiteral(a,c),a=d?this.lexicon.registerLiteral(c):this.lexicon.resolveLiteral(c);else if(a.token==="blank"){var e=a.value,a=c.blanks[e];a==null&&(a=d?this.lexicon.registerBlank(e):this.lexicon.resolveBlank(e),c.blanks[e]=a);return a}else return a.token==="var"?a.value:null};E.QueryEngine.prototype.normalizeDatasets=
function(a,c){for(var d=0;d<a.length;d++){var e=a[d];if(e.value===this.lexicon.defaultGraphUri)e.oid=this.lexicon.defaultGraphOid;else{var f=this.normalizeTerm(e,c,!1);if(f!=null)e.oid=f;else return null}}return!0};E.QueryEngine.prototype.normalizeQuad=function(a,c,d){var e=null,f=null,j=e=null,i;if(a.graph==null)j=0;else if(i=this.normalizeTerm(a.graph,c,d),i!=null)j=i,d===!0&&a.graph.token!="var"&&this.lexicon.registerGraph(i);else return null;i=this.normalizeTerm(a.subject,c,d);if(i!=null)e=i;
else return null;i=this.normalizeTerm(a.predicate,c,d);if(i!=null)f=i;else return null;i=this.normalizeTerm(a.object,c,d);return i==null?null:{subject:e,predicate:f,object:i,graph:j}};E.QueryEngine.prototype.quadCost=function(a,c){var d=null,e=null,f=null,j=null,j=a.graph==null?this.lexicon.oidCounter/4:this.termCost(a.graph,c),d=this.termCost(a.subject,c),e=this.termCost(a.predicate,c),f=this.termCost(a.object,c);return j+d+e+f};E.QueryEngine.prototype.denormalizeBindingsList=function(a,c){for(var d=
[],e=0;e<a.length;e++){var f=this.denormalizeBindings(a[e],c);d.push(f)}return d};E.QueryEngine.prototype.copyDenormalizedBindings=function(a,c){for(var d=[],e=0;e<a.length;e++){for(var f={},j=a[e],i=A.keys(j),l=0;l<i.length;l++){var u=j[i[l]];if(u==null)f[i[l]]=null;else if(typeof u==="object")f[i[l]]=u;else{var w=c[u];w==null&&(w=this.lexicon.retrieve(u),c[u]=w);f[i[l]]=w}}d.push(f)}return d};E.QueryEngine.prototype.denormalizeBindings=function(a,c){for(var d=A.keys(a),e=c.outCache,f=0;f<d.length;f++){var j=
a[d[f]];if(j==null)a[d[f]]=null;else if(e[j]!=null)a[d[f]]=e[j];else{var i=this.lexicon.retrieve(j);a[d[f]]=i;i.token==="blank"&&(c.blanks[i.value]=j)}}return a};E.QueryEngine.prototype.execute=function(a,c,d,e){a=A.normalizeUnicodeLiterals(a);a=this.abstractQueryTree.parseQueryString(a);if(a==null)c(!1,"Error parsing query string");else if(a.token==="query"&&a.kind=="update"){this.callbacksBackend.startGraphModification();var f=this;this.executeUpdate(a,function(a,d){f.lexicon.updateAfterWrite&&
f.lexicon.updateAfterWrite();a?f.callbacksBackend.endGraphModification(function(){c(a,d)}):(f.callbacksBackend.cancelGraphModification(),c(a,d))})}else a.token==="query"&&a.kind=="query"&&this.executeQuery(a,c,d,e)};E.QueryEngine.prototype.executeQuery=function(a,c,d,e){var f=a.units,j=this,i={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,i);var l=j.abstractQueryTree.parseExecutableUnit(f[0]);if(l.kind==="select")this.executeSelect(l,i,d,e,function(a,d){a?typeof d==="object"&&d.denorm===
!0?c(!0,d.bindings):(d=j.denormalizeBindingsList(d,i),d!=null?c(!0,d):c(!1,d)):c(!1,d)});else if(l.kind==="ask")l.projection=[{token:"variable",kind:"*"}],this.executeSelect(l,i,d,e,function(a,d){a?a?d.length>0?c(!0,!0):c(!0,!1):c(!1,d):c(!1,d)});else if(l.kind==="construct")l.projection=[{token:"variable",kind:"*"}],j=this,this.executeSelect(l,i,d,e,function(a,d){if(a)if(a)if(d=j.denormalizeBindingsList(d,i),d!=null){var e=new x.Graph;if(l.template==null)l.template={triplesContext:l.pattern};for(var f=
1,k=[],A=0;A<d.length;A++){for(var C=d[A],s=0;s<k.length;s++)delete k[s].valuetmp;for(s=0;s<l.template.triplesContext.length;s++){for(var n=["subject","predicate","object"],D=l.template.triplesContext[s],z=0;z<n.length;z++){var E=n[z];if(D[E].token==="blank"&&!(D[E].valuetmp&&D[E].valuetmp!=null)){var F="_:b"+f;f++;D[E].valuetmp=F;k.push(D[E])}}n=x.buildRDFResource(D.subject,C,j,i);z=x.buildRDFResource(D.predicate,C,j,i);D=x.buildRDFResource(D.object,C,j,i);n!=null&&z!=null&&D!=null&&(z=new x.Triple(n,
z,D),e.add(z))}}c(!0,e)}else c(!1,d);else c(!1,d);else c(!1,d)})};E.QueryEngine.prototype.executeSelect=function(a,c,d,e,f){if(a.kind==="select"||a.kind==="ask"||a.kind==="construct"||a.kind==="modify"){var j=a.projection,i=a.dataset,l=a.modifier,u=a.limit,w=a.offset,r=a.order;if(d!=null||e!=null)i.implicit=d||[],i.named=e||[];i.implicit!=null&&i.implicit.length===0&&i.named!=null&&i.named.length===0&&i.implicit.push(this.lexicon.defaultGraphUriTerm);if(this.normalizeDatasets(i.implicit.concat(i.named),
c)!=null)if(e=this.executeSelectUnit(j,i,a.pattern,c),e!=null){if(a.group!=null&&a.group===""){for(var x=!1,d=0;d<a.projection.length;d++)if(a.projection[d].expression!=null&&a.projection[d].expression.expressionType==="aggregate"){x=!0;break}if(x===!0)a.group="singleGroup"}if(a.group&&a.group!="")if(this.checkGroupSemantics(a.group,j)){u=this.groupSolution(e,a.group,i,c);w=[];for(d=0;d<u.length;d++)l=this.aggregateBindings(j,u[d],i,c),w.push(l);f(!0,{bindings:w,denorm:!0})}else f(!1,"Incompatible Group and Projection variables");
else c=this.applyOrderBy(r,e,i,c),j=this.projectBindings(j,c,i),j=this.applyModifier(l,j),i=this.removeDefaultGraphBindings(this.applyLimitOffset(w,u,j),i),f(!0,i)}else f(!1,e);else f(!1,"Error normalizing datasets")}else f(!1,"Cannot execute "+a.kind+" query as a select query")};E.QueryEngine.prototype.groupSolution=function(a,c,d,e){var k=[],j=[],i=!1;if(c==="singleGroup")return[a];else{for(var l=0;l<a.length;l++){for(var u=a[l],w=!0,r=0;r<c.length;r++){var x=c[r],A=null;if(x.token==="var")A=x.value,
i==!1&&k.push(A);else if(x.token==="aliased_expression")if(A=x.alias.value,i==!1&&k.push(A),x.expression.primaryexpression==="var")u[x.alias.value]=u[x.expression.value.value];else if(A=this.copyDenormalizedBindings([u],e.outCache),A=f.runFilter(x.expression,A[0],this,d,e),f.isEbvError(A))w=!1;else{if(A.value!=null)A.value=""+A.value;u[x.alias.value]=A}else A=this.copyDenormalizedBindings([u],e.outCache),A=f.runFilter(x,A[0],this,e),f.isEbvError(A)?w=!1:(u["groupCondition"+env._i]=A,A="groupCondition"+
env._i,i==!1&&k.push(A))}i==!1&&(i=!0);w===!0&&j.push(u)}a={};for(l=0;l<j.length;l++){c=j[l];d="";for(r=0;r<k.length;r++)e=c[k[r]],d+=typeof e==="object"?e.value:e;a[d]==null?a[d]=[c]:a[d].push(c)}var k=[],B;for(B in a)k.push(a[B]);return k}};E.QueryEngine.prototype.executeSelectUnit=function(a,c,d,e){return d.kind==="BGP"?this.executeAndBGP(a,c,d,e):d.kind==="UNION"?this.executeUNION(a,c,d.value,e):d.kind==="JOIN"?this.executeJOIN(a,c,d,e):d.kind==="LEFT_JOIN"?this.executeLEFT_JOIN(a,c,d,e):d.kind===
"FILTER"?(a=this.executeSelectUnit(a,c,d.value,e),a!=null?a=f.checkFilters(d,a,!1,c,e,this):[]):d.kind==="EMPTY_PATTERN"?[]:d.kind==="ZERO_OR_MORE_PATH"||d.kind==="ONE_OR_MORE_PATH"?this.executeZeroOrMorePath(d,c,e):(console.log("Cannot execute query pattern "+d.kind+". Not implemented yet."),null)};E.QueryEngine.prototype.executeZeroOrMorePath=function(a,c,d){var e=[];a.x.token==="var"&&e.push({token:"variable",kind:"var",value:a.x.value});a.y.token==="var"&&e.push({token:"variable",kind:"var",value:a.y.value});
e.length===0&&e.push({token:"variable",kind:"*"});if(a.x.token==="var"&&a.y.token==="var"){var f=this.executeAndBGP(e,c,a.path,d),j={},e=[],i,l,u,w,r=a.x.value;l=a.x;for(var x=a.path,I=0;I<f.length;I++)if(i=f[I][r],j[i]==null){w=this.lexicon.retrieve(i);a.x=w;a.path=this.abstractQueryTree.replace(x,l,w,d);x=A.clone(a.path);l=this.executeZeroOrMorePath(a,c,d);for(var B=0;B<l.length;B++)u=l[B],u[r]=i,e.push(u);l=w}return e}else if(a.x.token!=="var"&&a.y.token==="var"){j={};i=!0;w=[];for(r=[];i==!0||
w.length!==0;){i===!0?(f=this.executeAndBGP(e,c,a.path,d),l=a.x,i=!1):(x=this.lexicon.retrieve(w.pop()),f=a.path,f=this.abstractQueryTree.replace(f,l,x,d),f=this.executeAndBGP(e,c,f,d),l=x);for(I=0;I<f.length;I++)x=f[I][a.y.value],j[x]!==!0&&(u={},u[a.y.value]=x,r.push(u),j[x]=!0,w.push(x))}return r}else throw"Kind of path not supported!";};E.QueryEngine.prototype.executeUNION=function(a,c,d,e){var k=d[0],j=d[1],i=null,l=null;if(d.length!=2)throw"SPARQL algebra UNION with more than two components";
i=this.executeSelectUnit(a,c,k,e);if(i==null)return null;l=this.executeSelectUnit(a,c,j,e);if(l==null)return null;a=ga.unionBindings(i,l);return a=f.checkFilters(d,a,!1,c,e,this)};E.QueryEngine.prototype.executeAndBGP=function(a,c,d,e){a=ga.executeAndBGPsDPSize(d.value,c,this,e);return a!=null?f.checkFilters(d,a,!1,c,e,this):null};E.QueryEngine.prototype.executeLEFT_JOIN=function(a,c,d,e){var k=d.rvalue,j=null,i=null,j=this.executeSelectUnit(a,c,d.lvalue,e);if(j==null)return null;i=this.executeSelectUnit(a,
c,k,e);if(i==null)return null;a=ga.leftOuterJoinBindings(j,i);c=f.checkFilters(d,a,!0,c,e,this);if(j.length>1&&i.length>1){var d=[],e={},l;for(l in j[0])e[l]=!0;for(l in i[0])e[l]!=!0&&d.push(l);j=[];i={};for(e=0;e<c.length;e++)if(c[e].__nullify__===!0){for(k=0;k<d.length;k++)c[e].bindings[d[k]]=null;k=[];a=[];for(l in c[e].bindings)c[e].bindings[l]!=null&&(k.push(l+c[e].bindings[l]),k.sort(),a.push(k.join("")));if(i[k.join("")]==null){for(k=0;k<a.length;k++)i[a[k]]=!0;j.push(c[e].bindings)}}else for(l in j.push(c[e]),
k=[],c[e])k.push(l+c[e][l]),k.sort(),i[k.join("")]=!0;return j}else return c};E.QueryEngine.prototype.executeJOIN=function(a,c,d,e){var k=d.lvalue,j=d.rvalue,i=null,l=null,i=this.executeSelectUnit(a,c,k,e);if(i==null)return null;l=this.executeSelectUnit(a,c,j,e);if(l==null)return null;a=null;if(i.length===0||l.length===0)a=[];else{var a={},u=[],w;for(w in i[0])a[w]=!1;for(w in l[0])a[w]===!1&&u.push(w);a=u.length==0?ga.joinBindings(i,l):this.abstractQueryTree.treeWithUnion(k)||this.abstractQueryTree.treeWithUnion(j)?
ga.joinBindings(i,l):ga.joinBindings2(u,i,l)}return a=f.checkFilters(d,a,!1,c,e,this)};E.QueryEngine.prototype.rangeQuery=function(a,c){var d=this.normalizeQuad(a,c,!1);return d!=null?(d=this.backend.range(new T.Pattern(d)),d==null||d.length==0?[]:d):(console.log("ERROR normalizing quad"),null)};E.QueryEngine.prototype.executeUpdate=function(a,c){var d=a.units,e=this,f={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,f);for(var j=0;j<d.length;j++){var i=e.abstractQueryTree.parseExecutableUnit(d[j]);
if(i.kind==="insertdata"){for(var l=0;l<i.quads.length;l++){var u=i.quads[l];if(e._executeQuadInsert(u,f)!==!0)return c(!1,error)}c(!0)}else if(i.kind==="deletedata"){for(l=0;l<i.quads.length;l++)u=i.quads[l],this._executeQuadDelete(u,f);c(!0)}else if(i.kind==="modify")this._executeModifyQuery(i,f,c);else if(i.kind==="create")c(!0);else if(i.kind==="load")l={uri:A.lexicalFormBaseUri(i.sourceGraph,f)},i.destinyGraph!=null&&(l={uri:A.lexicalFormBaseUri(i.destinyGraph,f)}),e=this,this.rdfLoader.load(i.sourceGraph.value,
l,function(a,d){a==!1?(console.log("Error loading graph"),console.log(d),c(!1,"error batch loading quads")):(d=e.batchLoad(d),c(d!=null,d||"error batch loading quads"))});else if(i.kind==="drop")this._executeClearGraph(i.destinyGraph,f,c);else if(i.kind==="clear")this._executeClearGraph(i.destinyGraph,f,c);else throw Error("not supported execution unit");}};E.QueryEngine.prototype.batchLoad=function(a,c){var d=null,e=null,f=null,j=null,i=0,l=!0,u={},w,r;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();
for(var x=0;x<a.length;x++){r=a[x];if(r.subject.uri||r.subject.token==="uri"){if(w=this.lexicon.registerUri(r.subject.uri||r.subject.value),r.subject.uri!=null)r.subject={token:"uri",value:r.subject.uri},delete r.subject.uri}else if(r.subject.literal||r.subject.token==="literal"){if(w=this.lexicon.registerLiteral(r.subject.literal||r.subject.value),r.subject.literal!=null)r.subject=this.lexicon.parseLiteral(r.subject.literal),delete r.subject.literal}else if(w=u[r.subject.blank||r.subject.value],
w==null&&(w=this.lexicon.registerBlank(r.subject.blank||r.subject.value),u[r.subject.blank||r.subject.value]=w),r.subject.token==null)r.subject.token="blank",r.subject.value=r.subject.blank,delete r.subject.blank;d=w;if(r.predicate.uri||r.predicate.token==="uri"){if(w=this.lexicon.registerUri(r.predicate.uri||r.predicate.value),r.predicate.uri!=null)r.predicate={token:"uri",value:r.predicate.uri},delete r.subject.uri}else if(r.predicate.literal||r.predicate.token==="literal"){if(w=this.lexicon.registerLiteral(r.predicate.literal||
r.predicate.value),r.predicate.literal!=null)r.predicate=this.lexicon.parseLiteral(r.predicate.literal),delete r.predicate.literal}else if(w=u[r.predicate.blank||r.predicate.value],w==null&&(w=this.lexicon.registerBlank(r.predicate.blank||r.predicate.value),u[r.predicate.blank||r.predicate.value]=w),r.predicate.token==null)r.predicate.token="blank",r.predicate.value=r.predicate.blank,delete r.predicate.blank;e=w;if(r.object.uri||r.object.token==="uri"){if(w=this.lexicon.registerUri(r.object.uri||
r.object.value),r.object.uri!=null)r.object={token:"uri",value:r.object.uri},delete r.subject.uri}else if(r.object.literal||r.object.token==="literal"){if(r.object.token==="literal")r.object.value=r.object.type!=null?'"'+r.object.value+'"^^<'+r.object.type+">":r.object.lang!=null?'"'+r.object.value+'"@'+r.object.lang:'"'+r.object.value+'"';w=this.lexicon.registerLiteral(r.object.literal||r.object.value);if(r.object.literal!=null)r.object=this.lexicon.parseLiteral(r.object.literal),delete r.object.literal}else if(w=
u[r.object.blank||r.object.value],w==null&&(w=this.lexicon.registerBlank(r.object.blank||r.object.value),u[r.object.blank||r.object.value]=w),r.object.token==null)r.object.token="blank",r.object.value=r.object.blank,delete r.object.blank;f=w;if(r.graph.uri||r.graph.token==="uri"){w=this.lexicon.registerUri(r.graph.uri||r.graph.value);if(r.graph.uri!=null)r.graph={token:"uri",value:r.graph.uri},delete r.subject.uri;this.lexicon.registerGraph(w)}else if(r.graph.literal||r.graph.token==="literal"){if(w=
this.lexicon.registerLiteral(r.graph.literal||r.graph.value),r.predicate.literal!=null)r.predicate=this.lexicon.parseLiteral(r.predicate.literal),delete r.predicate.literal}else if(w=u[r.graph.blank||r.graph.value],w==null&&(w=this.lexicon.registerBlank(r.graph.blank||r.graph.value),u[r.graph.blank||r.graph.value]=w),r.graph.token==null)r.graph.token="blank",r.graph.value=r.graph.blank,delete r.graph.blank;j=w;w=r;r={subject:d,predicate:e,object:f,graph:j};d=new T.NodeKey(r);e=this.backend.search(d);
if(!e)if(e=this.backend.index(d),e==!0)this.eventsOnBatchLoad&&this.callbacksBackend.nextGraphModification(F.added,[w,r]),i+=1;else{l=!1;break}}this.lexicon.updateAfterWrite!=null&&this.lexicon.updateAfterWrite();var A=function(){l?c&&c(!0,i):c&&c(!1,null)};this.eventsOnBatchLoad?this.callbacksBackend.endGraphModification(function(){A()}):A();return l?i:null};E.QueryEngine.prototype.computeCosts=function(a,c){for(var d=0;d<a.length;d++)a[d]._cost=this.quadCost(a[d],c);return a};E.QueryEngine.prototype._executeModifyQuery=
function(a,c,d){var e=this,f=!0,j=null,i=["subject","predicate","object","graph"];a.insert=a.insert==null?[]:a.insert;a["delete"]=a["delete"]==null?[]:a["delete"];A.seq(function(d){var i=[],w=[];a["with"]!=null&&i.push(a["with"]);if(a.using!=null)for(var w=[],r=0;r<a.using.length;r++){var x=a.using[r];x.kind==="named"?w.push(x.uri):i.push(x.uri)}a.dataset={};a.projection=[{token:"variable",kind:"*"}];e.executeSelect(a,c,i,w,function(a,i){a?(i=e.denormalizeBindingsList(i,c),i!=null?j=i:f=!1):f=!1;
return d()})},function(d){var u=a["with"];if(f){for(var w=[],r=0;r<a["delete"].length;r++)for(var x=a["delete"][r],A=0;A<j.length;A++){for(var B={},C=j[A],s=0;s<i.length;s++){var n=i[s];n=="graph"&&x[n]==null?B.graph=u:B[n]=x[n].token==="var"?C[x[n].value]:x[n]}w.push(B)}for(A=0;A<w.length;A++)B=w[A],e._executeQuadDelete(B,c)}d()},function(d){var u=a["with"];if(f){for(var w=[],r=0;r<a.insert.length;r++)for(var x=a.insert[r],A=0;A<j.length;A++){for(var B={},C=j[A],s=0;s<i.length;s++){var n=i[s];n==
"graph"&&x[n]==null?B.graph=u:B[n]=x[n].token==="var"?C[x[n].value]:x[n]}w.push(B)}for(r=0;r<w.length;r++)B=w[r],e._executeQuadInsert(B,c)}d()})(function(){d(f)})};E.QueryEngine.prototype._executeQuadInsert=function(a,c){var d=this.normalizeQuad(a,c,!0);if(d!=null){var e=new T.NodeKey(d),f=this.backend.search(e);return f?f:(f=this.backend.index(e),f==!0?(this.callbacksBackend.nextGraphModification(F.added,[a,d]),!0):(console.log("ERROR inserting quad"),!1))}else return console.log("ERROR normalizing quad"),
!1};E.QueryEngine.prototype._executeQuadDelete=function(a,c){var d=this.normalizeQuad(a,c,!1);if(d!=null){var e=new T.NodeKey(d);this.backend["delete"](e);return this.lexicon.unregister(a,e)==!0?(this.callbacksBackend.nextGraphModification(F.deleted,[a,d]),!0):(console.log("ERROR unregistering quad"),!1)}else return console.log("ERROR normalizing quad"),!1};E.QueryEngine.prototype._executeClearGraph=function(a,c,d){if(a==="default")this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",d);else if(a===
"named"){var e=this,f=this.lexicon.registeredGraphs(!0);if(f!=null){var j=!1;A.repeat(0,f.length,function(a,c){var d=f[c._i],w=arguments.callee;j?a(w,c):e.execute("DELETE { GRAPH <"+d+"> { ?s ?p ?o } } WHERE { GRAPH <"+d+"> { ?s ?p ?o } }",function(d){j=!d;a(w,c)})},function(){d(!j)})}else d(!1,"Error deleting named graphs")}else a==="all"?(e=this,this.execute("CLEAR DEFAULT",function(a,c){a?e.execute("CLEAR NAMED",d):d(!1,c)})):a.token=="uri"?(a=A.lexicalFormBaseUri(a,c),a!=null?this.execute("DELETE { GRAPH <"+
a+"> { ?s ?p ?o } } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",d):d(!1,"wrong graph URI")):d(!1,"wrong graph URI")};E.QueryEngine.prototype.checkGroupSemantics=function(a,c){if(a==="singleGroup")return!0;for(var d={},e=0;e<a.length;e++){var f=a[e];f.token==="var"?d[f.value]=!0:f.token==="aliased_expression"&&(d[f.alias.value]=!0)}for(e=0;e<c.length;e++)if(f=c[e],f.kind==="var"){if(d[f.value.value]==null)return!1}else if(f.kind==="aliased"&&f.expression&&f.expression.primaryexpression==="var"&&d[f.expression.value.value]==
null)return!1;return!0};E.QueryEngine.prototype.registerDefaultNamespace=function(a,c){this.defaultPrefixes[a]=c};var F={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(a){this.aqt=new N.AbstractQueryTree;this.engine=a;this.indexMap={};this.observersMap={};this.queriesIndexMap={};this.emptyNotificationsMap={};this.queriesList=[];this.pendingQueries=[];this.matchedQueries=[];this.updateInProgress=null;this.indices=["SPOG","GP",
"OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};this.callbackCounter=0;this.callbacksMap={};this.callbacksInverseMap={};this.queryCounter=0;this.queriesMap={};this.queriesCallbacksMap={};this.queriesInverseMap={};for(a=0;a<this.indices.length;a++){var c=
this.indices[a];this.indexMap[c]={};this.queriesIndexMap[c]={}}}};F.CallbacksBackend.prototype.startGraphModification=function(){this.pendingQueries=[].concat(this.queriesList);this.matchedQueries=[];if(this.updateInProgress==null)this.updateInProgress={added:[],deleted:[]}};F.CallbacksBackend.prototype.nextGraphModification=function(a,c){this.updateInProgress[a].push(c)};F.CallbacksBackend.prototype.endGraphModification=function(a){var c=this;if(this.updateInProgress!=null){var d=c.updateInProgress;
c.updateInProgress=null;this.sendNotification(F.deleted,d[F.deleted],function(){c.sendNotification(F.added,d[F.added],function(){c.sendEmptyNotification(F.eventsFlushed,null,function(){c.dispatchQueries(function(){a(!0)})})})})}else a(!0)};F.CallbacksBackend.prototype.cancelGraphModification=function(){this.updateInProgress=null};F.CallbacksBackend.prototype.sendNotification=function(a,c,d){for(var e={},f=0;f<c.length;f++){var j=c[f],i;for(i in this.indexMap){var l=this.indexMap[i],u=this.componentOrders[i];
this._searchCallbacksInIndex(l,u,a,j,e);this.pendingQueries.length!=0&&(l=this.queriesIndexMap[i],this._searchQueriesInIndex(l,u,j))}}this.dispatchNotifications(e);d!=null&&d(!0)};F.CallbacksBackend.prototype.sendEmptyNotification=function(a,c,d){for(var e=this.emptyNotificationsMap[a]||[],f=0;f<e.length;f++)e[f](a,c);d()};F.CallbacksBackend.prototype.dispatchNotifications=function(a){for(var c in a){var d=this.callbacksMap[c],e=a[c][F.deleted];if(e!=null)try{d(F.deleted,e)}catch(f){}for(var j in a[c])if(j!=
F.deleted)try{d(j,a[c][j])}catch(i){}}};F.CallbacksBackend.prototype._searchCallbacksInIndex=function(a,c,d,e,f){for(var j=e[1],e=e[0],i=0;i<c.length+1;i++){for(var l=a._||[],u=[],w=0;w<l.length;w++){var r=l[w];this.callbacksMap[r]!=null&&(f[r]=f[r]||{},f[r][d]=f[r][d]||[],f[r][d].push(e),u.push(r))}a._=u;l=c[i];if(a[""+j[l]]!=null)a=a[""+j[l]];else break}};F.CallbacksBackend.prototype.subscribeEmpty=function(a,c){var d=this.emptyNotificationsMap[a]||[];d.push(c);this.emptyNotificationsMap[a]=d};
F.CallbacksBackend.prototype.unsubscribeEmpty=function(a,c){var d=this.emptyNotificationsMap[a];d!=null&&(d=A.remove(d,c));this.emptyNotificationsMap[a]=d};F.CallbacksBackend.prototype.subscribe=function(a,c,d,e,f,j){a=this._tokenizeComponents(a,c,d,e);c={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,c);a=this.engine.normalizeQuad(a,c,!0);d=this._indexForPattern(new T.Pattern(a));c=this.componentOrders[d];d=this.indexMap[d];for(e=0;e<c.length;e++){var i=a[c[e]];if(i==="_"){d._==
null&&(d._=[]);this.callbackCounter++;d._.push(this.callbackCounter);this.callbacksMap[this.callbackCounter]=f;this.callbacksInverseMap[f]=this.callbackCounter;break}else e===c.length-1?(d[i]=d[i]||{_:[]},this.callbackCounter++,d[i]._.push(this.callbackCounter),this.callbacksMap[this.callbackCounter]=f,this.callbacksInverseMap[f]=this.callbackCounter):(d[i]=d[i]||{},d=d[i])}j!=null&&j(!0)};F.CallbacksBackend.prototype.unsubscribe=function(a){var c=this.callbacksInverseMap[a];c!=null&&(delete this.callbacksInverseMap[a],
delete this.callbacksMap[c])};F.CallbacksBackend.prototype._tokenizeComponents=function(a,c,d,e){var f={};f.subject=a==null?F.ANYTHING:a.indexOf("_:")==0?{token:"blank",value:a}:{token:"uri",value:a};f.predicate=c==null?F.ANYTHING:{token:"uri",value:c};f.object=d==null?F.ANYTHING:{token:"uri",value:d};f.graph=e==null?F.ANYTHING:{token:"uri",value:e};return f};F.CallbacksBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,d=0;d<c.length;d++)for(var e=c[d],f=this.componentOrders[e],
j=0;j<f.length;j++){if(A.include(a,f[j])===!1)break;if(j==a.length-1)return e}return"SPOG"};F.CallbacksBackend.prototype.observeNode=function(){var a,c,d,e;arguments.length===4?(a=arguments[0],c=arguments[1],d=arguments[2],e=arguments[3]):(a=arguments[0],c=this.engine.lexicon.defaultGraphUri,d=arguments[1],e=arguments[2]);c="CONSTRUCT { <"+a+"> ?p ?o } WHERE { GRAPH <"+c+"> { <"+a+"> ?p ?o } }";var f=this,j={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,j);var i=[];this.engine.execute(c,
function(c,u){if(c){var w=!1,r=function(a,c){if(a==="eventsFlushed"&&w){w=!1;try{d(u)}catch(e){}}else if(a!=="eventsFlushed"){w=!0;for(var l=0;l<c.length;l++){var r=c[l],n=x.buildRDFResource(r.subject,i,f.engine,j),A=x.buildRDFResource(r.predicate,i,f.engine,j),r=x.buildRDFResource(r.object,i,f.engine,j);n!=null&&A!=null&&r!=null&&(r=new x.Triple(n,A,r),a===F.added?u.add(r):a===F.deleted&&u.remove(r))}}};f.observersMap[d]=r;f.subscribeEmpty(F.eventsFlushed,r);f.subscribe(a,null,null,null,r,function(){try{d(u)}catch(a){}e&&
e(!0)})}else e&&e(!1)})};F.CallbacksBackend.prototype.stopObservingNode=function(a){return(a=this.observersMap[a])?(this.unsubscribe(a),this.unsubscribeEmpty(F.eventsFlushed,a),!0):!1};F.CallbacksBackend.prototype.observeQuery=function(a,c,d){var e=this.aqt.collectBasicTriples(this.aqt.parseSelect(this.aqt.parseQueryString(a).units[0])),f={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,f);var j,i,l,u=this.queryCounter;this.queryCounter++;this.queriesMap[u]=a;this.queriesInverseMap[a]=
u;this.queriesList.push(u);this.queriesCallbacksMap[u]=c;for(var w=0;w<e.length;w++){i=e[w];if(i.graph==null)i.graph=this.engine.lexicon.defaultGraphUriTerm;i=this.engine.normalizeQuad(i,f,!0);j=new T.Pattern(i);l=this._indexForPattern(j);j=this.componentOrders[l];l=this.queriesIndexMap[l];for(var r=0;r<j.length;r++){var x=i[j[r]];if(typeof x==="string"){l._==null&&(l._=[]);l._.push(u);break}else r===j.length-1?(l[x]=l[x]||{_:[]},l[x]._.push(u)):(l[x]=l[x]||{},l=l[x])}}this.engine.execute(a,function(a,
d){a?c(d):console.log("ERROR in query callback "+d)});d!=null&&d()};F.CallbacksBackend.prototype.stopObservingQuery=function(a){var c=this.queriesInverseMap[a];if(c!=null)delete this.queriesInverseMap[a],delete this.queriesMap[c],this.queriesList=A.remove(this.queriesList,c)};F.CallbacksBackend.prototype._searchQueriesInIndex=function(a,c,d){for(var d=d[1],e=0;e<c.length+1;e++){for(var f=a._||[],j=[],i=0;i<f.length;i++){var l=f[i];A.include(this.pendingQueries,l)&&(A.remove(this.pendingQueries,l),
this.matchedQueries.push(l));this.queriesMap[l]!=null&&j.push(l)}a._=j;f=c[e];if(a[""+d[f]]!=null)a=a[""+d[f]];else break}};F.CallbacksBackend.prototype.dispatchQueries=function(a){var c=this,d,e,f,j,i={};A.repeat(0,this.matchedQueries.length,function(a,u){d=arguments.callee;f=c.matchedQueries[u._i];i[f]==null?(i[f]=!0,e=c.queriesMap[f],j=c.queriesCallbacksMap[f],A.recur(function(){c.engine.execute(e,function(c,e){if(c)try{j(e)}catch(f){}a(d,u)})})):a(d,u)},function(){a()})};var O={};try{typeof Worker==
"undefined"&&(Worker=null)}catch(mc){Worker=null}if(Worker)O.RDFStoreClient=function(a,c,d){console.log("trying to load "+a);this.connection=Worker.Worker?new Worker.Worker(a):new Worker(a);this.callbacksCounter=1;var e=this;this.rdf=x.rdf;console.log("The worker");console.log(this.connection);e=this;this.connection.onmessage=function(a){e.receive(a)};this.observingCallbacks={};this.callbacks={0:{cb:function(a,c){a===!0?d(!0,e):d(!1,c)},fn:"create"}};this.connection.postMessage({fn:"create",args:c,
callback:"0"})},O.RDFStoreClient.prototype.receive=function(a){a=a.data||a;if(a.fn==="workerRequest:NetworkTransport:load"){var c=this,d=a.callback,a=a.arguments.concat(function(a,e){c.connection.postMessage({fn:"workerRequestResponse",results:[a,e],callback:d})});W.load.apply(W,a)}else{var e=this.callbacks[a.callback];e&&(e.fn==="create"||e.fn==="execute"||e.fn==="insert"||e.fn=="graph"||e.fn==="node"||e.fn==="insert"||e.fn==="delete"||e.fn==="clear"||e.fn==="load"||e.fn==="startObservingQueryEndCb"||
e.fn==="registeredGraphs"?(delete this.callbacks[a.callback],e.cb(a.success,a.result)):e.fn==="startObservingQuery"?e.cb(a.result):e.fn==="startObservingNode"?e.cb(a.result):e.fn==="subscribe"&&e.cb(a.event,a.result))}},O.RDFStoreClient.prototype.registerCallback=function(a,c){var d=""+this.callbacksCounter;this.callbacks[d]={fn:a,cb:c};this.callbacksCounter++;return d},O.RDFStoreClient.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);
else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);c=this.registerCallback("execute",c);this.connection.postMessage({fn:"execute",args:[a],callback:c})}},O.RDFStoreClient.prototype.insert=function(){var a,c,d;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"insert",args:[c]});else if(arguments.length===
2)c=arguments[0],d=arguments[1]||function(){},d=this.registerCallback("insert",d),this.connection.postMessage({fn:"insert",args:[c],callback:d});else if(arguments.length===3)c=arguments[0],a=arguments[1],d=arguments[2]||function(){},d=this.registerCallback("insert",d),this.connection.postMessage({fn:"insert",args:[c,a],callback:d});else throw"The triples to insert, an optional graph and callback must be provided";},O.RDFStoreClient.prototype.graph=function(){var a=null,c=null;if(arguments.length===
1)c=arguments[0]||function(){};else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";var d=this,e=this.registerCallback("insert",function(a,e){if(a){for(var f,l=0;l<e.triples.length;l++)f=e.triples[l],e.triples[l]=new x.Triple(d.adaptJSInterface(f.subject),d.adaptJSInterface(f.predicate),d.adaptJSInterface(f.object));c(a,d.rdf.createGraph(e.triples))}else c(a,e)});a==null?this.connection.postMessage({fn:"graph",
args:[],callback:e}):this.connection.postMessage({fn:"graph",args:[a],callback:e})},O.RDFStoreClient.prototype.node=function(){var a=null,c=null,d=null;if(arguments.length===2)d=arguments[0],c=arguments[1]||function(){};else if(arguments.length===3)d=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI and a callback function must be provided";var e=this,f=this.registerCallback("insert",function(a,d){if(a){for(var f,k=0;k<d.triples.length;k++)f=d.triples[k],d.triples[k]=
new x.Triple(e.adaptJSInterface(f.subject),e.adaptJSInterface(f.predicate),e.adaptJSInterface(f.object));c(a,e.rdf.createGraph(d.triples))}else c(a,d)});a==null?this.connection.postMessage({fn:"node",args:[d],callback:f}):this.connection.postMessage({fn:"node",args:[d,a],callback:f})},O.RDFStoreClient.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c);this.connection.postMessage({fn:"rdf/setPrefix",args:[a,c],callback:null})},O.RDFStoreClient.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a);
this.connection.postMessage({fn:"rdf/setDefaultPrefix",args:[a],callback:null})},O.RDFStoreClient.prototype["delete"]=function(){var a,c,d;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"delete",args:[c]});else if(arguments.length===2)c=arguments[0],d=arguments[1]||function(){},d=this.registerCallback("delete",d),this.connection.postMessage({fn:"delete",args:[c],callback:d});else if(arguments.length===3)c=arguments[0],a=arguments[1],d=arguments[2]||function(){},d=this.registerCallback("delete",
d),this.connection.postMessage({fn:"delete",args:[c,a],callback:d});else throw"The triples to delete, an optional graph and callback must be provided";},O.RDFStoreClient.prototype.clear=function(){var a,c;if(arguments.length===1)c=arguments[0]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[],callback:c});else if(arguments.length===2)a=arguments[0],c=arguments[1]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",
args:[a],callback:c});else throw"The optional graph and a callback must be provided";},O.RDFStoreClient.prototype.setBatchLoadEvents=function(a){this.connection.postMessage({fn:"setBatchLoadEvents",args:[a]})},O.RDFStoreClient.prototype.registerDefaultNamespace=function(a,c){this.connection.postMessage({fn:"registerDefaultNamespace",args:[a,c]})},O.RDFStoreClient.prototype.registerDefaultProfileNamespaces=function(){this.connection.postMessage({fn:"registerDefaultProfileNamespaces",args:[]})},O.RDFStoreClient.prototype.load=
function(){var a,c,d,e;if(arguments.length===3)a=arguments[0],c=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("load",e),this.connection.postMessage({fn:"load",args:[a,c],callback:e});else if(arguments.length===4)a=arguments[0],c=arguments[1],d=arguments[2],e=arguments[3]||function(){},e=this.registerCallback("load",e),this.connection.postMessage({fn:"load",args:[a,c,d],callback:e});else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";
},O.RDFStoreClient.prototype.startObservingQuery=function(a,c,d){d!=null?(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=c,d=this.registerCallback("startObservingQueryEndCb",d),this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c,d]})):(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=c,this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c]}))},O.RDFStoreClient.prototype.stopObservingQuery=function(a){var c=
this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingQuery",args:[a],callback:[]})},O.RDFStoreClient.prototype.startObservingNode=function(){var a,c,d;if(arguments.length===2){a=arguments[0];d=arguments[1];var e=this,f=this.registerCallback("startObservingNode",function(a){for(var c,f=0;f<a.triples.length;f++)c=a.triples[f],a.triples[f]=new x.Triple(e.adaptJSInterface(c.subject),e.adaptJSInterface(c.predicate),e.adaptJSInterface(c.object));
d(e.rdf.createGraph(a.triples))});this.observingCallbacks[d]=f;this.connection.postMessage({fn:"startObservingNode",args:[a],callback:f})}else arguments.length===3&&(a=arguments[0],c=arguments[1],d=arguments[2],e=this,f=this.registerCallback("startObservingNode",function(a){for(var c,f=0;f<a.triples.length;f++)c=a.triples[f],a.triples[f]=new x.Triple(e.adaptJSInterface(c.subject),e.adaptJSInterface(c.predicate),e.adaptJSInterface(c.object));d(e.rdf.createGraph(a.triples))}),this.observingCallbacks[d]=
f,this.connection.postMessage({fn:"startObservingNode",args:[a,c],callback:f}))},O.RDFStoreClient.prototype.stopObservingNode=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingNode",args:[c],callback:[]})},O.RDFStoreClient.prototype.subscribe=function(a,c,d,e,f){var j=this,i=this.registerCallback("subscribe",function(a,c){for(var d,e=0;e<c.length;e++)d=c[e],c[e]=new x.Triple(j.adaptJSInterface(d.subject),
j.adaptJSInterface(d.predicate),j.adaptJSInterface(d.object));f(a,c)});this.observingCallbacks[f]=i;this.connection.postMessage({fn:"subscribe",args:[a,c,d,e],callback:i})},O.RDFStoreClient.prototype.unsubscribe=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"unsubscribe",args:[c],callback:[]})},O.RDFStoreClient.prototype.registeredGraphs=function(a){var c=this;this.connection.postMessage({fn:"registeredGraphs",
args:[],callback:this.registerCallback("registeredGraphs",function(d,e){if(d)for(var f=0;f<e.length;f++)e[f]=c.adaptJSInterface(e[f]);a(d,e)})})},O.RDFStoreClient.prototype.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new x.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new x.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new x.NamedNode(a.nominalValue)},O.RDFStoreClient.prototype.isWebWorkerConnection=!0;var J={},
ob={MongodbQueryEngine:function(){throw"MongoDB backend not supported in the browser version";}};J.VERSION="0.6.4";J.connect=function(){var a,c,d;arguments.length==1&&(a=__dirname,c={},d=arguments[0]);arguments.length==2?(typeof arguments[0]==="string"?(a=arguments[0],c={}):(a=__dirname+"/index.js",c=arguments[0]),d=arguments[1]):(a=arguments[0],c=arguments[1],d=arguments[2]);try{Worker?new O.RDFStoreClient(a,c,function(a,c){d(a,c)}):J.create(c,function(a){d(!1,a)})}catch(e){J.create(c,function(a){d(!1,
a)})}};J.create=function(){return arguments.length==1?new J.Store(arguments[0]):arguments.length==2?new J.Store(arguments[0],arguments[1]):new J.Store};J.Store=function(a,c){var d=null,e=null;if(arguments.length==0)e={};else if(arguments.length==1)e={},d=a;else if(arguments.length>1)e=a,d=c;else throw"An optional argument map and a callback must be provided";e.treeOrder==null&&(e.treeOrder=15);this.functionMap={};var f=this;e.engine==="mongodb"?(this.isMongodb=!0,this.engine=new ob.MongodbQueryEngine(e),
this.engine.readConfiguration(function(){e.overwrite===!0?f.engine.clean(function(){d(f)}):d(f)})):new P.Lexicon(function(a){e.overwrite===!0&&a.clear();new Y.QuadBackend(e,function(c){e.overwrite===!0&&c.clear();e.backend=c;e.lexicon=a;f.engine=new E.QueryEngine(e);d&&d(f)})},e.name)};J.Store.prototype.rdf=x.rdf;J.Store.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],
arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);this.engine.execute(a,c)}};J.Store.prototype.executeWithEnvironment=function(){var a,c,d;if(arguments.length===3){a=arguments[0];var e=function(){};c=arguments[1];d=arguments[2]}else arguments.length===4&&(a=arguments[0],e=arguments[3],c=arguments[1],d=arguments[2]);for(var f=[],j=[],i=0;i<c.length;i++)f.push({token:"uri",value:c[i]});for(i=
0;i<d.length;i++)j.push({token:"uri",value:d[i]});this.engine.execute(a,e,f,j)};J.Store.prototype.graph=function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",
c)};J.Store.prototype.node=function(){var a=null,c=null,d=null;if(arguments.length===2)d=arguments[0],c=arguments[1]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===3)d=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI, node URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.rdf.resolve(d)!=null&&(d=this.rdf.resolve(d));this.engine.execute("CONSTRUCT { <"+d+"> ?p ?o } WHERE { GRAPH <"+
a+"> { <"+d+"> ?p ?o } }",c)};J.Store.prototype.startObservingNode=function(){var a,c,d;arguments.length===2?(a=arguments[0],d=arguments[1],this.engine.callbacksBackend.observeNode(a,d,function(){})):arguments.length===3&&(a=arguments[0],c=arguments[1],d=arguments[2],this.engine.callbacksBackend.observeNode(a,c,d,function(){}))};J.Store.prototype.stopObservingNode=function(a){this.engine.callbacksBackend.stopObservingNode(a)};J.Store.prototype.startObservingQuery=function(a,c,d){d!=null?this.engine.callbacksBackend.observeQuery(a,
c,d):this.engine.callbacksBackend.observeQuery(a,c,function(){})};J.Store.prototype.stopObservingQuery=function(a){this.engine.callbacksBackend.stopObservingQuery(a)};J.Store.prototype.subscribe=function(a,c,d,e,f){var j=this,i=function(a,c){for(var d=[],e={blanks:{},outCache:{}},i=[],A=0;A<c.length;A++){var B=c[A],C=x.buildRDFResource(B.subject,i,j.engine,e),s=x.buildRDFResource(B.predicate,i,j.engine,e),B=x.buildRDFResource(B.object,i,j.engine,e);C!=null&&s!=null&&B!=null&&(B=new x.Triple(C,s,B),
d.push(B))}f(a,d)};this.functionMap[f]=i;this.engine.callbacksBackend.subscribe(a,c,d,e,i,function(){})};J.Store.prototype.unsubscribe=function(a){this.engine.callbacksBackend.unsubscribe(this.functionMap[a]);delete this.functionMap[a]};J.Store.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c)};J.Store.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a)};J.Store.prototype.insert=function(){var a,c,d;if(arguments.length===1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),
c=arguments[0],d=arguments[1]||function(){};else if(arguments.length===3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),d=arguments[2]||function(){};else throw"The triples to insert, an optional graph and callback must be provided";var e="",f=this;c.forEach(function(a){e=e+f._nodeToQuery(a.subject)+f._nodeToQuery(a.predicate)+f._nodeToQuery(a.object)+"."});e=a!=null?"INSERT DATA { GRAPH "+this._nodeToQuery(a)+" { "+e+" } }":"INSERT DATA { "+this._nodeToQuery(a)+" { "+e+" }";this.engine.execute(e,
d)};J.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else{if(a.interfaceName!=="")if(a.lang!=null)return'"'+a.valueOf()+'"@'+a.lang;else if(a.datatype!=null)return'"'+a.valueOf()+'"^^<'+a.datatype+">";return a.toString()}};J.Store.prototype["delete"]=function(){var a,c,d;if(arguments.length===1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),
c=arguments[0],d=arguments[1]||function(){};else if(arguments.length===3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),d=arguments[2]||function(){};else throw"The triples to delete, an optional graph and callback must be provided";var e="",f=this;c.forEach(function(a){e=e+f._nodeToQuery(a.subject)+f._nodeToQuery(a.predicate)+f._nodeToQuery(a.object)+"."});e=a!=null?"DELETE DATA { GRAPH "+this._nodeToQuery(a)+" { "+e+" } }":"DELETE DATA { "+this._nodeToQuery(a)+" { "+e+" }";this.engine.execute(e,
d)};J.Store.prototype.clear=function(){var a,c;if(arguments.length===0)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=function(){};else if(arguments.length===1)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0]||function(){};else if(arguments.length===2)a=this.rdf.createNamedNode(arguments[0]),c=arguments[1]||function(){};else throw"The optional graph and a callback must be provided";this.engine.execute("CLEAR GRAPH "+this._nodeToQuery(a),c)};J.Store.prototype.setBatchLoadEvents=
function(a){this.engine.eventsOnBatchLoad=a};J.Store.prototype.registerDefaultNamespace=function(a,c){this.rdf.prefixes.set(a,c);this.engine.registerDefaultNamespace(a,c)};J.Store.prototype.registerDefaultProfileNamespaces=function(){var a=this.rdf.prefixes.values(),c;for(c in a)this.registerDefaultNamespace(c,a[c])};J.Store.prototype.load=function(){var a,c,d,e;if(arguments.length===3)d=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),a=arguments[0],c=arguments[1],e=arguments[2]||function(){};
else if(arguments.length===4)a=arguments[0],c=arguments[1],d=this.rdf.createNamedNode(arguments[2]),e=arguments[3]||function(){};else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if(a==="remote")c=this.rdf.createNamedNode(c),this.engine.execute("LOAD <"+c.valueOf()+"> INTO GRAPH <"+d.valueOf()+">",e);else if(c&&typeof c==="string"&&c.indexOf("file://")===0){a=this.engine.rdfLoader.parsers[a];var f=this;this.engine.rdfLoader.loadFromFile(a,
{token:"uri",value:d.valueOf()},c,function(a,c){a?f.engine.batchLoad(c,e):e(a,c)})}else a=this.engine.rdfLoader.parsers[a],f=this,this.engine.rdfLoader.tryToParse(a,{token:"uri",value:d.valueOf()},c,function(a,c){a?f.engine.batchLoad(c,e):e(a,c)})};J.Store.prototype.registerParser=function(a,c){this.engine.rdfLoader.registerParser(a,c)};J.Store.prototype.registeredGraphs=function(a){if(this.isMongodb)this.engine.registeredGraphs(!0,function(c){for(var d=[],e=0;e<c.length;e++){var f=new x.NamedNode(c[e]);
d.push(f)}return a(!0,d)});else{for(var c=this.engine.lexicon.registeredGraphs(!0),d=[],e=0;e<c.length;e++){var f=new x.NamedNode(c[e]);d.push(f)}return a(!0,d)}};J.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else return a.toString()};J.Store.prototype.getNetworkTransport=function(){return W};J.Store.prototype.setNetworkTransport=function(a){W=a};RDFStoreWorker={observingCallbacks:{},workerCallbacksCounter:0,
workerCallbacks:{}};RDFStoreWorker.registerCallback=function(a){var c=""+RDFStoreWorker.workerCallbacksCounter;RDFStoreWorker.workerCallbacksCounter++;RDFStoreWorker.workerCallbacks[c]=a;return c};RDFStoreWorker.handleCreate=function(a,c){typeof W!="undefined"&&W!=null&&(W={load:function(a,c,d){var f=RDFStoreWorker.registerCallback(function(a){d.apply(d,a)});postMessage({fn:"workerRequest:NetworkTransport:load",callback:f,arguments:[a,c]})},loadFromFile:function(){}});var d=[a];d.push(function(a){RDFStoreWorker.store=
a;postMessage({callback:c,result:"created",success:!0})});J.create.apply(J,d)};RDFStoreWorker.receive=function(a){var c=a.data||a;if(c.fn==="workerRequestResponse"){var d=c.callback,e=RDFStoreWorker.workerCallbacks[d];e!=null&&(delete RDFStoreWorker.workerCallbacks[d],e(c.results))}else if(c.fn==="create"&&c.args!=null)RDFStoreWorker.handleCreate(c.args,c.callback);else if(c.fn==="setBatchLoadEvents")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if(c.fn==="registerDefaultNamespace")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args);else if(c.fn==="registerDefaultProfileNamespaces")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if((c.fn==="execute"||c.fn==="executeWithEnvironment"||c.fn==="graph"||c.fn==="node"||c.fn==="clear"||c.fn==="load")&&c.args!=null){c.args.push(function(a,d){c.callback!=null&&postMessage({callback:c.callback,result:d,success:a})});try{RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)}catch(f){console.log("Error executing method through connection"),console.log(f)}}else if((c.fn===
"insert"||c.fn==="delete")&&c.args!=null)try{c.args.push(function(a,d){c.callback!=null&&postMessage({callback:c.callback,result:d,success:a})});e=c.args[0];for(a=0;a<e.triples.length;a++)d=e.triples[a],e.triples[a]=new x.Triple(RDFStoreWorker.adaptJSInterface(d.subject),RDFStoreWorker.adaptJSInterface(d.predicate),RDFStoreWorker.adaptJSInterface(d.object));c.args[1].interfaceName!=null&&(c.args[1]=RDFStoreWorker.adaptJSInterface(c.args[1]));c.args[0]=RDFStoreWorker.store.rdf.createGraph(e.triples);
RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)}catch(j){console.log("Error executing method through connection"),console.log(j)}else c.fn==="rdf/setPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setPrefix(c.args[0],c.args[1]):c.fn==="rdf/setDefaultPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setDefaultPrefix(c.args[0]):c.fn==="startObservingQuery"&&c.args!=null?(d=function(a,d){postMessage({callback:c.callback[0],result:d,success:a})},RDFStoreWorker.observingCallbacks[c.args[0]]=
d,c.args.push(d),c.args.push(function(a,d){c.callback&&c.callback[1]!=null&&postMessage({callback:c.callback[1],result:d,success:a})}),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingQuery"?((d=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[d]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="startObservingNode"&&c.args!=null?(d=function(a){postMessage({callback:c.callback,result:a})},RDFStoreWorker.observingCallbacks[c.callback]=
d,c.args.push(d),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingNode"&&c.args!=null?((d=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[d]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="subscribe"&&c.args!=null?(d=function(a,d){postMessage({callback:c.callback,event:a,result:d})},RDFStoreWorker.observingCallbacks[c.callback]=d,c.args.push(d),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args)):c.fn==="stopObservingNode"&&c.args!=null?((d=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[d]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="registeredGraphs"&&c.args!=null&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[function(a,d){c.callback!=null&&postMessage({callback:c.callback,result:d,success:a})}])};RDFStoreWorker.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new x.BlankNode(a.bnodeId);
else if(a.interfaceName==="Literal")return new x.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new x.NamedNode(a.nominalValue)};onmessage=RDFStoreWorker.receive;try{window.rdfstore=J}catch(nc){}})();
