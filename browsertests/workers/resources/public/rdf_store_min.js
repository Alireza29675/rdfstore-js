(function(){typeof console=="undefined"&&(console={log:function(){}});var z={"extends":function(a,c){c.prototype=new a},stackCounterLimit:1E3,stackCounter:0};z.recur=function(a){z.stackCounter===z.stackCounterLimit?(z.stackCounter=0,setTimeout(a,0)):(z.stackCounter++,a())};z.clone=function(a){return JSON.parse(JSON.stringify(a))};z.shuffle=function(a){for(var c,f,h=a.length;h;c=parseInt(Math.random()*h),f=a[--h],a[h]=a[c],a[c]=f);return a};z.include=function(a,c,f){for(var h=a.length-1;h>=0;h--){var j=
!1,j=f==null?a[h]===c:f(a[h],c)===0;if(j===!0)return!0}return!1};z.remove=function(a,c){for(var f=[],h=0;h<a.length;h++)a[h]!==c&&f.push(a[h]);return f};z.repeat=function(a,c,f,h,j){arguments.length===4&&(j={});a<c?(j._i=a,f(function(k,f){z.recur(function(){z.repeat(a+1,c,k,h,f)})},j)):h(j)};Utilsmeanwhile=function(a,c,f,h){arguments.length===3&&(h={});h._stack_counter==null&&(h._stack_counter=0);a===!0?c(function(a,c,h){h._stack_counter%40==39?(h._stack_counter+=1,setTimeout(function(){Utilsmeanwhile(a,
c,f,h)},0)):(h._stack_counter+=1,Utilsmeanwhile(a,c,f,h))},h):f(h)};z.seq=function(){var a=arguments;return function(c){z.repeat(0,a.length,function(c,h){var j=arguments.callee;a[h._i](function(){c(j,h)})},function(){c()})}};z.partition=function(a,c){for(var f=a.length%c,h=[],j=0;j<f;j++)h.push(null);f=[];for(j=0;j<a.length;j++)h.push(a[j]),h.length%c==0&&(f.push(h),h=[]);return f};z.keys=function(a){var c=[],f;for(f in a)c.push(f);return c};z.iso8601=function(a){function c(a){return a<10?"0"+a:a}
return a.getUTCFullYear()+"-"+c(a.getUTCMonth()+1)+"-"+c(a.getUTCDate())+"T"+c(a.getUTCHours())+":"+c(a.getUTCMinutes())+":"+c(a.getUTCSeconds())+"Z"};z.parseStrictISO8601=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),c=0,f=new Date(a[1],0,1);if(a[3])f.setMonth(a[3]-1);else throw"missing ISO8061 component";if(a[5])f.setDate(a[5]);else throw"missing ISO8061 component";if(a[7])f.setHours(a[7]);
else throw"missing ISO8061 component";if(a[8])f.setMinutes(a[8]);else throw"missing ISO8061 component";if(a[10])f.setSeconds(a[10]);else throw"missing ISO8061 component";a[12]&&f.setMilliseconds(Number("0."+a[12])*1E3);a[14]&&(c=Number(a[16])*60+Number(a[17]),c*=a[15]=="-"?1:-1);c-=f.getTimezoneOffset();time=Number(f)+c*6E4;a=new Date;a.setTime(Number(time));return a};z.parseISO8601=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),
c=0,f=new Date(a[1],0,1);a[3]&&f.setMonth(a[3]-1);a[5]&&f.setDate(a[5]);a[7]&&f.setHours(a[7]);a[8]&&f.setMinutes(a[8]);a[10]&&f.setSeconds(a[10]);a[12]&&f.setMilliseconds(Number("0."+a[12])*1E3);a[14]&&(c=Number(a[16])*60+Number(a[17]),c*=a[15]=="-"?1:-1);c-=f.getTimezoneOffset();time=Number(f)+c*6E4;a=new Date;a.setTime(Number(time));return a};z.parseISO8601Components=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2}))(-([0-9]{2}))(T([0-9]{2}):([0-9]{2})(:([0-9]{2}))?(.([0-9]+))?)?(Z|([-+])([0-9]{2})(:([0-9]{2}))?)?")),
c,f,h,j,k,i,g,s;c=Number(a[1]);f=a[3]-1;h=Number(a[5]);j=Number(a[7]);k=Number(a[8]);i=Number(a[10]);a[12]&&(g=Number("0."+a[12])*1E3);a[13]==="Z"?s=0:a[14]?(s=0,a[17]&&(s=Number(a[17])),s+=Number(a[15])*60,s*=a[14]=="-"?-1:1):a[14]==null&&a[11]&&(s=Number(a[12])*60);return{year:isNaN(c)?null:c,month:isNaN(f)?null:f,date:isNaN(h)?null:h,hours:isNaN(j)?null:j,minutes:isNaN(k)?null:k,seconds:isNaN(i)?null:i,millisecs:isNaN(g)?null:g,timezone:isNaN(s)?null:s}};z.compareDateComponents=function(a,c){var f=
z.parseISO8601Components(a),h=z.parseISO8601Components(c);return f.timezone==null&&h.timezone==null||f.timezone!=null&&h.timezone!=null?(da=z.parseISO8601(a),db=z.parseISO8601(c),da.getTime()==db.getTime()?0:da.getTime()<db.getTime()?-1:1):f.timezone!=null&&h.timezone==null?(da=z.parseISO8601(a),db=z.parseISO8601(c),ta=da.getTime(),tb=db.getTime(),f=50400,ta<tb&&ta<tb+f?-1:ta>tb&&ta>tb-f?1:null):(da=z.parseISO8601(a),db=z.parseISO8601(c),ta=da.getTime(),tb=db.getTime(),f=50400,ta<tb&&ta+f<tb?-1:ta>
tb&&ta+f>tb?1:null)};z.lexicalFormLiteral=function(a,c){var f=a.value,h=a.lang,j=a.type,k=null;if(f!=null&&j!=null&&typeof j!="string"){f=j.value;if(f==null)f=j.suffix,j=c.namespaces[j.prefix],a.type=j+f,f=j+f;k=f.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+f+">":'"'+a.value+'"^^<'+f+">"}else k=h==null&&j==null?'"'+f+'"':j==null?'"'+f+'"@'+h:j.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+j+">":'"'+a.value+'"^^<'+j+">";return k};z.lexicalFormBaseUri=function(a,c){var f=null;
if(a.value==null)var f=a.prefix,h=a.suffix,j=c.namespaces[f],f=j!=null?j+h:f+":"+h;else f=a.value;if(f===null)return null;else f.indexOf(":")==-1&&(f=(c.base||"")+f);return f};z.lexicalFormTerm=function(a,c){if(a.token==="uri")return{uri:z.lexicalFormBaseUri(a,c)};else if(a.token==="literal")return{literal:z.lexicalFormLiteral(a,c)};else if(a.token==="blank")return{blank:"_:"+a.value};else throw"Error, cannot get lexical form of unknown token: "+a.token;};z.normalizeUnicodeLiterals=function(a){for(var c=
a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],f={},h=0;h<c.length;h++)f[c[h]]==null&&(f[c[h]]=!0,a=a.replace(RegExp("\\"+c[h],"g"),eval("'"+c[h]+"'")));return a};z.hashTerm=function(a){try{if(a==null)return"";if(a.token==="uri")return"u"+a.value;else if(a.token==="blank")return"b"+a.value;else if(a.token==="literal")return l="l"+a.value,l+=a.type||"",l+=a.lang||"",l}catch(c){if(typeof a==="object"){var f="";for(p in a)f=f+p+a[p];return f}return a}};var K={Tree:function(a){if(arguments.length!=0)this.order=
a,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0,this._diskWrite(this.root),this._updateRootNode(this.root),this.comparator=function(a,f){return a<f?-1:a>f?1:0},this.merger=null}};K.Tree.prototype._allocateNode=function(){return new K.Node};K.Tree.prototype._diskWrite=function(){};K.Tree.prototype._diskRead=function(a){return a};K.Tree.prototype._diskDelete=function(){};K.Tree.prototype._updateRootNode=function(a){return a};K.Tree.prototype.clear=function(){this.root=this._allocateNode();
this.root.isLeaf=!0;this.root.level=0;this._updateRootNode(this.root)};K.Tree.prototype.search=function(a,c){for(var f=!0,h=this.root;f;){for(var j=0;j<h.numberActives&&this.comparator(a,h.keys[j].key)===1;)j++;if(j<h.numberActives&&this.comparator(h.keys[j].key,a)===0)return c!=null&&c==!0?!0:h.keys[j].data;else h.isLeaf===!0?f=!1:h=this._diskRead(h.children[j])}return null};K.Tree.prototype.walk=function(a){this._walk(a,this.root)};K.Tree.prototype._walk=function(a,c){if(c.isLeaf)for(var f=0;f<
c.numberActives;f++)a(c.keys[f]);else{for(f=0;f<c.numberActives;f++)this._walk(a,this._diskRead(c.children[f])),a(c.keys[f]);this._walk(a,this._diskRead(c.children[c.numberActives]))}};K.Tree.prototype.walkNodes=function(a){this._walkNodes(a,this.root)};K.Tree.prototype._walkNodes=function(a,c){if(c.isLeaf)a(c);else{a(c);for(var f=0;f<c.numberActives;f++)this._walkNodes(a,this._diskRead(c.children[f]));this._walkNodes(a,this._diskRead(c.children[c.numberActives]))}};K.Tree.prototype._splitChild=function(a,
c,f){var h=this._allocateNode();h.isLeaf=f.isLeaf;h.level=f.level;h.numberActives=this.order-1;var j=f.keys[this.order-1];f.keys[this.order-1]=null;for(var k=0;k<this.order-1;k++)h.keys[k]=f.keys[k+this.order],f.keys[k+this.order]=null,f.isLeaf||(h.children[k]=f.children[k+this.order],f.children[k+this.order]=null);f.isLeaf||(h.children[k]=f.children[k+this.order],f.children[k+this.order]=null);f.numberActives=this.order-1;for(k=a.numberActives+1;k>c+1;k--)a.children[k]=a.children[k-1];a.children[c+
1]=h;for(k=a.numberActives;k>c;k--)a.keys[k]=a.keys[k-1];a.keys[c]=j;a.numberActives++;this._diskWrite(h);this._diskWrite(a);this._diskWrite(f)};K.Tree.prototype.insert=function(a,c){if(this.root.numberActives===2*this.order-1){var f=this._allocateNode();f.isLeaf=!1;f.level=this.root.level+1;f.numberActives=0;f.children[0]=this.root;this._splitChild(f,0,this.root);this.root=f;this._updateRootNode(this.root);this._insertNonFull(f,a,c)}else this._insertNonFull(this.root,a,c)};K.Tree.prototype._insertNonFull=
function(a,c,f){for(var h=a.numberActives-1;!a.isLeaf;){for(;h>=0&&this.comparator(c,a.keys[h].key)===-1;)h--;h++;var j=this._diskRead(a.children[h]);j.numberActives===2*this.order-1&&(this._splitChild(a,h,j),this.comparator(c,a.keys[h].key)===1&&h++);a=this._diskRead(a.children[h]);h=a.numberActives-1}for(;h>=0&&this.comparator(c,a.keys[h].key)===-1;)a.keys[h+1]=a.keys[h],h--;a.keys[h+1]={key:c,data:f};a.numberActives++;this._diskWrite(a)};K.Tree.prototype["delete"]=function(a){for(var c=this.root,
f=null,h=!0,j=null,k=null,i=null,g=!0;g===!0;){for(g=!1;h===!0;){s=0;if(c.numberActives===0)return!1;for(;s<c.numberActives&&this.comparator(a,c.keys[s].key)===1;)s++;j=s;s<c.numberActives&&this.comparator(a,c.keys[s].key)===0&&(h=!1);if(h===!0){if(c.isLeaf===!0)return!1;f=c;c=this._diskRead(c.children[s]);if(c===null)return!1;j===f.numberActives?(k=this._diskRead(f.children[j-1]),i=null):j===0?(k=null,i=this._diskRead(f.children[1])):(k=this._diskRead(f.children[j-1]),i=this._diskRead(f.children[j+
1]));c.numberActives===this.order-1&&f!=null&&(i!=null&&i.numberActives>this.order-1?this._moveKey(f,s,-1):k!=null&&k.numberActives>this.order-1?this._moveKey(f,s,1):k!=null&&k.numberActives===this.order-1?c=this._mergeSiblings(f,s,-1):i!=null&&i.numberActives===this.order-1&&(c=this._mergeSiblings(f,s,1)))}}if(c.isLeaf&&c.numberActives>this.order-1)return this._deleteKeyFromNode(c,j),!0;if(c.isLeaf&&c===this.root)return this._deleteKeyFromNode(c,j),!0;if(c.isLeaf===!1)if(f=s=null,(s=this._diskRead(c.children[j])).numberActives>
this.order-1)a=this._getMaxKeyPos(s),a=a.node.keys[a.index],c.keys[j]=a,this._diskWrite(c),c=s,a=a.key,h=g=!0;else if((s=this._diskRead(c.children[j+1])).numberActives>this.order-1)a=this._getMinKeyPos(s),a=a.node.keys[a.index],c.keys[j]=a,this._diskWrite(c),c=s,a=a.key,h=g=!0;else if((s=this._diskRead(c.children[j])).numberActives===this.order-1&&(f=this._diskRead(c.children[j+1])).numberActives===this.order-1){h=this._mergeNodes(s,c.keys[j],f);c.children[j]=h;j++;for(var s=j;s<c.numberActives;s++)c.children[s]=
c.children[s+1],c.keys[s-1]=c.keys[s];c.children[s]=null;c.keys[s-1]=null;c.numberActives--;if(c.numberActives===0&&this.root===c)this.root=h;this._diskWrite(c);c=h;h=g=!0}c.isLeaf&&c.numberActives>this.order-1&&h===!1&&this._deleteKeyFromNode(c,j);if(g===!1)return!0}};K.Tree.prototype._moveKey=function(a,c,f){f===1&&c--;var h=this._diskRead(a.children[c]),j=this._diskRead(a.children[c+1]);if(f==-1){h.keys[h.numberActives]=a.keys[c];h.children[h.numberActives+1]=j.children[0];j.children[0]=null;h.numberActives++;
a.keys[c]=j.keys[0];for(f=1;f<j.numberActives;f++)j.keys[f-1]=j.keys[f],j.children[f-1]=j.children[f];j.children[j.numberActives-1]=j.children[j.numberActives];j.numberActives--}else{j.children[j.numberActives+1]=j.children[j.numberActives];for(f=j.numberActives;f>0;f--)j.children[f]=j.children[f-1],j.keys[f]=j.keys[f-1];j.keys[0]=null;j.children[0]=null;j.children[0]=h.children[h.numberActives];j.keys[0]=a.keys[c];j.numberActives++;h.children[h.numberActives]=null;a.keys[c]=h.keys[h.numberActives-
1];h.keys[h.numberActives-1]=null;h.numberActives--}this._diskWrite(h);this._diskWrite(j);this._diskWrite(a)};K.Tree.prototype._mergeSiblings=function(a,c){var f,h,j;c===a.numberActives?(c--,h=this._diskRead(a.children[a.numberActives-1]),j=this._diskRead(a.children[a.numberActives])):(h=this._diskRead(a.children[c]),j=this._diskRead(a.children[c+1]));var k=this._allocateNode();k.isLeaf=h.isLeaf;k.level=h.level;for(f=0;f<this.order-1;f++)k.keys[f]=h.keys[f],k.children[f]=h.children[f];k.keys[this.order-
1]=a.keys[c];k.children[this.order-1]=h.children[this.order-1];for(f=0;f<this.order-1;f++)k.keys[f+this.order]=j.keys[f],k.children[f+this.order]=j.children[f];k.children[2*this.order-1]=j.children[this.order-1];a.children[c]=k;for(f=c;f<a.numberActives;f++)a.keys[f]=a.keys[f+1],a.children[f+1]=a.children[f+2];k.numberActives=h.numberActives+j.numberActives+1;a.numberActives--;for(f=a.numberActives;f<2*this.order-1;f++)a.keys[f]=null;if(a.numberActives===0&&this.root===a)this.root=k,k.isLeaf=k.level?
!1:!0;this._diskWrite(k);this.root===k&&this._updateRootNode(this.root);this._diskWrite(a);this._diskDelete(h);this._diskDelete(j);return k};K.Tree.prototype._deleteKeyFromNode=function(a,c){var f=2*this.order-1;if(a.numberActives<f)f=a.numberActives;var h;if(a.isLeaf===!1)return!1;for(h=c;h<f-1;h++)a.keys[h]=a.keys[h+1];a.keys.pop();a.numberActives--;this._diskWrite(a);return!0};K.Tree.prototype._mergeNodes=function(a,c,f){var h,j;h=this._allocateNode();h.isLeaf=!0;for(j=0;j<a.numberActives;j++)h.keys[j]=
a.keys[j],h.children[j]=a.children[j];h.children[a.numberActives]=a.children[a.numberActives];h.keys[a.numberActives]=c;for(j=0;j<f.numberActives;j++)h.keys[j+a.numberActives+1]=f.keys[j],h.children[j+a.numberActives+1]=f.children[j];h.children[2*this.order-1]=f.children[f.numberActives];h.numberActives=a.numberActives+f.numberActives+1;h.isLeaf=a.isLeaf;h.level=a.level;this._diskWrite(h);return h};K.Tree.prototype.audit=function(a){var c=[],f=[],h=this,j=function(k){for(var j=0;j<f.length;j++)if(h.comparator(f[j],
k)===0){var g=" !!! duplicated key "+k;a===!0&&console.log(g);c.push(g)}},k=null,h=this;this.walkNodes(function(i){a===!0&&(console.log("--- Node at "+i.level+" level"),console.log(" - leaf? "+i.isLeaf),console.log(" - num actives? "+i.numberActives),console.log(" - keys: "));for(var g=i.numberActives;g<i.keys.length;g++)i.keys[g]!=null&&a===!0&&(console.log(" * warning : redundant key data"),c.push(" * warning : redundant key data"));for(g=i.numberActives+1;g<i.children.length;g++)i.children[g]!=
null&&a===!0&&(console.log(" * warning : redundant children data"),c.push(" * warning : redundant key data"));if(i.isLeaf===!1)for(g=0;g<i.numberActives;g++){var s=h._diskRead(i.children[g]).keys[h._diskRead(i.children[g]).numberActives-1].key,v=h._diskRead(i.children[g+1]).keys[0].key;a===!0&&console.log("   "+i.keys[g].key+"("+s+","+v+")");if(h.comparator(i.keys[g].key,s)===-1){var u=" !!! value max left "+s+" > key "+i.keys[g].key;a===!0&&console.log(u);c.push(u)}h.comparator(i.keys[g].key,v)===
1&&(u=" !!! value min right "+v+" < key "+i.keys[g].key,a===!0&&console.log(u),c.push(u));j(i.keys[g].key);f.push(i.keys[g].key)}else{k===null?k=i.level:k!=i.level&&(u=" !!! Leaf node with wrong level value",a===!0&&console.log(u),c.push(u));for(g=0;g<i.numberActives;g++)a===!0&&console.log(" "+i.keys[g].key),j(i.keys[g].key),f.push(i.keys[g].key)}i!=h.root&&(i.numberActives>2*h.order-1&&(a===!0&&(u=" !!!! MAX num keys restriction violated "),console.log(u),c.push(u)),i.numberActives<h.order-1&&(a===
!0&&(u=" !!!! MIN num keys restriction violated "),console.log(u),c.push(u)))});return c};K.Tree.prototype._getMaxKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=a.numberActives-1;break}else c.node=a,c.index=a.numberActives-1,a=this._diskRead(a.children[a.numberActives])}return c};K.Tree.prototype._getMinKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=0;break}else c.node=a,c.index=0,a=this._diskRead(a.children[0])}return c};
K.Node=function(){this.numberActives=0;this.isLeaf=null;this.keys=[];this.children=[];this.level=0};var T={NodeKey:function(a,c){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.order=c}};T.NodeKey.prototype.comparator=function(a){for(var c=0;c<this.order.length;c++){var f=this.order[c];if(a[f]==null)break;else if(this[f]<a[f])return-1;else if(this[f]>a[f])return 1}return 0};T.Pattern=function(a){this.subject=a.subject;this.predicate=a.predicate;this.object=
a.object;this.graph=a.graph;this.indexKey=[];this.keyComponents={};for(var c=[],f=[],a=["subject","predicate","object","graph"],h=0;h<a.length;h++)typeof this[a[h]]==="string"?(f.push(a[h]),this.keyComponents[a[h]]=null):(c.push(a[h]),this.keyComponents[a[h]]=this[a[h]],this.indexKey.push(a[h]));this.order=c.concat(f);this.key=new T.NodeKey(this.keyComponents,this.order)};var Y={Tree:function(a,c){if(arguments!=0)this.componentOrder=a.componentOrder,K.Tree.call(this,a.order,a.name,a.persistent,a.cacheMaxSize),
this.comparator=function(a,c){for(var j=0;j<this.componentOrder.length;j++){var k=this.componentOrder[j],i=a[k],k=c[k];if(i<k)return-1;else if(i>k)return 1}return 0},this.rangeComparator=function(a,c){for(var j=0;j<this.componentOrder.length;j++){var k=this.componentOrder[j];if(c[k]==null||a[k]==null)break;else if(a[k]<c[k])return-1;else if(a[k]>c[k])return 1}return 0},c!=null&&c(this)}};z["extends"](K.Tree,Y.Tree);Y.Tree.prototype.insert=function(a,c){K.Tree.prototype.insert.call(this,a,null);c&&
c(!0);return!0};Y.Tree.prototype.search=function(a,c){var f=K.Tree.prototype.search.call(this,a,!0);c&&c(f);return f};Y.Tree.prototype.range=function(a,c){var f=null,f=typeof this.root==="string"?this._rangeTraverse(this,this._diskRead(this.root),a):this._rangeTraverse(this,this.root,a);c&&c(f);return f};Y.Tree.prototype._rangeTraverse=function(a,c,f){for(var f=f.key,h=[],j=[c],k;j.length>0;){c=j.shift();for(k=0;k<c.numberActives&&a.rangeComparator(c.keys[k].key,f)===-1;)k++;if(c.isLeaf===!0)for(;k<
c.numberActives&&a.rangeComparator(c.keys[k].key,f)===0;)h.push(c.keys[k].key),k++;else{var i=a._diskRead(c.children[k]);for(j.push(i);;)if(k<c.numberActives&&a.rangeComparator(c.keys[k].key,f)===0)h.push(c.keys[k].key),k++,i=a._diskRead(c.children[k]),j.push(i);else break}}return h};var V={QuadBackend:function(a,c){if(arguments!=0){this.indexMap={};this.treeOrder=a.treeOrder;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph",
"predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};for(var f=0;f<this.indices.length;f++){var h=this.indices[f],j=new Y.Tree({order:this.treeOrder,componentOrder:this.componentOrders[h],persistent:a.persistent,name:(a.name||"")+h,cacheMaxSize:a.cacheMaxSize});this.indexMap[h]=j}c&&c(this)}}};V.QuadBackend.prototype.clear=function(){for(var a=
0;a<this.indices.length;a++)this.indexMap[this.indices[a]].clear()};V.QuadBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,f=0;f<c.length;f++)for(var h=c[f],j=this.componentOrders[h],k=0;k<j.length;k++){if(z.include(a,j[k])===!1)break;if(k==a.length-1)return h}return"SPOG"};V.QuadBackend.prototype.index=function(a,c){for(var f=0;f<this.indices.length;f++)this.indexMap[this.indices[f]].insert(a);c&&c(!0);return!0};V.QuadBackend.prototype.range=function(a,c){var f=
this.indexMap[this._indexForPattern(a)].range(a);c&&c(f);return f};V.QuadBackend.prototype.search=function(a,c){var f=this.indexMap[this.indices[0]].search(a);c&&c(f!=null);return f!=null};V.QuadBackend.prototype["delete"]=function(a,c){for(var f,h=0;h<this.indices.length;h++)f=this.indices[h],f=this.indexMap[f],f["delete"](a);c&&c(!0);return!0};var H={Lexicon:function(a){this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};this.defaultGraphOid=
0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri,oid:this.defaultGraphOid};this.oidCounter=1;this.knownGraphs={};a!=null&&a(this)}};H.Lexicon.prototype.registerGraph=function(a){a!=this.defaultGraphOid&&(this.knownGraphs[a]=!0);return!0};H.Lexicon.prototype.registeredGraphs=function(a){var c=[],f;for(f in this.knownGraphs)a===!0?c.push(this.OIDToUri["u"+f]):c.push(f);return c};
H.Lexicon.prototype.registerUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;else{if(this.uriToOID[a]==null){var c=this.oidCounter;this.oidCounter++;this.uriToOID[a]=[c,0];this.OIDToUri["u"+c]=a}else{var f=this.uriToOID[a],c=f[0];this.uriToOID[a]=[c,f[1]+1]}return c}};H.Lexicon.prototype.resolveUri=function(a){return a===this.defaultGraphUri?this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[0]:-1)};H.Lexicon.prototype.resolveUriCost=function(a){return a===this.defaultGraphUri?
this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[1]:-1)};H.Lexicon.prototype.registerBlank=function(){var a=this.oidCounter;this.oidCounter++;a=""+a;this.OIDToBlank[a]=!0;return a};H.Lexicon.prototype.resolveBlank=function(){var a=this.oidCounter;this.oidCounter++;return""+a};H.Lexicon.prototype.resolveBlankCost=function(){return 0};H.Lexicon.prototype.registerLiteral=function(a){if(this.literalToOID[a]==null){var c=this.oidCounter;this.oidCounter++;this.literalToOID[a]=[c,0];this.OIDToLiteral["l"+
c]=a}else{var f=this.literalToOID[a],c=f[0];this.literalToOID[a]=[c,f[1]+1]}return c};H.Lexicon.prototype.resolveLiteral=function(a){a=this.literalToOID[a];return a!=null?a[0]:-1};H.Lexicon.prototype.resolveLiteralCost=function(a){a=this.literalToOID[a];return a!=null?a[1]:0};H.Lexicon.prototype.parseLiteral=function(a){var c=a.lastIndexOf("@");if(c!=-1&&a[c-1]==='"'&&a.substring(c,a.length).match(/^@[a-zA-Z\-]+$/g)!=null){var f=a.substring(1,c-1),a=a.substring(c+1,a.length);return{token:"literal",
value:f,lang:a}}c=a.lastIndexOf("^^");if(c!=-1&&a[c-1]==='"'&&a[c+2]==="<"&&a[a.length-1]===">")return f=a.substring(1,c-1),a=a.substring(c+3,a.length-1),{token:"literal",value:f,type:a};f=a.substring(1,a.length-1);return{token:"literal",value:f}};H.Lexicon.prototype.parseUri=function(a){return{token:"uri",value:a}};H.Lexicon.prototype.retrieve=function(a){try{if(a===this.defaultGraphOid)return{token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0};else{var c=this.OIDToUri["u"+
a];if(c!=null)return this.parseUri(c);else{var f=this.OIDToLiteral["l"+a];if(f!=null)return this.parseLiteral(f);else if(this.OIDToBlank[""+a]!=null)return{token:"blank",value:"_:"+a};else throw"Null value for OID";}}}catch(h){throw console.log("error in lexicon retrieving OID:"),console.log(a),h.message||h.stack?(h.message&&console.log(h.message),h.stack&&console.log(h.stack)):console.log(h),Error("Unknown retrieving OID in lexicon:"+a);}};H.Lexicon.prototype.clear=function(){this.uriToOID={};this.OIDToUri=
{};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={}};H.Lexicon.prototype.unregister=function(a,c){try{return this.unregisterTerm(a.subject.token,c.subject),this.unregisterTerm(a.predicate.token,c.predicate),this.unregisterTerm(a.object.token,c.object),a.graph!=null&&this.unregisterTerm(a.graph.token,c.graph),!0}catch(f){return console.log("Error unregistering quad"),console.log(f.message),!1}};H.Lexicon.prototype.unregisterTerm=function(a,c){if(a==="uri"){if(c!=this.defaultGraphOid){var f=
"u"+c,h=this.OIDToUri[f],j=this.uriToOID[h],k=j[1];if(""+j[0]===""+c)k===0?(delete this.OIDToUri[f],delete this.uriToOID[h],delete this.knownGraphs[c]):this.uriToOID[h]=[c,k-1];else throw"Not matching OID : "+c+" vs "+j[0];}}else if(a==="literal")if(this.oidCounter++,f="l"+c,h=this.OIDToLiteral[f],j=this.literalToOID[h],k=j[1],""+j[0]===""+c)k===0?(delete this.OIDToLiteral[f],delete this.literalToOID[h]):this.literalToOID[h]=[c,k-1];else throw"Not matching OID : "+c+" vs "+j[0];else a==="blank"&&
delete this.OIDToBlank[""+c]};var P={};P.load=function(a,c,f){jQuery.ajax({url:a,headers:{Accept:c},success:function(a,c,k){if((""+k.status)[0]=="2"){for(var c=k.getAllResponseHeaders().split("\n"),k={},i=0;i<c.length;i++){var g=c[i].split(":");k[g[0]]=g[1]}f(!0,{headers:k,data:a})}},error:function(a){(""+a.status)[0]=="3"?redirection==0?f(!1,500):(a=a.getAllResponseHeaders().Location||a.getAllResponseHeaders().location,a!=null?P.load(a,c,f,redirection-1):f(!1,500)):f(!1,a.statusCode())}})};var va=
null;(function(){var a=function(a,c){a.stack="";for(var k in c)a[k]=c[k]};if(typeof window!=="undefined"){var c=window.jsonld=window.jsonld||{};Exception=function(c){a(this,c)};if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var c=[],k;for(k in a)Object.prototype.hasOwnProperty.call(a,k)&&c.push(k);return c};if(!Array.prototype.filter)Array.prototype.filter=function(a,c){if(this==null)throw new TypeError;var k=Object(this),f=k.length>>>
0;if(typeof a!="function")throw new TypeError;for(var h=[],i=0;i<f;i++)if(i in k){var j=k[i];a.call(c,j,i,k)&&h.push(j)}return h}}else typeof module!=="undefined"&&module.exports&&(c={},Exception=function(c){a(this,c);this.stack=Error().stack});va=c;var f={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",
vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},h={xsd:"http://www.w3.org/2001/XMLSchema#"},j={"boolean":h.xsd+"boolean","double":h.xsd+"double",integer:h.xsd+"integer"},k=function(a,
c,k){c in a?a[c].constructor===Array?a[c].push(k):a[c]=[a[c],k]:a[c]=k},i=function(a){var c;if(a.constructor===Object){c={};var k=Object.keys(a).sort(),f;for(f in k){var h=k[f];c[h]=i(a[h])}}else if(a.constructor===Array)for(f in c=[],a)c[f]=i(a[f]);else c=a;return c},g=function(a){var c={"@id":"@id","@language":"@language","@literal":"@literal","@type":"@type"};if(a){var k={},f;for(f in a)a[f].constructor===String&&a[f]in c&&(k[a[f]]=f);for(f in k)c[f]=k[f]}return c},s=function(a,c){var k=null;c in
a&&(a[c].constructor===String?k=a[c]:a[c].constructor===Object&&"@id"in a[c]&&(k=a[c]["@id"]));return k},v=function(a,c,k){var f=null,h;for(h in a)if(h.length>0&&h[0]!=="@"&&c===s(a,h)){f=h;k!==null&&(k[h]=i(a[h]));break}f===null&&c==="@type"&&(f=g(a)["@type"]);if(f===null)for(h in a)if(h.length>0&&h[0]!=="@"){var j=s(a,h);if(j!==null&&c.indexOf(j)===0&&c.length>j.length){f=h+":"+c.substr(j.length);k!==null&&(k[h]=i(a[h]));break}}f===null&&(f=c);return f},u=function(a,c,k){var f=c,h=g(a),j=c.indexOf(":");
if(j!==-1)h=c.substr(0,j),h in a&&(f=s(a,h)+c.substr(j+1),k!==null&&(k[h]=i(a[h])));else if(c in a)f=s(a,c),k!==null&&(k[c]=i(a[c]));else for(var v in h)if(c===h[v]){f=v;break}return f},x=function(a){var c=!1;a!==null&&a.constructor===Object&&!("@literal"in a)&&(c=Object.keys(a).length>1||!("@id"in a));return c};c.normalize=function(a){return(new F).normalize(a)};c.expand=function(a){return(new F).expand({},null,a)};c.compact=function(a,k){var f=null;if(k!==null){var k=c.expand(k),h;k.constructor===
Array?(f=[],h=k):h=[k];a.constructor===Array&&(a=c.mergeContexts({},a));for(var j in h){var g={},m=(new F).compact(i(a),null,h[j],g);if(Object.keys(g).length>0){var s=g,g={},v=Object.keys(s).sort(),u=void 0;for(u in v){var x=v[u];g[x]=s[x]}s=Object.keys(m);s.sort();s.unshift("@context");m["@context"]=g;var g={},z;for(z in s)v=s[z],g[v]=m[v];m=g}f===null?f=m:f.push(m)}}return f};c.mergeContexts=function(a,k){a.constructor===Array&&(a=c.mergeContexts({},a));var f=i(a);if(k.constructor===Array)for(var h in k)f=
c.mergeContexts(f,k[h]);else{for(var j in k)if(j.indexOf("@")!==0)for(var g in f)if(f[g]===k[j]){delete f[g];break}for(j in k)f[j]=i(k[j])}return f};c.expandTerm=u;c.compactIri=function(a,c){return v(a,c,null)};c.frame=function(a,c,k){return(new F).frame(a,c,k)};c.toTriples=function(a,k,f){var h=null,a=c.normalize(a),f=f||null;f===null&&(h=[],f=function(a,c,f){h.push({subject:z.lexicalFormTerm(a),predicate:z.lexicalFormTerm(c),object:z.lexicalFormTerm(f),graph:k})});var i=!1,j;for(j in a){var g=a[j],
m=g["@id"],m=m[0]=="_"?{token:"blank",value:m.split(":")[1]}:{token:"uri",value:m},s;for(s in g)if(s!=="@id"){var v=g[s];v.constructor!==Array&&(v=[v]);for(var u in v)if(i=v[u],s==="@type"?(s="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",i={token:"uri",value:i}):typeof i==="string"?i={token:"literal",value:i}:i["@id"]!=null?i=i["@id"][0]=="_"?{token:"blank",value:i["@id"].split(":")[1]}:{token:"uri",value:i["@id"]}:i["@type"]!=null?i={token:"literal",value:i["@literal"],type:i["@type"]}:i["@language"]!=
null&&(i={token:"literal",value:i["@literal"],lang:i["@language"]}),i=f(m,{token:"uri",value:s},i)===!1)break;if(i)break}if(i)break}return h};c.resolve=function(a,c,k){var f={},h=function(a,c){if(a.constructor===Array)for(var k in a)h(a[k]);else if(a.constructor===Object)for(var i in a)if(i==="@context")if(a[i].constructor===Array){var j=a[i];for(k in j)j[k].constructor===String&&(c?j[k]=f[j[k]]:f[j[k]]={})}else a[i].constructor===String&&(c?a[i]=f[a[i]]:f[a[i]]={})};h(a,!1);var i=Object.keys(f).length,
j=null;if(i===0)k(a,j);else for(var g in f)c(g,function(c,m){--i;if(c===null)j=j||[],j.push({url:g,error:m});else try{f[g]=c.constructor===String?JSON.parse(c)["@context"]:c["@context"]}catch(s){j=j||[],j.push({url:g,error:s})}i===0&&(j===null&&h(a,!0),k(a,j))})};var F=function(){};F.prototype.compact=function(a,c,k,f){var h,s=g(a);if(k===null)h=null,this.getCoerceType(a,c,f);else if(k.constructor===Array){h=[];for(var u in k)h.push(this.compact(a,c,k[u],f))}else if(k.constructor===Object&&"@id"in
k&&k["@id"].constructor===Array)h={},h[s["@id"]]=this.compact(a,c,k["@id"],f);else if(x(k)){h={};for(var z in k)if(k[z]!=="@context"&&(s=v(a,z,f),s!==z||!(s in h)))h[s]=this.compact(a,z,k[z],f)}else{c=this.getCoerceType(a,c,f);u=null;k.constructor===Object?"@language"in k||(u="@type"in k?k["@type"]:"@id"in k?"@id":c):k.constructor===String&&(u=c);if(c===null&&(u===j["boolean"]||u===j.integer||u===j["double"]))c=u;if(c!==null)if(u===null)throw{message:"Cannot coerce type when a language is specified. The language information would be lost."};
else if(u!==c)throw new Exception({message:"Cannot coerce type because the type does not match.",type:u,expected:c});else k.constructor===Object?"@id"in k?h=k["@id"]:"@literal"in k&&(h=k["@literal"]):h=k,c===j["boolean"]?h=h==="true"||h!=0:c===j["double"]?h=parseFloat(h):c===j.integer&&(h=parseInt(h));else if(k.constructor===Object)for(z in h={},k)h[s[z]]=k[z];else h=i(k);u==="@id"&&(h.constructor===Object?h[s["@id"]]=v(a,h[s["@id"]],f):h=v(a,h,f))}return h};F.prototype.expand=function(a,f,h){var s;
if(h===null)s=null;else if(f===null&&h.constructor===String)s=u(a,h,null);else if(h.constructor===Array){s=[];for(var v in h)s.push(this.expand(a,f,h[v]))}else if(h.constructor===Object){"@context"in h&&(a=c.mergeContexts(a,h["@context"]));s={};for(var x in h)x==="@embed"||x==="@explicit"||x==="@default"||x==="@omitDefault"?k(s,x,i(h[x])):x!=="@context"&&k(s,u(a,x,null),this.expand(a,x,h[x]))}else{v=this.getCoerceType(a,f,null);s=g(a);if(v===null&&(h.constructor===Number||h.constructor===Boolean))v=
h.constructor===Boolean?j["boolean"]:(""+h).indexOf(".")==-1?j.integer:j["double"];f===s["@id"]||f===s["@type"]?s=u(a,h,null):v!==null?(s={},v==="@id"?s["@id"]=u(a,h,null):(s["@type"]=v,v===j["double"]&&(h=h.toExponential(6).replace(/(e(?:\+|-))([0-9])$/,"$10$2")),s["@literal"]=""+h)):s=""+h}return s};F.prototype.normalize=function(a){var c=[];if(a!==null){this.ng={tmp:null,c14n:null};var k=this.expand(f,null,a);this.nameBlankNodes(k);a={};J(null,null,k,a);for(var h in a){var k=a[h],i={},j=Object.keys(k).sort(),
g;for(g in j){var m=j[g];i[m]=k[m]}c.push(i)}this.canonicalizeBlankNodes(c);c.sort(function(a,c){return N(a["@id"],c["@id"])})}return c};F.prototype.getCoerceType=function(a,c,k){var f=null,c=u(a,c,null);c==="@id"||c==="@type"?f="@id":(c=v(a,c,null),c in a&&a[c].constructor===Object&&"@type"in a[c]&&(f=u(a,a[c]["@type"],k),k!==null&&(k[c]=i(a[c]))));return f};var B=function(a){return a.indexOf("_:")===0},E=function(a){return a.constructor===Object&&"@id"in a&&B(a["@id"])},N=function(a,c){var k=0;
if(a.constructor===Array&&c.constructor===Array)for(var f=0;f<a.length&&k===0;++f)k=N(a[f],c[f]);else k=a<c?-1:a>c?1:0;return k},D=function(a,c,k){var f=0;k in a?f=k in c?N(a[k],c[k]):-1:k in c&&(f=1);return f},G=function(a,c){var k=0;a.constructor===String?k=c.constructor!==String?-1:N(a,c):c.constructor===String?k=1:(k=D(a,c,"@literal"),k===0&&("@literal"in a?(k=D(a,c,"@type"),k===0&&(k=D(a,c,"@language"))):k=N(a["@id"],c["@id"])));return k},C=function(a,c){var k=0,f;for(f in a)if(f!=="@id"){k=
N(a[f].constructor===Array?a[f].length:1,c[f].constructor===Array?c[f].length:1);if(k===0){var h=a[f],i=c[f];h.constructor!==Array&&(h=[h],i=[i]);h=h.filter(function(a){return!E(a)});i=i.filter(function(a){return!E(a)});k=N(h.length,i.length)}if(k===0){h.sort(G);i.sort(G);for(var j=0;j<h.length&&k===0;++j)k=G(h[j],i[j])}if(k!==0)break}return k},K=function(a){var c=-1,k={next:function(){++c;return k.current()},current:function(){return"_:"+a+c},inNamespace:function(c){return c.indexOf("_:"+a)===0}};
return k},L=function(a,c,k){if(a!==null)if(a.constructor===Array)for(var f in a)L(a[f],c,k);else if(a.constructor===Object){"@id"in a?a["@id"].constructor==Array?L(a["@id"],c,k):x(a)&&(c[a["@id"]]=a):x(a)&&(!("@id"in a)||E(a))&&k.push(a);for(var h in a)L(a[h],c,k)}},J=function(a,c,k,f){var h=null;if(k!==null)if(k.constructor===Array)for(var j in k)J(a,c,k[j],f);else if(k.constructor===Object)if("@literal"in k||c==="@type")h=i(k);else if(k["@id"].constructor===Array){if(a!==null)throw{message:"Embedded graph literals cannot be flattened."};
for(var g in k["@id"])J(a,c,k["@id"][g],f)}else{k["@id"]in f?j=f[k["@id"]]:(j={"@id":k["@id"]},f[k["@id"]]=j);var h={"@id":j["@id"]},m;for(m in k)g=k[m],g!==null&&m!=="@id"&&(m in j?j[m].constructor!==Array&&(j[m]=[j[m]]):j[m]=[],J(j[m],m,g,f),j[m].length===1&&(j[m]=j[m][0]))}else h=k;h!==null&&a!==null&&(a.constructor===Array?(c=!1,h.constructor===Object&&"@id"in h&&(c=a.filter(function(a){return a.constructor===Object&&"@id"in a&&a["@id"]===h["@id"]}).length>0),c||a.push(h)):a[c]=h)};F.prototype.nameBlankNodes=
function(a){var c=this.ng.tmp=K("tmp"),k={},f=[];L(a,k,f);for(var h in f)if(a=f[h],!("@id"in a)){for(;c.next()in k;);a["@id"]=c.current();k[c.current()]=a}};F.prototype.renameBlankNode=function(a,c){var k=a["@id"];a["@id"]=c;var f=this.subjects;f[c]=f[k];delete f[k];this.edges.refs[c]=this.edges.refs[k];this.edges.props[c]=this.edges.props[k];delete this.edges.refs[k];delete this.edges.props[k];var h=this.edges.refs[c].all,i;for(i in h){var j=h[i].s;j===k&&(j=c);var g=f[j],m=this.edges.props[j].all,
s;for(s in m)if(m[s].s===k){m[s].s=c;var j=m[s].p,j=g[j].constructor===Object?[g[j]]:g[j].constructor===Array?g[j]:[],v;for(v in j)j[v].constructor===Object&&"@id"in j[v]&&j[v]["@id"]===k&&(j[v]["@id"]=c)}}m=this.edges.props[c].all;for(i in m){var j=m[i].s,h=this.edges.refs[j].all,u;for(u in h)if(h[u].s===k)h[u].s=c}};F.prototype.canonicalizeBlankNodes=function(a){this.renamed={};this.mappings={};this.serializations={};var c=this.edges={refs:{},props:{}},k=this.subjects={},f=[],h;for(h in a){var j=
a[h]["@id"];k[j]=a[h];c.refs[j]={all:[],bnodes:[]};c.props[j]={all:[],bnodes:[]};B(j)&&f.push(a[h])}this.collectEdges();var a=this.ng.c14n=K("c14n"),i=this.ng.tmp;for(h in f){var g=f[h],j=g["@id"];if(a.inNamespace(j)){for(;i.next()in k;);this.renameBlankNode(g,i.current());j=g["@id"]}this.serializations[j]={props:null,refs:null}}for(var i=!0,m=this;f.length>0;){i&&(i=!1,f.sort(function(a,c){return m.deepCompareBlankNodes(a,c)}));var g=f.shift(),j=g["@id"],g=["props","refs"],s;for(s in g){var v=g[s];
if(this.serializations[j][v]===null){var u={};u[j]="s1"}else u=this.serializations[j][v].m;var x=Object.keys(u);x.sort(function(a,c){return N(u[a],u[c])});var z=[];for(h in x){var F=x[h];!a.inNamespace(j)&&F in k&&(this.renameBlankNode(k[F],a.next()),z.push(F))}x=f;f=[];for(h in x){var F=x[h],O=F["@id"];if(!a.inNamespace(O)){for(var E in z)this.markSerializationDirty(O,z[E],v)&&(i=!0);f.push(F)}}}}for(var D in c.props)if(c.props[D].bnodes.length>0){var g=k[D],C;for(C in g)C.indexOf("@")!==0&&g[C].constructor===
Array&&g[C].sort(G)}};MappingBuilder=function(){this.count=1;this.processed={};this.mapping={};this.adj={};this.keyStack=[{keys:["s1"],idx:0}];this.done={};this.s=""};MappingBuilder.prototype.copy=function(){var a=new MappingBuilder;a.count=this.count;a.processed=i(this.processed);a.mapping=i(this.mapping);a.adj=i(this.adj);a.keyStack=i(this.keyStack);a.done=i(this.done);a.s=this.s;return a};MappingBuilder.prototype.mapNode=function(a){a in this.mapping||(this.mapping[a]=a.indexOf("_:c14n")===0?"c"+
a.substr(6):"s"+this.count++);return this.mapping[a]};MappingBuilder.prototype.serialize=function(a,c){if(this.keyStack.length>0)for(var k=this.keyStack.pop();k.idx<k.keys.length;++k.idx){var f=k.keys[k.idx];if(!(f in this.adj)){this.keyStack.push(k);break}if(f in this.done)this.s+="_"+f;else{this.done[f]=!0;var h=f,f=this.adj[f],j=f.i;if(j in a){var i=a[j],g="",m=!0,s=void 0;for(s in i)if(s!=="@id"){m?m=!1:g+="|";g+="<"+s+">";var v=i[s].constructor===Array?i[s]:[i[s]],u;for(u in v){var x=v[u];x.constructor===
Object?"@id"in x?g+=B(x["@id"])?"_:":"<"+x["@id"]+">":(g+='"'+x["@literal"]+'"',"@type"in x?g+="^^<"+x["@type"]+">":"@language"in x&&(g+="@"+x["@language"])):g+='"'+x+'"'}}h+="["+g+"]";i=!0;h+="[";var j=c.refs[j].all,z;for(z in j)i?i=!1:h+="|",h+="<"+j[z].p+">",h+=B(j[z].s)?"_:":"<"+j[z].s+">";h+="]"}h+=f.k.join("");this.s+=h;this.keyStack.push({keys:f.k,idx:0});this.serialize(a,c)}}};F.prototype.markSerializationDirty=function(a,c,k){var f=!1,a=this.serializations[a];a[k]!==null&&c in a[k].m&&(a[k]=
null,f=!0);return f};var H=function(a,c){var k=0;return k=a.length==c.length?N(a,c):a.length>c.length?N(a.substr(0,c.length),c):N(a,c.substr(0,a.length))};F.prototype.serializeCombos=function(a,c,k,f,h,j,g){if(g.length>0){j=i(j);j[f.mapNode(g[0].s)]=g[0].s;for(var m=f.copy(),g=g.slice(1),s=Math.max(1,g.length),v=0;v<s;++v){var u=v===0?f:m.copy();this.serializeCombos(a,c,k,u,h,j,g);g.unshift.apply(g,g.splice(1,g.length))}}else if(g=Object.keys(j).sort(),f.adj[k]={i:c,k:g,m:j},f.serialize(this.subjects,
this.edges),a[h]===null||H(f.s,a[h].s)<=0){for(m in g)this.serializeBlankNode(a,j[g[m]],f,h);f.serialize(this.subjects,this.edges);if(a[h]===null||H(f.s,a[h].s)<=0&&f.s.length>=a[h].s.length)a[h]={s:f.s,m:f.mapping}}};F.prototype.serializeBlankNode=function(a,c,k,f){if(!(c in k.processed)){k.processed[c]=!0;var h=k.mapNode(c),j=k.copy(),i=this.edges[f][c].bnodes,g={},m=[],s;for(s in i)i[s].s in k.mapping?g[k.mapping[i[s].s]]=i[s].s:m.push(i[s]);i=Math.max(1,m.length);for(s=0;s<i;++s){var v=s===0?
k:j.copy();this.serializeCombos(a,c,h,v,f,g,m)}}};F.prototype.deepCompareBlankNodes=function(a,c){var k=0,f=a["@id"],h=c["@id"];if(f===h)k=0;else if(k=this.shallowCompareBlankNodes(a,c),k===0)for(var j=["props","refs"],g=0;k===0&&g<j.length;++g){var k=j[g],m=this.serializations[f],s=this.serializations[h];if(m[k]===null){var v=new MappingBuilder;if(k==="refs")v.mapping=i(m.props.m),v.count=Object.keys(v.mapping).length+1;this.serializeBlankNode(m,f,v,k)}if(s[k]===null){v=new MappingBuilder;if(k===
"refs")v.mapping=i(s.props.m),v.count=Object.keys(v.mapping).length+1;this.serializeBlankNode(s,h,v,k)}k=N(m[k].s,s[k].s)}return k};F.prototype.shallowCompareBlankNodes=function(a,c){var k=0,f=Object.keys(a),h=Object.keys(c),k=N(f.length,h.length);k===0&&(k=N(f.sort(),h.sort()));k===0&&(k=C(a,c));if(k===0)var j=this.edges.refs[a["@id"]].all,i=this.edges.refs[c["@id"]].all,k=N(j.length,i.length);if(k===0)for(f=0;f<j.length&&k===0;++f)k=this.compareEdges(j[f],i[f]);return k};F.prototype.compareEdges=
function(a,c){var k=0,f=B(a.s),h=B(c.s),j=this.ng.c14n;f!=h?k=f?1:-1:(f||(k=N(a.s,c.s)),k===0&&(k=N(a.p,c.p)),k===0&&j!==null&&(f=j.inNamespace(a.s),j=j.inNamespace(c.s),f!=j?k=f?1:-1:f&&(k=N(a.s,c.s))));return k};F.prototype.collectEdges=function(){var a=this.edges.refs,c=this.edges.props,k;for(k in this.subjects){var f=this.subjects[k],h;for(h in f)if(h!=="@id"){var j=f[h],j=j.constructor!==Array?[j]:j,i;for(i in j){var g=j[i];g.constructor===Object&&"@id"in g&&g["@id"]in this.subjects&&(g=g["@id"],
a[g].all.push({s:k,p:h}),c[k].all.push({s:g,p:h}))}}}var m=this;for(k in a)a[k].all.sort(function(a,c){return m.compareEdges(a,c)}),a[k].bnodes=a[k].all.filter(function(a){return B(a.s)});for(k in c)c[k].all.sort(function(a,c){return m.compareEdges(a,c)}),c[k].bnodes=c[k].all.filter(function(a){return B(a.s)})};var P=function(a,c){var k=!1;if(!("@type"in c)){var f=Object.keys(c).filter(function(a){return a.indexOf("@")!==0});if(f.length===0)k=!0;else if(a.constructor===Object&&"@id"in a){var k=!0,
h;for(h in f)if(!(f[h]in a)){k=!1;break}}}return k},T=function(a,c,k,f,h,j,i,g){var m=c["@id"],s=m in f?f[m]:null;if(("@embed"in k&&k["@embed"]||!("@embed"in k)&&g.defaults.embedOn)&&(s===null||s.autoembed&&!h)){if(s===null)s={},f[m]=s;else if(s.parent!==null){if(s.parent[s.key].constructor===Array){var v=s.parent[s.key],u;for(u in v)if(v[u].constructor===Object&&"@id"in v[u]&&v[u]["@id"]===m){v[u]={"@id":c["@id"]};break}}else s.parent[s.key]={"@id":c["@id"]};var x=function(a){var c=Object.keys(f),
k;for(k in c)k=c[k],k in f&&f[k].parent!==null&&f[k].parent["@id"]===a&&(delete f[k],x(k))};x(m)}s.autoembed=h;s.parent=j;s.key=i;if(k["@explicit"]===!0||g.defaults.explicitOn)for(z in c)z!=="@id"&&!(z in k)&&delete c[z];h=Object.keys(c);for(u in h){var z=h[u];if(z.indexOf("@")!==0){z in k?(j=k[z],i=!1):(j=c[z].constructor===Array?[]:{},i=!0);var m=c[z],m=m.constructor===Array?m:[m],F;for(F in m)m[F].constructor===Object&&"@id"in m[F]&&m[F]["@id"]in a&&(m[F]=a[m[F]["@id"]]);c[z]=aa(a,m,j,f,i,c,z,
g)}}for(z in k)if(z.indexOf("@")!==0&&(!(z in c)||c[z]===null))j=k[z],j.constructor===Array?c[z]=[]:(j.constructor===Array&&(j=j.length>0?j[0]:{}),j["@omitDefault"]===!0||g.defaults.omitDefaultOn||(c[z]="@default"in j?j["@default"]:null))}else c={"@id":c["@id"]};return c},aa=function(a,c,k,f,h,j,i,g){var m=null,s=-1,v;k.constructor===Array?(m=[],v=k,v.length===0&&v.push({})):(v=[k],s=1);for(var u=[],z=0;z<v.length&&s!==0;++z){k=v[z];if(k.constructor!==Object)throw{message:"Invalid JSON-LD frame. Frame must be an object or an array.",
frame:k};u[z]=[];for(var F=0;F<c.length&&s!==0;++F){var B=c[F],N=!1,E="@type";if("@type"in k&&B.constructor===Object&&E in B)for(var D=B[E].constructor===Array?B[E]:[B[E]],G=k[E].constructor===Array?k[E]:[k[E]],C=0;C<G.length&&!N;++C){var E=G[C],wb;for(wb in D)if(D[wb]===E){N=!0;break}}if(N||P(B,k))u[z].push(B),--s}}for(var K in u)for(var zc in u[K])k=v[K],c=u[K][zc],x(c)&&(c=T(a,c,k,f,h,j,i,g)),m===null?m=c:(k=c!==null&&c.constructor===Object&&"@id"in c&&Object.keys(c).length===1&&c["@id"]in f,j===
null&&k||m.push(c));return m};F.prototype.frame=function(a,k,f){var a=c.normalize(a),h=null;if("@context"in k)h=i(k["@context"]),k=c.expand(k);else if(k.constructor===Array){k.length>0&&"@context"in k[0]&&(h=i(k[0]["@context"]));var f=[],j;for(j in k)f.push(c.expand(k[j]));k=f}var f={defaults:{embedOn:!0,explicitOn:!1,omitDefaultOn:!1}},g={};for(j in a)g[a[j]["@id"]]=a[j];a=aa(g,a,k,{},!1,null,null,f);h!==null&&a!==null&&(a=c.compact(h,a));return a}})();var xa={parser:{}};xa.parser.parse=function(a,
c){typeof a==="string"&&(a=JSON.parse(a));return va.toTriples(a,c)};var Z={RDFLoader:function(a){this.precedences=["text/turtle","text/n3","application/json"];this.parsers={"text/turtle":ba.parser,"text/n3":ba.parser,"application/json":xa.parser};if(a!=null)for(var c in a.parsers)this.parsers[c]=a.parsers[c];if(a&&a.precedences!=null)for(c in this.precedences=a.precedences,a.parsers)z.include(this.precedences,c)||this.precedences.push(c);this.acceptHeaderValue="";for(a=0;a<this.precedences.length;a++)a!=
0?this.acceptHeaderValue=this.acceptHeaderValue+","+this.precedences[a]:this.acceptHeaderValue+=this.precedences[a]}};Z.RDFLoader.prototype.registerParser=function(a,c){this.parsers[a]=c;this.precedences.push(a)};Z.RDFLoader.prototype.unregisterParser=function(a){delete this.parsers[a];for(var c=[],f=0;f<this.precedences.length;f++)this.precedences[f]!=a&&c.push(this.precedences[f]);this.precedences=c};Z.RDFLoader.prototype.setAcceptHeaderPrecedence=function(a){this.precedences=a};Z.RDFLoader.prototype.load=
function(a,c,f){var h=this;P.load(a,this.acceptHeaderValue,function(j,k){if(j==!0){var i=k.headers["Content-Type"]||k.headers["content-type"],g=k.data;if(i!=null){var i=i.split(";")[0],s;for(s in h.parsers)if(s.indexOf("/")!=-1){var v=s.split("/");if(v[1]==="*"){if(i.indexOf(v[0])!=-1)return h.tryToParse(h.parsers[s],c,g,f)}else if(i.indexOf(s)!=-1)return h.tryToParse(h.parsers[s],c,g,f);else if(i.indexOf(v[1])!=-1)return h.tryToParse(h.parsers[s],c,g,f)}else if(i.indexOf(s)!=-1)return h.tryToParse(h.parsers[s],
a,c,f);f(!1,"Unknown media type : "+i)}else console.log("Unknown media type"),console.log(k.headers),f(!1,"Uknown media type")}else f(!1,"Network error: "+k)})};Z.RDFLoader.prototype.loadFromFile=function(a,c,f,h){try{var j=this;fs=require("fs");fs.readFile(f.split("file:/")[1],function(k,f){if(k)throw k;f=f.toString("utf8");j.tryToParse(a,c,f,h)})}catch(k){h(!1,k)}};Z.RDFLoader.prototype.tryToParse=function(a,c,f,h){try{typeof f==="string"&&(f=z.normalizeUnicodeLiterals(f));var j=a.parse(f,c);j!=
null?h(!0,j):h(!1,"parsing error")}catch(k){console.log(k.message),console.log(k.stack),h(!1,"parsing error with mime type : "+k)}};var J={AbstractQueryTree:function(){}};J.AbstractQueryTree.prototype.parseQueryString=function(a){return ia.parser.parse(a)};J.AbstractQueryTree.prototype.parseExecutableUnit=function(a){if(a.kind==="select")return this.parseSelect(a);else if(a.kind==="ask")return this.parseSelect(a);else if(a.kind==="modify")return this.parseSelect(a);else if(a.kind==="construct")return this.parseSelect(a);
else if(a.kind==="insertdata")return this.parseInsertData(a);else if(a.kind==="deletedata")return this.parseInsertData(a);else if(a.kind==="load")return a;else if(a.kind==="clear")return a;else if(a.kind==="drop")return a;else if(a.kind==="create")return a;else throw Error("unknown executable unit: "+a.kind);};J.AbstractQueryTree.prototype.parseSelect=function(a){return a==null?(console.log("error parsing query"),null):(a.pattern=this.build(a.pattern,{freshCounter:0}),a)};J.AbstractQueryTree.prototype.parseInsertData=
function(a){return a==null?(console.log("error parsing query"),null):a};J.AbstractQueryTree.prototype.build=function(a,c){if(a.token==="groupgraphpattern")return this._buildGroupGraphPattern(a,c);else if(a.token==="basicgraphpattern"){var f={kind:"BGP",value:a.triplesContext};return f=J.translatePathExpressionsInBGP(f,c)}else if(a.token==="graphunionpattern"){var f=this.build(a.value[0],c),h=this.build(a.value[1],c);return{kind:"UNION",value:[f,h]}}else if(a.token==="graphgraphpattern")return{kind:"GRAPH",
value:this.build(a.value,c),graph:a.graph};else throw Error("not supported token in query:"+a.token);};J.translatePathExpressionsInBGP=function(a,c){var f,h=[],j,k;for(k=0;k<a.value.length;k++)if(a.value[k].predicate&&a.value[k].predicate.token==="path"){f=a.value[k];j=a.value.slice(k+1);var i=J.translatePathExpression(f,c);f=null;if(i.kind==="BGP")h=h.concat(i.value);else if(i.kind==="ZERO_OR_MORE_PATH"||i.kind==="ONE_OR_MORE_PATH"){k=h.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:h},rvalue:i}:
i;if(i.kind==="ZERO_OR_MORE_PATH")if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0&&i.x.token==="var"&&i.x.value.indexOf("fresh:")===0)for(var g=0;g<a.value.length;g++){if(a.value[g].object&&a.value[g].object.token==="var"&&a.value[g].object.value===i.x.value)f=z.clone(a.value[g]),f.object=i.y}else if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0)for(g=0;g<a.value.length;g++)if(a.value[g].subject&&a.value[g].subject.token==="var"&&a.value[g].subject.value===i.y.value)f=z.clone(a.value[g]),
f.subject=i.x;return j.length>0?(i=J.translatePathExpressionsInBGP({kind:"BGP",value:j},c),f!=null?(h=h.concat([f]).concat(j),{kind:"UNION",value:[{kind:"JOIN",lvalue:k,rvalue:i},{kind:"BGP",value:h}]}):{kind:"JOIN",lvalue:k,rvalue:i}):k}else return i}else h.push(a.value[k]);a.value=h;return a};J.translatePathExpression=function(a,c){if(a.predicate.kind==="element")if(a.predicate.modifier==="+"){a.predicate.modifier=null;var f=J.translatePathExpression(a,c);return{kind:"ONE_OR_MORE_PATH",path:f,x:a.subject,
y:a.object}}else return a.predicate.modifier==="*"?(a.predicate.modifier=null,f=J.translatePathExpression(a,c),{kind:"ZERO_OR_MORE_PATH",path:f,x:a.subject,y:a.object}):(a.predicate=a.predicate.value,{kind:"BGP",value:[a]});else if(a.predicate.kind==="sequence"){for(var f=a.subject,h=a.object,j=a.graph,k,i,g=[],s=0;s<a.predicate.value.length;s++){s!=a.predicate.value.length-1?(k={token:"var",value:"fresh:"+c.freshCounter},c.freshCounter++):k=h;i={subject:f,predicate:a.predicate.value[s],object:k};
if(j!=null)i.graph=z.clone(j);g.push(i);s!=a.predicate.value.length-1&&(f=z.clone(k))}return J.translatePathExpressionsInBGP({kind:"BGP",value:g},c)}};J.AbstractQueryTree.prototype._buildGroupGraphPattern=function(a,c){for(var f=a.filters||[],h={kind:"EMPTY_PATTERN"},j=0;j<a.patterns.length;j++){var k=a.patterns[j];k.token==="optionalgraphpattern"?(k=this.build(k.value,c),h=k.kind==="FILTER"?{kind:"LEFT_JOIN",lvalue:h,rvalue:k.value,filter:k.filter}:{kind:"LEFT_JOIN",lvalue:h,rvalue:k,filter:!0}):
(k=this.build(k,c),h=h.kind=="EMPTY_PATTERN"?k:{kind:"JOIN",lvalue:h,rvalue:k})}if(f.length!=0)if(h.kind==="EMPTY_PATTERN")return{kind:"FILTER",filter:f,value:h};else if(h.kind==="LEFT_JOIN"&&h.filter===!0)return{kind:"FILTER",filter:f,value:h};else if(h.kind==="LEFT_JOIN")return{kind:"FILTER",filter:f,value:h};else if(h.kind==="JOIN")return{kind:"FILTER",filter:f,value:h};else if(h.kind==="UNION")return{kind:"FILTER",filter:f,value:h};else if(h.kind==="GRAPH")return{kind:"FILTER",filter:f,value:h};
else if(h.kind==="BGP")return{kind:"FILTER",filter:f,value:h};else throw Error("Unknow kind of algebra expression: "+h.kind);else return h};J.AbstractQueryTree.prototype.collectBasicTriples=function(a,c){c==null&&(c=[]);if(a.kind==="select")c=this.collectBasicTriples(a.pattern,c);else if(a.kind==="BGP")c=c.concat(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")c=this.collectBasicTriples(a.path);else if(a.kind==="UNION")c=this.collectBasicTriples(a.value[0],c),c=this.collectBasicTriples(a.value[1],c);
else if(a.kind==="GRAPH")c=this.collectBasicTriples(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")c=this.collectBasicTriples(a.lvalue,c),c=this.collectBasicTriples(a.rvalue,c);else if(a.kind==="FILTER")c=this.collectBasicTriples(a.value,c);else if(a.kind==="construct")c=this.collectBasicTriples(a.pattern,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return c};J.AbstractQueryTree.prototype.bind=function(a,c){if(a.graph!=null&&a.graph.token&&a.graph.token==="var"&&c[a.graph.value]!=
null)a.graph=c[a.graph.value];if(a.filter!=null){for(var f=[],h=0;h<a.filter.length;h++)a.filter[h].value=this._bindFilter(a.filter[h].value,c),f.push(a.filter[h]);a.filter=f}if(a.kind==="select")a.pattern=this.bind(a.pattern,c);else if(a.kind==="BGP")a.value=this._bindTripleContext(a.value,c);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._bindTripleContext(a.path,c);if(a.x&&a.x.token==="var"&&c[a.x.value]!=null)a.x=c[a.x.value];if(a.y&&a.y.token==="var"&&c[a.y.value]!=null)a.y=c[a.y.value]}else if(a.kind===
"UNION")a.value[0]=this.bind(a.value[0],c),a.value[1]=this.bind(a.value[1],c);else if(a.kind==="GRAPH")a.value=this.bind(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.bind(a.lvalue,c),a.rvalue=this.bind(a.rvalue,c);else if(a.kind==="FILTER")a.filter=this._bindFilter(a.filter[h].value,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};J.AbstractQueryTree.prototype._bindTripleContext=function(a,c){for(var f=0;f<a.length;f++){delete a[f].graph;delete a[f].variables;
for(var h in a[f]){var j=a[f][h];j.token==="var"&&c[j.value]!=null&&(a[f][h]=c[j.value])}}return a};J.AbstractQueryTree.prototype._bindFilter=function(a,c){if(a.expressionType!=null){var f=a.expressionType;if(f=="relationalexpression")a.op1=this._bindFilter(a.op1,c),a.op2=this._bindFilter(a.op2,c);else if(f=="conditionalor"||f=="conditionaland")for(f=0;f<a.operands.length;f++)a.operands[f]=this._bindFilter(a.operands[f],c);else if(f=="additiveexpression"){a.summand=this._bindFilter(a.summand,c);for(f=
0;f<a.summands.length;f++)a.summands[f].expression=this._bindFilter(a.summands[f].expression,c)}else if(f=="builtincall")for(f=0;f<a.args.length;f++)a.args[f]=this._bindFilter(a.args[f],c);else if(f=="multiplicativeexpression"){a.factor=this._bindFilter(a.factor,c);for(f=0;f<a.factors.length;f++)a.factors[f].expression=this._bindFilter(a.factors[f].expression,c)}else if(f=="unaryexpression")a.expression=this._bindFilter(a.expression,c);else if(f=="irireforfunction")for(f=0;f<a.factors.args;f++)a.args[f]=
this._bindFilter(a.args[f],c);else if(f=="atomic"&&a.primaryexpression=="var"&&c[a.value.value]!=null)f=c[a.value.value],a.primaryexpression=f.token==="uri"?"iri":"literal",a.value=f}return a};J.AbstractQueryTree.prototype.replace=function(a,c,f,h){if(a.graph!=null&&a.graph.token&&a.graph.token===c.token&&a.graph.value==c.value)a.graph=z.clone(f);if(a.filter!=null){for(var j=[],k=0;k<a.filter.length;k++)a.filter[k].value=this._replaceFilter(a.filter[k].value,c,f,h),j.push(a.filter[k]);a.filter=j}if(a.kind===
"select")a.pattern=this.replace(a.pattern,c,f,h);else if(a.kind==="BGP")a.value=this._replaceTripleContext(a.value,c,f,h);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._replaceTripleContext(a.path,c,f,h);if(a.x&&a.x.token===c.token&&a.value===c.value)a.x=z.clone(f);if(a.y&&a.y.token===c.token&&a.value===c.value)a.y=z.clone(f)}else if(a.kind==="UNION")a.value[0]=this.replace(a.value[0],c,f,h),a.value[1]=this.replace(a.value[1],c,f,h);else if(a.kind==="GRAPH")a.value=this.replace(a.value,c,f);else if(a.kind===
"LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.replace(a.lvalue,c,f,h),a.rvalue=this.replace(a.rvalue,c,f,h);else if(a.kind==="FILTER")a.value=this._replaceFilter(a.value,c,f,h);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};J.AbstractQueryTree.prototype._replaceTripleContext=function(a,c,f,h){for(var j=0;j<a.length;j++)for(var k in a[j]){var i=a[j][k];if(i.token==="var"&&c.token==="var"&&i.value===c.value)a[j][k]=f;else if(i.token==="blank"&&c.token==="blank"&&i.value===c.value)a[j][k]=
f;else if((i.token==="literal"||i.token==="uri")&&(c.token==="literal"||c.token==="uri")&&i.token===c.token&&z.lexicalFormTerm(i,h)[i.token]===z.lexicalFormTerm(c,h)[i.token])a[j][k]=f}return a};J.AbstractQueryTree.prototype._replaceFilter=function(a,c,f,h){if(a.expressionType!=null){var j=a.expressionType;if(j=="relationalexpression")a.op1=this._replaceFilter(a.op1,c,f,h),a.op2=this._replaceFilter(a.op2,c,f,h);else if(j=="conditionalor"||j=="conditionaland")for(j=0;j<a.operands.length;j++)a.operands[j]=
this._replaceFilter(a.operands[j],c,f,h);else if(j=="additiveexpression"){a.summand=this._replaceFilter(a.summand,c,f,h);for(j=0;j<a.summands.length;j++)a.summands[j].expression=this._replaceFilter(a.summands[j].expression,c,f,h)}else if(j=="builtincall")for(j=0;j<a.args.length;j++)a.args[j]=this._replaceFilter(a.args[j],c,f,h);else if(j=="multiplicativeexpression"){a.factor=this._replaceFilter(a.factor,c,f,h);for(j=0;j<a.factors.length;j++)a.factors[j].expression=this._replaceFilter(a.factors[j].expression,
c,f,h)}else if(j=="unaryexpression")a.expression=this._replaceFilter(a.expression,c,f,h);else if(j=="irireforfunction")for(j=0;j<a.factors.args;j++)a.args[j]=this._replaceFilter(a.args[j],c,f,h);else if(j=="atomic"){h=null;if(a.primaryexpression==c.token&&a.value==c.value)h=f.value;else if(a.primaryexpression=="iri"&&c.token=="uri"&&a.value==c.value)h=f.value;if(h!=null)a.primaryexpression=f.token==="uri"?"iri":f.token,a.value=h}}return a};J.AbstractQueryTree.prototype.treeWithUnion=function(a){if(a==
null)return!1;if(a.kind==null)return!1;if(a.kind==="select")return this.treeWithUnion(a.pattern);else if(a.kind==="BGP")return this.treeWithUnion(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")return!1;else if(a.kind==="UNION")if(console.log("UNION!!"),a.value[0].value!=null&&a.value[0].value.variables!=null&&a.value[1].value!=null&&a.value[1].value.variables!=null){if(console.log("COMPARING:"+a.value[0].variables.join("/")),console.log("VS "+a.values[1].variables.join("/")),a.value[0].variables.join("/")===
a.values[1].variables.join("/"))return this.treeWithUnion(a.value[0])?!0:this.treeWithUnion(a.value[1])}else return!0;else if(a.kind==="GRAPH")return!1;else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")if(this.treeWithUnion(a.lvalue))return!0;else this.treeWithUnion(a.rvalue);else return!1};var ia={};ia.parser=function(){var a={parse:function(a,f){function h(a){var b=a.charCodeAt(0);if(b<=255)var a="x",c=2;else a="u",c=4;var a="\\"+a,d=b.toString(16).toUpperCase(),b=d;c-=d.length;for(d=0;d<c;d++)b="0"+
b;return a+b}function j(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,h)+'"'}function k(a){b<ya||(b>ya&&(ya=b,$a=[]),$a.push(a))}function i(){var a="SPARQL@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=g();c===null&&(c=Ya(),c=c!==null?c:null);y[a]={nextPos:b,result:c};return c}function g(){var a="Query@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=s();if(e!==null){var h=D();h===null&&(h=K(),h===null&&
(h=L(),h===null&&(h=J(),h=h!==null?h:null)));h!==null?e=[e,h]:(e=null,b=d)}else e=null,b=d;d=e!==null?{token:"query",kind:"query",prologue:e[0],units:[e[1]]}:null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[2] Query");y[a]={nextPos:b,result:d};return d}function s(){var a="Prologue@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=v(),e=e!==null?e:"";if(e!==null){for(var h=[],r=q();r!==null;)h.push(r),r=q();if(h!==null){for(var r=[],w=u();w!==null;)r.push(w),w=u();r!==null?e=[e,h,
r]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?{token:"prologue",base:e[0],prefixes:e[2]}:null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[3] Prologue");y[a]={nextPos:b,result:d};return d}function v(){var f="BaseDecl@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var I=b,d=b,e=[],A=q();A!==null;)e.push(A),A=q();if(e!==null)if(a.substr(b,4)==="BASE"?(A="BASE",b+=4):(A=null,n&&k('"BASE"')),A===null&&(a.substr(b,4)==="base"?(A="base",b+=4):(A=null,n&&k('"base"')),A=A!==null?A:null),
A!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();r!==null?(w=na(),w!==null?e=[e,A,r,w]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?function(a){base={token:"base"};base.value=a;return base}(e[3]):null;d===null&&(d=null,b=I);(n=h)&&d===null&&k("[4] BaseDecl");y[f]={nextPos:b,result:d};return d}function u(){var f="PrefixDecl@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var I=b,d=b,e=[],A=q();A!==null;)e.push(A),A=q();if(e!==null)if(a.substr(b,6)==="PREFIX"?
(A="PREFIX",b+=6):(A=null,n&&k('"PREFIX"')),A===null&&(a.substr(b,6)==="prefix"?(A="prefix",b+=6):(A=null,n&&k('"prefix"')),A=A!==null?A:null),A!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=Ea(),w!==null){for(var o=[],j=q();j!==null;)o.push(j),j=q();o!==null?(j=na(),j!==null?e=[e,A,r,w,o,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){prefix={token:"prefix"};prefix.prefix=a;prefix.local=b;return prefix}(e[3],
e[5]):null;d===null&&(d=null,b=I);(n=h)&&d===null&&k("[5] PrefixDecl");y[f]={nextPos:b,result:d};return d}function x(){var a="TURTLE@"+b,c=y[a];if(c)return b=c.nextPos,c.result;for(var c=b,k=[],d=z();d!==null;)k.push(d),d=z();k=k!==null?k:null;k===null&&(k=null,b=c);y[a]={nextPos:b,result:k};return k}function z(){var f="statement@"+b,h=y[f];if(h)return b=h.nextPos,h.result;for(var I=h=b,d=[],e=q();e!==null;)d.push(e),e=q();if(d!==null)if(e=B(),e!==null){for(var A=[],r=q();r!==null;)A.push(r),r=q();
if(A!==null)if(a.substr(b,1)==="."?(r=".",b+=1):(r=null,n&&k('"."')),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?d=[d,e,A,r,w]:(d=null,b=I)}else d=null,b=I;else d=null,b=I}else d=null,b=I;else d=null,b=I;I=d!==null?d[1]:null;I===null&&(I=null,b=h);if(I!==null)h=I;else{I=h=b;d=[];for(e=q();e!==null;)d.push(e),e=q();if(d!==null)if(e=oa(),e!==null){A=[];for(r=q();r!==null;)A.push(r),r=q();A!==null?d=[d,e,A]:(d=null,b=I)}else d=null,b=I;else d=null,b=I;I=d!==null?d[1]:null;I===null&&
(I=null,b=h);if(I!==null)h=I;else{h=q();if(h!==null)for(I=[];h!==null;)I.push(h),h=q();else I=null;h=I!==null?I:null}}y[f]={nextPos:b,result:h};return h}function B(){var a="directive@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=N();c===null&&(c=E(),c=c!==null?c:null);y[a]={nextPos:b,result:c};return c}function E(){var f="base@"+b,h=y[f];if(h)return b=h.nextPos,h.result;for(var I=h=b,d=[],e=q();e!==null;)d.push(e),e=q();if(d!==null)if(a.substr(b,5)==="@base"?(e="@base",b+=5):(e=null,n&&k('"@base"')),
e!==null){var A=q();if(A!==null)for(var r=[];A!==null;)r.push(A),A=q();else r=null;r!==null?(A=na(),A!==null?d=[d,e,r,A]:(d=null,b=I)):(d=null,b=I)}else d=null,b=I;else d=null,b=I;I=d!==null?function(a){base={token:"base"};base.value=a;return base}(d[3]):null;I===null&&(I=null,b=h);y[f]={nextPos:b,result:I};return I}function N(){var f="prefixID@"+b,h=y[f];if(h)return b=h.nextPos,h.result;for(var I=h=b,d=[],e=q();e!==null;)d.push(e),e=q();if(d!==null)if(a.substr(b,7)==="@prefix"?(e="@prefix",b+=7):
(e=null,n&&k('"@prefix"')),e!==null){var A=q();if(A!==null)for(var r=[];A!==null;)r.push(A),A=q();else r=null;if(r!==null)if(A=ab(),A=A!==null?A:"",A!==null){if(a.substr(b,1)===":"){var w=":";b+=1}else w=null,n&&k('":"');if(w!==null){for(var o=[],j=q();j!==null;)o.push(j),j=q();o!==null?(j=na(),j!==null?d=[d,e,r,A,w,o,j]:(d=null,b=I)):(d=null,b=I)}else d=null,b=I}else d=null,b=I;else d=null,b=I}else d=null,b=I;else d=null,b=I;I=d!==null?function(a,b){prefix={token:"prefix"};prefix.prefix=a;prefix.local=
b;return prefix}(d[3],d[6]):null;I===null&&(I=null,b=h);y[f]={nextPos:b,result:I};return I}function D(){var a="SelectQuery@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=G();if(e!==null){for(var h=[],r=q();r!==null;)h.push(r),r=q();if(h!==null){for(var r=[],w=H();w!==null;)r.push(w),w=H();if(r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();if(w!==null)if(o=aa(),o!==null){for(var j=[],i=q();i!==null;)j.push(i),i=q();if(j!==null)if(i=V(),i!==null){for(var g=[],m=q();m!==null;)g.push(m),
m=q();g!==null?(m=xa(),m!==null?e=[e,h,r,w,o,j,i,g,m]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,e,d){for(var c={named:[],"default":[]},k=0;k<b.length;k++){var f=b[k];f.kind==="default"?c["default"].push(f.graph):c.named.push(f.graph)}c.named.length===0&&c["default"].length===0&&c["default"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});
b={kind:"select",token:"executableunit"};b.dataset=c;b.projection=a.vars;b.modifier=a.modifier;b.pattern=e;if(d!=null&&d.limit!=null)b.limit=d.limit;if(d!=null&&d.offset!=null)b.offset=d.offset;if(d!=null&&d.order!=null&&d.order!="")b.order=d.order;if(d!=null&&d.group!=null)b.group=d.group;return b}(e[0],e[2],e[4],e[6]):null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[6] SelectQuery");y[a]={nextPos:b,result:d};return d}function C(){var a="SubSelect@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;
n=!1;var f=b,d=G();if(d!==null){var e=aa();if(e!==null){var h=V();h!==null?d=[d,e,h]:(d=null,b=f)}else d=null,b=f}else d=null,b=f;(n=c)&&d===null&&k("[7] SubSelect");y[a]={nextPos:b,result:d};return d}function G(){var f="SelectClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var I=b,d=b,e=[],A=q();A!==null;)e.push(A),A=q();if(e!==null)if(a.substr(b,6)==="SELECT"?(A="SELECT",b+=6):(A=null,n&&k('"SELECT"')),A===null&&(a.substr(b,6)==="select"?(A="select",b+=6):(A=null,n&&k('"select"')),
A=A!==null?A:null),A!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(a.substr(b,8)==="DISTINCT"?(w="DISTINCT",b+=8):(w=null,n&&k('"DISTINCT"')),w===null&&(a.substr(b,8)==="distinct"?(w="distinct",b+=8):(w=null,n&&k('"distinct"')),w=w!==null?w:null),w===null&&(a.substr(b,7)==="REDUCED"?(w="REDUCED",b+=7):(w=null,n&&k('"REDUCED"')),w===null&&(a.substr(b,7)==="reduced"?(w="reduced",b+=7):(w=null,n&&k('"reduced"')),w=w!==null?w:null),w=w!==null?w:null),w=w!==null?w:"",w!==null){for(var o=
[],j=q();j!==null;)o.push(j),j=q();if(o!==null){for(var i=b,g=[],m=q();m!==null;)g.push(m),m=q();if(g!==null)if(m=Q(),m!==null){for(var s=[],v=q();v!==null;)s.push(v),v=q();s!==null?g=[g,m,s]:(g=null,b=i)}else g=null,b=i;else g=null,b=i;if(g!==null)i=g;else{i=b;g=[];for(m=q();m!==null;)g.push(m),m=q();if(g!==null)if(a.substr(b,1)==="("?(m="(",b+=1):(m=null,n&&k('"("')),m!==null){s=[];for(v=q();v!==null;)s.push(v),v=q();if(s!==null)if(v=M(),v!==null){for(var u=[],x=q();x!==null;)u.push(x),x=q();if(u!==
null)if(a.substr(b,2)==="AS"?(x="AS",b+=2):(x=null,n&&k('"AS"')),x===null&&(a.substr(b,2)==="as"?(x="as",b+=2):(x=null,n&&k('"as"')),x=x!==null?x:null),x!==null){for(var z=[],F=q();F!==null;)z.push(F),F=q();if(z!==null)if(F=Q(),F!==null){for(var ja=[],S=q();S!==null;)ja.push(S),S=q();if(ja!==null)if(a.substr(b,1)===")"?(S=")",b+=1):(S=null,n&&k('")"')),S!==null){for(var B=[],O=q();O!==null;)B.push(O),O=q();B!==null?g=[g,m,s,v,u,x,z,F,ja,S,B]:(g=null,b=i)}else g=null,b=i;else g=null,b=i}else g=null,
b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i;i=g!==null?g:null}if(i!==null)for(j=[];i!==null;){j.push(i);i=b;g=[];for(m=q();m!==null;)g.push(m),m=q();if(g!==null)if(m=Q(),m!==null){s=[];for(v=q();v!==null;)s.push(v),v=q();s!==null?g=[g,m,s]:(g=null,b=i)}else g=null,b=i;else g=null,b=i;if(g!==null)i=g;else{i=b;g=[];for(m=q();m!==null;)g.push(m),m=q();if(g!==null)if(a.substr(b,1)==="("?(m="(",b+=1):(m=null,n&&k('"("')),m!==null){s=
[];for(v=q();v!==null;)s.push(v),v=q();if(s!==null)if(v=M(),v!==null){u=[];for(x=q();x!==null;)u.push(x),x=q();if(u!==null)if(a.substr(b,2)==="AS"?(x="AS",b+=2):(x=null,n&&k('"AS"')),x===null&&(a.substr(b,2)==="as"?(x="as",b+=2):(x=null,n&&k('"as"')),x=x!==null?x:null),x!==null){z=[];for(F=q();F!==null;)z.push(F),F=q();if(z!==null)if(F=Q(),F!==null){ja=[];for(S=q();S!==null;)ja.push(S),S=q();if(ja!==null)if(a.substr(b,1)===")"?(S=")",b+=1):(S=null,n&&k('")"')),S!==null){B=[];for(O=q();O!==null;)B.push(O),
O=q();B!==null?g=[g,m,s,v,u,x,z,F,ja,S,B]:(g=null,b=i)}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i;i=g!==null?g:null}}else j=null;if(j===null){j=b;i=[];for(g=q();g!==null;)i.push(g),g=q();if(i!==null)if(a.substr(b,1)==="*"?(g="*",b+=1):(g=null,n&&k('"*"')),g!==null){m=[];for(s=q();s!==null;)m.push(s),s=q();m!==null?i=[i,g,m]:(i=null,b=j)}else i=null,b=j;else i=null,b=j;j=i!==null?i:
null}j!==null?e=[e,A,r,w,o,j]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){var e=[];if(b.length===3&&b[1]==="*")return{vars:[{token:"variable",kind:"*"}],modifier:Fb(a)};for(var d=0;d<b.length;d++){var c=b[d];c.length===3?e.push({token:"variable",kind:"var",value:c[1]}):e.push({token:"variable",kind:"aliased",expression:c[3],alias:c[7]})}return{vars:e,modifier:Fb(a)}}(e[3],e[5]):null;d===null&&(d=null,b=I);(n=h)&&d===null&&k("[8] SelectClause");
y[f]={nextPos:b,result:d};return d}function K(){var f="ConstructQuery@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var I=b,d=b,e=[],A=q();A!==null;)e.push(A),A=q();if(e!==null)if(a.substr(b,9)==="CONSTRUCT"?(A="CONSTRUCT",b+=9):(A=null,n&&k('"CONSTRUCT"')),A===null&&(a.substr(b,9)==="construct"?(A="construct",b+=9):(A=null,n&&k('"construct"')),A=A!==null?A:null),A!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=Gb(),w!==null){for(var o=[],j=q();j!==null;)o.push(j),
j=q();if(o!==null){for(var j=[],i=H();i!==null;)j.push(i),i=H();if(j!==null){for(var i=[],g=q();g!==null;)i.push(g),g=q();if(i!==null)if(g=aa(),g!==null){for(var m=[],s=q();s!==null;)m.push(s),s=q();m!==null?(s=V(),s!==null?e=[e,A,r,w,o,j,i,g,m,s]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b,e,d){for(var c={named:[],"default":[]},k=0;k<b.length;k++){var f=b[k];f.kind===
"default"?c["default"].push(f.graph):c.named.push(f.graph)}c.named.length===0&&c["default"].length===0&&c["default"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});b={kind:"construct",token:"executableunit"};b.dataset=c;b.template=a;b.pattern=e;if(d!=null&&d.limit!=null)b.limit=d.limit;if(d!=null&&d.offset!=null)b.offset=d.offset;if(d!=null&&d.order!=null&&d.order!="")b.order=d.order;return b}(e[3],e[5],e[7],e[9]):null;d===null&&(d=
null,b=I);(n=h)&&d===null&&k("[9] ConstructQuery");y[f]={nextPos:b,result:d};return d}function L(){var f="DescribeQuery@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b;if(a.substr(b,8)==="DESCRIBE"){var d="DESCRIBE";b+=8}else d=null,n&&k('"DESCRIBE"');if(d!==null){var e=ka();if(e!==null)for(var A=[];e!==null;)A.push(e),e=ka();else A=null;A!==null?e=A:(a.substr(b,1)==="*"?(e="*",b+=1):(e=null,n&&k('"*"')),e=e!==null?e:null);if(e!==null){for(var A=[],r=H();r!==null;)A.push(r),r=H();if(A!==
null)if(r=aa(),r=r!==null?r:"",r!==null){var w=V();w!==null?d=[d,e,A,r,w]:(d=null,b=j)}else d=null,b=j;else d=null,b=j}else d=null,b=j}else d=null,b=j;(n=h)&&d===null&&k("[10] DescribeQuery");y[f]={nextPos:b,result:d};return d}function J(){var f="AskQuery@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var j=b,d=b,e=[],A=q();A!==null;)e.push(A),A=q();if(e!==null)if(a.substr(b,3)==="ASK"?(A="ASK",b+=3):(A=null,n&&k('"ASK"')),A===null&&(a.substr(b,3)==="ask"?(A="ask",b+=3):(A=null,n&&k('"ask"')),
A=A!==null?A:null),A!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null){for(var w=[],o=H();o!==null;)w.push(o),o=H();if(w!==null){for(var o=[],i=q();i!==null;)o.push(i),i=q();o!==null?(i=aa(),i!==null?e=[e,A,r,w,o,i]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d}else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){for(var e={named:[],"default":[]},d=0;d<a.length;d++){var c=a[d];c.kind==="default"?e["default"].push(c.graph):e.named.push(c.graph)}e.named.length===0&&
e["default"].length===0&&e["default"].push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});d={kind:"ask",token:"executableunit"};d.dataset=e;d.pattern=b;return d}(e[3],e[5]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[11] AskQuery");y[f]={nextPos:b,result:d};return d}function H(){var f="DatasetClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,4)==="FROM"){var e="FROM";b+=4}else e=null,n&&k('"FROM"');
e===null&&(a.substr(b,4)==="from"?(e="from",b+=4):(e=null,n&&k('"from"')),e=e!==null?e:null);if(e!==null){for(var A=[],r=q();r!==null;)A.push(r),r=q();if(A!==null)if(r=P(),r===null&&(r=T(),r=r!==null?r:null),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?e=[e,A,r,w]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[12] DatasetClause");y[f]={nextPos:b,result:d};return d}function P(){var a="DefaultGraphClause@"+
b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;for(var f=b,d=b,e=[],h=q();h!==null;)e.push(h),h=q();e!==null?(h=R(),h!==null?e=[e,h]:(e=null,b=d)):(e=null,b=d);d=e!==null?{graph:e[1],kind:"default",token:"graphClause"}:null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[13] DefaultGraphClause");y[a]={nextPos:b,result:d};return d}function T(){var f="NamedGraphClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,5)==="NAMED"){var e="NAMED";b+=5}else e=null,n&&k('"NAMED"');
e===null&&(a.substr(b,5)==="named"?(e="named",b+=5):(e=null,n&&k('"named"')),e=e!==null?e:null);if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();i!==null?(r=R(),r!==null?e=[e,i,r]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?{graph:e[2],kind:"named",token:"graphCluase"}:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[14] NamedGraphClause");y[f]={nextPos:b,result:d};return d}function aa(){var f="WhereClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,
5)==="WHERE"){var e="WHERE";b+=5}else e=null,n&&k('"WHERE"');e===null&&(a.substr(b,5)==="where"?(e="where",b+=5):(e=null,n&&k('"where"')),e=e!==null?e:null);e=e!==null?e:"";if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=W(),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?e=[e,i,r,w]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[16] WhereClause");y[f]={nextPos:b,result:d};return d}
function V(){var a="SolutionModifier@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=Z(),e=e!==null?e:"";if(e!==null){var h=ba(),h=h!==null?h:"";if(h!==null){var r=ga(),r=r!==null?r:"";if(r!==null){var w=va(),w=w!==null?w:"";w!==null?e=[e,h,r,w]:(e=null,b=d)}else e=null,b=d}else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,e){var d={};if(e!=null){if(e.limit!=null)d.limit=e.limit;if(e.offset!=null)d.offset=e.offset}if(a!=null)d.group=a;d.order=b;return d}(e[0],e[2],e[3]):null;
d===null&&(d=null,b=f);(n=c)&&d===null&&k("[17] SolutionModifier");y[a]={nextPos:b,result:d};return d}function Z(){var f="GroupClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,5)==="GROUP"){var e="GROUP";b+=5}else e=null,n&&k('"GROUP"');e===null&&(a.substr(b,5)==="group"?(e="group",b+=5):(e=null,n&&k('"group"')),e=e!==null?e:null);if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(a.substr(b,2)==="BY"?(r="BY",b+=2):(r=null,n&&k('"BY"')),r===
null&&(a.substr(b,2)==="by"?(r="by",b+=2):(r=null,n&&k('"by"')),r=r!==null?r:null),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();if(w!==null){o=Y();if(o!==null)for(var g=[];o!==null;)g.push(o),o=Y();else g=null;g!==null?e=[e,i,r,w,g]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[4]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[18] GroupClause");y[f]={nextPos:b,result:d};return d}function Y(){var f="GroupCondition@"+b,h=y[f];if(h)return b=h.nextPos,
h.result;h=n;n=!1;for(var j=b,d=b,e=[],i=q();i!==null;)e.push(i),i=q();if(e!==null)if(i=Fa(),i!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();r!==null?e=[e,i,r]:(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=j);if(d!==null)j=d;else{d=j=b;e=[];for(i=q();i!==null;)e.push(i),i=q();if(e!==null)if(i=bb(),i!==null){r=[];for(w=q();w!==null;)r.push(w),w=q();r!==null?e=[e,i,r]:(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=
j);if(d!==null)j=d;else{d=j=b;e=[];for(i=q();i!==null;)e.push(i),i=q();if(e!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){r=[];for(w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=M(),w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();if(o!==null){g=b;if(a.substr(b,2)==="AS"){var t="AS";b+=2}else t=null,n&&k('"AS"');t===null&&(a.substr(b,2)==="as"?(t="as",b+=2):(t=null,n&&k('"as"')),t=t!==null?t:null);if(t!==null){for(var m=[],s=q();s!==null;)m.push(s),s=q();m!==null?
(s=Q(),s!==null?t=[t,m,s]:(t=null,b=g)):(t=null,b=g)}else t=null,b=g;g=t!==null?t:"";if(g!==null){t=[];for(m=q();m!==null;)t.push(m),m=q();if(t!==null)if(a.substr(b,1)===")"?(m=")",b+=1):(m=null,n&&k('")"')),m!==null){for(var s=[],v=q();v!==null;)s.push(v),v=q();s!==null?e=[e,i,r,w,o,g,t,m,s]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?e[5].length!=0?{token:"aliased_expression",expression:e[3],
alias:e[5][2]}:e[3]:null;d===null&&(d=null,b=j);if(d!==null)j=d;else{d=j=b;e=[];for(i=q();i!==null;)e.push(i),i=q();if(e!==null)if(i=Q(),i!==null){r=[];for(w=q();w!==null;)r.push(w),w=q();r!==null?e=[e,i,r]:(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=j);j=d!==null?d:null}}}(n=h)&&j===null&&k("[19] GroupCondition");y[f]={nextPos:b,result:j};return j}function ba(){var f="HavingClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b;if(a.substr(b,
6)==="HAVING"){var d="HAVING";b+=6}else d=null,n&&k('"HAVING"');if(d!==null){var e=za();if(e!==null)for(var i=[];e!==null;)i.push(e),e=za();else i=null;i!==null?d=[d,i]:(d=null,b=j)}else d=null,b=j;(n=h)&&d===null&&k("[20] HavingClause");y[f]={nextPos:b,result:d};return d}function ga(){var f="OrderClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,5)==="ORDER"){var e="ORDER";b+=5}else e=null,n&&k('"ORDER"');e===null&&(a.substr(b,5)==="order"?(e="order",b+=5):(e=
null,n&&k('"order"')),e=e!==null?e:null);if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(a.substr(b,2)==="BY"?(r="BY",b+=2):(r=null,n&&k('"BY"')),r===null&&(a.substr(b,2)==="by"?(r="by",b+=2):(r=null,n&&k('"by"')),r=r!==null?r:null),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();if(w!==null){var g=ia();if(g!==null)for(o=[];g!==null;)o.push(g),g=ia();else o=null;if(o!==null){for(var g=[],t=q();t!==null;)g.push(t),t=q();g!==null?e=[e,i,r,w,o,g]:(e=null,b=d)}else e=null,
b=d}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[4]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[22] OrderClause");y[f]={nextPos:b,result:d};return d}function ia(){var f="OrderCondition@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,3)==="ASC"){var e="ASC";b+=3}else e=null,n&&k('"ASC"');e===null&&(a.substr(b,3)==="asc"?(e="asc",b+=3):(e=null,n&&k('"asc"')),e===null&&(a.substr(b,4)==="DESC"?(e="DESC",b+=4):(e=null,n&&k('"DESC"')),
e===null&&(a.substr(b,4)==="desc"?(e="desc",b+=4):(e=null,n&&k('"desc"')),e=e!==null?e:null)));if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(r=Ga(),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?e=[e,j,r,w]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?{direction:e[0].toUpperCase(),expression:e[2]}:null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;e=za();e===null&&(e=Q(),e=e!==null?e:null);if(e!==null){j=[];for(r=q();r!==null;)j.push(r),
r=q();j!==null?e=[e,j]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.token==="var"&&(a={token:"expression",expressionType:"atomic",primaryexpression:"var",value:a});return{direction:"ASC",expression:a}}(e[0]):null;d===null&&(d=null,b=i);i=d!==null?d:null}(n=h)&&i===null&&k("[23] OrderCondition");y[f]={nextPos:b,result:i};return i}function va(){var a="LimitOffsetClauses@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=Wa();if(e!==null){var h=Xa(),h=h!==null?h:"";h!==null?
e=[e,h]:(e=null,b=d)}else e=null,b=d;e!==null?d=e:(d=b,e=Xa(),e!==null?(h=Wa(),h=h!==null?h:"",h!==null?e=[e,h]:(e=null,b=d)):(e=null,b=d),d=e!==null?e:null);d=d!==null?function(a){for(var b={},e=0;e<a.length;e++){var d=a[e];if(d.limit!=null)b.limit=d.limit;else if(d.offset!=null)b.offset=d.offset}return b}(d):null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[24] LimitOffsetClauses");y[a]={nextPos:b,result:d};return d}function Wa(){var f="LimitClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;
n=!1;var i=b,d=b;if(a.substr(b,5)==="LIMIT"){var e="LIMIT";b+=5}else e=null,n&&k('"LIMIT"');e===null&&(a.substr(b,5)==="limit"?(e="limit",b+=5):(e=null,n&&k('"limit"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(r=ca(),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?e=[e,j,r,w]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?{limit:parseInt(e[2].value)}:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[25] LimitClause");
y[f]={nextPos:b,result:d};return d}function Xa(){var f="OffsetClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,6)==="OFFSET"){var e="OFFSET";b+=6}else e=null,n&&k('"OFFSET"');e===null&&(a.substr(b,6)==="offset"?(e="offset",b+=6):(e=null,n&&k('"offset"')),e=e!==null?e:null);if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=ca(),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?e=[e,i,r,w]:(e=null,b=d)}else e=null,b=d;else e=
null,b=d}else e=null,b=d;d=e!==null?{offset:parseInt(e[2].value)}:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[26] OffsetClause");y[f]={nextPos:b,result:d};return d}function xa(){var f="BindingsClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b;if(a.substr(b,8)==="BINDINGS"){var d="BINDINGS";b+=8}else d=null,n&&k('"BINDINGS"');if(d!==null){for(var e=[],j=Q();j!==null;)e.push(j),j=Q();if(e!==null)if(a.substr(b,1)==="{"?(j="{",b+=1):(j=null,n&&k('"{"')),j!==null){var r=[],w=b;if(a.substr(b,
1)==="("){var o="(";b+=1}else o=null,n&&k('"("');if(o!==null){var g=wa();if(g!==null)for(var q=[];g!==null;)q.push(g),g=wa();else q=null;q!==null?(a.substr(b,1)===")"?(g=")",b+=1):(g=null,n&&k('")"')),g!==null?o=[o,q,g]:(o=null,b=w)):(o=null,b=w)}else o=null,b=w;o!==null?w=o:(w=la(),w=w!==null?w:null);for(;w!==null;){r.push(w);w=b;a.substr(b,1)==="("?(o="(",b+=1):(o=null,n&&k('"("'));if(o!==null){g=wa();if(g!==null)for(q=[];g!==null;)q.push(g),g=wa();else q=null;q!==null?(a.substr(b,1)===")"?(g=")",
b+=1):(g=null,n&&k('")"')),g!==null?o=[o,q,g]:(o=null,b=w)):(o=null,b=w)}else o=null,b=w;o!==null?w=o:(w=la(),w=w!==null?w:null)}r!==null?(a.substr(b,1)==="}"?(w="}",b+=1):(w=null,n&&k('"}"')),w!==null?d=[d,e,j,r,w]:(d=null,b=i)):(d=null,b=i)}else d=null,b=i;else d=null,b=i}else d=null,b=i;i=d!==null?d:"";(n=h)&&i===null&&k("[27] BindingsClause");y[f]={nextPos:b,result:i};return i}function wa(){var f="BindingValue@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=R();i===null&&(i=Ha(),i===
null&&(i=Ia(),i===null&&(i=Ja(),i===null&&(a.substr(b,5)==="UNDEF"?(i="UNDEF",b+=5):(i=null,n&&k('"UNDEF"')),i=i!==null?i:null))));(n=h)&&i===null&&k("[28] BindingValue");y[f]={nextPos:b,result:i};return i}function Ya(){var f="Update@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b,e=s();if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(r=ub(),r!==null){for(var w=b,o=[],g=q();g!==null;)o.push(g),g=q();if(o!==null)if(a.substr(b,1)===";"?(g=";",b+=1):(g=null,n&&
k('";"')),g!==null){for(var t=[],m=q();m!==null;)t.push(m),m=q();t!==null?(m=Ya(),m=m!==null?m:"",m!==null?o=[o,g,t,m]:(o=null,b=w)):(o=null,b=w)}else o=null,b=w;else o=null,b=w;w=o!==null?o:"";w!==null?e=[e,j,r,w]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,e){var d={token:"query",kind:"update"};d.prologue=a;a=[b];e.length!=null&&e[3]!=null&&e[3].units!=null&&(a=a.concat(e[3].units));d.units=a;return d}(e[0],e[2],e[3]):null;d===null&&(d=null,b=i);(n=h)&&d===
null&&k("[30] Update");y[f]={nextPos:b,result:d};return d}function ub(){var a="Update1@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=vb();f===null&&(f=zb(),f===null&&(f=Ab(),f===null&&(f=Bb(),f===null&&(f=Cb(),f===null&&(f=Db(),f===null&&(f=xb(),f===null&&(f=yb(),f=f!==null?f:null)))))));(n=c)&&f===null&&k("[31] Update1");y[a]={nextPos:b,result:f};return f}function vb(){var f="Load@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,4)==="LOAD"){var e="LOAD";
b+=4}else e=null,n&&k('"LOAD"');e===null&&(a.substr(b,4)==="load"?(e="load",b+=4):(e=null,n&&k('"load"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(r=R(),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();if(w!==null){o=b;if(a.substr(b,4)==="INTO"){var g="INTO";b+=4}else g=null,n&&k('"INTO"');g===null&&(a.substr(b,4)==="into"?(g="into",b+=4):(g=null,n&&k('"into"')),g=g!==null?g:null);if(g!==null){for(var t=[],m=q();m!==null;)t.push(m),m=q();t!==
null?(m=Ka(),m!==null?g=[g,t,m]:(g=null,b=o)):(g=null,b=o)}else g=null,b=o;o=g!==null?g:"";o!==null?e=[e,j,r,w,o]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){var e={kind:"load",token:"executableunit"};e.sourceGraph=a;e.destinyGraph=b[2];return e}(e[2],e[4]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[32] Load");y[f]={nextPos:b,result:d};return d}function zb(){var f="Clear@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=
b;if(a.substr(b,5)==="CLEAR"){var e="CLEAR";b+=5}else e=null,n&&k('"CLEAR"');e===null&&(a.substr(b,5)==="clear"?(e="clear",b+=5):(e=null,n&&k('"clear"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(a.substr(b,6)==="SILENT"?(r="SILENT",b+=6):(r=null,n&&k('"SILENT"')),r===null&&(a.substr(b,6)==="silent"?(r="silent",b+=6):(r=null,n&&k('"silent"')),r=r!==null?r:null),r=r!==null?r:"",r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?(o=cb(),
o!==null?e=[e,j,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={kind:"clear",token:"executableunit"};b.destinyGraph=a;return b}(e[4]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[33] Clear");y[f]={nextPos:b,result:d};return d}function Ab(){var f="Drop@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,4)==="DROP"){var e="DROP";b+=4}else e=null,n&&k('"DROP"');e===null&&(a.substr(b,4)==="drop"?(e="drop",
b+=4):(e=null,n&&k('"drop"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(a.substr(b,6)==="SILENT"?(r="SILENT",b+=6):(r=null,n&&k('"SILENT"')),r===null&&(a.substr(b,6)==="silent"?(r="silent",b+=6):(r=null,n&&k('"silent"')),r=r!==null?r:null),r=r!==null?r:"",r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?(o=cb(),o!==null?e=[e,j,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b=
{kind:"drop",token:"executableunit"};b.destinyGraph=a;return b}(e[4]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[34] Drop");y[f]={nextPos:b,result:d};return d}function Bb(){var f="Create@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,6)==="CREATE"){var e="CREATE";b+=6}else e=null,n&&k('"CREATE"');e===null&&(a.substr(b,6)==="create"?(e="create",b+=6):(e=null,n&&k('"create"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(a.substr(b,
6)==="SILENT"?(r="SILENT",b+=6):(r=null,n&&k('"SILENT"')),r===null&&(a.substr(b,6)==="silent"?(r="silent",b+=6):(r=null,n&&k('"silent"')),r=r!==null?r:null),r=r!==null?r:"",r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?(o=Ka(),o!==null?e=[e,j,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={kind:"create",token:"executableunit"};b.destinyGraph=a;return b}(e[4]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[35] Create");
y[f]={nextPos:b,result:d};return d}function Cb(){var f="InsertData@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,6)==="INSERT"){var e="INSERT";b+=6}else e=null,n&&k('"INSERT"');e===null&&(a.substr(b,6)==="insert"?(e="insert",b+=6):(e=null,n&&k('"insert"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(a.substr(b,4)==="DATA"?(r="DATA",b+=4):(r=null,n&&k('"DATA"')),r===null&&(a.substr(b,4)==="data"?(r="data",b+=4):(r=null,
n&&k('"data"')),r=r!==null?r:null),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?(o=eb(),o!==null?e=[e,j,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={kind:"insertdata",token:"executableunit"};b.quads=a;return b}(e[4]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[36] InsertData");y[f]={nextPos:b,result:d};return d}function Db(){var f="DeleteData@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;
if(a.substr(b,6)==="DELETE"){var e="DELETE";b+=6}else e=null,n&&k('"DELETE"');e===null&&(a.substr(b,6)==="delete"?(e="delete",b+=6):(e=null,n&&k('"delete"')),e=e!==null?e:null);if(e!==null){for(var j=[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(a.substr(b,4)==="DATA"?(r="DATA",b+=4):(r=null,n&&k('"DATA"')),r===null&&(a.substr(b,4)==="data"?(r="data",b+=4):(r=null,n&&k('"data"')),r=r!==null?r:null),r!==null){var w=eb();w!==null?e=[e,j,r,w]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,
b=d;d=e!==null?function(a){var b={kind:"deletedata",token:"executableunit"};b.quads=a;return b}(e[3]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[37] DeleteData");y[f]={nextPos:b,result:d};return d}function xb(){var f="DeleteWhere@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,6)==="DELETE"){var e="DELETE";b+=6}else e=null,n&&k('"DELETE"');e===null&&(a.substr(b,6)==="delete"?(e="delete",b+=6):(e=null,n&&k('"delete"')),e=e!==null?e:null);if(e!==null){for(var j=
[],r=q();r!==null;)j.push(r),r=q();if(j!==null)if(a.substr(b,5)==="WHERE"?(r="WHERE",b+=5):(r=null,n&&k('"WHERE"')),r===null&&(a.substr(b,5)==="where"?(r="where",b+=5):(r=null,n&&k('"where"')),r=r!==null?r:null),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?(o=W(),o!==null?e=[e,j,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={kind:"modify"};b.pattern=a;b["with"]=null;b.using=null;for(var e=[],a=a.patterns[0],a=a.triplesContext==
null&&a.patterns!=null?a.patterns[0].triplesContext:a.triplesContext,d=0;d<a.length;d++){var c={},k=a[d];c.subject=k.subject;c.predicate=k.predicate;c.object=k.object;c.graph=k.graph;e.push(c)}b["delete"]=e;return b}(e[4]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[38] DeleteWhere");y[f]={nextPos:b,result:d};return d}function yb(){var f="Modify@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b,e=b;if(a.substr(b,4)==="WITH"){var j="WITH";b+=4}else j=null,n&&k('"WITH"');j===null&&
(a.substr(b,4)==="with"?(j="with",b+=4):(j=null,n&&k('"with"')),j=j!==null?j:null);if(j!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();r!==null?(w=R(),w!==null?j=[j,r,w]:(j=null,b=e)):(j=null,b=e)}else j=null,b=e;e=j!==null?j:"";if(e!==null){j=[];for(r=q();r!==null;)j.push(r),r=q();if(j!==null){r=b;w=Eb();if(w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();o!==null?(g=Za(),g=g!==null?g:"",g!==null?w=[w,o,g]:(w=null,b=r)):(w=null,b=r)}else w=null,b=r;w!==null?r=w:(r=Za(),r=r!==null?r:null);
if(r!==null){w=[];for(o=q();o!==null;)w.push(o),o=q();if(w!==null){o=[];for(g=fb();g!==null;)o.push(g),g=fb();if(o!==null){for(var g=[],t=q();t!==null;)g.push(t),t=q();if(g!==null)if(a.substr(b,5)==="WHERE"?(t="WHERE",b+=5):(t=null,n&&k('"WHERE"')),t===null&&(a.substr(b,5)==="where"?(t="where",b+=5):(t=null,n&&k('"where"')),t=t!==null?t:null),t!==null){for(var m=[],s=q();s!==null;)m.push(s),s=q();if(m!==null)if(s=W(),s!==null){for(var v=[],u=q();u!==null;)v.push(u),u=q();v!==null?e=[e,j,r,w,o,g,t,
m,s,v]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,e,d){var c={kind:"modify"};c["with"]=a!=""?a[2]:null;b.length===3&&b[2]===""?(c["delete"]=b[0],c.insert=null):b.length===3&&b[0].length!=null&&b[1].length!=null&&b[2].length!=null?(c["delete"]=b[0],c.insert=b[2]):(c.insert=b,c["delete"]=null);e!=""&&(c.using=e);c.pattern=d;return c}(e[0],e[2],e[4],e[8]):null;d===
null&&(d=null,b=i);(n=h)&&d===null&&k("[39] Modify");y[f]={nextPos:b,result:d};return d}function Eb(){var f="DeleteClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,6)==="DELETE"){var e="DELETE";b+=6}else e=null,n&&k('"DELETE"');e===null&&(a.substr(b,6)==="delete"?(e="delete",b+=6):(e=null,n&&k('"delete"')),e=e!==null?e:null);if(e!==null){var i=gb();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[40] DeleteClause");
y[f]={nextPos:b,result:d};return d}function Za(){var f="InsertClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,6)==="INSERT"){var e="INSERT";b+=6}else e=null,n&&k('"INSERT"');e===null&&(a.substr(b,6)==="insert"?(e="insert",b+=6):(e=null,n&&k('"insert"')),e=e!==null?e:null);if(e!==null){var i=gb();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[41] InsertClause");y[f]={nextPos:b,result:d};return d}function fb(){var f=
"UsingClause@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var j=b,d=b,e=[],i=q();i!==null;)e.push(i),i=q();if(e!==null)if(a.substr(b,5)==="USING"?(i="USING",b+=5):(i=null,n&&k('"USING"')),i===null&&(a.substr(b,5)==="using"?(i="using",b+=5):(i=null,n&&k('"using"')),i=i!==null?i:null),i!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null){w=R();if(w===null){w=b;if(a.substr(b,5)==="NAMED"){var o="NAMED";b+=5}else o=null,n&&k('"NAMED"');o===null&&(a.substr(b,5)==="named"?(o="named",
b+=5):(o=null,n&&k('"named"')),o=o!==null?o:null);if(o!==null){for(var g=[],t=q();t!==null;)g.push(t),t=q();g!==null?(t=R(),t!==null?o=[o,g,t]:(o=null,b=w)):(o=null,b=w)}else o=null,b=w;w=o!==null?o:null}w!==null?e=[e,i,r,w]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?e[3].length!=null?{kind:"named",uri:e[3][2]}:{kind:"default",uri:e[3]}:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[42] UsingClause");y[f]={nextPos:b,result:d};return d}function Ka(){var f="GraphRef@"+
b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,5)==="GRAPH"){var e="GRAPH";b+=5}else e=null,n&&k('"GRAPH"');e===null&&(a.substr(b,5)==="graph"?(e="graph",b+=5):(e=null,n&&k('"graph"')),e=e!==null?e:null);if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();i!==null?(r=R(),r!==null?e=[e,i,r]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[43] GraphRef");y[f]={nextPos:b,result:d};return d}function cb(){var f=
"GraphRefAll@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=Ka(),d=d!==null?d:null;d===null&&(d=null,b=i);d!==null?i=d:(i=b,a.substr(b,7)==="DEFAULT"?(d="DEFAULT",b+=7):(d=null,n&&k('"DEFAULT"')),d===null&&(a.substr(b,7)==="default"?(d="default",b+=7):(d=null,n&&k('"default"')),d=d!==null?d:null),d=d!==null?"default":null,d===null&&(d=null,b=i),d!==null?i=d:(i=b,a.substr(b,5)==="NAMED"?(d="NAMED",b+=5):(d=null,n&&k('"NAMED"')),d===null&&(a.substr(b,5)==="named"?(d="named",b+=5):(d=
null,n&&k('"named"')),d=d!==null?d:null),d=d!==null?"named":null,d===null&&(d=null,b=i),d!==null?i=d:(i=b,a.substr(b,3)==="ALL"?(d="ALL",b+=3):(d=null,n&&k('"ALL"')),d===null&&(a.substr(b,3)==="all"?(d="all",b+=3):(d=null,n&&k('"all"')),d=d!==null?d:null),d=d!==null?"all":null,d===null&&(d=null,b=i),i=d!==null?d:null)));(n=h)&&i===null&&k("[44] GraphRefAll");y[f]={nextPos:b,result:i};return i}function gb(){var f="QuadPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var i=b,d=b,e=[],
j=q();j!==null;)e.push(j),j=q();if(e!==null)if(a.substr(b,1)==="{"?(j="{",b+=1):(j=null,n&&k('"{"')),j!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=hb(),w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();if(o!==null)if(a.substr(b,1)==="}"?(g="}",b+=1):(g=null,n&&k('"}"')),g!==null){for(var t=[],m=q();m!==null;)t.push(m),m=q();t!==null?e=[e,j,r,w,o,g,t]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?
e[3].quadsContext:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[45] QuadPattern");y[f]={nextPos:b,result:d};return d}function eb(){var f="QuadData@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var i=b,d=b,e=[],j=q();j!==null;)e.push(j),j=q();if(e!==null)if(a.substr(b,1)==="{"?(j="{",b+=1):(j=null,n&&k('"{"')),j!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=hb(),w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();if(o!==null)if(a.substr(b,1)==="}"?(g="}",b+=
1):(g=null,n&&k('"}"')),g!==null){for(var t=[],m=q();m!==null;)t.push(m),m=q();t!==null?e=[e,j,r,w,o,g,t]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?e[3].quadsContext:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[46] QuadData");y[f]={nextPos:b,result:d};return d}function hb(){var f="Quads@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b,e=pa(),e=e!==null?e:"";if(e!==null){var j=[],r=b,w=ib();if(w!==null){if(a.substr(b,
1)==="."){var o=".";b+=1}else o=null,n&&k('"."');o=o!==null?o:"";if(o!==null){var g=pa(),g=g!==null?g:"";g!==null?w=[w,o,g]:(w=null,b=r)}else w=null,b=r}else w=null,b=r;for(;w!==null;)j.push(w),r=b,w=ib(),w!==null?(a.substr(b,1)==="."?(o=".",b+=1):(o=null,n&&k('"."')),o=o!==null?o:"",o!==null?(g=pa(),g=g!==null?g:"",g!==null?w=[w,o,g]:(w=null,b=r)):(w=null,b=r)):(w=null,b=r);j!==null?e=[e,j]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){var e=[];if(a.triplesContext!=null&&a.triplesContext!=
null)for(var d=0;d<a.triplesContext.length;d++){var c=a.triplesContext[d];c.graph=null;e.push(c)}if(b&&b.length>0&&b[0].length>0&&(e=e.concat(b[0][0].quadsContext),b[0][2]!=null&&b[0][2].triplesContext!=null))for(d=0;d<b[0][2].triplesContext.length;d++)c=b[0][2].triplesContext[d],c.graph=null,e.push(c);return{token:"quads",quadsContext:e}}(e[0],e[1]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[47] Quads");y[f]={nextPos:b,result:d};return d}function ib(){var f="QuadsNotTriples@"+b,h=y[f];if(h)return b=
h.nextPos,h.result;h=n;n=!1;for(var i=b,d=b,e=[],j=q();j!==null;)e.push(j),j=q();if(e!==null)if(a.substr(b,5)==="GRAPH"?(j="GRAPH",b+=5):(j=null,n&&k('"GRAPH"')),j===null&&(a.substr(b,5)==="graph"?(j="graph",b+=5):(j=null,n&&k('"graph"')),j=j!==null?j:null),j!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=ka(),w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();if(o!==null)if(a.substr(b,1)==="{"?(g="{",b+=1):(g=null,n&&k('"{"')),g!==null){for(var t=[],m=q();m!==null;)t.push(m),
m=q();if(t!==null)if(m=pa(),m=m!==null?m:"",m!==null){for(var s=[],v=q();v!==null;)s.push(v),v=q();if(s!==null)if(a.substr(b,1)==="}"?(v="}",b+=1):(v=null,n&&k('"}"')),v!==null){for(var u=[],x=q();x!==null;)u.push(x),x=q();u!==null?e=[e,j,r,w,o,g,t,m,s,v,u]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){for(var e=[],d=0;d<b.triplesContext.length;d++){var c=
b.triplesContext[d];c.graph=a;e.push(c)}return{token:"quadsnottriples",quadsContext:e}}(e[3],e[7]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[48] QuadsNotTriples");y[f]={nextPos:b,result:d};return d}function pa(){var f="TriplesTemplate@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=jb();if(e!==null){for(var i=b,r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(a.substr(b,1)==="."?(w=".",b+=1):(w=null,n&&k('"."')),w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();o!==
null?(g=pa(),g=g!==null?g:"",g!==null?r=[r,w,o,g]:(r=null,b=i)):(r=null,b=i)}else r=null,b=i;else r=null,b=i;i=r!==null?r:"";i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){var e=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(e=e.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:e}}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[49] TriplesTemplate");y[f]={nextPos:b,result:d};return d}function W(){var f=
"GroupGraphPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,1)==="{"){var e="{";b+=1}else e=null,n&&k('"{"');if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=C(),r!==null){for(var w=[],o=q();o!==null;)w.push(o),o=q();w!==null?(a.substr(b,1)==="}"?(o="}",b+=1):(o=null,n&&k('"}"')),o!==null?e=[e,i,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=j);if(d!==null)j=
d;else{d=j=b;a.substr(b,1)==="{"?(e="{",b+=1):(e=null,n&&k('"{"'));if(e!==null){i=[];for(r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=Hb(),r!==null){w=[];for(o=q();o!==null;)w.push(o),o=q();w!==null?(a.substr(b,1)==="}"?(o="}",b+=1):(o=null,n&&k('"}"')),o!==null?e=[e,i,r,w,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=j);j=d!==null?d:null}(n=h)&&j===null&&k("[50] GroupGraphPattern");y[f]={nextPos:b,result:j};return j}function Hb(){var f=
"GroupGraphPatternSub@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=oa(),e=e!==null?e:"";if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null){var r=[],w=b,o=kb();if(o!==null){for(var g=[],t=q();t!==null;)g.push(t),t=q();if(g!==null)if(a.substr(b,1)==="."?(t=".",b+=1):(t=null,n&&k('"."')),t=t!==null?t:"",t!==null){for(var m=[],s=q();s!==null;)m.push(s),s=q();m!==null?(s=oa(),s=s!==null?s:"",s!==null?o=[o,g,t,m,s]:(o=null,b=w)):(o=null,b=w)}else o=null,b=w;else o=
null,b=w}else o=null,b=w;for(;o!==null;)if(r.push(o),w=b,o=kb(),o!==null){g=[];for(t=q();t!==null;)g.push(t),t=q();if(g!==null)if(a.substr(b,1)==="."?(t=".",b+=1):(t=null,n&&k('"."')),t=t!==null?t:"",t!==null){m=[];for(s=q();s!==null;)m.push(s),s=q();m!==null?(s=oa(),s=s!==null?s:"",s!==null?o=[o,g,t,m,s]:(o=null,b=w)):(o=null,b=w)}else o=null,b=w;else o=null,b=w}else o=null,b=w;r!==null?e=[e,i,r]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){var e=[];a!=null&&a!=[]&&e.push(a);
for(var d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)b[d][c].token!=null&&e.push(b[d][c]);for(var f=[],k=[],h=[],d=0;d<e.length;d++)if(e[d].token!="triplespattern"&&e[d].token!="filter"){if(k.length!=0||h.length!=0){for(var r=[],c=0;c<k.length;c++)r=r.concat(k[c].triplesContext);r.length>0&&f.push({token:"basicgraphpattern",triplesContext:r});k=[]}f.push(e[d])}else e[d].token==="triplespattern"?k.push(e[d]):h.push(e[d]);if(k.length!=0||h.length!=0){r=[];for(c=0;c<k.length;c++)r=r.concat(k[c].triplesContext);
r.length>0&&f.push({token:"basicgraphpattern",triplesContext:r})}return{token:"groupgraphpattern",patterns:f,filters:h}}(e[0],e[2]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[51] GroupGraphPatternSub");y[f]={nextPos:b,result:d};return d}function oa(){var f="TriplesBlock@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=Ib();if(e!==null){for(var i=b,r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(a.substr(b,1)==="."?(w=".",b+=1):(w=null,n&&k('"."')),w!==null){var o=oa(),
o=o!==null?o:"";o!==null?r=[r,w,o]:(r=null,b=i)}else r=null,b=i;else r=null,b=i;i=r!==null?r:"";i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){var e=a.triplesContext;typeof b==="object"&&b.length!=null&&b[2].triplesContext!=null&&(e=e.concat(b[2].triplesContext));return{token:"triplespattern",triplesContext:e}}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[54] TriplesBlock");y[f]={nextPos:b,result:d};return d}function kb(){var a="GraphPatternNotTriples@"+b,c=
y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Jb();f===null&&(f=Kb(),f===null&&(f=Lb(),f===null&&(f=Mb(),f===null&&(f=Nb(),f===null&&(f=Ob(),f=f!==null?f:null)))));(n=c)&&f===null&&k("[53] GraphPatternNotTriples");y[a]={nextPos:b,result:f};return f}function Kb(){var f="OptionalGraphPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var i=b,d=b,e=[],j=q();j!==null;)e.push(j),j=q();if(e!==null)if(a.substr(b,8)==="OPTIONAL"?(j="OPTIONAL",b+=8):(j=null,n&&k('"OPTIONAL"')),j!==null){for(var r=
[],w=q();w!==null;)r.push(w),w=q();r!==null?(w=W(),w!==null?e=[e,j,r,w]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?{token:"optionalgraphpattern",value:e[3]}:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[54] OptionalGraphPattern");y[f]={nextPos:b,result:d};return d}function Mb(){var f="GraphGraphPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var j=b,d=b,e=[],i=q();i!==null;)e.push(i),i=q();if(e!==null)if(a.substr(b,5)==="GRAPH"?(i="GRAPH",b+=5):(i=null,
n&&k('"GRAPH"')),i===null&&(a.substr(b,5)==="graph"?(i="graph",b+=5):(i=null,n&&k('"graph"')),i=i!==null?i:null),i!==null){for(var r=[],w=q();w!==null;)r.push(w),w=q();if(r!==null)if(w=ka(),w!==null){for(var o=[],g=q();g!==null;)o.push(g),g=q();o!==null?(g=W(),g!==null?e=[e,i,r,w,o,g]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){for(var e=0;e<b.patterns.length;e++)for(var d=b.patterns[e],c=0;c<d.triplesContext.length;c++)d.triplesContext[c].graph=
a;b.token="groupgraphpattern";return b}(e[3],e[5]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[55] GraphGraphPattern");y[f]={nextPos:b,result:d};return d}function Nb(){var f="ServiceGraphPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,7)==="SERVICE"){var e="SERVICE";b+=7}else e=null,n&&k('"SERVICE"');if(e!==null){var j=ka();if(j!==null){var r=W();r!==null?e=[e,j,r]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?{token:"servicegraphpattern",status:"todo",
value:[e[1],e[2]]}:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[56] ServiceGraphPattern");y[f]={nextPos:b,result:d};return d}function Lb(){var f="MinusGraphPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,5)==="MINUS"){var e="MINUS";b+=5}else e=null,n&&k('"MINUS"');if(e!==null){var j=W();j!==null?e=[e,j]:(e=null,b=d)}else e=null,b=d;d=e!==null?{token:"minusgraphpattern",status:"todo",value:e[1]}:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[57] MinusGraphPattern");
y[f]={nextPos:b,result:d};return d}function Jb(){var f="GroupOrUnionGraphPattern@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b,e=W();if(e!==null){for(var j=[],r=b,w=[],g=q();g!==null;)w.push(g),g=q();if(w!==null)if(a.substr(b,5)==="UNION"?(g="UNION",b+=5):(g=null,n&&k('"UNION"')),g===null&&(a.substr(b,5)==="union"?(g="union",b+=5):(g=null,n&&k('"union"')),g=g!==null?g:null),g!==null){for(var m=[],t=q();t!==null;)m.push(t),t=q();m!==null?(t=W(),t!==null?w=[w,g,m,t]:(w=null,b=r)):
(w=null,b=r)}else w=null,b=r;else w=null,b=r;for(;w!==null;){j.push(w);r=b;w=[];for(g=q();g!==null;)w.push(g),g=q();if(w!==null)if(a.substr(b,5)==="UNION"?(g="UNION",b+=5):(g=null,n&&k('"UNION"')),g===null&&(a.substr(b,5)==="union"?(g="union",b+=5):(g=null,n&&k('"union"')),g=g!==null?g:null),g!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=W(),t!==null?w=[w,g,m,t]:(w=null,b=r)):(w=null,b=r)}else w=null,b=r;else w=null,b=r}j!==null?e=[e,j]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,
b){if(b.length===0)return a;else{for(var e={token:"graphunionpattern",value:[a]},d=0;d<b.length;d++)d==b.length-1?e.value.push(b[d][3]):(e.value.push(b[d][3]),e={token:"graphunionpattern",value:[e]});return e}}(e[0],e[1]):null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[58] GroupOrUnionGraphPattern");y[f]={nextPos:b,result:d};return d}function Ob(){var f="Filter@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var i=b,d=b,e=[],j=q();j!==null;)e.push(j),j=q();if(e!==null)if(a.substr(b,6)===
"FILTER"?(j="FILTER",b+=6):(j=null,n&&k('"FILTER"')),j===null&&(a.substr(b,6)==="filter"?(j="filter",b+=6):(j=null,n&&k('"filter"')),j=j!==null?j:null),j!==null){for(var r=[],g=q();g!==null;)r.push(g),g=q();r!==null?(g=za(),g!==null?e=[e,j,r,g]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?{token:"filter",value:e[3]}:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[59] Filter");y[f]={nextPos:b,result:d};return d}function za(){var a="Constraint@"+b,c=y[a];if(c)return b=c.nextPos,
c.result;c=n;n=!1;var f=Ga();f===null&&(f=Fa(),f===null&&(f=bb(),f=f!==null?f:null));(n=c)&&f===null&&k("[60] Constraint");y[a]={nextPos:b,result:f};return f}function bb(){var a="FunctionCall@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=R();if(e!==null){var h=lb();h!==null?e=[e,h]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){var e={token:"expression",expressionType:"irireforfunction"};e.iriref=a;e.args=b.value;return e}(e[0],e[1]):null;d===null&&(d=null,b=f);(n=c)&&
d===null&&k("[61] FunctionCall");y[a]={nextPos:b,result:d};return d}function lb(){var f="ArgList@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=la()!==null?{token:"args",value:[]}:null;d===null&&(d=null,b=j);if(d!==null)j=d;else{d=j=b;if(a.substr(b,1)==="("){var e="(";b+=1}else e=null,n&&k('"("');if(e!==null){if(a.substr(b,8)==="DISTINCT"){var i="DISTINCT";b+=8}else i=null,n&&k('"DISTINCT"');i===null&&(a.substr(b,8)==="distinct"?(i="distinct",b+=8):(i=null,n&&k('"distinct"')),i=i!==
null?i:null);i=i!==null?i:"";if(i!==null){var r=M();if(r!==null){var g=[],o=b;if(a.substr(b,1)===","){var q=",";b+=1}else q=null,n&&k('","');if(q!==null){var t=M();t!==null?q=[q,t]:(q=null,b=o)}else q=null,b=o;for(;q!==null;)g.push(q),o=b,a.substr(b,1)===","?(q=",",b+=1):(q=null,n&&k('","')),q!==null?(t=M(),t!==null?q=[q,t]:(q=null,b=o)):(q=null,b=o);g!==null?(a.substr(b,1)===")"?(o=")",b+=1):(o=null,n&&k('")"')),o!==null?e=[e,i,r,g,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d}else e=null,b=d}else e=
null,b=d;d=e!==null?function(a,b,e){cleanEx=[];for(var d=0;d<e.length;d++)cleanEx.push(e[d][1]);e={token:"args"};e.value=[b].concat(cleanEx);e.distinct=a!=null&&a.toUpperCase()==="DISTINCT"?!0:!1;return e}(e[1],e[2],e[3]):null;d===null&&(d=null,b=j);j=d!==null?d:null}(n=h)&&j===null&&k("[62] ArgList");y[f]={nextPos:b,result:j};return j}function Pb(){var f="ExpressionList@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=la()!==null?{token:"args",value:[]}:null;d===null&&(d=null,b=j);
if(d!==null)j=d;else{d=j=b;if(a.substr(b,1)==="("){var e="(";b+=1}else e=null,n&&k('"("');if(e!==null){var i=M();if(i!==null){var r=[],g=b;if(a.substr(b,1)===","){var o=",";b+=1}else o=null,n&&k('","');if(o!==null){var q=M();q!==null?o=[o,q]:(o=null,b=g)}else o=null,b=g;for(;o!==null;)r.push(o),g=b,a.substr(b,1)===","?(o=",",b+=1):(o=null,n&&k('","')),o!==null?(q=M(),q!==null?o=[o,q]:(o=null,b=g)):(o=null,b=g);r!==null?(a.substr(b,1)===")"?(g=")",b+=1):(g=null,n&&k('")"')),g!==null?e=[e,i,r,g]:(e=
null,b=d)):(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){cleanEx=[];for(var e=0;e<b.length;e++)cleanEx.push(b[e][1]);e={token:"args"};e.value=[a].concat(cleanEx);return e}(e[1],e[2]):null;d===null&&(d=null,b=j);j=d!==null?d:null}(n=h)&&j===null&&k("[63] ExpressionList");y[f]={nextPos:b,result:j};return j}function Gb(){var f="ConstructTemplate@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b;if(a.substr(b,1)==="{"){var e="{";b+=1}else e=null,n&&k('"{"');if(e!==
null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=mb(),r=r!==null?r:"",r!==null){for(var g=[],o=q();o!==null;)g.push(o),o=q();g!==null?(a.substr(b,1)==="}"?(o="}",b+=1):(o=null,n&&k('"}"')),o!==null?e=[e,i,r,g,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[64] ConstructTemplate");y[f]={nextPos:b,result:d};return d}function mb(){var f="ConstructTriples@"+b,h=y[f];if(h)return b=h.nextPos,
h.result;h=n;n=!1;var j=b,d=b,e=jb();if(e!==null){for(var i=b,r=[],g=q();g!==null;)r.push(g),g=q();if(r!==null)if(a.substr(b,1)==="."?(g=".",b+=1):(g=null,n&&k('"."')),g!==null){for(var o=[],m=q();m!==null;)o.push(m),m=q();o!==null?(m=mb(),m=m!==null?m:"",m!==null?r=[r,g,o,m]:(r=null,b=i)):(r=null,b=i)}else r=null,b=i;else r=null,b=i;i=r!==null?r:"";i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){var e=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=
null&&(e=e.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:e}}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[65] ConstructTriples");y[f]={nextPos:b,result:d};return d}function jb(){var a="TriplesSameSubject@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;for(var f=b,d=b,e=[],h=q();h!==null;)e.push(h),h=q();if(e!==null)if(h=La(),h!==null){for(var r=[],j=q();j!==null;)r.push(j),j=q();r!==null?(j=Aa(),j!==null?e=[e,h,r,j]:(e=null,b=d)):(e=null,b=d)}else e=
null,b=d;else e=null,b=d;d=e!==null?function(a,b){var e=b.triplesContext;if(b.pairs)for(var d=0;d<b.pairs.length;d++){var c=b.pairs[d],f=null;c[1].length!=null&&(c[1]=c[1][0]);a.token&&a.token==="triplesnodecollection"?(f={subject:a.chainSubject[0],predicate:c[0],object:c[1]},e.push(f),e=e.concat(a.triplesContext)):(f={subject:a,predicate:c[0],object:c[1]},e.push(f))}d={token:"triplessamesubject"};d.triplesContext=e;d.chainSubject=a;return d}(e[1],e[3]):null;d===null&&(d=null,b=f);if(d!==null)f=d;
else{d=f=b;e=[];for(h=q();h!==null;)e.push(h),h=q();if(e!==null)if(h=Ma(),h!==null){r=[];for(j=q();j!==null;)r.push(j),j=q();r!==null?(j=Qb(),j!==null?e=[e,h,r,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){var e=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var c=0;c<b.pairs.length;c++){var f=b.pairs[c];f[1].length!=null&&(f[1]=f[1][0]);if(a.token==="triplesnodecollection")for(var k=0;k<d.length;k++){var h=d[k];if(h.triplesContext!=null){var r={subject:h.chainSubject,
predicate:f[0],object:f[1]};e.concat(h.triplesContext)}else r={subject:d[k],predicate:f[0],object:f[1]},e.push(r)}else r={subject:d,predicate:f[0],object:f[1]},e.push(r)}c={token:"triplessamesubject"};c.triplesContext=e;c.chainSubject=d;return c}(e[1],e[3]):null;d===null&&(d=null,b=f);f=d!==null?d:null}(n=c)&&f===null&&k("[66] TriplesSameSubject");y[a]={nextPos:b,result:f};return f}function Aa(){var f="PropertyListNotEmpty@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=Na();if(e!==
null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=ma(),r!==null){for(var g=[],o=b,m=[],t=q();t!==null;)m.push(t),t=q();if(m!==null)if(a.substr(b,1)===";"?(t=";",b+=1):(t=null,n&&k('";"')),t!==null){for(var s=[],v=q();v!==null;)s.push(v),v=q();if(s!==null){var v=b,u=Na();if(u!==null){for(var x=[],z=q();z!==null;)x.push(z),z=q();x!==null?(z=ma(),z!==null?u=[u,x,z]:(u=null,b=v)):(u=null,b=v)}else u=null,b=v;v=u!==null?u:"";v!==null?m=[m,t,s,v]:(m=null,b=o)}else m=null,b=o}else m=null,
b=o;else m=null,b=o;for(;m!==null;){g.push(m);o=b;m=[];for(t=q();t!==null;)m.push(t),t=q();if(m!==null)if(a.substr(b,1)===";"?(t=";",b+=1):(t=null,n&&k('";"')),t!==null){s=[];for(v=q();v!==null;)s.push(v),v=q();if(s!==null){v=b;u=Na();if(u!==null){x=[];for(z=q();z!==null;)x.push(z),z=q();x!==null?(z=ma(),z!==null?u=[u,x,z]:(u=null,b=v)):(u=null,b=v)}else u=null,b=v;v=u!==null?u:"";v!==null?m=[m,t,s,v]:(m=null,b=o)}else m=null,b=o}else m=null,b=o;else m=null,b=o}g!==null?e=[e,i,r,g]:(e=null,b=d)}else e=
null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,e){token={token:"propertylist"};for(var d=[],c=[],f=0;f<b.length;f++)b[f].triplesContext!=null?(d=d.concat(b[f].triplesContext),b[f].token==="triplesnodecollection"&&b[f].chainSubject.length!=null?c.push([a,b[f].chainSubject[0]]):c.push([a,b[f].chainSubject])):c.push([a,b[f]]);for(f=0;f<e.length;f++)for(var b=e[f][3],a=b[0],b=b[2]||[],k=0;k<b.length;k++)b[k].triplesContext!=null?(d=d.concat(b[k].triplesContext),c.push([a,b[k].chainSubject])):
c.push([a,b[k]]);token.pairs=c;token.triplesContext=d;return token}(e[0],e[2],e[3]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[67] PropertyListNotEmpty");y[f]={nextPos:b,result:d};return d}function Qb(){var a="PropertyList@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Aa(),f=f!==null?f:"";(n=c)&&f===null&&k("[68] PropertyList");y[a]={nextPos:b,result:f};return f}function ma(){var f="ObjectList@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=qa();if(e!==null){for(var i=
[],r=q();r!==null;)i.push(r),r=q();if(i!==null){var r=[],g=b;if(a.substr(b,1)===","){var o=",";b+=1}else o=null,n&&k('","');if(o!==null){for(var m=[],t=q();t!==null;)m.push(t),t=q();m!==null?(t=qa(),t!==null?o=[o,m,t]:(o=null,b=g)):(o=null,b=g)}else o=null,b=g;for(;o!==null;)if(r.push(o),g=b,a.substr(b,1)===","?(o=",",b+=1):(o=null,n&&k('","')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=qa(),t!==null?o=[o,m,t]:(o=null,b=g)):(o=null,b=g)}else o=null,b=g;r!==null?e=[e,i,r]:(e=null,
b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){var e=[];e.push(a);for(var d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)typeof b[d][c]=="object"&&b[d][c].token!=null&&e.push(b[d][c]);return e}(e[0],e[2]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[69] ObjectList");y[f]={nextPos:b,result:d};return d}function Na(){var f="Verb@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=ka();if(j===null){j=b;if(a.substr(b,1)==="a"){var d="a";b+=1}else d=null,n&&k('"a"');d=d!==null?
{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:null;d===null&&(d=null,b=j);j=d!==null?d:null}(n=h)&&j===null&&k("[71] Verb");y[f]={nextPos:b,result:j};return j}function Ib(){var a="TriplesSameSubjectPath@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;for(var f=b,d=b,e=[],h=q();h!==null;)e.push(h),h=q();if(e!==null)if(h=La(),h!==null){for(var r=[],j=q();j!==null;)r.push(j),j=q();r!==null?(j=Rb(),j!==null?e=[e,h,r,j]:(e=null,b=d)):(e=null,b=d)}else e=
null,b=d;else e=null,b=d;d=e!==null?function(a,b){var e=b.triplesContext;if(b.pairs)for(var d=0;d<b.pairs.length;d++){var c=b.pairs[d],f=null;c[1].length!=null&&(c[1]=c[1][0]);a.token&&a.token==="triplesnodecollection"?(f={subject:a.chainSubject[0],predicate:c[0],object:c[1]},e.push(f),e=e.concat(a.triplesContext)):(f={subject:a,predicate:c[0],object:c[1]},e.push(f))}d={token:"triplessamesubject"};d.triplesContext=e;d.chainSubject=a;return d}(e[1],e[3]):null;d===null&&(d=null,b=f);if(d!==null)f=d;
else{d=f=b;e=[];for(h=q();h!==null;)e.push(h),h=q();if(e!==null)if(h=Ma(),h!==null){r=[];for(j=q();j!==null;)r.push(j),j=q();r!==null?(j=Sb(),j!==null?e=[e,h,r,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?function(a,b){var e=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var c=0;c<b.pairs.length;c++){var f=b.pairs[c];f[1].length!=null&&(f[1]=f[1][0]);if(a.token==="triplesnodecollection")for(var k=0;k<d.length;k++){var h=d[k];if(h.triplesContext!=null){var r={subject:h.chainSubject,
predicate:f[0],object:f[1]};e.concat(h.triplesContext)}else r={subject:d[k],predicate:f[0],object:f[1]},e.push(r)}else r={subject:d,predicate:f[0],object:f[1]},e.push(r)}c={token:"triplessamesubject"};c.triplesContext=e;c.chainSubject=d;return c}(e[1],e[3]):null;d===null&&(d=null,b=f);f=d!==null?d:null}(n=c)&&f===null&&k("[72] TriplesSameSubjectPath");y[a]={nextPos:b,result:f};return f}function Rb(){var f="PropertyListNotEmptyPath@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=
Oa();e===null&&(e=Q(),e=e!==null?e:null);if(e!==null){for(var i=[],r=q();r!==null;)i.push(r),r=q();if(i!==null)if(r=ma(),r!==null){for(var g=[],o=b,m=[],t=q();t!==null;)m.push(t),t=q();if(m!==null)if(a.substr(b,1)===";"?(t=";",b+=1):(t=null,n&&k('";"')),t!==null){for(var s=[],v=q();v!==null;)s.push(v),v=q();if(s!==null){var v=b,u=Oa();u===null&&(u=Q(),u=u!==null?u:null);if(u!==null){var x=ma();x!==null?u=[u,x]:(u=null,b=v)}else u=null,b=v;v=u!==null?u:"";v!==null?m=[m,t,s,v]:(m=null,b=o)}else m=null,
b=o}else m=null,b=o;else m=null,b=o;for(;m!==null;){g.push(m);o=b;m=[];for(t=q();t!==null;)m.push(t),t=q();if(m!==null)if(a.substr(b,1)===";"?(t=";",b+=1):(t=null,n&&k('";"')),t!==null){s=[];for(v=q();v!==null;)s.push(v),v=q();s!==null?(v=b,u=Oa(),u===null&&(u=Q(),u=u!==null?u:null),u!==null?(x=ma(),x!==null?u=[u,x]:(u=null,b=v)):(u=null,b=v),v=u!==null?u:"",v!==null?m=[m,t,s,v]:(m=null,b=o)):(m=null,b=o)}else m=null,b=o;else m=null,b=o}g!==null?e=[e,i,r,g]:(e=null,b=d)}else e=null,b=d;else e=null,
b=d}else e=null,b=d;d=e!==null?function(a,b,e){token={token:"propertylist"};for(var d=[],c=[],f=0;f<b.length;f++)b[f].triplesContext!=null?(d=d.concat(b[f].triplesContext),b[f].token==="triplesnodecollection"&&b[f].chainSubject.length!=null?c.push([a,b[f].chainSubject[0]]):c.push([a,b[f].chainSubject])):c.push([a,b[f]]);for(f=0;f<e.length;f++)for(var b=e[f][3],a=b[0],b=b[1]||[],k=0;k<b.length;k++)b[k].triplesContext!=null?(d=d.concat(b[k].triplesContext),c.push([a,b[k].chainSubject])):c.push([a,b[k]]);
token.pairs=c;token.triplesContext=d;return token}(e[0],e[2],e[3]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[73] PropertyListNotEmptyPath");y[f]={nextPos:b,result:d};return d}function Sb(){var a="PropertyListPath@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Aa(),f=f!==null?f:"";(n=c)&&f===null&&k("[74] PropertyListPath");y[a]={nextPos:b,result:f};return f}function Oa(){var a="VerbPath@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=nb(),d=d!==null?d:null;d===null&&
(d=null,b=f);(n=c)&&d===null&&k("[75]");y[a]={nextPos:b,result:d};return d}function nb(){var f="PathAlternative@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=Pa();if(e!==null){var i=[],r=b;if(a.substr(b,1)==="|"){var g="|";b+=1}else g=null,n&&k('"|"');if(g!==null){var o=Pa();o!==null?g=[g,o]:(g=null,b=r)}else g=null,b=r;for(;g!==null;)i.push(g),r=b,a.substr(b,1)==="|"?(g="|",b+=1):(g=null,n&&k('"|"')),g!==null?(o=Pa(),o!==null?g=[g,o]:(g=null,b=r)):(g=null,b=r);i!==null?e=[e,
i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var e=[],d=0;d<b.length;d++)e.push(b[1]);d={token:"path",kind:"alternative"};d.value=e;return d}}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[78] PathAlternative");y[f]={nextPos:b,result:d};return d}function Pa(){var f="PathSequence@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=Qa();if(e!==null){var i=[],r=b;if(a.substr(b,1)==="/"){var g="/";b+=1}else g=null,n&&
k('"/"');if(g!==null){var o=Qa();o!==null?g=[g,o]:(g=null,b=r)}else g=null,b=r;for(;g!==null;)i.push(g),r=b,a.substr(b,1)==="/"?(g="/",b+=1):(g=null,n&&k('"/"')),g!==null?(o=Qa(),o!==null?g=[g,o]:(g=null,b=r)):(g=null,b=r);i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var e=[a],d=0;d<b.length;d++)e.push(b[d][1]);d={token:"path",kind:"sequence"};d.value=e;return d}}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[79] PathSequence");
y[f]={nextPos:b,result:d};return d}function ob(){var a="PathElt@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=Tb();if(e!==null){var h=Ub(),h=h!==null?h:"";h!==null?e=[e,h]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(a.token&&a.token!="path"&&b=="")return a;else if(a.token&&a.token!=e&&b!=""){var e={token:"path",kind:"element"};e.value=a;e.modifier=b;return e}else return a.modifier=b,a}(e[0],e[1]):null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[88] PathElt");y[a]=
{nextPos:b,result:d};return d}function Qa(){var f="PathEltOrInverse@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=ob();if(j===null){var d=j=b;if(a.substr(b,1)==="^"){var e="^";b+=1}else e=null,n&&k('"^"');if(e!==null){var i=ob();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){var b={token:"path",kind:"inversePath"};b.value=a;return b}(e[1]):null;d===null&&(d=null,b=j);j=d!==null?d:null}(n=h)&&j===null&&k("[81] PathEltOrInverse");y[f]={nextPos:b,result:j};return j}
function Ub(){var f="PathMod@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;if(a.substr(b,1)==="*"){var j="*";b+=1}else j=null,n&&k('"*"');if(j===null&&(a.substr(b,1)==="?"?(j="?",b+=1):(j=null,n&&k('"?"')),j===null&&(a.substr(b,1)==="+"?(j="+",b+=1):(j=null,n&&k('"+"')),j===null))){j=b;if(a.substr(b,1)==="{"){var d="{";b+=1}else d=null,n&&k('"{"');if(d!==null){var e=b,i=ca();if(i!==null){var r=b;if(a.substr(b,1)===","){var g=",";b+=1}else g=null,n&&k('","');if(g!==null){if(a.substr(b,1)===
"}"){var o="}";b+=1}else o=null,n&&k('"}"');if(o===null){var o=b,q=ca();if(q!==null){if(a.substr(b,1)==="}"){var m="}";b+=1}else m=null,n&&k('"}"');m!==null?q=[q,m]:(q=null,b=o)}else q=null,b=o;o=q!==null?q:null}o!==null?g=[g,o]:(g=null,b=r)}else g=null,b=r;g!==null?r=g:(a.substr(b,1)==="}"?(r="}",b+=1):(r=null,n&&k('"}"')),r=r!==null?r:null);r!==null?i=[i,r]:(i=null,b=e)}else i=null,b=e;i!==null?e=i:(e=b,a.substr(b,1)===","?(i=",",b+=1):(i=null,n&&k('","')),i!==null?(r=ca(),r!==null?(a.substr(b,
1)==="}"?(g="}",b+=1):(g=null,n&&k('"}"')),g!==null?i=[i,r,g]:(i=null,b=e)):(i=null,b=e)):(i=null,b=e),e=i!==null?i:null);e!==null?d=[d,e]:(d=null,b=j)}else d=null,b=j;j=d!==null?d:null}(n=h)&&j===null&&k("[82] PathMod");y[f]={nextPos:b,result:j};return j}function Tb(){var f="PathPrimary@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=R();if(j===null){j=b;if(a.substr(b,1)==="a"){var d="a";b+=1}else d=null,n&&k('"a"');d=d!==null?{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:
null;d===null&&(d=null,b=j);if(d!==null)j=d;else{j=b;a.substr(b,1)==="!"?(d="!",b+=1):(d=null,n&&k('"!"'));if(d!==null){var e=Vb();e!==null?d=[d,e]:(d=null,b=j)}else d=null,b=j;if(d!==null)j=d;else{d=j=b;a.substr(b,1)==="("?(e="(",b+=1):(e=null,n&&k('"("'));if(e!==null){var i=nb();if(i!==null){if(a.substr(b,1)===")"){var r=")";b+=1}else r=null,n&&k('")"');r!==null?e=[e,i,r]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=j);j=d!==null?d:null}}}(n=h)&&j===null&&
k("[83] PathPrimary");y[f]={nextPos:b,result:j};return j}function Vb(){var f="PathNegatedPropertySet@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=Ba();if(h===null){h=b;if(a.substr(b,1)==="("){var j="(";b+=1}else j=null,n&&k('"("');if(j!==null){var d=b,e=Ba();if(e!==null){var i=[],r=b;if(a.substr(b,1)==="|"){var g="|";b+=1}else g=null,n&&k('"|"');if(g!==null){var o=Ba();o!==null?g=[g,o]:(g=null,b=r)}else g=null,b=r;for(;g!==null;)i.push(g),r=b,a.substr(b,1)==="|"?(g="|",b+=1):(g=null,n&&k('"|"')),
g!==null?(o=Ba(),o!==null?g=[g,o]:(g=null,b=r)):(g=null,b=r);i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e:"";d!==null?(a.substr(b,1)===")"?(e=")",b+=1):(e=null,n&&k('")"')),e!==null?j=[j,d,e]:(j=null,b=h)):(j=null,b=h)}else j=null,b=h;h=j!==null?j:null}y[f]={nextPos:b,result:h};return h}function Ba(){var f="PathOneInPropertySet@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=R();if(j===null&&(a.substr(b,1)==="a"?(j="a",b+=1):(j=null,n&&k('"a"')),j===null)){j=b;if(a.substr(b,
1)==="^"){var d="^";b+=1}else d=null,n&&k('"^"');if(d!==null){var e=R();e===null&&(a.substr(b,1)==="a"?(e="a",b+=1):(e=null,n&&k('"a"')),e=e!==null?e:null);e!==null?d=[d,e]:(d=null,b=j)}else d=null,b=j;j=d!==null?d:null}(n=h)&&j===null&&k("[85] PathOneInPropertySet");y[f]={nextPos:b,result:j};return j}function Ma(){var a="TriplesNode@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=Wb(),d=d!==null?function(a){triplesContext=[];chainSubject=[];for(var b=null,d=0;d<a.length;d++)ea++,b=
null,a[d].chainSubject==null&&a[d].triplesContext==null?b=a[d]:(b=a[d].chainSubject,triplesContext=triplesContext.concat(nextSubject.triplesContext)),b={subject:{token:"blank",value:"_:"+ea},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:b},d==0&&chainSubject.push(b.subject),triplesContext.push(b),b=d===a.length-1?{subject:{token:"blank",value:"_:"+ea},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},
object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+ea},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(ea+1)}},triplesContext.push(b);return{token:"triplesnodecollection",triplesContext:triplesContext,chainSubject:chainSubject}}(d):null;d===null&&(d=null,b=f);d!==null?f=d:(f=Xb(),f=f!==null?f:null);(n=c)&&f===null&&k("[87] TriplesNode");
y[a]={nextPos:b,result:f};return f}function Xb(){var f="BlankNodePropertyList@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var j=b,d=b,e=[],i=q();i!==null;)e.push(i),i=q();if(e!==null)if(a.substr(b,1)==="["?(i="[",b+=1):(i=null,n&&k('"["')),i!==null){for(var r=[],g=q();g!==null;)r.push(g),g=q();if(r!==null)if(g=Aa(),g!==null){for(var o=[],m=q();m!==null;)o.push(m),m=q();if(o!==null)if(a.substr(b,1)==="]"?(m="]",b+=1):(m=null,n&&k('"]"')),m!==null){for(var t=[],s=q();s!==null;)t.push(s),
s=q();t!==null?e=[e,i,r,g,o,m,t]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?function(a){ea++;for(var b={token:"blank",value:"_:"+ea},d=[],e=0;e<a.pairs.length;e++){var c=a.pairs[e],f={};f.subject=b;f.predicate=c[0];c[1].length!=null&&(c[1]=c[1][0]);f.object=c[1];d.push(f)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:a.triplesContext.concat(d),chainSubject:b}}(e[3]):null;d===null&&(d=null,b=j);(n=
h)&&d===null&&k("[88] BlankNodePropertyList");y[f]={nextPos:b,result:d};return d}function Wb(){var f="Collection@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;for(var j=b,d=b,e=[],i=q();i!==null;)e.push(i),i=q();if(e!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){for(var r=[],g=q();g!==null;)r.push(g),g=q();if(r!==null){var o=qa();if(o!==null)for(g=[];o!==null;)g.push(o),o=qa();else g=null;if(g!==null){for(var o=[],m=q();m!==null;)o.push(m),m=q();if(o!==null)if(a.substr(b,
1)===")"?(m=")",b+=1):(m=null,n&&k('")"')),m!==null){for(var t=[],s=q();s!==null;)t.push(s),s=q();t!==null?e=[e,i,r,g,o,m,t]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d}else e=null,b=d}else e=null,b=d;else e=null,b=d;d=e!==null?e[3]:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[89] Collection");y[f]={nextPos:b,result:d};return d}function qa(){var a="GraphNode@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;for(var f=b,d=b,e=[],h=q();h!==null;)e.push(h),h=q();if(e!==null)if(h=
La(),h!==null){for(var j=[],i=q();i!==null;)j.push(i),i=q();j!==null?e=[e,h,j]:(e=null,b=d)}else e=null,b=d;else e=null,b=d;if(e!==null)d=e;else{d=b;e=[];for(h=q();h!==null;)e.push(h),h=q();if(e!==null)if(h=Ma(),h!==null){j=[];for(i=q();i!==null;)j.push(i),i=q();j!==null?e=[e,h,j]:(e=null,b=d)}else e=null,b=d;else e=null,b=d;d=e!==null?e:null}d=d!==null?d[1]:null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[90] GraphNode");y[a]={nextPos:b,result:d};return d}function La(){var a="VarOrTerm@"+b,c=y[a];
if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Q();f===null&&(f=Yb(),f=f!==null?f:null);(n=c)&&f===null&&k("[91] VarOrTerm");y[a]={nextPos:b,result:f};return f}function ka(){var a="VarOrIRIref@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Q();f===null&&(f=R(),f=f!==null?f:null);(n=c)&&f===null&&k("[92] VarOrIRIref");y[a]={nextPos:b,result:f};return f}function Q(){var a="Var@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=Zb();d===null&&(d=$b(),d=d!==null?d:null);d=d!==
null?function(a){var b={token:"var"};b.value=a;return b}(d):null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[93] Var");y[a]={nextPos:b,result:d};return d}function Yb(){var a="GraphTerm@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=R();f===null&&(f=Ha(),f===null&&(f=Ia(),f===null&&(f=Ja(),f===null&&(f=ac(),f===null&&(f=la(),f=f!==null?f:null)))));(n=c)&&f===null&&k("[94] GraphTerm");y[a]={nextPos:b,result:f};return f}function M(){var f="ConditionalOrExpression@"+b,h=y[f];if(h)return b=
h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=Ra();if(e!==null){for(var i=[],r=b,g=[],o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="||"?(o="||",b+=2):(o=null,n&&k('"||"')),o!==null){for(var m=[],t=q();t!==null;)m.push(t),t=q();m!==null?(t=Ra(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;for(;g!==null;){i.push(g);r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="||"?(o="||",b+=2):(o=null,n&&k('"||"')),o!==null){m=[];for(t=
q();t!==null;)m.push(t),t=q();m!==null?(t=Ra(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r}i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b.length===0)return a;for(var d={token:"expression",expressionType:"conditionalor"},e=[a],c=0;c<b.length;c++)e.push(b[c][3]);d.operands=e;return d}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[96] ConditionalOrExpression");y[f]={nextPos:b,result:d};return d}function Ra(){var f="ConditionalAndExpression@"+
b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=Sa();if(e!==null){for(var i=[],r=b,g=[],o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="&&"?(o="&&",b+=2):(o=null,n&&k('"&&"')),o!==null){for(var m=[],t=q();t!==null;)m.push(t),t=q();m!==null?(t=Sa(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;for(;g!==null;){i.push(g);r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="&&"?(o="&&",b+=2):(o=null,n&&k('"&&"')),
o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=Sa(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r}i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b.length===0)return a;for(var d={token:"expression",expressionType:"conditionaland"},e=[a],c=0;c<b.length;c++)e.push(b[c][3]);d.operands=e;return d}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[97] ConditionalAndExpression");y[f]={nextPos:b,result:d};return d}function Sa(){var f=
"RelationalExpression@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=U();if(e!==null){for(var i=[],r=b,g=[],o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,1)==="="?(o="=",b+=1):(o=null,n&&k('"="')),o!==null){for(var m=[],t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="!="?(o="!=",b+=2):(o=null,
n&&k('"!="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,1)==="<"?(o="<",b+=1):(o=null,n&&k('"<"')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),
o=q();if(g!==null)if(a.substr(b,1)===">"?(o=">",b+=1):(o=null,n&&k('">"')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="<="?(o="<=",b+=2):(o=null,n&&k('"<="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,
b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)===">="?(o=">=",b+=2):(o=null,n&&k('">="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;r=g!==null?g:null}}}}}for(;r!==null;){i.push(r);r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,1)==="="?(o="=",b+=1):(o=null,n&&k('"="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();
m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)==="!="?(o="!=",b+=2):(o=null,n&&k('"!="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,1)==="<"?(o="<",b+=1):(o=null,
n&&k('"<"')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,1)===">"?(o=">",b+=1):(o=null,n&&k('">"')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),
o=q();if(g!==null)if(a.substr(b,2)==="<="?(o="<=",b+=2):(o=null,n&&k('"<="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=null,b=r;if(g!==null)r=g;else{r=b;g=[];for(o=q();o!==null;)g.push(o),o=q();if(g!==null)if(a.substr(b,2)===">="?(o=">=",b+=2):(o=null,n&&k('">="')),o!==null){m=[];for(t=q();t!==null;)m.push(t),t=q();m!==null?(t=U(),t!==null?g=[g,o,m,t]:(g=null,b=r)):(g=null,b=r)}else g=null,b=r;else g=
null,b=r;r=g!==null?g:null}}}}}}i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b.length===0)return a;else{var d={expressionType:"relationalexpression"};d.operator=b[0][1];d.op1=a;d.op2=b[0][3];d.token="expression";return d}}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[99] RelationalExpression");y[f]={nextPos:b,result:d};return d}function U(){var f="AdditiveExpression@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b,e=ra();if(e!==null){for(var j=
[],i=b,m=[],o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="+"?(o="+",b+=1):(o=null,n&&k('"+"')),o!==null){for(var s=[],t=q();t!==null;)s.push(t),t=q();s!==null?(t=ra(),t!==null?m=[m,o,s,t]:(m=null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;if(m!==null)i=m;else{i=b;m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="-"?(o="-",b+=1):(o=null,n&&k('"-"')),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(t=ra(),t!==null?m=[m,o,s,t]:(m=null,b=i)):
(m=null,b=i)}else m=null,b=i;else m=null,b=i;if(m!==null)i=m;else{i=b;m=sa();m===null&&(m=sa(),m=m!==null?m:null);if(m!==null){o=b;s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)==="*"?(t="*",b+=1):(t=null,n&&k('"*"')),t!==null){for(var v=[],u=q();u!==null;)v.push(u),u=q();v!==null?(u=$(),u!==null?s=[s,t,v,u]:(s=null,b=o)):(s=null,b=o)}else s=null,b=o;else s=null,b=o;if(s!==null)o=s;else{o=b;s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)==="/"?(t="/",b+=
1):(t=null,n&&k('"/"')),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();v!==null?(u=$(),u!==null?s=[s,t,v,u]:(s=null,b=o)):(s=null,b=o)}else s=null,b=o;else s=null,b=o;o=s!==null?s:null}o=o!==null?o:"";o!==null?m=[m,o]:(m=null,b=i)}else m=null,b=i;i=m!==null?m:null}}for(;i!==null;){j.push(i);i=b;m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="+"?(o="+",b+=1):(o=null,n&&k('"+"')),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(t=ra(),t!==null?m=[m,o,s,t]:(m=
null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;if(m!==null)i=m;else{i=b;m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="-"?(o="-",b+=1):(o=null,n&&k('"-"')),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(t=ra(),t!==null?m=[m,o,s,t]:(m=null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;if(m!==null)i=m;else{i=b;m=sa();m===null&&(m=sa(),m=m!==null?m:null);if(m!==null){o=b;s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)==="*"?
(t="*",b+=1):(t=null,n&&k('"*"')),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();v!==null?(u=$(),u!==null?s=[s,t,v,u]:(s=null,b=o)):(s=null,b=o)}else s=null,b=o;else s=null,b=o;if(s!==null)o=s;else{o=b;s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)==="/"?(t="/",b+=1):(t=null,n&&k('"/"')),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();v!==null?(u=$(),u!==null?s=[s,t,v,u]:(s=null,b=o)):(s=null,b=o)}else s=null,b=o;else s=null,b=o;o=s!==null?s:null}o=o!==null?o:"";o!==
null?m=[m,o]:(m=null,b=i)}else m=null,b=i;i=m!==null?m:null}}}j!==null?e=[e,j]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b.length===0)return a;var d={token:"expression",expressionType:"additiveexpression"};d.summand=a;d.summands=[];for(var e=0;e<b.length;e++){var c=b[e],f={};if(c.length==4&&typeof c[1]==="string")f.operator=c[1],f.expression=c[3];else{var c={},h=f[0],k=f[1][1],g=f[1][3],k=null;h.value<0?(f.operator="-",h.value=-h.value):f.operator="+";c.token="expression";c.expressionType=
"multiplicativeexpression";c.operator=h;c.factors=[{operator:k,expression:g}];f.expression=c}d.summands.push(f)}return d}(e[0],e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[101] AdditiveExpression");y[f]={nextPos:b,result:d};return d}function ra(){var f="MultiplicativeExpression@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b,e=$();if(e!==null){for(var j=[],i=b,m=[],o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="*"?(o="*",b+=1):(o=null,n&&k('"*"')),o!==null){for(var s=
[],t=q();t!==null;)s.push(t),t=q();s!==null?(t=$(),t!==null?m=[m,o,s,t]:(m=null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;if(m!==null)i=m;else{i=b;m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="/"?(o="/",b+=1):(o=null,n&&k('"/"')),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(t=$(),t!==null?m=[m,o,s,t]:(m=null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;i=m!==null?m:null}for(;i!==null;){j.push(i);i=b;m=[];for(o=q();o!==null;)m.push(o),o=q();
if(m!==null)if(a.substr(b,1)==="*"?(o="*",b+=1):(o=null,n&&k('"*"')),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(t=$(),t!==null?m=[m,o,s,t]:(m=null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;if(m!==null)i=m;else{i=b;m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,1)==="/"?(o="/",b+=1):(o=null,n&&k('"/"')),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(t=$(),t!==null?m=[m,o,s,t]:(m=null,b=i)):(m=null,b=i)}else m=null,b=i;else m=null,b=i;i=m!==
null?m:null}}j!==null?e=[e,j]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b.length===0)return a;var d={token:"expression",expressionType:"multiplicativeexpression"};d.factor=a;d.factors=[];for(var e=0;e<b.length;e++){var c=b[e],f={};f.operator=c[1];f.expression=c[3];d.factors.push(f)}return d}(e[0],e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[102] MultiplicativeExpression");y[f]={nextPos:b,result:d};return d}function $(){var f="UnaryExpression@"+b,h=y[f];if(h)return b=h.nextPos,
h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,1)==="!"){var e="!";b+=1}else e=null,n&&k('"!"');if(e!==null){for(var g=[],j=q();j!==null;)g.push(j),j=q();g!==null?(j=Ca(),j!==null?e=[e,g,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"};b.expression=a;return b}(e[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="+"?(e="+",b+=1):(e=null,n&&k('"+"'));if(e!==null){g=[];for(j=q();j!==
null;)g.push(j),j=q();g!==null?(j=Ca(),j!==null?e=[e,g,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};b.expression=a;return b}(e[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="-"?(e="-",b+=1):(e=null,n&&k('"-"'));if(e!==null){g=[];for(j=q();j!==null;)g.push(j),j=q();g!==null?(j=Ca(),j!==null?e=[e,g,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){var b=
{token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};b.expression=a;return b}(e[2]):null;d===null&&(d=null,b=i);d!==null?i=d:(i=Ca(),i=i!==null?i:null)}}(n=h)&&i===null&&k("[103] UnaryExpression");y[f]={nextPos:b,result:i};return i}function Ca(){var a="PrimaryExpression@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Ga();if(f===null&&(f=Fa(),f===null&&(f=bc(),f===null))){var f=b,d=Ha(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"};
b.value=a;return b}(d):null;d===null&&(d=null,b=f);d!==null?f=d:(f=b,d=Ia(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};b.value=a;return b}(d):null,d===null&&(d=null,b=f),d!==null?f=d:(f=b,d=Ja(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};b.value=a;return b}(d):null,d===null&&(d=null,b=f),d!==null?f=d:(f=cc(),f===null&&(f=b,d=Q(),d=d!==null?function(a){var b={token:"expression",
expressionType:"atomic",primaryexpression:"var"};b.value=a;return b}(d):null,d===null&&(d=null,b=f),f=d!==null?d:null))))}(n=c)&&f===null&&k("[104] PrimaryExpression");y[a]={nextPos:b,result:f};return f}function Ga(){var f="BrackettedExpression@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,1)==="("){var e="(";b+=1}else e=null,n&&k('"("');if(e!==null){for(var j=[],g=q();g!==null;)j.push(g),g=q();if(j!==null)if(g=M(),g!==null){for(var m=[],o=q();o!==null;)m.push(o),
o=q();m!==null?(a.substr(b,1)===")"?(o=")",b+=1):(o=null,n&&k('")"')),o!==null?e=[e,j,g,m,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?e[2]:null;d===null&&(d=null,b=i);(n=h)&&d===null&&k("[105] BrackettedExpression");y[f]={nextPos:b,result:d};return d}function Fa(){var f="BuiltInCall@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b,3)==="STR"){var e="STR";b+=3}else e=null,n&&k('"STR"');e===null&&(a.substr(b,3)==="str"?(e="str",
b+=3):(e=null,n&&k('"str"')),e=e!==null?e:null);if(e!==null){for(var j=[],g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){for(var m=[],o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){for(var s=[],t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=
d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"str"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,4)==="LANG"?(e="LANG",b+=4):(e=null,n&&k('"LANG"'));e===null&&(a.substr(b,4)==="lang"?(e="lang",b+=4):(e=null,n&&k('"lang"')),e=e!==null?e:null);if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),
o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"lang"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,11)==="LANGMATCHES"?(e="LANGMATCHES",
b+=11):(e=null,n&&k('"LANGMATCHES"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)===","?(t=",",b+=1):(t=null,n&&k('","')),t!==null){for(var v=[],u=q();u!==null;)v.push(u),u=q();if(v!==null)if(u=M(),u!==null){for(var x=[],z=q();z!==null;)x.push(z),z=q();x!==null?(a.substr(b,
1)===")"?(z=")",b+=1):(z=null,n&&k('")"')),z!==null?e=[e,j,g,m,o,s,t,v,u,x,z]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){var d={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};d.args=[a,b];return d}(e[4],e[8]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,8)==="DATATYPE"?(e="DATATYPE",b+=8):(e=null,n&&
k('"DATATYPE"'));e===null&&(a.substr(b,8)==="datatype"?(e="datatype",b+=8):(e=null,n&&k('"datatype"')),e=e!==null?e:null);if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;
else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"datatype"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,5)==="BOUND"?(e="BOUND",b+=5):(e=null,n&&k('"BOUND"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=
Q(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bound"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,3)==="IRI"?(e="IRI",b+=3):(e=null,n&&k('"IRI"'));if(e!==
null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",
builtincall:"iri"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,3)==="URI"?(e="URI",b+=3):(e=null,n&&k('"URI"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=
null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"uri"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,5)==="BNODE"?(e="BNODE",b+=5):(e=null,n&&k('"BNODE"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null){g=b;a.substr(b,1)==="("?(m="(",b+=1):(m=null,n&&k('"("'));if(m!==null){o=[];for(s=q();s!==
null;)o.push(s),s=q();if(o!==null)if(s=M(),s!==null){t=[];for(v=q();v!==null;)t.push(v),v=q();t!==null?(a.substr(b,1)===")"?(v=")",b+=1):(v=null,n&&k('")"')),v!==null?m=[m,o,s,t,v]:(m=null,b=g)):(m=null,b=g)}else m=null,b=g;else m=null,b=g}else m=null,b=g;m!==null?g=m:(g=la(),g=g!==null?g:null);g!==null?e=[e,j,g]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bnode"};b.args=a.length===5?[a[2]]:null;return b}(e[2]):
null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,8)==="COALESCE"?(e="COALESCE",b+=8):(e=null,n&&k('"COALESCE"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();j!==null?(g=Pb(),g!==null?e=[e,j,g]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};b.args=a;return b}(e[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,2)==="IF"?(e="IF",b+=2):(e=null,n&&k('"IF"'));
if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)===","?(t=",",b+=1):(t=null,n&&k('","')),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();if(v!==null)if(u=M(),u!==null){x=[];for(z=q();z!==null;)x.push(z),z=q();if(x!==null)if(a.substr(b,1)===","?(z=",",b+=1):(z=null,n&&k('","')),
z!==null){for(var F=[],B=q();B!==null;)F.push(B),B=q();if(F!==null)if(B=M(),B!==null){for(var O=[],E=q();E!==null;)O.push(E),E=q();O!==null?(a.substr(b,1)===")"?(E=")",b+=1):(E=null,n&&k('")"')),E!==null?e=[e,j,g,m,o,s,t,v,u,x,z,F,B,O,E]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,d){var e=
{token:"expression",expressionType:"builtincall",builtincall:"if"};e.args=[a,b,d];return e}(e[4],e[8],e[12]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,9)==="ISLITERAL"?(e="ISLITERAL",b+=9):(e=null,n&&k('"ISLITERAL"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,
1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,7)==="ISBLANK"?(e="ISBLANK",b+=7):(e=null,n&&k('"ISBLANK"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,
1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isblank"};b.args=[a];return b}(e[4]):null;d===
null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,8)==="SAMETERM"?(e="SAMETERM",b+=8):(e=null,n&&k('"SAMETERM"'));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)===","?(t=",",b+=1):(t=null,n&&k('","')),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();if(v!==null)if(u=
M(),u!==null){x=[];for(z=q();z!==null;)x.push(z),z=q();x!==null?(a.substr(b,1)===")"?(z=")",b+=1):(z=null,n&&k('")"')),z!==null?e=[e,j,g,m,o,s,t,v,u,x,z]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){var d={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};d.args=[a,b];return d}(e[4],e[8]):null;d===null&&(d=null,b=i);if(d!==null)i=
d;else{d=i=b;a.substr(b,5)==="ISURI"?(e="ISURI",b+=5):(e=null,n&&k('"ISURI"'));e===null&&(a.substr(b,5)==="isuri"?(e="isuri",b+=5):(e=null,n&&k('"isuri"')),e===null&&(a.substr(b,5)==="ISIRI"?(e="ISIRI",b+=5):(e=null,n&&k('"ISIRI"')),e===null&&(a.substr(b,5)==="isiri"?(e="isiri",b+=5):(e=null,n&&k('"isiri"')),e=e!==null?e:null)));if(e!==null){j=[];for(g=q();g!==null;)j.push(g),g=q();if(j!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,n&&k('"("')),g!==null){m=[];for(o=q();o!==null;)m.push(o),o=
q();if(m!==null)if(o=M(),o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,n&&k('")"')),t!==null?e=[e,j,g,m,o,s,t]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isuri"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=i);d!==null?i=d:(i=dc(),i===null&&(i=ec(),i===null&&(i=fc(),i=i!==null?i:null)))}}}}}}}}}}}}}(n=
h)&&i===null&&k("[106] BuiltInCall");y[f]={nextPos:b,result:i};return i}function dc(){var f="RegexExpression@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,5)==="REGEX"){var e="REGEX";b+=5}else e=null,n&&k('"REGEX"');e===null&&(a.substr(b,5)==="regex"?(e="regex",b+=5):(e=null,n&&k('"regex"')),e=e!==null?e:null);if(e!==null){for(var j=[],i=q();i!==null;)j.push(i),i=q();if(j!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){for(var m=[],o=q();o!==
null;)m.push(o),o=q();if(m!==null)if(o=M(),o!==null){for(var s=[],t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)===","?(t=",",b+=1):(t=null,n&&k('","')),t!==null){for(var v=[],u=q();u!==null;)v.push(u),u=q();if(v!==null)if(u=M(),u!==null){for(var x=[],z=q();z!==null;)x.push(z),z=q();if(x!==null){z=b;if(a.substr(b,1)===","){var F=",";b+=1}else F=null,n&&k('","');if(F!==null){for(var B=[],O=q();O!==null;)B.push(O),O=q();B!==null?(O=M(),O!==null?F=[F,B,O]:(F=null,b=z)):(F=null,b=z)}else F=
null,b=z;z=F!==null?F:"";if(z!==null){F=[];for(B=q();B!==null;)F.push(B),B=q();F!==null?(a.substr(b,1)===")"?(B=")",b+=1):(B=null,n&&k('")"')),B!==null?e=[e,j,i,m,o,s,t,v,u,x,z,F,B]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d}else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b,d){var e={token:"expression",expressionType:"regex"};e.text=a;e.pattern=b;e.flags=d[2];return e}(e[4],
e[8],e[10]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[107] RegexExpression");y[f]={nextPos:b,result:d};return d}function ec(){var f="ExistsFunc@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,6)==="EXISTS"){var e="EXISTS";b+=6}else e=null,n&&k('"EXISTS"');e===null&&(a.substr(b,6)==="exists"?(e="exists",b+=6):(e=null,n&&k('"exists"')),e=e!==null?e:null);if(e!==null){for(var i=[],j=q();j!==null;)i.push(j),j=q();i!==null?(j=W(),j!==null?e=[e,i,j]:(e=null,b=d)):(e=
null,b=d)}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"exists"};b.args=[a];return b}(e[2]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[108] ExistsFunc");y[f]={nextPos:b,result:d};return d}function fc(){var f="NotExistsFunc@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,3)==="NOT"){var e="NOT";b+=3}else e=null,n&&k('"NOT"');e===null&&(a.substr(b,3)==="not"?(e="not",b+=3):(e=null,n&&k('"not"')),e=e!==
null?e:null);if(e!==null){for(var i=[],j=q();j!==null;)i.push(j),j=q();if(i!==null)if(a.substr(b,6)==="EXISTS"?(j="EXISTS",b+=6):(j=null,n&&k('"EXISTS"')),j===null&&(a.substr(b,6)==="exists"?(j="exists",b+=6):(j=null,n&&k('"exists"')),j=j!==null?j:null),j!==null){for(var m=[],o=q();o!==null;)m.push(o),o=q();m!==null?(o=W(),o!==null?e=[e,i,j,m,o]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a){var b={token:"expression",expressionType:"builtincall",
builtincall:"notexists"};b.args=[a];return b}(e[4]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[109] NotExistsFunc");y[f]={nextPos:b,result:d};return d}function cc(){var f="Aggregate@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,5)==="COUNT"){var e="COUNT";b+=5}else e=null,n&&k('"COUNT"');e===null&&(a.substr(b,5)==="count"?(e="count",b+=5):(e=null,n&&k('"count"')),e=e!==null?e:null);if(e!==null){for(var j=[],i=q();i!==null;)j.push(i),i=q();if(j!==null)if(a.substr(b,
1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){for(var m=[],o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,8)==="DISTINCT"?(o="DISTINCT",b+=8):(o=null,n&&k('"DISTINCT"')),o===null&&(a.substr(b,8)==="distinct"?(o="distinct",b+=8):(o=null,n&&k('"distinct"')),o=o!==null?o:null),o=o!==null?o:"",o!==null){for(var s=[],t=q();t!==null;)s.push(t),t=q();if(s!==null)if(a.substr(b,1)==="*"?(t="*",b+=1):(t=null,n&&k('"*"')),t===null&&(t=M(),t=t!==null?t:null),t!==null){for(var v=[],u=q();u!==
null;)v.push(u),u=q();if(v!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,n&&k('")"')),u!==null){for(var x=[],z=q();z!==null;)x.push(z),z=q();x!==null?e=[e,j,i,m,o,s,t,v,u,x]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){exp={token:"expression",expressionType:"aggregate",aggregateType:"count"};exp.distinct=a!=""?"DISTINCT":a;exp.expression=b;return exp}(e[4],
e[6]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="SUM"?(e="SUM",b+=3):(e=null,n&&k('"SUM"'));e===null&&(a.substr(b,3)==="sum"?(e="sum",b+=3):(e=null,n&&k('"sum"')),e=e!==null?e:null);if(e!==null){j=[];for(i=q();i!==null;)j.push(i),i=q();if(j!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,8)==="DISTINCT"?(o="DISTINCT",b+=8):(o=null,n&&k('"DISTINCT"')),o===null&&(a.substr(b,8)===
"distinct"?(o="distinct",b+=8):(o=null,n&&k('"distinct"')),o=o!==null?o:null),o=o!==null?o:"",o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(t=M(),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();if(v!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,n&&k('")"')),u!==null){x=[];for(z=q();z!==null;)x.push(z),z=q();x!==null?e=[e,j,i,m,o,s,t,v,u,x]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=
null,b=d}else e=null,b=d;d=e!==null?function(a,b){exp={token:"expression",expressionType:"aggregate",aggregateType:"sum"};exp.distinct=a!=""?"DISTINCT":a;exp.expression=b;return exp}(e[4],e[6]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="MIN"?(e="MIN",b+=3):(e=null,n&&k('"MIN"'));e===null&&(a.substr(b,3)==="min"?(e="min",b+=3):(e=null,n&&k('"min"')),e=e!==null?e:null);if(e!==null){j=[];for(i=q();i!==null;)j.push(i),i=q();if(j!==null)if(a.substr(b,1)==="("?(i="(",b+=1):
(i=null,n&&k('"("')),i!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,8)==="DISTINCT"?(o="DISTINCT",b+=8):(o=null,n&&k('"DISTINCT"')),o===null&&(a.substr(b,8)==="distinct"?(o="distinct",b+=8):(o=null,n&&k('"distinct"')),o=o!==null?o:null),o=o!==null?o:"",o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(t=M(),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();if(v!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,n&&k('")"')),u!==null){x=[];for(z=q();z!==
null;)x.push(z),z=q();x!==null?e=[e,j,i,m,o,s,t,v,u,x]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){exp={token:"expression",expressionType:"aggregate",aggregateType:"min"};exp.distinct=a!=""?"DISTINCT":a;exp.expression=b;return exp}(e[4],e[6]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="MAX"?(e="MAX",b+=3):(e=null,n&&k('"MAX"'));e===null&&
(a.substr(b,3)==="max"?(e="max",b+=3):(e=null,n&&k('"max"')),e=e!==null?e:null);if(e!==null){j=[];for(i=q();i!==null;)j.push(i),i=q();if(j!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,8)==="DISTINCT"?(o="DISTINCT",b+=8):(o=null,n&&k('"DISTINCT"')),o===null&&(a.substr(b,8)==="distinct"?(o="distinct",b+=8):(o=null,n&&k('"distinct"')),o=o!==null?o:null),o=o!==null?o:"",o!==null){s=[];for(t=q();t!==null;)s.push(t),
t=q();if(s!==null)if(t=M(),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();if(v!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,n&&k('")"')),u!==null){x=[];for(z=q();z!==null;)x.push(z),z=q();x!==null?e=[e,j,i,m,o,s,t,v,u,x]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){exp={token:"expression",expressionType:"aggregate",aggregateType:"max"};exp.distinct=a!=
""?"DISTINCT":a;exp.expression=b;return exp}(e[4],e[6]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="AVG"?(e="AVG",b+=3):(e=null,n&&k('"AVG"'));e===null&&(a.substr(b,3)==="avg"?(e="avg",b+=3):(e=null,n&&k('"avg"')),e=e!==null?e:null);if(e!==null){j=[];for(i=q();i!==null;)j.push(i),i=q();if(j!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,n&&k('"("')),i!==null){m=[];for(o=q();o!==null;)m.push(o),o=q();if(m!==null)if(a.substr(b,8)==="DISTINCT"?(o="DISTINCT",b+=8):(o=null,
n&&k('"DISTINCT"')),o===null&&(a.substr(b,8)==="distinct"?(o="distinct",b+=8):(o=null,n&&k('"distinct"')),o=o!==null?o:null),o=o!==null?o:"",o!==null){s=[];for(t=q();t!==null;)s.push(t),t=q();if(s!==null)if(t=M(),t!==null){v=[];for(u=q();u!==null;)v.push(u),u=q();if(v!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,n&&k('")"')),u!==null){x=[];for(z=q();z!==null;)x.push(z),z=q();x!==null?e=[e,j,i,m,o,s,t,v,u,x]:(e=null,b=d)}else e=null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=
null,b=d;else e=null,b=d}else e=null,b=d;else e=null,b=d}else e=null,b=d;d=e!==null?function(a,b){exp={token:"expression",expressionType:"aggregate",aggregateType:"avg"};exp.distinct=a!=""?"DISTINCT":a;exp.expression=b;return exp}(e[4],e[6]):null;d===null&&(d=null,b=g);g=d!==null?d:null}}}}(n=h)&&g===null&&k("[110] Aggregate");y[f]={nextPos:b,result:g};return g}function bc(){var a="IRIrefOrFunction@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=R();if(e!==null){var h=lb(),h=h!==
null?h:"";h!==null?e=[e,h]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){var d={token:"expression",expressionType:"irireforfunction"};d.iriref=a;d.args=b.value;return d}(e[0],e[1]):null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[117] IRIrefOrFunction");y[a]={nextPos:b,result:d};return d}function Ha(){var f="RDFLiteral@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b,e=gc();if(e!==null){var i=hc();if(i===null){i=b;if(a.substr(b,2)==="^^"){var j="^^";b+=2}else j=null,n&&k('"^^"');
if(j!==null){var m=R();m!==null?j=[j,m]:(j=null,b=i)}else j=null,b=i;i=j!==null?j:null}i=i!==null?i:"";i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){return typeof b==="string"&&b.length>0?{token:"literal",value:a.value,lang:b.slice(1),type:null}:typeof b==="object"?(b.shift(),{token:"literal",value:a.value,lang:null,type:b[0]}):{token:"literal",value:a.value,lang:null,type:null}}(e[0],e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[112] RDFLiteral");y[f]={nextPos:b,
result:d};return d}function Ia(){var a="NumericLiteral@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=ic();f===null&&(f=jc(),f===null&&(f=sa(),f=f!==null?f:null));(n=c)&&f===null&&k("[113] NumericLiteral");y[a]={nextPos:b,result:f};return f}function ic(){var a="NumericLiteralUnsigned@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=Ta();f===null&&(f=Ua(),f===null&&(f=ca(),f=f!==null?f:null));(n=c)&&f===null&&k("[114] NumericLiteralUnsigned");y[a]={nextPos:b,result:f};return f}
function jc(){var a="NumericLiteralPositive@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=kc();f===null&&(f=lc(),f===null&&(f=mc(),f=f!==null?f:null));(n=c)&&f===null&&k("[115] NumericLiteralPositive");y[a]={nextPos:b,result:f};return f}function sa(){var a="NumericLiteralNegative@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=nc();f===null&&(f=oc(),f===null&&(f=pc(),f=f!==null?f:null));(n=c)&&f===null&&k("[116] NumericLiteralNegative");y[a]={nextPos:b,result:f};return f}function Ja(){var f=
"BooleanLiteral@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b;if(a.substr(b,4)==="TRUE"){var d="TRUE";b+=4}else d=null,n&&k('"TRUE"');d===null&&(a.substr(b,4)==="true"?(d="true",b+=4):(d=null,n&&k('"true"')),d=d!==null?d:null);d=d!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}:null;d===null&&(d=null,b=g);d!==null?g=d:(g=b,a.substr(b,5)==="FALSE"?(d="FALSE",b+=5):(d=null,n&&k('"FALSE"')),d===null&&(a.substr(b,5)==="false"?(d="false",b+=5):
(d=null,n&&k('"false"')),d=d!==null?d:null),d=d!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}:null,d===null&&(d=null,b=g),g=d!==null?d:null);(n=h)&&g===null&&k("[117] BooleanLiteral");y[f]={nextPos:b,result:g};return g}function gc(){var a="String@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=qc(),d=d!==null?{token:"string",value:d}:null;d===null&&(d=null,b=f);d!==null?f=d:(f=b,d=rc(),d=d!==null?{token:"string",value:d}:null,d===null&&
(d=null,b=f),d!==null?f=d:(f=b,d=sc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=f),d!==null?f=d:(f=b,d=tc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=f),f=d!==null?d:null)));(n=c)&&f===null&&k("[118] String");y[a]={nextPos:b,result:f};return f}function R(){var a="IRIref@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=na(),d=d!==null?{token:"uri",prefix:null,suffix:null,value:d}:null;d===null&&(d=null,b=f);d!==null?f=d:(f=b,d=uc(),d=d!==null?d:null,
d===null&&(d=null,b=f),f=d!==null?d:null);(n=c)&&f===null&&k("[119] IRIref");y[a]={nextPos:b,result:f};return f}function uc(){var a="PrefixedName@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=vc(),d=d!==null?{token:"uri",prefix:d[0],suffix:d[1],value:null}:null;d===null&&(d=null,b=f);d!==null?f=d:(f=b,d=Ea(),d=d!==null?{token:"uri",prefix:d,suffix:"",value:null}:null,d===null&&(d=null,b=f),f=d!==null?d:null);(n=c)&&f===null&&k("[120] PrefixedName");y[a]={nextPos:b,result:f};return f}
function ac(){var a="BlankNode@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=wc(),d=d!==null?{token:"blank",value:d}:null;d===null&&(d=null,b=f);d!==null?f=d:(f=b,xc()!==null?(ea++,d={token:"blank",value:"_:"+ea}):d=null,d===null&&(d=null,b=f),f=d!==null?d:null);(n=c)&&f===null&&k("[121] BlankNode");y[a]={nextPos:b,result:f};return f}function na(){var f="IRI_REF@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="<"){var e="<";b+=1}else e=null,n&&
k('"<"');if(e!==null){var i=[];if(a.substr(b).match(/^[^<>"{}|^`\\]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k('[^<>"{}|^`\\\\]');for(;j!==null;)i.push(j),a.substr(b).match(/^[^<>"{}|^`\\]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k('[^<>"{}|^`\\\\]'));i!==null?(a.substr(b,1)===">"?(j=">",b+=1):(j=null,n&&k('">"')),j!==null?e=[e,i,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?e[1].join(""):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[122] IRI_REF");y[f]={nextPos:b,result:d};return d}
function Ea(){var f="PNAME_NS@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b,e=ab(),e=e!==null?e:"";if(e!==null){if(a.substr(b,1)===":"){var i=":";b+=1}else i=null,n&&k('":"');i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[0]:null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[123] PNAME_NS");y[f]={nextPos:b,result:d};return d}function vc(){var a="PNAME_LN@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=n;n=!1;var f=b,d=b,e=Ea();if(e!==null){var h=pb();h!==null?e=[e,h]:(e=
null,b=d)}else e=null,b=d;d=e!==null?[e[0],e[1]]:null;d===null&&(d=null,b=f);(n=c)&&d===null&&k("[124] PNAME_LN");y[a]={nextPos:b,result:d};return d}function wc(){var f="BLANK_NODE_LABEL@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,2)==="_:"){var e="_:";b+=2}else e=null,n&&k('"_:"');if(e!==null){var i=pb();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[125] BLANK_NODE_LABEL");y[f]={nextPos:b,result:d};
return d}function Zb(){var f="VAR1@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="?"){var e="?";b+=1}else e=null,n&&k('"?"');if(e!==null){var i=qb();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[126] VAR1");y[f]={nextPos:b,result:d};return d}function $b(){var f="VAR2@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="$"){var e="$";b+=1}else e=null,n&&k('"$"');if(e!==
null){var i=qb();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[1]:null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[127] VAR2");y[f]={nextPos:b,result:d};return d}function hc(){var f="LANGTAG@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="@"){var e="@";b+=1}else e=null,n&&k('"@"');if(e!==null){if(a.substr(b).match(/^[a-zA-Z]/)!==null){var i=a.charAt(b);b++}else i=null,n&&k("[a-zA-Z]");if(i!==null)for(var j=[];i!==null;)j.push(i),a.substr(b).match(/^[a-zA-Z]/)!==
null?(i=a.charAt(b),b++):(i=null,n&&k("[a-zA-Z]"));else j=null;if(j!==null){var i=[],m=b;if(a.substr(b,1)==="-"){var o="-";b+=1}else o=null,n&&k('"-"');if(o!==null){if(a.substr(b).match(/^[a-zA-Z0-9]/)!==null){var q=a.charAt(b);b++}else q=null,n&&k("[a-zA-Z0-9]");if(q!==null)for(var s=[];q!==null;)s.push(q),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(q=a.charAt(b),b++):(q=null,n&&k("[a-zA-Z0-9]"));else s=null;s!==null?o=[o,s]:(o=null,b=m)}else o=null,b=m;for(;o!==null;)if(i.push(o),m=b,a.substr(b,1)===
"-"?(o="-",b+=1):(o=null,n&&k('"-"')),o!==null){a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(q=a.charAt(b),b++):(q=null,n&&k("[a-zA-Z0-9]"));if(q!==null)for(s=[];q!==null;)s.push(q),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(q=a.charAt(b),b++):(q=null,n&&k("[a-zA-Z0-9]"));else s=null;s!==null?o=[o,s]:(o=null,b=m)}else o=null,b=m;i!==null?e=[e,j,i]:(e=null,b=d)}else e=null,b=d}else e=null,b=d;d=e!==null?e[2].length===0?("@"+e[1].join("")).toLowerCase():("@"+e[1].join("")+"-"+e[2][0][1].join("")).toLowerCase():
null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[128] LANGTAG");y[f]={nextPos:b,result:d};return d}function ca(){var f="INTEGER@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b;if(a.substr(b).match(/^[0-9]/)!==null){var d=a.charAt(b);b++}else d=null,n&&k("[0-9]");if(d!==null)for(var e=[];d!==null;)e.push(d),a.substr(b).match(/^[0-9]/)!==null?(d=a.charAt(b),b++):(d=null,n&&k("[0-9]"));else e=null;d=e!==null?function(a){var b={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"};
b.value=X(a);return b}(e):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[129] INTEGER");y[f]={nextPos:b,result:d};return d}function Ua(){var f="DECIMAL@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b).match(/^[0-9]/)!==null){var e=a.charAt(b);b++}else e=null,n&&k("[0-9]");if(e!==null)for(var i=[];e!==null;)i.push(e),a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]"));else i=null;if(i!==null)if(a.substr(b,1)==="."?(e=".",b+=1):(e=null,n&&k('"."')),
e!==null){var j=[];if(a.substr(b).match(/^[0-9]/)!==null){var m=a.charAt(b);b++}else m=null,n&&k("[0-9]");for(;m!==null;)j.push(m),a.substr(b).match(/^[0-9]/)!==null?(m=a.charAt(b),b++):(m=null,n&&k("[0-9]"));j!==null?i=[i,e,j]:(i=null,b=d)}else i=null,b=d;else i=null,b=d;d=i!==null?function(a,b,d){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};c.value=X([a,b,d]);return c}(i[0],i[1],i[2]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,1)==="."?
(i=".",b+=1):(i=null,n&&k('"."'));if(i!==null){a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]"));if(e!==null)for(j=[];e!==null;)j.push(e),a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]"));else j=null;j!==null?i=[i,j]:(i=null,b=d)}else i=null,b=d;d=i!==null?function(a,b){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};d.value=X([a,b]);return d}(i[0],i[1]):null;d===null&&(d=null,b=g);g=d!==null?d:null}(n=h)&&g===
null&&k("[130] DECIMAL");y[f]={nextPos:b,result:g};return g}function Ta(){var f="DOUBLE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var i=b,d=b;if(a.substr(b).match(/^[0-9]/)!==null){var e=a.charAt(b);b++}else e=null,n&&k("[0-9]");if(e!==null)for(var g=[];e!==null;)g.push(e),a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]"));else g=null;if(g!==null)if(a.substr(b,1)==="."?(e=".",b+=1):(e=null,n&&k('"."')),e!==null){var j=[];if(a.substr(b).match(/^[0-9]/)!==null){var m=
a.charAt(b);b++}else m=null,n&&k("[0-9]");for(;m!==null;)j.push(m),a.substr(b).match(/^[0-9]/)!==null?(m=a.charAt(b),b++):(m=null,n&&k("[0-9]"));j!==null?(m=Va(),m!==null?g=[g,e,j,m]:(g=null,b=d)):(g=null,b=d)}else g=null,b=d;else g=null,b=d;d=g!==null?function(a,b,d,c){var e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};e.value=X([a,b,d,c]);return e}(g[0],g[1],g[2],g[3]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="."?(g=".",b+=1):(g=null,n&&
k('"."'));if(g!==null){a.substr(b).match(/^[0-9]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[0-9]"));if(j!==null)for(e=[];j!==null;)e.push(j),a.substr(b).match(/^[0-9]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[0-9]"));else e=null;e!==null?(j=Va(),j!==null?g=[g,e,j]:(g=null,b=d)):(g=null,b=d)}else g=null,b=d;d=g!==null?function(a,b,d){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};c.value=X([a,b,d]);return c}(g[0],g[1],g[2]):null;d===null&&(d=null,b=i);if(d!==null)i=
d;else{d=i=b;a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]"));if(e!==null)for(g=[];e!==null;)g.push(e),a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]"));else g=null;g!==null?(e=Va(),e!==null?g=[g,e]:(g=null,b=d)):(g=null,b=d);d=g!==null?function(a,b){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};d.value=X([a,b]);return d}(g[0],g[1]):null;d===null&&(d=null,b=i);i=d!==null?d:null}}(n=h)&&i===null&&k("[131] DOUBLE");
y[f]={nextPos:b,result:i};return i}function mc(){var f="INTEGER_POSITIVE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="+"){var e="+";b+=1}else e=null,n&&k('"+"');if(e!==null){var i=ca();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.value="+"+a.value;return a}(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[132] INTEGER_POSITIVE");y[f]={nextPos:b,result:d};return d}function lc(){var f="DECIMAL_POSITIVE@"+b,h=y[f];if(h)return b=
h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="+"){var e="+";b+=1}else e=null,n&&k('"+"');if(e!==null){var i=Ua();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.value="+"+a.value;return a}(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[133] DECIMAL_POSITIVE");y[f]={nextPos:b,result:d};return d}function kc(){var f="DOUBLE_POSITIVE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="+"){var e="+";b+=1}else e=null,n&&k('"+"');
if(e!==null){var i=Ta();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.value="+"+a.value;return a}(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[134] DOUBLE_POSITIVE");y[f]={nextPos:b,result:d};return d}function pc(){var f="INTEGER_NEGATIVE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="-"){var e="-";b+=1}else e=null,n&&k('"-"');if(e!==null){var i=ca();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.value=
"-"+a.value;return a}(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[135] INTEGER_NEGATIVE");y[f]={nextPos:b,result:d};return d}function oc(){var f="DECIMAL_NEGATIVE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="-"){var e="-";b+=1}else e=null,n&&k('"-"');if(e!==null){var i=Ua();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.value="-"+a.value;return a}(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[136] DECIMAL_NEGATIVE");
y[f]={nextPos:b,result:d};return d}function nc(){var f="DOUBLE_NEGATIVE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="-"){var e="-";b+=1}else e=null,n&&k('"-"');if(e!==null){var i=Ta();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a){a.value="-"+a.value;return a}(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[137] DOUBLE_NEGATIVE");y[f]={nextPos:b,result:d};return d}function Va(){var f="EXPONENT@"+b,h=y[f];if(h)return b=h.nextPos,
h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b).match(/^[eE]/)!==null){var e=a.charAt(b);b++}else e=null,n&&k("[eE]");if(e!==null){if(a.substr(b).match(/^[+\-]/)!==null){var i=a.charAt(b);b++}else i=null,n&&k("[+\\-]");i=i!==null?i:"";if(i!==null){if(a.substr(b).match(/^[0-9]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k("[0-9]");if(j!==null)for(var m=[];j!==null;)m.push(j),a.substr(b).match(/^[0-9]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[0-9]"));else m=null;m!==null?e=[e,i,m]:(e=null,b=d)}else e=
null,b=d}else e=null,b=d;d=e!==null?X([e[0],e[1],e[2]]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[138] EXPONENT");y[f]={nextPos:b,result:d};return d}function sc(){var f="STRING_LITERAL1@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)==="'"){var e="'";b+=1}else e=null,n&&k('"\'"');if(e!==null){var i=[];if(a.substr(b).match(/^[^'\\\n\r]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k("[^'\\\\\\n\\r]");j===null&&(j=fa(),j=j!==null?j:null);for(;j!==null;)i.push(j),
a.substr(b).match(/^[^'\\\n\r]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[^'\\\\\\n\\r]")),j===null&&(j=fa(),j=j!==null?j:null);i!==null?(a.substr(b,1)==="'"?(j="'",b+=1):(j=null,n&&k('"\'"')),j!==null?e=[e,i,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?X(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[139] STRING_LITERAL1");y[f]={nextPos:b,result:d};return d}function tc(){var f="STRING_LITERAL2@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,1)===
'"'){var e='"';b+=1}else e=null,n&&k('"\\""');if(e!==null){var i=[];if(a.substr(b).match(/^[^"\\\n\r]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k('[^"\\\\\\n\\r]');j===null&&(j=fa(),j=j!==null?j:null);for(;j!==null;)i.push(j),a.substr(b).match(/^[^"\\\n\r]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k('[^"\\\\\\n\\r]')),j===null&&(j=fa(),j=j!==null?j:null);i!==null?(a.substr(b,1)==='"'?(j='"',b+=1):(j=null,n&&k('"\\""')),j!==null?e=[e,i,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?X(e[1]):
null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[140] STRING_LITERAL2");y[f]={nextPos:b,result:d};return d}function qc(){var f="STRING_LITERAL_LONG1@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,3)==="'''"){var e="'''";b+=3}else e=null,n&&k("\"'''\"");if(e!==null){var i=[];if(a.substr(b).match(/^[^'\\]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k("[^'\\\\]");j===null&&(j=fa(),j=j!==null?j:null);for(;j!==null;)i.push(j),a.substr(b).match(/^[^'\\]/)!==null?(j=a.charAt(b),
b++):(j=null,n&&k("[^'\\\\]")),j===null&&(j=fa(),j=j!==null?j:null);i!==null?(a.substr(b,3)==="'''"?(j="'''",b+=3):(j=null,n&&k("\"'''\"")),j!==null?e=[e,i,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?X(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[141] STRING_LITERAL_LONG1");y[f]={nextPos:b,result:d};return d}function rc(){var f="STRING_LITERAL_LONG2@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var g=b,d=b;if(a.substr(b,3)==='"""'){var e='"""';b+=3}else e=null,n&&k('"\\"\\"\\""');
if(e!==null){var i=[];if(a.substr(b).match(/^[^"\\]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k('[^"\\\\]');j===null&&(j=fa(),j=j!==null?j:null);for(;j!==null;)i.push(j),a.substr(b).match(/^[^"\\]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k('[^"\\\\]')),j===null&&(j=fa(),j=j!==null?j:null);i!==null?(a.substr(b,3)==='"""'?(j='"""',b+=3):(j=null,n&&k('"\\"\\"\\""')),j!==null?e=[e,i,j]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?X(e[1]):null;d===null&&(d=null,b=g);(n=h)&&d===null&&k("[142] STRING_LITERAL_LONG2");
y[f]={nextPos:b,result:d};return d}function fa(){var f="ECHAR@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b;if(a.substr(b,1)==="\\"){var d="\\";b+=1}else d=null,n&&k('"\\\\"');if(d!==null){if(a.substr(b).match(/^[tbnrf"']/)!==null){var e=a.charAt(b);b++}else e=null,n&&k("[tbnrf\"']");e!==null?d=[d,e]:(d=null,b=j)}else d=null,b=j;(n=h)&&d===null&&k("[143] ECHAR");y[f]={nextPos:b,result:d};return d}function la(){var f="NIL@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,
d=b;if(a.substr(b,1)==="("){var e="(";b+=1}else e=null,n&&k('"("');if(e!==null){for(var g=[],i=q();i!==null;)g.push(i),i=q();g!==null?(a.substr(b,1)===")"?(i=")",b+=1):(i=null,n&&k('")"')),i!==null?e=[e,g,i]:(e=null,b=d)):(e=null,b=d)}else e=null,b=d;d=e!==null?{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}:null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[144] NIL");y[f]={nextPos:b,result:d};return d}function q(){var f=
"WS@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;if(a.substr(b).match(/^[ ]/)!==null){var j=a.charAt(b);b++}else j=null,n&&k("[ ]");j===null&&(a.substr(b).match(/^[\t]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\t]")),j===null&&(a.substr(b).match(/^[\r]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\r]")),j===null&&(a.substr(b).match(/^[\n]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\n]")),j===null&&(j=yc(),j=j!==null?j:null))));(n=h)&&j===null&&k("[145] WS");y[f]={nextPos:b,result:j};return j}
function yc(){var f="COMMENT@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b;if(a.substr(b,1)==="#"){var d="#";b+=1}else d=null,n&&k('"#"');if(d!==null){var e=[];if(a.substr(b).match(/^[^\n\r]/)!==null){var g=a.charAt(b);b++}else g=null,n&&k("[^\\n\\r]");for(;g!==null;)e.push(g),a.substr(b).match(/^[^\n\r]/)!==null?(g=a.charAt(b),b++):(g=null,n&&k("[^\\n\\r]"));e!==null?d=[d,e]:(d=null,b=j)}else d=null,b=j;(n=h)&&d===null&&k(" COMMENT");y[f]={nextPos:b,result:d};return d}function xc(){var f=
"ANON@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b;if(a.substr(b,1)==="["){var d="[";b+=1}else d=null,n&&k('"["');if(d!==null){for(var e=[],g=q();g!==null;)e.push(g),g=q();e!==null?(a.substr(b,1)==="]"?(g="]",b+=1):(g=null,n&&k('"]"')),g!==null?d=[d,e,g]:(d=null,b=j)):(d=null,b=j)}else d=null,b=j;(n=h)&&d===null&&k("[146] ANON");y[f]={nextPos:b,result:d};return d}function rb(){var f="PN_CHARS_BASE@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;if(a.substr(b).match(/^[A-Z]/)!==
null){var j=a.charAt(b);b++}else j=null,n&&k("[A-Z]");j===null&&(a.substr(b).match(/^[a-z]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[a-z]")),j===null&&(a.substr(b).match(/^[\xC0-\xD6]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\xC0-\\xD6]")),j===null&&(a.substr(b).match(/^[\xD8-\xF6]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\xD8-\\xF6]")),j===null&&(a.substr(b).match(/^[\xF8-\u02FF]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\xF8-\\u02FF]")),j===null&&(a.substr(b).match(/^[\u0370-\u037D]/)!==
null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u0370-\\u037D]")),j===null&&(a.substr(b).match(/^[\u037F-\u1FFF]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u037F-\\u1FFF]")),j===null&&(a.substr(b).match(/^[\u200C-\u200D]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u200C-\\u200D]")),j===null&&(a.substr(b).match(/^[\u2070-\u218F]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u2070-\\u218F]")),j===null&&(a.substr(b).match(/^[\u2C00-\u2FEF]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u2C00-\\u2FEF]")),
j===null&&(a.substr(b).match(/^[\u3001-\uD7FF]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u3001-\\uD7FF]")),j===null&&(a.substr(b).match(/^[\uF900-\uFDCF]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\uF900-\\uFDCF]")),j===null&&(a.substr(b).match(/^[\uFDF0-\uFFFD]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\uFDF0-\\uFFFD]")),j===null&&(a.substr(b).match(/^[\u1000-\uEFFF]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u1000-\\uEFFF]")),j=j!==null?j:null)))))))))))));(n=h)&&j===null&&k("[147] PN_CHARS_BASE");
y[f]={nextPos:b,result:j};return j}function ua(){var f="PN_CHARS_U@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=rb();j===null&&(a.substr(b,1)==="_"?(j="_",b+=1):(j=null,n&&k('"_"')),j=j!==null?j:null);(n=h)&&j===null&&k("[148] PN_CHARS_U");y[f]={nextPos:b,result:j};return j}function qb(){var f="VARNAME@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=ua();e===null&&(a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&k("[0-9]")),e=e!==null?e:null);if(e!==
null){var g=[],i=ua();i===null&&(a.substr(b).match(/^[0-9]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[0-9]")),i===null&&(a.substr(b).match(/^[\xB7]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[\\xB7]")),i===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[\\u0300-\\u036F]")),i===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[\\u203F-\\u2040]")),i=i!==null?i:null))));for(;i!==null;)g.push(i),i=ua(),i===null&&(a.substr(b).match(/^[0-9]/)!==
null?(i=a.charAt(b),b++):(i=null,n&&k("[0-9]")),i===null&&(a.substr(b).match(/^[\xB7]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[\\xB7]")),i===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[\\u0300-\\u036F]")),i===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(i=a.charAt(b),b++):(i=null,n&&k("[\\u203F-\\u2040]")),i=i!==null?i:null))));g!==null?e=[e,g]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[0]+e[1].join(""):null;d===null&&(d=null,b=j);(n=h)&&d===null&&
k("[149] VARNAME");y[f]={nextPos:b,result:d};return d}function Da(){var f="PN_CHARS@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=ua();j===null&&(a.substr(b,1)==="-"?(j="-",b+=1):(j=null,n&&k('"-"')),j===null&&(a.substr(b).match(/^[0-9]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[0-9]")),j===null&&(a.substr(b).match(/^[\xB7]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\xB7]")),j===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u0300-\\u036F]")),
j===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(j=a.charAt(b),b++):(j=null,n&&k("[\\u203F-\\u2040]")),j=j!==null?j:null)))));(n=h)&&j===null&&k("[150] PN_CHARS");y[f]={nextPos:b,result:j};return j}function ab(){var f="PN_PREFIX@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=rb();if(e!==null){var i=[],g=Da();g===null&&(a.substr(b,1)==="."?(g=".",b+=1):(g=null,n&&k('"."')),g=g!==null?g:null);for(;g!==null;)i.push(g),g=Da(),g===null&&(a.substr(b,1)==="."?(g=".",b+=1):(g=
null,n&&k('"."')),g=g!==null?g:null);i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?function(a,b){if(b[b.length-1]==".")throw Error("Wrong PN_PREFIX, cannot finish with '.'");else return a+b.join("")}(e[0],e[1]):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[151] PN_PREFIX");y[f]={nextPos:b,result:d};return d}function pb(){var f="PN_LOCAL@"+b,h=y[f];if(h)return b=h.nextPos,h.result;h=n;n=!1;var j=b,d=b,e=ua();e===null&&(a.substr(b).match(/^[0-9]/)!==null?(e=a.charAt(b),b++):(e=null,n&&
k("[0-9]")),e=e!==null?e:null);if(e!==null){for(var i=[],g=Da();g!==null;)i.push(g),g=Da();i!==null?e=[e,i]:(e=null,b=d)}else e=null,b=d;d=e!==null?e[0]+e[1].join(""):null;d===null&&(d=null,b=j);(n=h)&&d===null&&k("[152] PN_LOCAL");y[f]={nextPos:b,result:d};return d}function sb(){var f=function(a){a.sort();for(var b=null,c=[],f=0;f<a.length;f++)a[f]!==b&&(c.push(a[f]),b=a[f]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-
1]}}($a),h=Math.max(b,ya),h=h<a.length?j(a.charAt(h)):"end of input";return"Expected "+f+" but "+h+" found."}function Ac(){for(var b=1,f=1,h=!1,d=0;d<ya;d++){var e=a.charAt(d);e==="\n"?(h||b++,f=1,h=!1):e==="\r"|e==="\u2028"||e==="\u2029"?(b++,f=1,h=!0):(f++,h=!1)}return{line:b,column:f}}var ha={ANON:xc,AdditiveExpression:U,Aggregate:cc,ArgList:lb,AskQuery:J,BLANK_NODE_LABEL:wc,BaseDecl:v,BindingValue:wa,BindingsClause:xa,BlankNode:ac,BlankNodePropertyList:Xb,BooleanLiteral:Ja,BrackettedExpression:Ga,
BuiltInCall:Fa,COMMENT:yc,Clear:zb,Collection:Wb,ConditionalAndExpression:Ra,ConditionalOrExpression:M,Constraint:za,ConstructQuery:K,ConstructTemplate:Gb,ConstructTriples:mb,Create:Bb,DECIMAL:Ua,DECIMAL_NEGATIVE:oc,DECIMAL_POSITIVE:lc,DOCUMENT:function(){var a="DOCUMENT@"+b,c=y[a];if(c)return b=c.nextPos,c.result;c=i();c===null&&(c=x(),c=c!==null?c:null);y[a]={nextPos:b,result:c};return c},DOUBLE:Ta,DOUBLE_NEGATIVE:nc,DOUBLE_POSITIVE:kc,DatasetClause:H,DefaultGraphClause:P,DeleteClause:Eb,DeleteData:Db,
DeleteWhere:xb,DescribeQuery:L,Drop:Ab,ECHAR:fa,EXPONENT:Va,ExistsFunc:ec,ExpressionList:Pb,Filter:Ob,FunctionCall:bb,GraphGraphPattern:Mb,GraphNode:qa,GraphPatternNotTriples:kb,GraphRef:Ka,GraphRefAll:cb,GraphTerm:Yb,GroupClause:Z,GroupCondition:Y,GroupGraphPattern:W,GroupGraphPatternSub:Hb,GroupOrUnionGraphPattern:Jb,HavingClause:ba,INTEGER:ca,INTEGER_NEGATIVE:pc,INTEGER_POSITIVE:mc,IRI_REF:na,IRIref:R,IRIrefOrFunction:bc,InsertClause:Za,InsertData:Cb,LANGTAG:hc,LimitClause:Wa,LimitOffsetClauses:va,
Load:vb,MinusGraphPattern:Lb,Modify:yb,MultiplicativeExpression:ra,NIL:la,NamedGraphClause:T,NotExistsFunc:fc,NumericLiteral:Ia,NumericLiteralNegative:sa,NumericLiteralPositive:jc,NumericLiteralUnsigned:ic,ObjectList:ma,OffsetClause:Xa,OptionalGraphPattern:Kb,OrderClause:ga,OrderCondition:ia,PNAME_LN:vc,PNAME_NS:Ea,PN_CHARS:Da,PN_CHARS_BASE:rb,PN_CHARS_U:ua,PN_LOCAL:pb,PN_PREFIX:ab,PathAlternative:nb,PathElt:ob,PathEltOrInverse:Qa,PathMod:Ub,PathNegatedPropertySet:Vb,PathOneInPropertySet:Ba,PathPrimary:Tb,
PathSequence:Pa,PrefixDecl:u,PrefixedName:uc,PrimaryExpression:Ca,Prologue:s,PropertyList:Qb,PropertyListNotEmpty:Aa,PropertyListNotEmptyPath:Rb,PropertyListPath:Sb,QuadData:eb,QuadPattern:gb,Quads:hb,QuadsNotTriples:ib,Query:g,RDFLiteral:Ha,RegexExpression:dc,RelationalExpression:Sa,SPARQL:i,STRING_LITERAL1:sc,STRING_LITERAL2:tc,STRING_LITERAL_LONG1:qc,STRING_LITERAL_LONG2:rc,SelectClause:G,SelectQuery:D,ServiceGraphPattern:Nb,SolutionModifier:V,String:gc,SubSelect:C,TURTLE:x,TriplesBlock:oa,TriplesNode:Ma,
TriplesSameSubject:jb,TriplesSameSubjectPath:Ib,TriplesTemplate:pa,UnaryExpression:$,Update:Ya,Update1:ub,UsingClause:fb,VAR1:Zb,VAR2:$b,VARNAME:qb,Var:Q,VarOrIRIref:ka,VarOrTerm:La,Verb:Na,VerbPath:Oa,WS:q,WhereClause:aa,base:E,directive:B,prefixID:N,statement:z};if(f!==void 0){if(ha[f]===void 0)throw Error("Invalid rule name: "+j(f)+".");}else f="DOCUMENT";var b=0,n=!0,ya=0,$a=[],y={},X=function(a){for(var b="",c=0;c<a.length;c++)b+=typeof a[c]==="string"?a[c]:a[c].join("");return b},ea=0,Fb=function(a){for(var b=
"",c=0;c<a.length;c++)b+=a[c];return b.toUpperCase()},ha=ha[f]();if(ha===null||b!==a.length)throw ha=Ac(),new this.SyntaxError(sb(),ha.line,ha.column);return ha},toSource:function(){return this._source},SyntaxError:function(a,f,h){this.name="SyntaxError";this.message=a;this.line=f;this.column=h}};a.SyntaxError.prototype=Error.prototype;return a}();var ba={};(new Date).getTime();ba.combined_parser=ia.parser;ba.parser={};ba.parser.parse=function(a,c){for(var f=[],h=ba.combined_parser.parse(a),j={},
g={namespaces:j,base:"",blankCounter:0},i=0;i<h.length;i++){var m=h[i];if(m.token==="base")g.base=m.value;else if(m.token==="prefix")j[m.prefix]=m.local;else if(m.token==="triples"||m.token==="triplespattern")for(var s=0;s<m.triplesContext.length;s++){var v=m.triplesContext[s],v={subject:z.lexicalFormTerm(v.subject,g),predicate:z.lexicalFormTerm(v.predicate,g),object:z.lexicalFormTerm(v.object,g),graph:c};f.push(v)}}return f};var x={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",
rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",
sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},UrisMap:function(){this.defaultNs="";this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]}};x.UrisMap.prototype.values=function(){var a={},c;for(c in this)!z.include(this.interfaceProperties,c)&&typeof this[c]!=="function"&&c!=="defaultNs"&&c!=="interfaceProperties"&&(a[c]=this[c]);return a};x.UrisMap.prototype.get=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";
return this[a]};x.UrisMap.prototype.remove=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";delete this[a];return null};x.UrisMap.prototype.set=function(a,c){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";this[a]=c};x.UrisMap.prototype.setDefault=function(a){this.defaultNs=a};x.UrisMap.prototype.addAll=function(a,c){for(var f in a)z.include(this.interfaceProperties,f)||(this[f]!=null?c===!0&&(this[f]=a[f]):this[f]=a[f]);return this};x.UrisMap.prototype.resolve=
function(a){var c=a.split(":"),a=c[0],c=c[1];return a===""?this.defaultNs==null?null:this.defaultNs+c:this[a]!=null?this[a]+c:null};x.UrisMap.prototype.shrink=function(a){for(var c in this){var f=this[c];if(a.indexOf(f)===0&&f!==""&&c!="defaultNs")return a=a.split(f)[1],c+":"+a}return a};x.Profile=function(){this.prefixes=new x.UrisMap;this.terms=new x.UrisMap};x.Profile.prototype.importProfile=function(a,c){this.prefixes.addAll(a.prefixes,c);this.terms.addAll(a.terms,c)};x.Profile.prototype.resolve=
function(a){return a.indexOf(":")!=-1?this.prefixes.resolve(a):this.terms[a]!=null?this.terms.resolve(a):null};x.Profile.prototype.setDefaultPrefix=function(a){this.prefixes.setDefault(a)};x.Profile.prototype.setDefaultVocabulary=function(a){this.terms.setDefault(a)};x.Profile.prototype.setPrefix=function(a,c){this.prefixes.set(a,c)};x.Profile.prototype.setTerm=function(a,c){this.terms.set(a,c)};x.RDFEnvironment=function(){this.blankNodeCounter=0;var a=this;this.filters={s:function(a){return function(c){return c.subject.equals(a)}},
p:function(a){return function(c){return c.predicate.equals(a)}},o:function(a){return function(c){return c.object.equals(a)}},sp:function(a,c){return function(j){return j.subject.equals(a)&&j.predicate.equals(c)}},so:function(a,c){return function(j){return j.subject.equals(a)&&j.object.equals(c)}},po:function(a,c){return function(j){return j.predicate.equals(a)&&j.object.equals(c)}},spo:function(a,c,j){return function(g){return g.subject.equals(a)&&g.predicate.equals(c)&&g.object.equals(j)}},describes:function(a){return function(c){return c.subject.equals(a)||
c.object.equals(a)}},type:function(c){var h=a.resolve("rdf:type");return function(a){return a.predicate.equals(h)&&a.object.equals(c)}}};for(var c in x.defaultContext)this.prefixes.set(c,x.defaultContext[c])};z["extends"](x.Profile,x.RDFEnvironment);x.RDFEnvironment.prototype.createBlankNode=function(){var a=new x.BlankNode(this.blankNodeCounter);this.blankNodeCounter++;return a};x.RDFEnvironment.prototype.createNamedNode=function(a){var c=this.resolve(a);return c!=null?new x.NamedNode(c):new x.NamedNode(a)};
x.RDFEnvironment.prototype.createLiteral=function(a,c,f){return f!=null?new x.Literal(a,c,f.toString()):new x.Literal(a,c,f)};x.RDFEnvironment.prototype.createTriple=function(a,c,f){return new x.Triple(a,c,f)};x.RDFEnvironment.prototype.createGraph=function(a){var c=new x.Graph;if(a!=null)for(var f=0;f<a.length;f++)c.add(a[f]);return c};x.RDFEnvironment.prototype.createAction=function(a,c){return function(f){return a(f)?c(f):f}};x.RDFEnvironment.prototype.createProfile=function(a){return a===!0?new x.RDFEnvironment.Profile:
(a=new x.RDFEnvironment.Profile,a.importProfile(this),a)};x.RDFEnvironment.prototype.createTermMap=function(a){if(a===!0)return new x.UrisMap;else{var a=this.terms.values(),c=new x.UrisMap,f;for(f in a)c[f]=a[f];return c}};x.RDFEnvironment.prototype.createPrefixMap=function(a){if(a===!0)return new x.UrisMap;else{var a=this.prefixes.values(),c=new x.UrisMap,f;for(f in a)c[f]=a[f];return c}};x.RDFNode=function(a){this.interfaceName=a;this.attributes=["interfaceName","nominalValue"]};x.RDFNode.prototype.equals=
function(a){if(a.interfaceName==null)return this.valueOf()==a;else{for(var c in this.attributes){var f=this.attributes[c];if(this[f]!=a[f])return!1}return!0}};x.BlankNode=function(a){x.RDFNode.call(this,"BlankNode");this.nominalValue="_:"+a;this.bnodeId=a};z["extends"](x.RDFNode,x.BlankNode);x.BlankNode.prototype.toString=function(){return this.nominalValue};x.BlankNode.prototype.toNT=function(){return this.nominalValue};x.BlankNode.prototype.valueOf=function(){return this.nominalValue};x.Literal=
function(a,c,f){x.RDFNode.call(this,"Literal");this.nominalValue=a;if(c!=null)this.language=c;else if(f!=null)this.datatype=f};z["extends"](x.RDFNode,x.Literal);x.Literal.prototype.toString=function(){var a='"'+this.nominalValue+'"';if(this.language!=null)a=a+"@"+this.language;else if(this.datatype!=null||this.type)a=a+"^^<"+(this.datatype||this.type)+">";return a};x.Literal.prototype.toNT=function(){return this.toString()};x.Literal.prototype.valueOf=function(){return g.effectiveTypeValue({token:"literal",
type:this.type,value:this.nominalValue,language:this.language})};x.NamedNode=function(a){x.RDFNode.call(this,"NamedNode");this.nominalValue=a.value!=null?a.value:a};z["extends"](x.RDFNode,x.NamedNode);x.NamedNode.prototype.toString=function(){return this.nominalValue};x.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"};x.NamedNode.prototype.valueOf=function(){return this.nominalValue};x.Triple=function(a,c,f){this.subject=a;this.predicate=c;this.object=f};x.Triple.prototype.equals=
function(a){return this.subject.equals(a.subject)&&this.predicate.equals(a.predicate)&&this.object.equals(a.object)};x.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"};x.Graph=function(){this.triples=[];this.duplicates={};this.actions=[]};x.Graph.prototype.add=function(a){for(var c=0;c<this.actions.length;c++)a=this.actions[c](a);c=a.subject.toString()+a.predicate.toString()+a.object.toString();this.duplicates[c]||(this.duplicates[c]=
!0,this.triples.push(a));return this};x.Graph.prototype.addAction=function(a,c){this.actions.push(a);if(c==!0)for(var f=0;f<this.triples.length;f++)this.triples[f]=a(this.triples[f]);return this};x.Graph.prototype.addAll=function(a){for(var a=a.toArray(),c=0;c<a.length;c++)this.add(a[c]);return this};x.Graph.prototype.remove=function(a){for(var c=null,f=0;f<this.triples.length;f++)if(this.triples[f].equals(a)){delete this.duplicates[a.subject.toString()+a.predicate.toString()+a.object.toString()];
c=f;break}c!=null&&this.triples.splice(c,1);return this};x.Graph.prototype.toArray=function(){return this.triples};x.Graph.prototype.some=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!0)return!0;return!1};x.Graph.prototype.every=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!1)return!1;return!0};x.Graph.prototype.filter=function(a){for(var c=new x.Graph,f=0;f<this.triples.length;f++)a(this.triples[f],this)===!0&&c.add(this.triples[f]);
return c};x.Graph.prototype.forEach=function(a){for(var c=0;c<this.triples.length;c++)a(this.triples[c],this)};x.Graph.prototype.merge=function(){for(var a=new x.Graph,c=0;c<this.triples;c++){var f=this.triples[c];a.add(f)}for(c=0;c<triples.length;c++)f=triples[c],this.add(f);return a};x.Graph.prototype.match=function(a,c,f,h){for(var j=new x.Graph,g=0,i=0;i<this.triples.length;i++){var m=this.triples[i];if(a==null||m.subject.equals(a))if(c==null||m.predicate.equals(c))if(f==null||m.object.equals(f))if(h==
null||g<h)g++,j.add(m);else break}return j};x.Graph.prototype.removeMatches=function(a,c,f){for(var h=[],j=0;j<this.triples.length;j++){var g=this.triples[j];if(a==null||g.subject.equals(a))if(c==null||g.predicate.equals(c))(f==null||g.object.equals(f))&&h.push(g)}for(j=0;j<h.length;j++)this.remove(h[j]);return this};x.Graph.prototype.toNT=function(){var a="";this.forEach(function(c){a+=c.toString()});return a};x.buildRDFResource=function(a,c,f,h){return a.token==="blank"?x.buildBlankNode(a,c,f,h):
a.token==="literal"?x.buildLiteral(a,c,f,h):a.token==="uri"?x.buildNamedNode(a,c,f,h):a.token==="var"?(a=c[a.value],a!=null?x.buildRDFResource(a,c,f,h):null):null};x.buildBlankNode=function(a){if(a.valuetmp!=null)a.value=a.valuetmp;if(a.value.indexOf("_:")===0)a.value=a.value.split("_:")[1];return new x.BlankNode(a.value)};x.buildLiteral=function(a){return new x.Literal(a.value,a.lang,a.type)};x.buildNamedNode=function(a,c,f,h){if(a.value==null&&a.prefix!=null)c=f.resolveNsInEnvironment(a.prefix,
h),a.value=c+a.suffix;return new x.NamedNode(a)};x.rdf=new x.RDFEnvironment;var g={checkFilters:function(a,c,f,h,j,k){var i=a.filter,m=[];if(i==null||a.length!=null)return c;for(a=0;a<i.length;a++){for(var c=g.run(i[a].value,c,f,h,j,k),s=[],v=0;v<c.length;v++)c[v].__nullify__!=null?m.push(c[v]):s.push(c[v]);c=s}return c.concat(m)}};g.boundVars=function(a){if(a.expressionType!=null){var c=a.expressionType;if(c=="relationalexpression")return c=a.op2,g.boundVars(a.op1)+g.boundVars(c);else if(c=="conditionalor"||
c=="conditionaland"){for(var f=[],c=0;c<a.operands;c++)f=f.concat(g.boundVars(a.operands[c]));return f}else if(c=="builtincall")if(a.args==null)return[];else{f=[];for(c=0;c<a.args.length;c++)f=f.concat(g.boundVars(a.args[c]));return f}else if(c=="multiplicativeexpression"){f=g.boundVars(a.factor);for(c=0;c<a.factors.length;c++)f=f.concat(g.boundVars(a.factors[c].expression));return f}else if(c=="additiveexpression"){f=g.boundVars(a.summand);for(c=0;c<a.summands.length;c++)f=f.concat(g.boundVars(a.summands[c].expression));
return f}else if(c=="regex")return f=g.boundVars(a.expression1),f.concat(g.boundVars(a.expression2));else if(c=="unaryexpression")return g.boundVars(a.expression);else if(c=="atomic")return a.primaryexpression=="var"?[a.value]:[]}else throw console.log("ERROR"),console.log(a),"Cannot find bound expressions in a no expression token";};g.run=function(a,c,f,h,j,k){for(var i=k.copyDenormalizedBindings(c,j.outCache),m=[],s=0;s<c.length;s++){var v=g.runFilter(a,i[s],k,h,j),v=g.ebv(v);g.isEbvError(v)?f&&
(v={__nullify__:!0,bindings:c[s]},m.push(v)):v===!0?m.push(c[s]):f&&(v={__nullify__:!0,bindings:c[s]},m.push(v))}return m};g.collect=function(a,c,f,h,j){for(var k=j.copyDenormalizedBindings(c,h.outCache),i=[],m=0;m<k.length;m++){var s=g.runFilter(a,k[m],j,f,h);i.push({binding:c[m],value:s})}return i};g.runDistinct=function(){};g.runAggregator=function(a,c,f,h,j){if(c==null||c.length===0)return g.ebvError();else if(a.token==="variable"&&a.kind=="var")return c[0][a.value.value];else if(a.token==="variable"&&
a.kind==="aliased")if(a.expression.expressionType==="atomic"&&a.expression.primaryexpression==="var")return c[0][a.expression.value.value];else if(a.expression.expressionType==="aggregate")if(a.expression.aggregateType==="max"){for(var k=null,i=0;i<c.length;i++){var m=c[i],m=g.runFilter(a.expression.expression,m,f,h,j);g.isEbvError(m)||(k===null?k=m:g.runLtFunction(k,m).value===!0&&(k=m))}return k===null?g.ebvError():k}else if(a.expression.aggregateType==="min"){k=null;for(i=0;i<c.length;i++)m=c[i],
m=g.runFilter(a.expression.expression,m,f,h,j),g.isEbvError(m)||(k===null?k=m:g.runGtFunction(k,m).value===!0&&(k=m));return k===null?g.ebvError():k}else if(a.expression.aggregateType==="count"){var k={},s=0;if(a.expression.expression==="*")if(a.expression.distinct!=null&&a.expression.distinct!="")for(i=0;i<c.length;i++){var m=c[i],v=z.hashTerm(m);k[v]==null&&(k[v]=!0,s++)}else s=c.length;else for(i=0;i<c.length;i++)m=c[i],m=g.runFilter(a.expression.expression,m,f,h,j),g.isEbvError(m)||(a.expression.distinct!=
null&&a.expression.distinct!=""?(v=z.hashTerm(m),k[v]==null&&(k[v]=!0,s++)):s++);return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+s}}else if(a.expression.aggregateType==="avg"){for(var k={},u={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},i=s=0;i<c.length;i++)m=c[i],m=g.runFilter(a.expression.expression,m,f,h,j),g.isEbvError(m)||(a.expression.distinct!=null&&a.expression.distinct!=""?(v=z.hashTerm(m),k[v]==null&&(k[v]=!0,g.isNumeric(m)&&
(u=g.runSumFunction(u,m),s++))):g.isNumeric(m)&&(u=g.runSumFunction(u,m),s++));a=g.runDivFunction(u,{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:""+s});a.value=""+a.value;return a}else if(a.expression.aggregateType==="sum"){k={};u={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(i=0;i<c.length;i++)m=c[i],m=g.runFilter(a.expression.expression,m,f,h,j),g.isEbvError(m)||(a.expression.distinct!=null&&a.expression.distinct!=""?(v=z.hashTerm(m),k[v]==
null&&(k[v]=!0,g.isNumeric(m)&&(u=g.runSumFunction(u,m)))):g.isNumeric(m)&&(u=g.runSumFunction(u,m)));u.value=""+u.value;return u}else return m=g.runFilter(aggregate.expression,c[0],h,{blanks:{},outCache:{}})};g.runFilter=function(a,c,f,h,j){if(a.expressionType!=null){var k=a.expressionType;if(k=="relationalexpression"){var k=g.runFilter(a.op1,c,f,h,j),i=g.runFilter(a.op2,c,f,h,j);return g.runRelationalFilter(a,k,i,c,f,h,j)}else if(k=="conditionalor")return g.runOrFunction(a,c,f,h,j);else if(k=="conditionaland")return g.runAndFunction(a,
c,f,h,j);else if(k=="additiveexpression")return g.runAddition(a.summand,a.summands,c,f,h,j);else if(k=="builtincall")return g.runBuiltInCall(a.builtincall,a.args,c,f,h,j);else if(k=="multiplicativeexpression")return g.runMultiplication(a.factor,a.factors,c,f,h,j);else if(k=="unaryexpression")return g.runUnaryExpression(a.unaryexpression,a.expression,c,f,h,j);else if(k=="irireforfunction")return g.runIriRefOrFunction(a.iriref,a.args,c,f,h,j);else if(k=="regex")return g.runRegex(a.text,a.pattern,a.flags,
c,f,h,j);else if(k=="atomic")if(a.primaryexpression=="var")return c[a.value.value];else{if(typeof a.value=="object"&&!(a.value.type==null||typeof a.value.type!="object"))a.value.type=z.lexicalFormBaseUri(a.value.type,j);return a.value}else throw"Unknown filter expression type";}else throw"Cannot find bound expressions in a no expression token";};g.isRDFTerm=function(a){return a==null?!1:a.token&&a.token=="literal"||a.token&&a.token=="uri"||a.token&&a.token=="blank"?!0:!1};g.RDFTermEquality=function(a,
c,f,h){return a.token==="literal"&&c.token==="literal"?a.lang==c.lang&&a.type==c.type&&a.value==c.value?!0:a.type!=null&&c.type!=null?g.ebvError():g.isSimpleLiteral(a)&&c.type!=null?g.ebvError():g.isSimpleLiteral(c)&&a.type!=null?g.ebvError():!1:a.token==="uri"&&c.token==="uri"?z.lexicalFormBaseUri(a,h)==z.lexicalFormBaseUri(c,h):a.token==="blank"&&c.token==="blank"?a.value==c.value:!1};g.isInteger=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||
a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||
a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};g.isFloat=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#float"?!0:!1:!1};g.isDecimal=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#decimal"?!0:!1:!1};g.isDouble=function(a){return a==
null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#double"?!0:!1:!1};g.isNumeric=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#float"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||
a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:
!1};g.isSimpleLiteral=function(a){return a&&a.token=="literal"?a.type==null&&a.lang==null?!0:!1:!1};g.isXsdType=function(a,c){return c&&c.token=="literal"?c.type=="http://www.w3.org/2001/XMLSchema#"+a:!1};g.ebv=function(a){if(a==null||g.isEbvError(a))return g.ebvError();else if(a.token&&a.token==="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||
a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||
a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"){var c=parseFloat(a.value);return isNaN(c)?!1:parseFloat(a.value)!=0}else return a.type==="http://www.w3.org/2001/XMLSchema#boolean"?a.value==="true"||a.value===!0||a.value==="True":a.type==="http://www.w3.org/2001/XMLSchema#string"?a.value!="":a.type==="http://www.w3.org/2001/XMLSchema#dateTime"?new Date(a.value)!=null:g.isEbvError(a)?a:a.type==null?a.value!=""?!0:!1:g.ebvError();else return a.value===!0};g.ebvTrue=function(){return val=
{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}};g.ebvFalse=function(){return val={token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}};g.ebvError=function(){return val={token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}};g.isEbvError=function(a){return typeof a=="object"&&a!=null?a.type==="https://github.com/antoniogarrote/js-tools/types#error":!1};g.ebvBoolean=function(a){return g.isEbvError(a)?a:a===!0?g.ebvTrue():
g.ebvFalse()};g.runRelationalFilter=function(a,c,f,h,j,k,i){a=a.operator;if(a==="=")return g.runEqualityFunction(c,f,h,j,k,i);else if(a==="!="){c=g.runEqualityFunction(c,f,h,j,k,i);if(!g.isEbvError(c))c.value=!c.value;return c}else if(a==="<")return g.runLtFunction(c,f,h);else if(a===">")return g.runGtFunction(c,f,h);else if(a==="<=")return g.runLtEqFunction(c,f,h);else if(a===">=")return g.runGtEqFunction(c,f,h);else throw"Error applying relational filter, unknown operator";};g.effectiveTypeValue=
function(a){if(a.token=="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#decimal")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#float")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#double")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#long")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#int")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#short")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#byte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#date"||a.type=="http://www.w3.org/2001/XMLSchema#dateTime")try{return z.parseISO8601(a.value)}catch(c){return null}else return a.type==
"http://www.w3.org/2001/XMLSchema#boolean"?a.value===!0||a.value==="true"||a.value==="1"||a.value===1||a.value===!0?!0:a.value===!1||a.value==="false"||a.value==="0"||a.value===0||a.value===!1?!1:void 0:a.type=="http://www.w3.org/2001/XMLSchema#string"?a.value===null||a.value===void 0?void 0:""+a.value:a.value;else throw console.log("not implemented yet"),"value not supported in operations yet";};g.runOrFunction=function(a,c,f,h,j){for(var k=null,i=0;i<a.operands.length;i++){var m=g.runFilter(a.operands[i],
c,f,h,j);g.isEbvError(m)==!1&&(m=g.ebv(m));k==null?k=m:g.isEbvError(m)?k=g.isEbvError(k)?g.ebvError():k===!0?!0:g.ebvError():m===!0?k=!0:g.isEbvError(k)&&(k=g.ebvError())}return g.ebvBoolean(k)};g.runAndFunction=function(a,c,f,h,j){for(var k=null,i=0;i<a.operands.length;i++){var m=g.runFilter(a.operands[i],c,f,h,j);g.isEbvError(m)==!1&&(m=g.ebv(m));k==null?k=m:g.isEbvError(m)?k=g.isEbvError(k)?g.ebvError():k===!0?g.ebvError():!1:m===!0?g.isEbvError(k)&&(k=g.ebvError()):k=!1}return g.ebvBoolean(k)};
g.runEqualityFunction=function(a,c,f,h,j,k){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return f=g.effectiveTypeValue(a),j=g.effectiveTypeValue(c),isNaN(f)||isNaN(j)?g.ebvBoolean(g.RDFTermEquality(a,c,h,k)):g.ebvBoolean(f==j);else if((g.isSimpleLiteral(a)||g.isXsdType("string",a))&&(g.isSimpleLiteral(c)||g.isXsdType("string",c)))return g.ebvBoolean(g.effectiveTypeValue(a)==g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",
c))return g.ebvBoolean(g.effectiveTypeValue(a)==g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();a=z.compareDateComponents(a.value,c.value);return a!=null?a==0?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.isRDFTerm(a)&&g.isRDFTerm(c)?g.ebvBoolean(g.RDFTermEquality(a,
c,h,k)):g.ebvFalse()};g.runGtFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",
c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var f=z.compareDateComponents(a.value,c.value);return f!=null?f==1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runTotalGtFunction=function(a,c){return g.isEbvError(a)||
g.isEbvError(c)?g.ebvError():g.isNumeric(a)&&g.isNumeric(c)||g.isSimpleLiteral(a)&&g.isSimpleLiteral(c)||g.isXsdType("string",a)&&g.isSimpleLiteral("string",c)||g.isXsdType("boolean",a)&&g.isSimpleLiteral("boolean",c)||g.isXsdType("dateTime",a)&&g.isSimpleLiteral("dateTime",c)?g.runGtFunction(a,c,[]):a.token&&a.token==="uri"&&c.token&&c.token==="uri"?g.ebvBoolean(a.value>c.value):a.token&&a.token==="literal"&&c.token&&c.token==="literal"?g.ebvBoolean(""+a.value+a.type+a.lang>""+c.value+c.type+c.lang):
a.token&&a.token==="blank"&&c.token&&c.token==="blank"?g.ebvBoolean(a.value>c.value):a.value&&c.value?g.ebvBoolean(a.value>c.value):g.ebvTrue()};g.runLtFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",
c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var f=z.compareDateComponents(a.value,c.value);
return f!=null?f==-1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runGtEqFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));
else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var f=z.compareDateComponents(a.value,c.value);return f!=null?f!=-1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};
g.runLtEqFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)<=
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var f=z.compareDateComponents(a.value,c.value);return f!=null?f!=1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runAddition=function(a,c,f,h,j,k){var i=g.runFilter(a,f,h,j,k);if(g.isEbvError(i))return g.ebvError();
a=i;if(g.isNumeric(i)){for(i=0;i<c.length;i++){var m=g.runFilter(c[i].expression,f,h,j,k);if(g.isNumeric(m))c[i].operator==="+"?a=g.runSumFunction(a,m):c[i].operator==="-"&&(a=g.runSubFunction(a,m));else return g.ebvFalse()}return a}else return g.ebvFalse()};g.runSumFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var f=g.effectiveTypeValue(a)+g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:f}:
g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:f}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:f}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:f}};g.runSubFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var f=g.effectiveTypeValue(a)-g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",
value:f}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:f}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:f}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:f}};g.runMultiplication=function(a,c,f,h,j,k){a=g.runFilter(a,f,h,j,k);if(g.isEbvError(a))return a;var i=a;if(g.isNumeric(a)){for(var m=0;m<c.length;m++){var s=g.runFilter(c[m].expression,f,h,j,k);if(g.isEbvError(s))return a;
if(g.isNumeric(s))c[m].operator==="*"?i=g.runMulFunction(i,s):c[m].operator==="/"&&(i=g.runDivFunction(i,s));else return g.ebvFalse()}return i}else return g.ebvFalse()};g.runMulFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var f=g.effectiveTypeValue(a)*g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:f}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:f}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:f}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:f}};g.runDivFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var f=g.effectiveTypeValue(a)/g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:f}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:f}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:f}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:f}};g.runBuiltInCall=function(a,c,f,h,j,k){if(a==="notexists"||a==="exists"){var i=JSON.parse(JSON.stringify(c[0])),i=h.abstractQueryTree.parseSelect({pattern:i},f),i=h.abstractQueryTree.bind(i.pattern,f),f=h.executeSelectUnit([{kind:"*"}],j,i,k);return a==="exists"?g.ebvBoolean(f.length!==0):g.ebvBoolean(f.length===
0)}else{for(var i=[],m=0;m<c.length;m++)if(c[m].token==="var")i.push(c[m]);else{var s=g.runFilter(c[m],f,h,j,k);if(g.isEbvError(s))return s;i.push(s)}if(a==="str")return i[0].token==="literal"?{token:"literal",type:null,value:""+i[0].value}:i[0].token==="uri"?{token:"literal",type:null,value:i[0].value}:g.ebvFalse();else if(a==="lang")return i[0].token==="literal"?i[0].lang!=null?{token:"literal",value:""+i[0].lang}:{token:"literal",value:""}:g.ebvError();else if(a==="datatype")return i[0].token===
"literal"?(a=i[0],a.type!=null?typeof a.type==="string"?{token:"uri",value:a.type,prefix:null,suffix:null}:a.type:a.lang==null?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:g.ebvError()):g.ebvError();else if(a==="isliteral")return i[0].token==="literal"?g.ebvTrue():g.ebvFalse();else if(a==="isblank")return i[0].token==="blank"?g.ebvTrue():g.ebvFalse();else if(a==="isuri"||a==="isiri")return i[0].token==="uri"?g.ebvTrue():g.ebvFalse();else if(a==="sameterm")return a=
g.RDFTermEquality(i[0],i[1],h,k),g.isEbvError(a)&&(a=!1),g.ebvBoolean(a);else if(a==="langmatches")return a=i[0],f=i[1],a.token==="literal"&&f.token==="literal"?f.value==="*"&&a.value!=""?g.ebvTrue():g.ebvBoolean(a.value.toLowerCase().indexOf(f.value.toLowerCase())===0):g.ebvError();else if(a==="bound")return a=i[0].value,a==null?g.ebvError():f[a]!=null?g.ebvTrue():g.ebvFalse();else throw"Builtin call "+a+" not implemented yet";}};g.runUnaryExpression=function(a,c,f,h,j,k){c=g.runFilter(c,f,h,j,k);
if(g.isEbvError(c))return c;if(a==="!"){var i=g.ebv(c);return g.isEbvError(i)?g.ebvFalse():g.ebvBoolean(!i)}else if(a==="+")return g.isNumeric(c)?c:g.ebvError();else if(a==="-")if(g.isNumeric(c)){a={};for(i in c)a[i]=c[i];a.value=-a.value;return a}else return g.ebvError()};g.runRegex=function(a,c,f,h,j,k,i){if(a!=null)a=g.runFilter(a,h,j,k,i);else return g.ebvError();if(c!=null)c=g.runFilter(c,h,j,k,i);else return g.ebvError();f!=null&&(f=g.runFilter(f,h,j,k,i));if(c!=null&&c.token==="literal"&&(f==
null||f.token==="literal"))c=c.value,f=f==null?null:f.value;else return g.ebvError();if(a!=null&&a.token=="var")if(h[a.value]!=null)a=h[a.value];else return g.ebvError();else if(a!=null&&a.token==="literal")if(a.type==null||g.isXsdType("string",a))a=a.value;else return g.ebvError();else return g.ebvError();return(f==null?RegExp(c):RegExp(c,f.toLowerCase())).exec(a)?g.ebvTrue():g.ebvFalse()};g.normalizeLiteralDatatype=function(a,c,f){if(!(a.value.type==null||typeof a.value.type!="object"))a.value.type=
z.lexicalFormBaseUri(a.value.type,f);return a};g.runIriRefOrFunction=function(a,c,f,h,j,k){if(c==null)return a;else{for(var i=[],m=0;m<c.length;m++)i.push(g.runFilter(c[m],f,h,j,k));a=z.lexicalFormBaseUri(a,k);if(a=="http://www.w3.org/2001/XMLSchema#integer"||a=="http://www.w3.org/2001/XMLSchema#decimal"||a=="http://www.w3.org/2001/XMLSchema#double"||a=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a=="http://www.w3.org/2001/XMLSchema#long"||
a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#short"||a=="http://www.w3.org/2001/XMLSchema#byte"||a=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a=="http://www.w3.org/2001/XMLSchema#positiveInteger")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,
h,k),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||
i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return i.type=a,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=
a,i.value=parseInt(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null){if(i.value.split(".").length>2)return g.ebvError();else if(i.value.split("-").length>2)return g.ebvError();else if(i.value.split("/").length>2)return g.ebvError();else if(i.value.split("+").length>2)return g.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#decimal"&&(i.value.indexOf("e")!=-1||i.value.indexOf("E")!=-1))return g.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#integer")if(i.value.indexOf("e")!=
-1||i.value.indexOf("E")!=-1||i.value.indexOf(".")!=-1)return g.ebvError();try{return i.value=parseInt(parseFloat(i.value)),isNaN(i.value)?g.ebvError():(i.type=a,i)}catch(s){return g.ebvError()}}else return g.ebvError();else return g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#boolean")return i=i[0],i.token==="literal"&&i.type==null?i.value==="true"||i.value==="1"?g.ebvTrue():i.value==="false"||i.value==="0"?g.ebvFalse():g.ebvError():i.token==="literal"?g.isEbvError(i)?i:g.ebvBoolean(i):
g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#string")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,h,k),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||
i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#float")return i.type=
a,i.value=""+i.value,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)?(i.type=a,i.value="true"):(i.type=a,i.value="false"),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date"){i.type=a;if(typeof i.value!="string")i.value=z.iso8601(i.value);return i}else return i.type==null?(i.value=""+i.value,i.type=a,i):g.ebvError();else return i.token==="uri"?
{token:"literal",value:z.lexicalFormBaseUri(i,k),type:a,lang:null}:g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#dateTime"||a=="http://www.w3.org/2001/XMLSchema#date")if(i=i[0],i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null)try{return i.value=z.iso8601(z.parseStrictISO8601(i.value)),i.type=a,i}catch(v){return g.ebvError()}else return g.ebvError();else if(a==
"http://www.w3.org/2001/XMLSchema#float")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,h,k),i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#int")return i.type=a,i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=a,
i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")try{return i.value=parseFloat(i.value),isNaN(i.value)?g.ebvError():(i.type=a,i)}catch(u){return g.ebvError()}else if(i.type==null){if(i.value.split(".").length>2)return g.ebvError();else if(i.value.split("-").length>2)return g.ebvError();else if(i.value.split("/").length>2)return g.ebvError();else if(i.value.split("+").length>2)return g.ebvError();try{return i.value=parseFloat(i.value),isNaN(i.value)?g.ebvError():
(i.type=a,i)}catch(x){return g.ebvError()}}else return g.ebvError();else return g.ebvError();else return g.ebvError()}};var E={variablesInBGP:function(a){var c=a.variables;if(c)return c;var f=a.value||a,c=[];for(comp in f)f[comp]&&f[comp].token==="var"?c.push(f[comp].value):f[comp]&&f[comp].token==="blank"&&c.push("blank:"+f[comp].value);return a.variables=c},connected:function(a,c){for(var f="/"+a.vars.join("/")+"/",h=0;h<c.vars.length;h++)if(f.indexOf("/"+c.vars[h]+"/")!=-1)return!0;return!1},variablesIntersectionBGP:function(a,
c){for(var f=E.variablesInBGP(a).sort(),h=E.variablesInBGP(c).sort(),j=0,g=0,i=[];j<f.length&&g<h.length;)f[j]===h[g]?(i.push(f[j]),j++,g++):f[j]<h[g]?j++:g++;return i},executeAndBGPsGroups:function(a){for(var c={},f={},h=0,j=0;j<a.length;j++){var g=a[j],i=[],m;for(m in g)m!="_cost"&&(g[m].token==="var"?i.push(g[m].value):g[m].token==="blank"&&i.push(g[m].value));var s=!1,v;for(v in f){groupVar=f[v];for(var u=0;u<i.length;u++)if(groupVar.indexOf("/"+i[u]+"/")!=-1){c[v].push(g);f[v]=groupVar+i.join("/")+
"/";s=!0;break}if(s)break}s||(c[h]=[g],f[h]="/"+i.join("/")+"/",h++)}a=[];for(h in c)a.push(c[h]);return a},intersectionSize:function(a,c){for(var f=c.i.split("_"),h=0;h<f.length;h++)if(f[h]!=""&&a.i.indexOf("_"+f[h]+"_")!=-1)return 1;return 0},createJoinTree:function(a,c){for(var f="/"+a.vars.join("/")+"/",h=a.vars.concat([]),j=[],g=0;g<c.vars.length;g++)f.indexOf("/"+c.vars[g]+"/")!=-1?c.vars[g].indexOf("_:")==0?j.push("blank:"+c.vars[g]):j.push(c.vars[g]):h.push(c.vars[g]);for(var i=c.i.split("_"),
m=a.i.split("_"),f={},g=0;g<i.length;g++)i[g]!=""&&(f[i[g]]=!0);for(g=0;g<m.length;g++)m[g]!=""&&(f[m[g]]=!0);var g=[],s;for(s in f)g.push(s);return{left:a,right:c,cost:a.cost+c.cost,i:"_"+g.sort().join("_")+"_",vars:h,join:j}}};E.executeBushyTree=function(a,c,f,h){if(a.left==null)return E.executeEmptyJoinBGP(a.right,c,f,h);else if(a.right==null)return E.executeEmptyJoinBGP(a.left,c,f,h);else{var j=E.executeBushyTree(a.left,c,f,h);if(j!=null)return c=E.executeBushyTree(a.right,c,f,h),c!=null?E.joinBindings2(a.join,
j,c):null}};E.executeAndBGPsDPSize=function(a,c,f,h){for(var j=E.executeAndBGPsGroups(a),a=[],g=0;g<j.length;g++){var i=j[g];f.computeCosts(i,h);var m={},s={},v={},u=1,x=null,z={};v["1"]=[];for(var B=0;B<i.length;B++){var u=[],D;for(D in i[B])D!="_cost"&&(i[B][D].token==="var"?u.push(i[B][D].value):i[B][D].token==="blank"&&u.push(i[B][D].value));s["_"+B+"_"]={left:i[B],right:null,cost:i[B]._cost,i:"_"+B+"_",vars:u};u={left:i[B],right:null,cost:i[B]._cost,i:"_"+B+"_",vars:u};m["_"+B+"_"]=u;delete i[B]._cost;
z["_"+B+"_"]=!0;v["1"].push("_"+B+"_");if(x==null||x.cost>u.cost)x=u}for(var N=2;N<=i.length;N++)for(var G=1;G<N;G++)for(var C=v[""+G]||[],K=v[""+(N-G)]||[],B=0;B<C.length;B++)for(var L=0;L<K.length;L++)if(C[B]!==K[L]){var J=s[C[B]],H=s[K[L]];if(E.intersectionSize(J,H)==0&&E.connected(J,H)&&(u=N,H=E.createJoinTree(m[J.i],m[H.i]),!z[H.i])){z[H.i]=!0;var P=H.cost+1;if(m[H.i]!=null)P=m[H.i].cost;J=v[N]||[];J.push(H.i);s[H.i]=H;v[N]=J;P>H.cost&&(u===N&&(x=H),m[H.i]=H)}}a.push(x)}J=null;for(g=0;g<a.length;g++)D=
E.executeBushyTree(a[g],c,f,h),J=J==null?D:E.crossProductBindings(J,D);return J};E.executeEmptyJoinBGP=function(a,c,f,h){return E.executeBGPDatasets(a,c,f,h)};E.executeBGPDatasets=function(a,c,f,h){var j={};if(a.graph==null){for(var g=[],i=0;i<c["default"].length;i++)if(j[c["default"][i].oid]==null){j[c["default"][i].oid]=!0;a.graph=c["default"][i];var m=f.rangeQuery(a,h),m=E.buildBindingsFromRange(m,a);g.push(m)}return a=E.unionManyBindings(g)}else if(a.graph.token==="var"){for(var s=a.graph.value,
g=[],i=0;i<c.named.length;i++)if(j[c.named[i].oid]==null)if(j[c.named[i].oid]=!0,a.graph=c.named[i],m=f.rangeQuery(a,h),m!=null){for(var m=E.buildBindingsFromRange(m,a),v=0;v<m.length;v++)m[v][s]=c.named[i].oid;g.push(m)}else return null;return a=E.unionManyBindings(g||[])}else return m=f.rangeQuery(a,h),m!=null?m=E.buildBindingsFromRange(m,a):null};E.buildBindingsFromRange=function(a,c){E.variablesInBGP(c);var f={},h=c.value||c,f={};for(m in h)h[m]&&h[m].token==="var"?f[m]=h[m].value:h[m]&&h[m].token===
"blank"&&(f[m]="blank:"+h[m].value);h=[];if(a!=null)for(var j=0;j<a.length;j++){var g={},i=a[j],m;for(m in f)g[f[m]]=i[m];h.push(g)}return h};E.areCompatibleBindings=function(a,c){for(var f in a)if(c[f]!=null&&c[f]!=a[f])return!1;return!0};E.mergeBindings=function(a,c){var f={},h;for(h in a)f[h]=a[h];for(h in c)f[h]=c[h];return f};E.joinBindings2=function(a,c,f){for(var h={},j,g,i,m,s=[],v=0;v<c.length;v++){j=c[v];m=h;for(var u=0;u<a.length;u++)g=a[u],g=j[g],u==a.length-1?(i=m[g]||[],i.push(j),m[g]=
i):(i=m[g]||{},m=m[g]=i)}for(v=0;v<f.length;v++){j=f[v];m=h;for(u=0;u<a.length;u++)if(g=a[u],g=j[g],m[g]!=null)if(u==a.length-1)for(c=0;c<m[g].length;c++)s.push(E.mergeBindings(m[g][c],j));else m=m[g]}return s};E.joinBindings=function(a,c){for(var f=[],h=0;h<a.length;h++)for(var g=a[h],k=0;k<c.length;k++){var i=c[k];E.areCompatibleBindings(g,i)&&f.push(E.mergeBindings(g,i))}return f};E.augmentMissingBindings=function(a,c){for(var f in c)a[f]==null&&(a[f]=null);return a};E.leftOuterJoinBindings=function(a,
c){for(var f=[],h=0;h<a.length;h++){for(var g=a[h],k=!1,i=0;i<c.length;i++){var m=c[i];E.areCompatibleBindings(g,m)&&(k=!0,f.push(E.mergeBindings(g,m)))}k===!1&&(E.augmentMissingBindings(g,m),f.push(g))}return f};E.crossProductBindings=function(a,c){for(var f=[],h=0;h<a.length;h++)for(var g=a[h],k=0;k<c.length;k++)f.push(E.mergeBindings(g,c[k]));return f};E.unionBindings=function(a,c){return a.concat(c)};E.unionManyBindings=function(a){for(var c=[],f=0;f<a.length;f++)c=E.unionBindings(c,a[f]);return c};
var D={},ga=E;D.QueryEngine=function(a){if(arguments.length!=0)this.backend=a.backend,this.lexicon=a.lexicon,this.eventsOnBatchLoad=a.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new J.AbstractQueryTree,this.rdfLoader=new Z.RDFLoader(a.communication),this.callbacksBackend=new G.CallbacksBackend(this)};D.QueryEngine.prototype.registerNsInEnvironment=function(a,c){var f=[];if(a!=null&&a.prefixes!=null)f=a.prefixes;var h={},g;for(g in this.defaultPrefixes)h[g]=this.defaultPrefixes[g];
for(g=0;g<f.length;g++){var k=f[g];if(k.token==="prefix")h[k.prefix]=k.local}c.namespaces=h;c.base=a!=null&&a.base&&typeof a.base==="object"?a.base.value:null};D.QueryEngine.prototype.applyModifier=function(a,c){if(a=="DISTINCT"){for(var f={},h=[],g=0;g<c.length;g++){var k=c[g],i="",m;for(m in k){var s=k[m];s==null?i=i+m+"null":s.token=="literal"?(s.value!=null&&(i+=s.value),s.lang!=null&&(i+=s.lang),s.type!=null&&(i+=s.type)):i=s.value?i+m+s.value:i+m+s}f[i]==null&&(h.push(k),f[i]=!0)}return h}else return c};
D.QueryEngine.prototype.applyLimitOffset=function(a,c,f){if(c==null&&a==null)return f;a==null&&(a=0);c=c==null?f.length:a+c;return f.slice(a,c)};D.QueryEngine.prototype.applySingleOrderBy=function(a,c,f,h){for(var j=[],k=0;k<a.length;k++){var i=g.collect(a[k].expression,[c],f,h,this);j.push(i[0].value)}return{binding:c,value:j}};D.QueryEngine.prototype.applyOrderBy=function(a,c,f,h){var g=this,k=[];if(a!=null&&a.length>0){for(var i=0;i<c.length;i++){var m=g.applySingleOrderBy(a,c[i],f,h);k.push(m)}k.sort(function(c,
f){return g.compareFilteredBindings(c,f,a,h)});c=[];for(i=0;i<k.length;i++)c.push(k[i].binding)}return c};D.QueryEngine.prototype.compareFilteredBindings=function(a,c,f,h){for(var j=0;;){if(j==a.value.length)return 0;var k=f[j].direction;if(a.value[j]==null&&c.value[j]==null)j++;else{if(a.value[j]==null)a={value:!1};else if(c.value[j]==null)a={value:!0};else if(a.value[j].token==="blank"&&c.value[j].token==="blank"){j++;continue}else if(a.value[j].token==="blank")a={value:!1};else if(c.value[j].token===
"blank")a={value:!0};else if(a.value[j].token==="uri"&&c.value[j].token==="uri")if(g.runEqualityFunction(a.value[j],c.value[j],[],this,h).value==!0){j++;continue}else a=g.runTotalGtFunction(a.value[j],c.value[j],[]);else if(a.value[j].token==="uri")a={value:!1};else if(c.value[j].token==="uri")a={value:!0};else if(a.value[j].token==="literal"&&c.value[j].token==="literal"&&a.value[j].type==null&&c.value[j].type==null)if(g.runEqualityFunction(a.value[j],c.value[j],[],this,h).value==!0){j++;continue}else a=
g.runTotalGtFunction(a.value[j],c.value[j],[]);else if(a.value[j].token==="literal"&&a.value[j].type==null)a={value:!1};else if(c.value[j].token==="literal"&&c.value[j].type==null)a={value:!0};else if(g.runEqualityFunction(a.value[j],c.value[j],[],this,h).value==!0){j++;continue}else a=g.runTotalGtFunction(a.value[j],c.value[j],[]);return a.value==!0?k==="ASC"?1:-1:k==="ASC"?-1:1}}};D.QueryEngine.prototype.removeDefaultGraphBindings=function(a,c){for(var f=[],h={},g=0;g<c.named.length;g++)h[c.named[g].oid]=
!0;for(g=0;g<c["default"].length;g++)h[c["default"][g].oid]==null&&f.push(c["default"][g].oid);f=[];for(g=0;g<a.length;g++){var k=a[g],i=!1,m;for(m in k){for(var s=0;s<h.length;s++)if(k[m]===h[s]){i=!0;break}if(i)break}i||f.push(k)}return f};D.QueryEngine.prototype.aggregateBindings=function(a,c,f,h){for(var c=this.copyDenormalizedBindings(c,h.outCache),j={},k=0;k<a.length;k++){var i=g.runAggregator(a[k],c,this,f,h);a[k].alias?j[a[k].alias.value]=i:j[a[k].value.value]=i}return j};D.QueryEngine.prototype.projectBindings=
function(a,c,f){if(a[0].kind==="*")return c;else{for(var h=[],j=0;j<c.length;j++){for(var k=c[j],i={},m=!0,s=0;s<a.length;s++)if(a[s].token=="variable"&&a[s].kind!="aliased")i[a[s].value.value]=k[a[s].value.value];else if(a[s].token=="variable"&&a[s].kind=="aliased"){var v=g.runFilter(a[s].expression,k,this,f,{blanks:{},outCache:{}});if(g.isEbvError(v)){m=!1;break}else i[a[s].alias.value]=v}m===!0&&h.push(i)}return h}};D.QueryEngine.prototype.resolveNsInEnvironment=function(a,c){return c.namespaces[a]};
D.QueryEngine.prototype.termCost=function(a,c){if(a.token==="uri"){var f=z.lexicalFormBaseUri(a,c);return f==null?0:this.lexicon.resolveUriCost(f)}else return a.token==="literal"?this.lexicon.resolveLiteralCost(z.lexicalFormLiteral(a,c)):a.token==="blank"?this.lexicon.resolveBlankCost(a.value):a.token==="var"?this.lexicon.oidCounter/3:null};D.QueryEngine.prototype.normalizeTerm=function(a,c,f){if(a.token==="uri")return c=z.lexicalFormBaseUri(a,c),c==null?null:f?this.lexicon.registerUri(c):this.lexicon.resolveUri(c);
else if(a.token==="literal")return c=z.lexicalFormLiteral(a,c),a=f?this.lexicon.registerLiteral(c):this.lexicon.resolveLiteral(c);else if(a.token==="blank"){var h=a.value,a=c.blanks[h];a==null&&(a=f?this.lexicon.registerBlank(h):this.lexicon.resolveBlank(h),c.blanks[h]=a);return a}else return a.token==="var"?a.value:null};D.QueryEngine.prototype.normalizeDatasets=function(a,c){for(var f=0;f<a.length;f++){var h=a[f];if(h.value===this.lexicon.defaultGraphUri)h.oid=this.lexicon.defaultGraphOid;else{var g=
this.normalizeTerm(h,c,!1);if(g!=null)h.oid=g;else return null}}return!0};D.QueryEngine.prototype.normalizeQuad=function(a,c,f){var h=null,g=null,k=h=null,i;if(a.graph==null)k=0;else if(i=this.normalizeTerm(a.graph,c,f),i!=null)k=i,f===!0&&a.graph.token!="var"&&this.lexicon.registerGraph(i);else return null;i=this.normalizeTerm(a.subject,c,f);if(i!=null)h=i;else return null;i=this.normalizeTerm(a.predicate,c,f);if(i!=null)g=i;else return null;i=this.normalizeTerm(a.object,c,f);return i==null?null:
{subject:h,predicate:g,object:i,graph:k}};D.QueryEngine.prototype.quadCost=function(a,c){var f=null,h=null,g=null,k=null,k=a.graph==null?this.lexicon.oidCounter/4:this.termCost(a.graph,c),f=this.termCost(a.subject,c),h=this.termCost(a.predicate,c),g=this.termCost(a.object,c);return k+f+h+g};D.QueryEngine.prototype.denormalizeBindingsList=function(a,c){for(var f=[],h=0;h<a.length;h++)result=this.denormalizeBindings(a[h],c),f.push(result);return f};D.QueryEngine.prototype.copyDenormalizedBindings=function(a,
c){for(var f=[],h=0;h<a.length;h++){for(var g={},k=a[h],i=z.keys(k),m=0;m<i.length;m++){var s=k[i[m]];if(s==null)g[i[m]]=null;else if(typeof s==="object")g[i[m]]=s;else{var v=c[s];v==null&&(v=this.lexicon.retrieve(s),c[s]=v);g[i[m]]=v}}f.push(g)}return f};D.QueryEngine.prototype.denormalizeBindings=function(a,c){for(var f=z.keys(a),h=0;h<f.length;h++){var g=a[f[h]];g==null?a[f[h]]=null:c[g]!=null?a[f[h]]=c[g]:(g=this.lexicon.retrieve(g),a[f[h]]=g)}return a};D.QueryEngine.prototype.execute=function(a,
c,f,h){a=z.normalizeUnicodeLiterals(a);a=this.abstractQueryTree.parseQueryString(a);if(a==null)c(!1,"Error parsing query string");else if(a.token==="query"&&a.kind=="update"){this.callbacksBackend.startGraphModification();var g=this;this.executeUpdate(a,function(a,f){g.lexicon.updateAfterWrite&&g.lexicon.updateAfterWrite();a?g.callbacksBackend.endGraphModification(function(){c(a,f)}):(g.callbacksBackend.cancelGraphModification(),c(a,f))})}else a.token==="query"&&a.kind=="query"&&this.executeQuery(a,
c,f,h)};D.QueryEngine.prototype.executeQuery=function(a,c,f,h){var g=a.units,k=this,i={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,i);var m=k.abstractQueryTree.parseExecutableUnit(g[0]);if(m.kind==="select")this.executeSelect(m,i,f,h,function(a,f){a?typeof f==="object"&&f.denorm===!0?c(!0,f.bindings):(f=k.denormalizeBindingsList(f,i.outCache),f!=null?c(!0,f):c(!1,f)):c(!1,f)});else if(m.kind==="ask")m.projection=[{token:"variable",kind:"*"}],this.executeSelect(m,i,f,h,function(a,
f){a?a?f.length>0?c(!0,!0):c(!0,!1):c(!1,f):c(!1,f)});else if(m.kind==="construct")m.projection=[{token:"variable",kind:"*"}],k=this,this.executeSelect(m,i,f,h,function(a,f){if(a)if(a)if(f=k.denormalizeBindingsList(f,i.outCache),f!=null){var h=new x.Graph;if(m.template==null)m.template={triplesContext:m.pattern};for(var g=1,j=[],z=0;z<f.length;z++){for(var E=f[z],D=0;D<j.length;D++)delete j[D].valuetmp;for(D=0;D<m.template.triplesContext.length;D++){for(var G=["subject","predicate","object"],C=m.template.triplesContext[D],
H=0;H<G.length;H++){var J=G[H];if(C[J].token==="blank"&&!(C[J].valuetmp&&C[J].valuetmp!=null)){var K="_:b"+g;g++;C[J].valuetmp=K;j.push(C[J])}}G=x.buildRDFResource(C.subject,E,k,i);H=x.buildRDFResource(C.predicate,E,k,i);C=x.buildRDFResource(C.object,E,k,i);G!=null&&H!=null&&C!=null&&(H=new x.Triple(G,H,C),h.add(H))}}c(!0,h)}else c(!1,f);else c(!1,f);else c(!1,f)})};D.QueryEngine.prototype.executeSelect=function(a,c,f,h,g){if(a.kind==="select"||a.kind==="ask"||a.kind==="construct"||a.kind==="modify"){var k=
a.projection,i=a.dataset,m=a.modifier,s=a.limit,v=a.offset,u=a.order;if(f!=null||h!=null)i["default"]=f||[],i.named=h||[];i["default"]!=null&&i["default"].length===0&&i.named!=null&&i.named.length===0&&i["default"].push(this.lexicon.defaultGraphUriTerm);if(this.normalizeDatasets(i["default"].concat(i.named),c)!=null)if(h=this.executeSelectUnit(k,i,a.pattern,c),h!=null){if(a.group!=null&&a.group===""){for(var x=!1,f=0;f<a.projection.length;f++)if(a.projection[f].expression!=null&&a.projection[f].expression.expressionType===
"aggregate"){x=!0;break}if(x===!0)a.group="singleGroup"}if(a.group&&a.group!="")if(this.checkGroupSemantics(a.group,k)){m=this.groupSolution(h,a.group,i,c);s=[];for(f=0;f<m.length;f++)v=this.aggregateBindings(k,m[f],i,c),s.push(v);g(!0,{bindings:s,denorm:!0})}else g(!1,"Incompatible Group and Projection variables");else c=this.applyOrderBy(u,h,i,c),k=this.projectBindings(k,c,i),modifiedBindings=this.applyModifier(m,k),filteredBindings=this.removeDefaultGraphBindings(this.applyLimitOffset(v,s,modifiedBindings),
i),g(!0,filteredBindings)}else g(!1,h);else g(!1,"Error normalizing datasets")}else g(!1,"Cannot execute "+a.kind+" query as a select query")};D.QueryEngine.prototype.groupSolution=function(a,c,f,h){var j=[],k=[],i=!1;if(c==="singleGroup")return[a];else{for(var m=0;m<a.length;m++){for(var s=a[m],v=!0,u=0;u<c.length;u++){var x=c[u],z=null;if(x.token==="var")z=x.value,i==!1&&j.push(z);else if(x.token==="aliased_expression")if(z=x.alias.value,i==!1&&j.push(z),x.expression.primaryexpression==="var")s[x.alias.value]=
s[x.expression.value.value];else if(z=this.copyDenormalizedBindings([s],h.outCache),z=g.runFilter(x.expression,z[0],this,f,h),g.isEbvError(z))v=!1;else{if(z.value!=null)z.value=""+z.value;s[x.alias.value]=z}else z=this.copyDenormalizedBindings([s],h.outCache),z=g.runFilter(x,z[0],this,h),g.isEbvError(z)?v=!1:(s["groupCondition"+env._i]=z,z="groupCondition"+env._i,i==!1&&j.push(z))}i==!1&&(i=!0);v===!0&&k.push(s)}a={};for(m=0;m<k.length;m++){c=k[m];f="";for(u=0;u<j.length;u++)h=c[j[u]],f+=typeof h===
"object"?h.value:h;a[f]==null?a[f]=[c]:a[f].push(c)}var j=[],B;for(B in a)j.push(a[B]);return j}};D.QueryEngine.prototype.executeSelectUnit=function(a,c,f,h){return f.kind==="BGP"?this.executeAndBGP(a,c,f,h):f.kind==="UNION"?this.executeUNION(a,c,f.value,h):f.kind==="JOIN"?this.executeJOIN(a,c,f,h):f.kind==="LEFT_JOIN"?this.executeLEFT_JOIN(a,c,f,h):f.kind==="FILTER"?(a=this.executeSelectUnit(a,c,f.value,h),a!=null?a=g.checkFilters(f,a,!1,c,h,this):[]):f.kind==="EMPTY_PATTERN"?[]:f.kind==="ZERO_OR_MORE_PATH"||
f.kind==="ONE_OR_MORE_PATH"?this.executeZeroOrMorePath(f,c,h):(console.log("Cannot execute query pattern "+f.kind+". Not implemented yet."),null)};D.QueryEngine.prototype.executeZeroOrMorePath=function(a,c,f){var h=[];a.x.token==="var"&&h.push({token:"variable",kind:"var",value:a.x.value});a.y.token==="var"&&h.push({token:"variable",kind:"var",value:a.y.value});h.length===0&&h.push({token:"variable",kind:"*"});if(a.x.token==="var"&&a.y.token==="var"){var g=this.executeAndBGP(h,c,a.path,f),k={},h=
[],i,m,s,v,u=a.x.value;m=a.x;for(var x=a.path,F=0;F<g.length;F++)if(i=g[F][u],k[i]==null){v=this.lexicon.retrieve(i);a.x=v;a.path=this.abstractQueryTree.replace(x,m,v,f);x=z.clone(a.path);m=this.executeZeroOrMorePath(a,c,f);for(var B=0;B<m.length;B++)s=m[B],s[u]=i,h.push(s);m=v}return h}else if(a.x.token!=="var"&&a.y.token==="var"){k={};i=!0;v=[];for(u=[];i==!0||v.length!==0;){i===!0?(g=this.executeAndBGP(h,c,a.path,f),m=a.x,i=!1):(x=this.lexicon.retrieve(v.pop()),g=a.path,g=this.abstractQueryTree.replace(g,
m,x,f),g=this.executeAndBGP(h,c,g,f),m=x);for(F=0;F<g.length;F++)x=g[F][a.y.value],k[x]!==!0&&(s={},s[a.y.value]=x,u.push(s),k[x]=!0,v.push(x))}return u}else throw"Kind of path not supported!";};D.QueryEngine.prototype.executeUNION=function(a,c,f,h){var j=f[0],k=f[1],i=null,m=null;if(f.length!=2)throw"SPARQL algebra UNION with more than two components";i=this.executeSelectUnit(a,c,j,h);if(i==null)return null;m=this.executeSelectUnit(a,c,k,h);if(m==null)return null;a=ga.unionBindings(i,m);return a=
g.checkFilters(f,a,!1,c,h,this)};D.QueryEngine.prototype.executeAndBGP=function(a,c,f,h){a=ga.executeAndBGPsDPSize(f.value,c,this,h);return a!=null?g.checkFilters(f,a,!1,c,h,this):null};D.QueryEngine.prototype.executeLEFT_JOIN=function(a,c,f,h){var j=f.rvalue,k=null,i=null,k=this.executeSelectUnit(a,c,f.lvalue,h);if(k==null)return null;i=this.executeSelectUnit(a,c,j,h);if(i==null)return null;a=ga.leftOuterJoinBindings(k,i);c=g.checkFilters(f,a,!0,c,h,this);if(k.length>1&&i.length>1){var f=[],h={},
m;for(m in k[0])h[m]=!0;for(m in i[0])h[m]!=!0&&f.push(m);k=[];i={};for(h=0;h<c.length;h++)if(c[h].__nullify__===!0){for(j=0;j<f.length;j++)c[h].bindings[f[j]]=null;j=[];a=[];for(m in c[h].bindings)c[h].bindings[m]!=null&&(j.push(m+c[h].bindings[m]),j.sort(),a.push(j.join("")));if(i[j.join("")]==null){for(j=0;j<a.length;j++)i[a[j]]=!0;k.push(c[h].bindings)}}else for(m in k.push(c[h]),j=[],c[h])j.push(m+c[h][m]),j.sort(),i[j.join("")]=!0;return k}else return c};D.QueryEngine.prototype.executeJOIN=
function(a,c,f,h){var j=f.lvalue,k=f.rvalue,i=null,m=null,i=this.executeSelectUnit(a,c,j,h);if(i==null)return null;m=this.executeSelectUnit(a,c,k,h);if(m==null)return null;a=null;if(i.length===0||m.length===0)a=[];else{var a={},s=[],v;for(v in i[0])a[v]=!1;for(v in m[0])a[v]===!1&&s.push(v);a=s.length==0?ga.joinBindings(i,m):this.abstractQueryTree.treeWithUnion(j)||this.abstractQueryTree.treeWithUnion(k)?ga.joinBindings(i,m):ga.joinBindings2(s,i,m)}return a=g.checkFilters(f,a,!1,c,h,this)};D.QueryEngine.prototype.rangeQuery=
function(a,c){var f=this.normalizeQuad(a,c,!1);return f!=null?(f=this.backend.range(new T.Pattern(f)),f==null||f.length==0?[]:f):(console.log("ERROR normalizing quad"),null)};D.QueryEngine.prototype.executeUpdate=function(a,c){var f=a.units,h=this,g={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,g);for(var k=0;k<f.length;k++){var i=h.abstractQueryTree.parseExecutableUnit(f[k]);if(i.kind==="insertdata"){for(var m=0;m<i.quads.length;m++){var s=i.quads[m];if(h._executeQuadInsert(s,g)!==
!0)return c(!1,error)}c(!0)}else if(i.kind==="deletedata"){for(m=0;m<i.quads.length;m++)s=i.quads[m],this._executeQuadDelete(s,g);c(!0)}else if(i.kind==="modify")this._executeModifyQuery(i,g,c);else if(i.kind==="create")c(!0);else if(i.kind==="load")m={uri:z.lexicalFormBaseUri(i.sourceGraph,g)},i.destinyGraph!=null&&(m={uri:z.lexicalFormBaseUri(i.destinyGraph,g)}),h=this,this.rdfLoader.load(i.sourceGraph.value,m,function(a,f){a==!1?(console.log("Error loading graph"),console.log(f),c(!1,"error batch loading quads")):
(f=h.batchLoad(f),c(f!=null,f||"error batch loading quads"))});else if(i.kind==="drop")this._executeClearGraph(i.destinyGraph,g,c);else if(i.kind==="clear")this._executeClearGraph(i.destinyGraph,g,c);else throw Error("not supported execution unit");}};D.QueryEngine.prototype.batchLoad=function(a,c){var f=null,h=null,g=null,k=null,i=0,m=!0,s={},v,u;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();for(var x=0;x<a.length;x++)if(u=a[x],u.subject.uri||u.subject.token==="uri"?v=this.lexicon.registerUri(u.subject.uri||
u.subject.value):u.subject.literal||u.subject.token==="literal"?v=this.lexicon.registerLiteral(u.subject.literal||u.subject.value):(v=s[u.subject.blank||u.subject.value],v==null&&(v=this.lexicon.registerBlank(u.subject.blank||u.subject.value),s[u.subject.blank||u.subject.value]=v)),f=v,u.predicate.uri||u.predicate.token==="uri"?v=this.lexicon.registerUri(u.predicate.uri||u.predicate.value):u.predicate.literal||u.predicate.token==="literal"?v=this.lexicon.registerLiteral(u.predicate.literal||u.predicate.value):
(v=s[u.predicate.blank||u.predicate.value],v==null&&(v=this.lexicon.registerBlank(u.predicate.blank||u.predicate.value),s[u.predicate.blank||u.predicate.value]=v)),h=v,u.object.uri||u.object.token==="uri"?v=this.lexicon.registerUri(u.object.uri||u.object.value):u.object.literal||u.object.token==="literal"?v=this.lexicon.registerLiteral(u.object.literal||u.object.value):(v=s[u.object.blank||u.object.value],v==null&&(v=this.lexicon.registerBlank(u.object.blank||u.object.value),s[u.object.blank||u.object.value]=
v)),g=v,u.graph.uri||u.graph.token==="uri"?(v=this.lexicon.registerUri(u.graph.uri||u.graph.value),this.lexicon.registerGraph(v)):u.graph.literal||u.graph.token==="literal"?v=this.lexicon.registerLiteral(u.graph.literal||u.graph.value):(v=s[u.graph.blank||u.graph.value],v==null&&(v=this.lexicon.registerBlank(u.graph.blank||u.graph.value),s[u.graph.blank||u.graph.value]=v)),k=v,v=u,u={subject:f,predicate:h,object:g,graph:k},f=new T.NodeKey(u),h=this.backend.search(f),!h)if(h=this.backend.index(f),
h==!0)this.eventsOnBatchLoad&&this.callbacksBackend.nextGraphModification(G.added,[v,u]),i+=1;else{m=!1;break}this.lexicon.updateAfterWrite!=null&&this.lexicon.updateAfterWrite();var z=function(){m?c&&c(!0,i):c&&c(!1,null)};this.eventsOnBatchLoad?this.callbacksBackend.endGraphModification(function(){z()}):z();return m?i:null};D.QueryEngine.prototype.computeCosts=function(a,c){for(var f=0;f<a.length;f++)a[f]._cost=this.quadCost(a[f],c);return a};D.QueryEngine.prototype._executeModifyQuery=function(a,
c,f){var h=this,g=!0,k=null,i=["subject","predicate","object","graph"];a.insert=a.insert==null?[]:a.insert;a["delete"]=a["delete"]==null?[]:a["delete"];z.seq(function(f){var i=[],v=[];a["with"]!=null&&i.push(a["with"]);if(a.using!=null)for(var v=[],u=0;u<a.using.length;u++){var x=a.using[u];x.kind==="named"?v.push(x.uri):i.push(x.uri)}a.dataset={};a.projection=[{token:"variable",kind:"*"}];h.executeSelect(a,c,i,v,function(a,i){a?(i=h.denormalizeBindingsList(i,c.outCache),i!=null?k=i:g=!1):g=!1;return f()})},
function(f){var s=a["with"];if(g){for(var v=[],u=0;u<a["delete"].length;u++)for(var x=a["delete"][u],z=0;z<k.length;z++){for(var B={},E=k[z],D=0;D<i.length;D++){var C=i[D];C=="graph"&&x[C]==null?B.graph=s:B[C]=x[C].token==="var"?E[x[C].value]:x[C]}v.push(B)}for(z=0;z<v.length;z++)B=v[z],h._executeQuadDelete(B,c)}f()},function(f){var s=a["with"];if(g){for(var v=[],u=0;u<a.insert.length;u++)for(var x=a.insert[u],z=0;z<k.length;z++){for(var B={},E=k[z],D=0;D<i.length;D++){var C=i[D];C=="graph"&&x[C]==
null?B.graph=s:B[C]=x[C].token==="var"?E[x[C].value]:x[C]}v.push(B)}for(u=0;u<v.length;u++)B=v[u],h._executeQuadInsert(B,c)}f()})(function(){f(g)})};D.QueryEngine.prototype._executeQuadInsert=function(a,c){var f=this.normalizeQuad(a,c,!0);if(f!=null){var h=new T.NodeKey(f),g=this.backend.search(h);return g?g:(g=this.backend.index(h),g==!0?(this.callbacksBackend.nextGraphModification(G.added,[a,f]),!0):(console.log("ERROR inserting quad"),!1))}else return console.log("ERROR normalizing quad"),!1};
D.QueryEngine.prototype._executeQuadDelete=function(a,c){var f=this.normalizeQuad(a,c,!1);if(f!=null){var h=new T.NodeKey(f);this.backend["delete"](h);return this.lexicon.unregister(a,h)==!0?(this.callbacksBackend.nextGraphModification(G.deleted,[a,f]),!0):(console.log("ERROR unregistering quad"),!1)}else return console.log("ERROR normalizing quad"),!1};D.QueryEngine.prototype._executeClearGraph=function(a,c,f){if(a==="default")this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",f);else if(a===
"named"){var h=this,g=this.lexicon.registeredGraphs(!0);if(g!=null){var k=!1;z.repeat(0,g.length,function(a,c){var f=g[c._i],v=arguments.callee;k?a(v,c):h.execute("DELETE { GRAPH <"+f+"> { ?s ?p ?o } } WHERE { GRAPH <"+f+"> { ?s ?p ?o } }",function(f){k=!f;a(v,c)})},function(){f(!k)})}else f(!1,"Error deleting named graphs")}else a==="all"?(h=this,this.execute("CLEAR DEFAULT",function(a,c){a?h.execute("CLEAR NAMED",f):f(!1,c)})):a.token=="uri"?(a=z.lexicalFormBaseUri(a,c),a!=null?this.execute("DELETE { GRAPH <"+
a+"> { ?s ?p ?o } } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",f):f(!1,"wrong graph URI")):f(!1,"wrong graph URI")};D.QueryEngine.prototype.checkGroupSemantics=function(a,c){if(a==="singleGroup")return!0;for(var f={},h=0;h<a.length;h++){var g=a[h];g.token==="var"?f[g.value]=!0:g.token==="aliased_expression"&&(f[g.alias.value]=!0)}for(h=0;h<c.length;h++)if(g=c[h],g.kind==="var"){if(f[g.value.value]==null)return!1}else if(g.kind==="aliased"&&g.expression&&g.expression.primaryexpression==="var"&&f[g.expression.value.value]==
null)return!1;return!0};D.QueryEngine.prototype.registerDefaultNamespace=function(a,c){this.defaultPrefixes[a]=c};var G={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(a){this.aqt=new J.AbstractQueryTree;this.engine=a;this.indexMap={};this.observersMap={};this.queriesIndexMap={};this.emptyNotificationsMap={};this.queriesList=[];this.pendingQueries=[];this.matchedQueries=[];this.updateInProgress=null;this.indices=["SPOG","GP",
"OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};this.callbackCounter=0;this.callbacksMap={};this.callbacksInverseMap={};this.queryCounter=0;this.queriesMap={};this.queriesCallbacksMap={};this.queriesInverseMap={};for(a=0;a<this.indices.length;a++){var c=
this.indices[a];this.indexMap[c]={};this.queriesIndexMap[c]={}}}};G.CallbacksBackend.prototype.startGraphModification=function(){this.pendingQueries=[].concat(this.queriesList);this.matchedQueries=[];if(this.updateInProgress==null)this.updateInProgress={added:[],deleted:[]}};G.CallbacksBackend.prototype.nextGraphModification=function(a,c){this.updateInProgress[a].push(c)};G.CallbacksBackend.prototype.endGraphModification=function(a){var c=this;if(this.updateInProgress!=null){var f=c.updateInProgress;
c.updateInProgress=null;this.sendNotification(G.deleted,f[G.deleted],function(){c.sendNotification(G.added,f[G.added],function(){c.sendEmptyNotification(G.eventsFlushed,null,function(){c.dispatchQueries(function(){a(!0)})})})})}else a(!0)};G.CallbacksBackend.prototype.cancelGraphModification=function(){this.updateInProgress=null};G.CallbacksBackend.prototype.sendNotification=function(a,c,f){for(var h={},g=0;g<c.length;g++){var k=c[g],i;for(i in this.indexMap){var m=this.indexMap[i],s=this.componentOrders[i];
this._searchCallbacksInIndex(m,s,a,k,h);this.pendingQueries.length!=0&&(m=this.queriesIndexMap[i],this._searchQueriesInIndex(m,s,k))}}this.dispatchNotifications(h);f!=null&&f(!0)};G.CallbacksBackend.prototype.sendEmptyNotification=function(a,c,f){for(var h=this.emptyNotificationsMap[a]||[],g=0;g<h.length;g++)h[g](a,c);f()};G.CallbacksBackend.prototype.dispatchNotifications=function(a){for(var c in a){var f=this.callbacksMap[c],h=a[c][G.deleted];h!=null&&f(G.deleted,h);for(var g in a[c])g!=G.deleted&&
f(g,a[c][g])}};G.CallbacksBackend.prototype._searchCallbacksInIndex=function(a,c,f,h,g){for(var k=h[1],h=h[0],i=0;i<c.length+1;i++){for(var m=a._||[],s=[],v=0;v<m.length;v++){var u=m[v];this.callbacksMap[u]!=null&&(g[u]=g[u]||{},g[u][f]=g[u][f]||[],g[u][f].push(h),s.push(u))}a._=s;m=c[i];if(a[""+k[m]]!=null)a=a[""+k[m]];else break}};G.CallbacksBackend.prototype.subscribeEmpty=function(a,c){var f=this.emptyNotificationsMap[a]||[];f.push(c);this.emptyNotificationsMap[a]=f};G.CallbacksBackend.prototype.unsubscribeEmpty=
function(a,c){var f=this.emptyNotificationsMap[a];f!=null&&(f=z.remove(f,c));this.emptyNotificationsMap[a]=f};G.CallbacksBackend.prototype.subscribe=function(a,c,f,h,g,k){a=this._tokenizeComponents(a,c,f,h);c={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,c);a=this.engine.normalizeQuad(a,c,!0);f=this._indexForPattern(new T.Pattern(a));c=this.componentOrders[f];f=this.indexMap[f];for(h=0;h<c.length;h++){var i=a[c[h]];if(i==="_"){f._==null&&(f._=[]);this.callbackCounter++;f._.push(this.callbackCounter);
this.callbacksMap[this.callbackCounter]=g;this.callbacksInverseMap[g]=this.callbackCounter;break}else h===c.length-1?(f[i]=f[i]||{_:[]},this.callbackCounter++,f[i]._.push(this.callbackCounter),this.callbacksMap[this.callbackCounter]=g,this.callbacksInverseMap[g]=this.callbackCounter):(f[i]=f[i]||{},f=f[i])}k!=null&&k(!0)};G.CallbacksBackend.prototype.unsubscribe=function(a){var c=this.callbacksInverseMap[a];c!=null&&(delete this.callbacksInverseMap[a],delete this.callbacksMap[c])};G.CallbacksBackend.prototype._tokenizeComponents=
function(a,c,f,h){var g={};g.subject=a==null?G.ANYTHING:a.indexOf("_:")==0?{token:"blank",value:a}:{token:"uri",value:a};g.predicate=c==null?G.ANYTHING:{token:"uri",value:c};g.object=f==null?G.ANYTHING:{token:"uri",value:f};g.graph=h==null?G.ANYTHING:{token:"uri",value:h};return g};G.CallbacksBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,f=0;f<c.length;f++)for(var h=c[f],g=this.componentOrders[h],k=0;k<g.length;k++){if(z.include(a,g[k])===!1)break;if(k==a.length-
1)return h}return"SPOG"};G.CallbacksBackend.prototype.observeNode=function(){var a,c,f,h;arguments.length===4?(a=arguments[0],c=arguments[1],f=arguments[2],h=arguments[3]):(a=arguments[0],c=this.engine.lexicon.defaultGraphUri,f=arguments[1],h=arguments[2]);c="CONSTRUCT { <"+a+"> ?p ?o } WHERE { GRAPH <"+c+"> { <"+a+"> ?p ?o } }";var g=this,k={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,k);var i=[];this.engine.execute(c,function(c,s){if(c){var v=!1,u=function(a,c){if(a==="eventsFlushed"&&
v)v=!1,f(s);else if(a!=="eventsFlushed"){v=!0;for(var h=0;h<c.length;h++){var m=c[h],u=x.buildRDFResource(m.subject,i,g.engine,k),z=x.buildRDFResource(m.predicate,i,g.engine,k),m=x.buildRDFResource(m.object,i,g.engine,k);u!=null&&z!=null&&m!=null&&(m=new x.Triple(u,z,m),a===G.added?s.add(m):a===G.deleted&&s.remove(m))}}};g.observersMap[f]=u;g.subscribeEmpty(G.eventsFlushed,u);g.subscribe(a,null,null,null,u,function(){f(s);h&&h(!0)})}else h&&h(!1)})};G.CallbacksBackend.prototype.stopObservingNode=
function(a){return(a=this.observersMap[a])?(this.unsubscribe(a),this.unsubscribeEmpty(G.eventsFlushed,a),!0):!1};G.CallbacksBackend.prototype.observeQuery=function(a,c,f){var h=this.aqt.collectBasicTriples(this.aqt.parseSelect(this.aqt.parseQueryString(a).units[0])),g={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,g);var k,i,m,s=this.queryCounter;this.queryCounter++;this.queriesMap[s]=a;this.queriesInverseMap[a]=s;this.queriesList.push(s);this.queriesCallbacksMap[s]=c;for(var v=
0;v<h.length;v++){i=h[v];if(i.graph==null)i.graph=this.engine.lexicon.defaultGraphUriTerm;i=this.engine.normalizeQuad(i,g,!0);k=new T.Pattern(i);m=this._indexForPattern(k);k=this.componentOrders[m];m=this.queriesIndexMap[m];for(var u=0;u<k.length;u++){var x=i[k[u]];if(typeof x==="string"){m._==null&&(m._=[]);m._.push(s);break}else u===k.length-1?(m[x]=m[x]||{_:[]},m[x]._.push(s)):(m[x]=m[x]||{},m=m[x])}}this.engine.execute(a,function(a,f){a?c(f):console.log("ERROR in query callback "+f)});f!=null&&
f()};G.CallbacksBackend.prototype.stopObservingQuery=function(a){var c=this.queriesInverseMap[a];if(c!=null)delete this.queriesInverseMap[a],delete this.queriesMap[c],this.queriesList=z.remove(this.queriesList,c)};G.CallbacksBackend.prototype._searchQueriesInIndex=function(a,c,f){for(var f=f[1],h=0;h<c.length+1;h++){for(var g=a._||[],k=[],i=0;i<g.length;i++){var m=g[i];z.include(this.pendingQueries,m)&&(z.remove(this.pendingQueries,m),this.matchedQueries.push(m));this.queriesMap[m]!=null&&k.push(m)}a._=
k;g=c[h];if(a[""+f[g]]!=null)a=a[""+f[g]];else break}};G.CallbacksBackend.prototype.dispatchQueries=function(a){var c=this,f,g,j,k;z.repeat(0,this.matchedQueries.length,function(a,m){f=arguments.callee;j=c.matchedQueries[m._i];g=c.queriesMap[j];k=c.queriesCallbacksMap[j];z.recur(function(){c.engine.execute(g,function(c,g){c?k(g):console.log("ERROR executing query callback "+g);a(f,m)})})},function(){a()})};var L={};try{typeof Worker=="undefined"&&(Worker=null)}catch(Bc){Worker=null}if(Worker)L.RDFStoreClient=
function(a,c,f){console.log("trying to load "+a);this.connection=Worker.Worker?new Worker.Worker(a):new Worker(a);this.callbacksCounter=1;var g=this;this.rdf=x.rdf;console.log("The worker");console.log(this.connection);g=this;this.connection.onmessage=function(a){g.receive(a)};this.observingCallbacks={};this.callbacks={0:{cb:function(a,c){a===!0?f(!0,g):f(!1,c)},fn:"create"}};this.connection.postMessage({fn:"create",args:c,callback:"0"})},L.RDFStoreClient.prototype.receive=function(a){event=a.data||
a;if(event.fn==="workerRequest:NetworkTransport:load"){var c=this,f=event.callback,a=event.arguments.concat(function(a,g){c.connection.postMessage({fn:"workerRequestResponse",results:[a,g],callback:f})});P.load.apply(P,a)}else if(a=this.callbacks[event.callback])a.fn==="create"||a.fn==="execute"||a.fn==="insert"||a.fn=="graph"||a.fn==="node"||a.fn==="insert"||a.fn==="delete"||a.fn==="clear"||a.fn==="load"||a.fn==="startObservingQueryEndCb"||a.fn==="registeredGraphs"?(delete this.callbacks[event.callback],
a.cb(event.success,event.result)):a.fn==="startObservingQuery"?a.cb(event.result):a.fn==="startObservingNode"?a.cb(event.result):a.fn==="subscribe"&&a.cb(event.event,event.result)},L.RDFStoreClient.prototype.registerCallback=function(a,c){var f=""+this.callbacksCounter;this.callbacks[f]={fn:a,cb:c};this.callbacksCounter++;return f},L.RDFStoreClient.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],
arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);c=this.registerCallback("execute",c);this.connection.postMessage({fn:"execute",args:[a],callback:c})}},L.RDFStoreClient.prototype.insert=function(){var a,c,f;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"insert",args:[c]});else if(arguments.length===2)c=arguments[0],f=arguments[1]||function(){},f=this.registerCallback("insert",
f),this.connection.postMessage({fn:"insert",args:[c],callback:f});else if(arguments.length===3)c=arguments[0],a=arguments[1],f=arguments[2]||function(){},f=this.registerCallback("insert",f),this.connection.postMessage({fn:"insert",args:[c,a],callback:f});else throw"The triples to insert, an optional graph and callback must be provided";},L.RDFStoreClient.prototype.graph=function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){};else if(arguments.length===2)c=arguments[1]||function(){},
a=arguments[0];else throw"An optional graph URI and a callback function must be provided";var f=this,g=this.registerCallback("insert",function(a,g){if(a){for(var h,m=0;m<g.triples.length;m++)h=g.triples[m],g.triples[m]=new x.Triple(f.adaptJSInterface(h.subject),f.adaptJSInterface(h.predicate),f.adaptJSInterface(h.object));c(a,f.rdf.createGraph(g.triples))}else c(a,g)});a==null?this.connection.postMessage({fn:"graph",args:[],callback:g}):this.connection.postMessage({fn:"graph",args:[a],callback:g})},
L.RDFStoreClient.prototype.node=function(){var a=null,c=null,f=null;if(arguments.length===2)f=arguments[0],c=arguments[1]||function(){};else if(arguments.length===3)f=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI and a callback function must be provided";var g=this,j=this.registerCallback("insert",function(a,f){if(a){for(var j,s=0;s<f.triples.length;s++)j=f.triples[s],f.triples[s]=new x.Triple(g.adaptJSInterface(j.subject),g.adaptJSInterface(j.predicate),
g.adaptJSInterface(j.object));c(a,g.rdf.createGraph(f.triples))}else c(a,f)});a==null?this.connection.postMessage({fn:"node",args:[f],callback:j}):this.connection.postMessage({fn:"node",args:[f,a],callback:j})},L.RDFStoreClient.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c);this.connection.postMessage({fn:"rdf/setPrefix",args:[a,c],callback:null})},L.RDFStoreClient.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a);this.connection.postMessage({fn:"rdf/setDefaultPrefix",
args:[a],callback:null})},L.RDFStoreClient.prototype["delete"]=function(){var a,c,f;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"delete",args:[c]});else if(arguments.length===2)c=arguments[0],f=arguments[1]||function(){},f=this.registerCallback("delete",f),this.connection.postMessage({fn:"delete",args:[c],callback:f});else if(arguments.length===3)c=arguments[0],a=arguments[1],f=arguments[2]||function(){},f=this.registerCallback("delete",f),this.connection.postMessage({fn:"delete",
args:[c,a],callback:f});else throw"The triples to delete, an optional graph and callback must be provided";},L.RDFStoreClient.prototype.clear=function(){var a,c;if(arguments.length===1)c=arguments[0]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[],callback:c});else if(arguments.length===2)a=arguments[0],c=arguments[1]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[a],callback:c});else throw"The optional graph and a callback must be provided";
},L.RDFStoreClient.prototype.setBatchLoadEvents=function(a){this.connection.postMessage({fn:"setBatchLoadEvents",args:[a]})},L.RDFStoreClient.prototype.registerDefaultNamespace=function(a,c){this.connection.postMessage({fn:"registerDefaultNamespace",args:[a,c]})},L.RDFStoreClient.prototype.registerDefaultProfileNamespaces=function(){this.connection.postMessage({fn:"registerDefaultProfileNamespaces",args:[]})},L.RDFStoreClient.prototype.load=function(){var a,c,f,g;if(arguments.length===3)a=arguments[0],
c=arguments[1],g=arguments[2]||function(){},g=this.registerCallback("load",g),this.connection.postMessage({fn:"load",args:[a,c],callback:g});else if(arguments.length===4)a=arguments[0],c=arguments[1],f=arguments[2],g=arguments[3]||function(){},g=this.registerCallback("load",g),this.connection.postMessage({fn:"load",args:[a,c,f],callback:g});else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";},L.RDFStoreClient.prototype.startObservingQuery=
function(a,c,f){f!=null?(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=c,f=this.registerCallback("startObservingQueryEndCb",f),this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c,f]})):(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=c,this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c]}))},L.RDFStoreClient.prototype.stopObservingQuery=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];
delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingQuery",args:[a],callback:[]})},L.RDFStoreClient.prototype.startObservingNode=function(){var a,c,f;if(arguments.length===2){a=arguments[0];f=arguments[1];var g=this,j=this.registerCallback("startObservingNode",function(a){for(var c,j=0;j<a.triples.length;j++)c=a.triples[j],a.triples[j]=new x.Triple(g.adaptJSInterface(c.subject),g.adaptJSInterface(c.predicate),g.adaptJSInterface(c.object));f(g.rdf.createGraph(a.triples))});this.observingCallbacks[f]=
j;this.connection.postMessage({fn:"startObservingNode",args:[a],callback:j})}else arguments.length===3&&(a=arguments[0],c=arguments[1],f=arguments[2],g=this,j=this.registerCallback("startObservingNode",function(a){for(var c,j=0;j<a.triples.length;j++)c=a.triples[j],a.triples[j]=new x.Triple(g.adaptJSInterface(c.subject),g.adaptJSInterface(c.predicate),g.adaptJSInterface(c.object));f(g.rdf.createGraph(a.triples))}),this.observingCallbacks[f]=j,this.connection.postMessage({fn:"startObservingNode",args:[a,
c],callback:j}))},L.RDFStoreClient.prototype.stopObservingNode=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingNode",args:[c],callback:[]})},L.RDFStoreClient.prototype.subscribe=function(a,c,f,g,j){var k=this,i=this.registerCallback("subscribe",function(a,c){for(var f,g=0;g<c.length;g++)f=c[g],c[g]=new x.Triple(k.adaptJSInterface(f.subject),k.adaptJSInterface(f.predicate),k.adaptJSInterface(f.object));
j(a,c)});this.observingCallbacks[j]=i;this.connection.postMessage({fn:"subscribe",args:[a,c,f,g],callback:i})},L.RDFStoreClient.prototype.unsubscribe=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"unsubscribe",args:[c],callback:[]})},L.RDFStoreClient.prototype.registeredGraphs=function(a){var c=this;this.connection.postMessage({fn:"registeredGraphs",args:[],callback:this.registerCallback("registeredGraphs",function(f,
g){if(f)for(var j=0;j<g.length;j++)graph=g[j],g[j]=c.adaptJSInterface(graph);a(f,g)})})},L.RDFStoreClient.prototype.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new x.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new x.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new x.NamedNode(a.nominalValue)},L.RDFStoreClient.prototype.isWebWorkerConnection=!0;var C={},sb={MongodbQueryEngine:function(){throw"MongoDB backend not supported in the browser version";
}};C.VERSION="0.5.10";C.connect=function(){var a,c,f;arguments.length==1&&(a=__dirname,c={},f=arguments[0]);arguments.length==2?(typeof arguments[0]==="string"?(a=arguments[0],c={}):(a=__dirname+"/index.js",c=arguments[0]),f=arguments[1]):(a=arguments[0],c=arguments[1],f=arguments[2]);try{Worker?new L.RDFStoreClient(a,c,function(a,c){f(a,c)}):C.create(c,function(a){f(!1,a)})}catch(g){C.create(c,function(a){f(!1,a)})}};C.create=function(){return arguments.length==1?new C.Store(arguments[0]):arguments.length==
2?new C.Store(arguments[0],arguments[1]):new C.Store};C.Store=function(a,c){var f=null,g=null;if(arguments.length==0)g={};else if(arguments.length==1)g={},f=a;else if(arguments.length>1)g=a,f=c;else throw"An optional argument map and a callback must be provided";g.treeOrder==null&&(g.treeOrder=15);this.functionMap={};var j=this;g.engine==="mongodb"?(this.isMongodb=!0,this.engine=new sb.MongodbQueryEngine(g),this.engine.readConfiguration(function(){g.overwrite===!0?j.engine.clean(function(){f(j)}):
f(j)})):new H.Lexicon(function(a){g.overwrite===!0&&a.clear();new V.QuadBackend(g,function(c){g.overwrite===!0&&c.clear();g.backend=c;g.lexicon=a;j.engine=new D.QueryEngine(g);f&&f(j)})},g.name)};C.Store.prototype.rdf=x.rdf;C.Store.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],
c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);this.engine.execute(a,c)}};C.Store.prototype.executeWithEnvironment=function(){var a,c,f;if(arguments.length===3){a=arguments[0];var g=function(){};c=arguments[1];f=arguments[2]}else arguments.length===4&&(a=arguments[0],g=arguments[3],c=arguments[1],f=arguments[2]);for(var j=[],k=[],i=0;i<c.length;i++)j.push({token:"uri",value:c[i]});for(i=0;i<f.length;i++)k.push({token:"uri",value:f[i]});this.engine.execute(a,g,j,k)};C.Store.prototype.graph=
function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",c)};C.Store.prototype.node=function(){var a=null,c=null,f=null;if(arguments.length===2)f=arguments[0],
c=arguments[1]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===3)f=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI, node URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.rdf.resolve(f)!=null&&(f=this.rdf.resolve(f));this.engine.execute("CONSTRUCT { <"+f+"> ?p ?o } WHERE { GRAPH <"+a+"> { <"+f+"> ?p ?o } }",c)};C.Store.prototype.startObservingNode=function(){var a,c,f;arguments.length===
2?(a=arguments[0],f=arguments[1],this.engine.callbacksBackend.observeNode(a,f,function(){})):arguments.length===3&&(a=arguments[0],c=arguments[1],f=arguments[2],this.engine.callbacksBackend.observeNode(a,c,f,function(){}))};C.Store.prototype.stopObservingNode=function(a){this.engine.callbacksBackend.stopObservingNode(a)};C.Store.prototype.startObservingQuery=function(a,c,f){f!=null?this.engine.callbacksBackend.observeQuery(a,c,f):this.engine.callbacksBackend.observeQuery(a,c,function(){})};C.Store.prototype.stopObservingQuery=
function(a){this.engine.callbacksBackend.stopObservingQuery(a)};C.Store.prototype.subscribe=function(a,c,f,g,j){var k=function(a,c){for(var f=[],g={blanks:{},outCache:{}},h=[],k=0;k<c.length;k++){var z=c[k],B=x.buildRDFResource(z.subject,h,this.engine,g),C=x.buildRDFResource(z.predicate,h,this.engine,g),z=x.buildRDFResource(z.object,h,this.engine,g);B!=null&&C!=null&&z!=null&&(z=new x.Triple(B,C,z),f.push(z))}j(a,f)};this.functionMap[j]=k;this.engine.callbacksBackend.subscribe(a,c,f,g,k,function(){})};
C.Store.prototype.unsubscribe=function(a){this.engine.callbacksBackend.unsubscribe(this.functionMap[a]);delete this.functionMap[a]};C.Store.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c)};C.Store.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a)};C.Store.prototype.insert=function(){var a,c,f;if(arguments.length===1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0],f=arguments[1]||function(){};else if(arguments.length===
3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),f=arguments[2]||function(){};else throw"The triples to insert, an optional graph and callback must be provided";var g="",j=this;c.forEach(function(a){g=g+j._nodeToQuery(a.subject)+j._nodeToQuery(a.predicate)+j._nodeToQuery(a.object)+"."});g=a!=null?"INSERT DATA { GRAPH "+this._nodeToQuery(a)+" { "+g+" } }":"INSERT DATA { "+this._nodeToQuery(a)+" { "+g+" }";this.engine.execute(g,f)};C.Store.prototype._nodeToQuery=function(a){if(a.interfaceName===
"NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else{if(a.interfaceName!=="")if(a.lang!=null)return'"'+a.valueOf()+'"@'+a.lang;else if(a.datatype!=null)return'"'+a.valueOf()+'"^^<'+a.datatype+">";return a.toString()}};C.Store.prototype["delete"]=function(){var a,c,f;if(arguments.length===1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0],f=arguments[1]||function(){};else if(arguments.length===
3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),f=arguments[2]||function(){};else throw"The triples to delete, an optional graph and callback must be provided";var g="",j=this;c.forEach(function(a){g=g+j._nodeToQuery(a.subject)+j._nodeToQuery(a.predicate)+j._nodeToQuery(a.object)+"."});g=a!=null?"DELETE DATA { GRAPH "+this._nodeToQuery(a)+" { "+g+" } }":"DELETE DATA { "+this._nodeToQuery(a)+" { "+g+" }";this.engine.execute(g,f)};C.Store.prototype.clear=function(){var a,c;if(arguments.length===
0)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=function(){};else if(arguments.length===1)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0]||function(){};else if(arguments.length===2)a=this.rdf.createNamedNode(arguments[0]),c=arguments[1]||function(){};else throw"The optional graph and a callback must be provided";this.engine.execute("CLEAR GRAPH "+this._nodeToQuery(a),c)};C.Store.prototype.setBatchLoadEvents=function(a){this.engine.eventsOnBatchLoad=
a};C.Store.prototype.registerDefaultNamespace=function(a,c){this.rdf.prefixes.set(a,c);this.engine.registerDefaultNamespace(a,c)};C.Store.prototype.registerDefaultProfileNamespaces=function(){var a=this.rdf.prefixes.values(),c;for(c in a)this.registerDefaultNamespace(c,a[c])};C.Store.prototype.load=function(){var a,c,f,g;if(arguments.length===3)f=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),a=arguments[0],c=arguments[1],g=arguments[2]||function(){};else if(arguments.length===4)a=
arguments[0],c=arguments[1],f=this.rdf.createNamedNode(arguments[2]),g=arguments[3]||function(){};else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if(a==="remote")c=this.rdf.createNamedNode(c),this.engine.execute("LOAD <"+c.valueOf()+"> INTO GRAPH <"+f.valueOf()+">",g);else if(c&&typeof c==="string"&&c.indexOf("file://")===0){a=this.engine.rdfLoader.parsers[a];var j=this;this.engine.rdfLoader.loadFromFile(a,{token:"uri",value:f.valueOf()},
c,function(a,c){a?j.engine.batchLoad(c,g):g(a,c)})}else a=this.engine.rdfLoader.parsers[a],j=this,this.engine.rdfLoader.tryToParse(a,{token:"uri",value:f.valueOf()},c,function(a,c){a?j.engine.batchLoad(c,g):g(a,c)})};C.Store.prototype.registerParser=function(a,c){this.engine.rdfLoader.registerParser(a,c)};C.Store.prototype.registeredGraphs=function(a){if(this.isMongodb)this.engine.registeredGraphs(!0,function(c){for(var f=[],g=0;g<c.length;g++){var h=new x.NamedNode(c[g]);f.push(h)}return a(!0,f)});
else{for(var c=this.engine.lexicon.registeredGraphs(!0),f=[],g=0;g<c.length;g++){var j=new x.NamedNode(c[g]);f.push(j)}return a(!0,f)}};C.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else return a.toString()};C.Store.prototype.getNetworkTransport=function(){return P};C.Store.prototype.setNetworkTransport=function(a){P=a};RDFStoreWorker={observingCallbacks:{},workerCallbacksCounter:0,workerCallbacks:{}};
RDFStoreWorker.registerCallback=function(a){var c=""+RDFStoreWorker.workerCallbacksCounter;RDFStoreWorker.workerCallbacksCounter++;RDFStoreWorker.workerCallbacks[c]=a;return c};RDFStoreWorker.handleCreate=function(a,c){typeof P!="undefined"&&P!=null&&(P={load:function(a,c,g){var k=RDFStoreWorker.registerCallback(function(a){g.apply(g,a)});postMessage({fn:"workerRequest:NetworkTransport:load",callback:k,arguments:[a,c]})},loadFromFile:function(){}});args=[a];args.push(function(a){RDFStoreWorker.store=
a;postMessage({callback:c,result:"created",success:!0})});C.create.apply(C,args)};RDFStoreWorker.receive=function(a){var c=a.data||a;if(c.fn==="workerRequestResponse"){var f=c.callback,g=RDFStoreWorker.workerCallbacks[f];g!=null&&(delete RDFStoreWorker.workerCallbacks[f],g(c.results))}else if(c.fn==="create"&&c.args!=null)RDFStoreWorker.handleCreate(c.args,c.callback);else if(c.fn==="setBatchLoadEvents")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if(c.fn==="registerDefaultNamespace")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args);else if(c.fn==="registerDefaultProfileNamespaces")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if((c.fn==="execute"||c.fn==="executeWithEnvironment"||c.fn==="graph"||c.fn==="node"||c.fn==="clear"||c.fn==="load")&&c.args!=null){c.args.push(function(a,f){c.callback!=null&&postMessage({callback:c.callback,result:f,success:a})});try{RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)}catch(j){console.log("Error executing method through connection"),console.log(j)}}else if((c.fn===
"insert"||c.fn==="delete")&&c.args!=null)try{c.args.push(function(a,f){c.callback!=null&&postMessage({callback:c.callback,result:f,success:a})});g=c.args[0];for(a=0;a<g.triples.length;a++)f=g.triples[a],g.triples[a]=new x.Triple(RDFStoreWorker.adaptJSInterface(f.subject),RDFStoreWorker.adaptJSInterface(f.predicate),RDFStoreWorker.adaptJSInterface(f.object));c.args[1].interfaceName!=null&&(c.args[1]=RDFStoreWorker.adaptJSInterface(c.args[1]));c.args[0]=RDFStoreWorker.store.rdf.createGraph(g.triples);
RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)}catch(k){console.log("Error executing method through connection"),console.log(k)}else c.fn==="rdf/setPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setPrefix(c.args[0],c.args[1]):c.fn==="rdf/setDefaultPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setDefaultPrefix(c.args[0]):c.fn==="startObservingQuery"&&c.args!=null?(f=function(a,f){postMessage({callback:c.callback[0],result:f,success:a})},RDFStoreWorker.observingCallbacks[c.args[0]]=
f,c.args.push(f),c.args.push(function(a,f){c.callback&&c.callback[1]!=null&&postMessage({callback:c.callback[1],result:f,success:a})}),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingQuery"?((f=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[f]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="startObservingNode"&&c.args!=null?(f=function(a){postMessage({callback:c.callback,result:a})},RDFStoreWorker.observingCallbacks[c.callback]=
f,c.args.push(f),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingNode"&&c.args!=null?((f=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[f]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="subscribe"&&c.args!=null?(f=function(a,f){postMessage({callback:c.callback,event:a,result:f})},RDFStoreWorker.observingCallbacks[c.callback]=f,c.args.push(f),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args)):c.fn==="stopObservingNode"&&c.args!=null?((f=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[f]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="registeredGraphs"&&c.args!=null&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[function(a,f){c.callback!=null&&postMessage({callback:c.callback,result:f,success:a})}])};RDFStoreWorker.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new x.BlankNode(a.bnodeId);
else if(a.interfaceName==="Literal")return new x.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new x.NamedNode(a.nominalValue)};onmessage=RDFStoreWorker.receive;try{window.rdfstore=C}catch(Cc){}})();
